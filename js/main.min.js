var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function s(t){try{h(n.next(t))}catch(e){r(e)}}function a(t){try{h(n["throw"](t))}catch(e){r(e)}}function h(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(s,a)}h((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(o)throw new TypeError("Generator is already executing.");for(;h;)try{if(o=1,r&&(s=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,r=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){h.label=i[1];break}if(6===i[0]&&h.label<s[1]){h.label=s[1],s=i;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(i);break}s[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(n){i=[6,n],r=0}finally{o=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,r,s,a,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},scene;!function(t){var e=function(t){function e(){var i=t.call(this)||this;return i.id=e.s_count++,i}return __extends(e,t),e.prototype.moveTo=function(t,e){this.m_x=t,this.m_y=e},e.prototype.setPos=function(t,e){this.m_x=t,this.m_y=e},e.prototype.dispose=function(){},Object.defineProperty(e.prototype,"x",{get:function(){return this.m_x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.m_y},enumerable:!0,configurable:!0}),e.s_count=0,e.MOVE="elementmove",e}(egret.EventDispatcher);t.fElement=e,__reflect(e.prototype,"scene.fElement")}(scene||(scene={}));var scene;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.m_visible=!0,i.m_isVisibleNow=!1,i.depthOrder=0,i.m_layer=0,i.m_depth=0,i.m_map=t,i.m_bInScene=!0,i.m_isDisposed=!1,i.m_screenArea=new egret.Rectangle,i}return __extends(i,e),Object.defineProperty(i.prototype,"map",{get:function(){return this.m_map},enumerable:!0,configurable:!0}),i.prototype.show=function(){this.m_visible||(this.m_visible=!0,this.updateRenderVisible())},i.prototype.hide=function(){this.m_visible&&(this.m_visible=!1,this.updateRenderVisible())},Object.defineProperty(i.prototype,"isInScene",{set:function(t){this.m_bInScene!=t&&(this.m_bInScene=t,this.updateRenderVisible())},enumerable:!0,configurable:!0}),i.prototype.onAddToMap=function(t){this.m_map=t},i.prototype.onRemoveFromMap=function(){this.m_map=null},i.prototype.isInQuadNode=function(t){return i.s_helpQuad_Rect.setTo(this.m_x+this.m_screenArea.x,this.m_y+this.m_screenArea.y,this.m_screenArea.width,this.m_screenArea.height),t.area.containsRect(i.s_helpQuad_Rect)},i.prototype.isIntersectWidth=function(t){return i.s_helpQuad_Rect.setTo(this.m_x+this.m_screenArea.x,this.m_y+this.m_screenArea.y,this.m_screenArea.width,this.m_screenArea.height),t.intersects(i.s_helpQuad_Rect)},i.prototype.isHit=function(t,e){return this.m_render?this.m_render.hitTest(t,e):!1},Object.defineProperty(i.prototype,"layer",{get:function(){return this.m_layer},set:function(t){this.m_layer=t},enumerable:!0,configurable:!0}),i.prototype.updateDepth=function(t){void 0===t&&(t=!0),Math.abs(this.m_depth-this.y)>32&&(this.m_depth=this.y,t&&this.dispatchEventWith(i.DEPTHCHANGE))},i.prototype.moveTo=function(i,n){e.prototype.moveTo.call(this,i,n),t.SLObject==this.layer&&this.updateDepth(!0)},Object.defineProperty(i.prototype,"depth",{get:function(){return this.m_depth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isInCamera",{set:function(t){this.m_inCamera!=t&&(this.m_inCamera=t,this.updateRenderVisible())},enumerable:!0,configurable:!0}),i.prototype.clearRender=function(){this.m_render&&(this.m_render.dispose(),this.m_render=null)},i.prototype.createRender=function(){if(null==this.m_render){var t=this.getflash9RendererClass();this.m_render=new t(this,this.m_map.getLayer(this.layer))}},i.prototype.showRender=function(){this.m_render&&(this.m_isVisibleNow=!0,this.m_render.show())},i.prototype.hideRender=function(){this.m_render&&(this.m_isVisibleNow=!1,this.m_render.hide())},Object.defineProperty(i.prototype,"elementRoot",{get:function(){return this.m_render?this.m_render.elementRoot:null},enumerable:!0,configurable:!0}),i.prototype.tryClearRender_OnUpdateRenderVisible=function(){this.clearRender()},i.prototype.updateRenderVisible=function(){return 0==this.m_map.isBeingRendered||0==this.m_bInScene||0==this.m_inCamera?(this.hideRender(),void this.tryClearRender_OnUpdateRenderVisible()):void(this.m_visible?0==this.m_isVisibleNow&&(this.createRender(),this.showRender()):this.m_isVisibleNow&&this.hideRender())},i.prototype.getflash9RendererClass=function(){return t.fElementRender},i.prototype.advanceTime=function(t){this.m_visible&&this.m_isVisibleNow&&this.m_render&&this.m_render.advanceTime(t)},i.prototype.dispose=function(){this.clearRender(),this.m_isDisposed=!0},Object.defineProperty(i.prototype,"isDisposed",{get:function(){return this.m_isDisposed},enumerable:!0,configurable:!0}),i.DEPTHCHANGE="renderableElementDepthChange",i.s_helpQuad_Rect=new egret.Rectangle,i}(t.fElement);t.fRenderableElement=e,__reflect(e.prototype,"scene.fRenderableElement")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){this.m_curIndex=0,this.mList=new Array}return Object.defineProperty(e.prototype,"length",{get:function(){return this.mList.length},enumerable:!0,configurable:!0}),e.prototype.getAction=function(t){return this.mList[t]},e.prototype.addAction=function(e,i,n){void 0===i&&(i=!0),void 0===n&&(n=!1);var o=new t.Action;o.mActID=e,o.mLoop=i,o.mBackwardPlay=n,this.mList.push(o)},e.prototype.clear=function(){this.mList.length=0},e.prototype.copyFrom=function(e){this.clear();var i=0,n=e.mList.length;for(i=0;n>i;i++){var o=new t.Action;o.copyFrom(e.mList[i]),this.mList.push(o)}},e}();t.ActionList=e,__reflect(e.prototype,"scene.ActionList")}(scene||(scene={}));var Cmd;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.byCmd=t,this.byParam=e}return t.prototype.serialize=function(t){t.writeByte(this.byCmd),t.writeByte(this.byParam)},t.prototype.deserialize=function(t){this.byCmd=t.readUnsignedByte(),this.byParam=t.readUnsignedByte()},t}();t.t_NullCmd=e,__reflect(e.prototype,"Cmd.t_NullCmd")}(Cmd||(Cmd={}));var dataset;!function(t){var e=function(){function t(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this.m_index=-1,this.m_list=new Array(t),this.m_funOnCollect=e,this.m_thisObject=i}return t.prototype.createObject=function(){return null},t.prototype.getObject=function(){var t;return this.m_index<0?t=this.createObject():(t=this.m_list[this.m_index],this.m_list[this.m_index]=null,this.m_index--,t)},t.prototype.collect=function(t){null!=this.m_funOnCollect&&this.m_thisObject&&this.m_funOnCollect.call(this.m_thisObject,t),this.m_index++,this.m_index>=this.m_list.length&&this.m_list.push(null),this.m_list[this.m_index]=t},t.prototype.dispose=function(){for(var t,e=0,i=this.m_list;e<i.length;e++)t=i[e],t&&"dispose"in t&&t.dispose.call(t)},t}();t.ObjectGCBase=e,__reflect(e.prototype,"dataset.ObjectGCBase")}(dataset||(dataset={}));var scene;!function(t){var e=function(e){function i(i,n){var o=e.call(this,n)||this;return o.m_ACfresh=!1,o.m_ACIndex=0,o.m_scale=1,o.m_scaleX=1,o.m_tempid=0,o.m_alpha=1,o.m_bGray=!1,o.m_angle=0/0,o.m_dir=0,o.m_AC=new t.ActionList,o.m_AC.addAction(UtilModel.TActStand),o.m_ACfresh=!0,o.setModel(i),o}return __extends(i,e),i.prototype.setModel=function(t){this.clearModel(),this.m_model=Context.modelDataMgr.getModelData(t),Context.modelDataMgr.addUser(this.m_model,this),this.m_model.config.getBound(this.m_screenArea),this.m_render&&this.m_render.isAssetCreated&&this.m_render.createModelMC()},i.prototype.clearModel=function(){this.m_model&&(Context.modelDataMgr.removeUser(this.m_model,this),this.m_model=null)},Object.defineProperty(i.prototype,"model",{get:function(){return this.m_model},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"amMgr",{get:function(){return this.m_amMgr||(this.m_amMgr=new t.AdditionalModelMgr),this.m_amMgr},enumerable:!0,configurable:!0}),i.prototype.has_additionalModel=function(){return null!=this.m_amMgr&&!this.m_amMgr.isEmpty},Object.defineProperty(i.prototype,"tModelItem",{get:function(){return this.m_model.config.tModelItem},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isTranslucent",{get:function(){return this.m_isTranslucent},set:function(t){this.m_isTranslucent!=t&&(this.m_isTranslucent=t,this.m_render&&(this.m_render.isTranslucent=t))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"angle",{get:function(){return this.m_angle},set:function(t){var e=t%360;0>e&&(e+=360),this.m_angle!=e&&(this.m_angle=e,this.m_dir=UtilModel.angle360ToDir8(this.m_angle))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dir",{get:function(){return this.m_dir},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"act",{get:function(){var t=this.m_AC.getAction(this.m_ACIndex);return t.mActID},enumerable:!0,configurable:!0}),i.prototype.onActListComplete=function(){},i.prototype.setAct=function(t,e,n){if(void 0===e&&(e=!0),void 0===n&&(n=!1),null!=this.m_model){if(!this.m_model.hasAct(t))return void egret.log("this.m_model.hasAct(a) == false; a="+t+" name="+this.m_model.config.name);if(1==this.m_AC.length){var o=this.m_AC.getAction(0);if(o.isEqualTo(t,e,n))return}i.s_oldAC.copyFrom(this.m_AC),this.m_AC.clear(),this.m_AC.addAction(t,e,n),this.m_ACfresh=!0,this.onActChange(i.s_oldAC),this.act==UtilModel.TActDie&&(this.angle=90)}},i.prototype.setActList=function(t){this.m_AC.copyFrom(t),this.m_ACfresh=!0},i.prototype.onActChange=function(t){},i.prototype.getTimeScale=function(){return 1},i.prototype.switchToRunAct=function(){this.setAct(UtilModel.TActRun)},i.prototype.switchToStandAct=function(){this.setAct(UtilModel.TActStand)},i.prototype.moveTo=function(t,e){egret.log("fObject::moveTo must be implemented by subclass")},i.prototype.dispose=function(){this.m_alphaFadeAni&&(this.m_alphaFadeAni.dispose(),this.m_alphaFadeAni=null),this.m_effectOnBody&&(this.m_effectOnBody.dispose(),this.m_effectOnBody=null),this.m_AC.clear(),this.clearModel(),this.m_bGray=!1,e.prototype.dispose.call(this)},i.prototype.changeShow=function(t){this.clearModel(),this.setModel(t)},Object.defineProperty(i.prototype,"tagHeight",{get:function(){return this.m_model.config.tModelItem.m_offsetName},enumerable:!0,configurable:!0}),i.prototype.getflash9RendererClass=function(){return t.fObjectRender},i.prototype.setScale=function(t){this.m_scale=t},i.prototype.getScale=function(){return this.m_scale},i.prototype.setScaleX=function(t){this.m_scaleX=t},i.prototype.getScaleX=function(){return this.m_scaleX},Object.defineProperty(i.prototype,"tempid",{get:function(){return this.m_tempid},set:function(t){this.m_tempid=t},enumerable:!0,configurable:!0}),i.prototype.onCreateAssets=function(){},i.prototype.getHeadTopClass=function(){return null},i.prototype.getHeadTopBase=function(){var t=this.m_render;return t?t.getHeadTop():null},i.prototype.updateNameDesc=function(){var t=this.getHeadTopBase();t&&t.updateHeadTopData()},Object.defineProperty(i.prototype,"hitY",{get:function(){return this.m_model.config.tModelItem.m_hitY},enumerable:!0,configurable:!0}),i.prototype.onClick=function(){},i.prototype.getPositionY=function(t){var e=0;switch(t){case UtilModel.MODELPostion_name:e=this.tagHeight;break;case UtilModel.MODELPostion_hit:e=this.hitY;break;case UtilModel.MODELPostion_referencePoint:e=0}return e},Object.defineProperty(i.prototype,"alpha",{get:function(){return this.m_alpha},set:function(t){this.m_alpha=t,this.m_render&&(this.m_render.alpha=t)},enumerable:!0,configurable:!0}),i.prototype.bGray=function(){return this.m_bGray},i.prototype.grayChange=function(t){this.m_bGray!=t&&(this.m_bGray=t,this.m_render&&this.m_render.grayChange(t))},Object.defineProperty(i.prototype,"isHasEffectOnBody",{get:function(){return null!=this.m_effectOnBody},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"effectOnBody",{get:function(){return null==this.m_effectOnBody&&(this.m_effectOnBody=new t.EffectOnBeing(this)),this.m_effectOnBody},enumerable:!0,configurable:!0}),i.prototype.onAddEffect=function(t){this.m_render&&this.m_render.onAddEffect(t)},Object.defineProperty(i.prototype,"bAniFading",{get:function(){return this.m_alphaFadeAni&&this.m_alphaFadeAni.bRun},enumerable:!0,configurable:!0}),i.prototype.fadeOut=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=this.getAlphaFadeAni();i.bRun&&Context.logMgr.sendServer("fadeOut() warning! id="+this.id+" tempid="+this.tempid+" hashCode="+this.hashCode),i.setComplete_callback(t,e),i.resetValues({alpha:0}),i.begin()},i.prototype.fadeIn=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=this.getAlphaFadeAni();i.bRun&&Context.logMgr.sendServer("fadeIn() warning! id="+this.id+" tempid="+this.tempid+" hashCode="+this.hashCode),i.setComplete_callback(t,e),i.resetValues({alpha:1}),i.begin()},i.prototype.getAlphaFadeAni=function(){var t=this.m_alphaFadeAni;return t||(t=new animation.AniPropertys,t.target=this,t.duration=.5,t.repeatCount=1,this.m_alphaFadeAni=t),t},i.s_oldAC=new t.ActionList,i}(t.fRenderableElement);t.fObject=e,__reflect(e.prototype,"scene.fObject")}(scene||(scene={}));var Cmd;!function(t){t.MAX_IP_LENGTH=48,t.MAX_NAMESIZE=48,t.MAX_QUEST_NAME=48,t.MAX_NSIZE=32,t.MAX_VSIZE=128,t.MAX_UID_LEN=80,t.MAX_LOGIN_ERRO_STR=128,t.MAX_TOKEN_LEN=512,t.MAX_CID_LEN=48,t.MAX_EXT_LEN=256,t.MAX_OPEN_KEY_LEN=128,t.FRIEND_HEAD_URL_LEN=256,t.TOPIC=32,t.MAILTEXT=1e3;var e=function(t){function e(){var e=t.call(this)||this;return e.dwTimestamp=0,e}return __extends(e,t),e.prototype.serialize=function(e){Context.msgRecordMgr.send(this),t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.dwTimestamp)},e.prototype.deserialize=function(e){Context.msgRecordMgr.receive(this),t.prototype.deserialize.call(this,e),this.dwTimestamp=e.readUnsignedInt(),this.dwTimestamp&&Context.timeMgr.updateServerTime(this.dwTimestamp)},e.LOGON_USERCMD=1,e.TIME_USERCMD=2,e.TASK_USERCMD=3,e.GAME_USERCMD=4,e.MAIL_USERCMD=5,e.CHAT_USERCMD=7,e.ACTIVITY_USERCMD=10,e.OBJECT_USERCMD=11,e.GIFT_USERCMD=26,e.FRIEND_USERCMD=28,e.FUNCTION_USERCMD=39,e}(t.t_NullCmd);t.stNullUserCmd=e,__reflect(e.prototype,"Cmd.stNullUserCmd")}(Cmd||(Cmd={}));var common;!function(t){var e=function(){function t(){this.m_id=0,this.m_isSupportABTest=!1,this.m_ABTestVersion=0,this.m_isSupportRelogin=!1,this.m_sdk=0}return t.prototype.init=function(t,e){return this.m_sdk=t,this.setPlatformID(e),!0},Object.defineProperty(t.prototype,"isSelfLoginCheck",{get:function(){return this.m_isSelfLoginCheck},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSupportRelogin",{get:function(){return this.m_isSupportRelogin},enumerable:!0,configurable:!0}),t.prototype.setPlatformID=function(t){this.m_id=t,Context.platformMgr.setPlatformID(t)},Object.defineProperty(t.prototype,"pid",{get:function(){return this.m_id},enumerable:!0,configurable:!0}),t.prototype.set_uid=function(t){var e=typeof t;"string"!=e&&(t=""+t),this.m_uid=t,Context.logMgr.addLog("set_uid="+t)},Object.defineProperty(t.prototype,"isSupportSendDesk",{get:function(){return this.m_supportSendDesk},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSupportABTest",{get:function(){return this.m_isSupportABTest},enumerable:!0,configurable:!0}),t.prototype.setABTestVersion=function(t){this.m_ABTestVersion="1"==t?1:0},t.prototype.getABTestVersion=function(){return this.m_ABTestVersion},t.prototype.setLoginParam=function(t){this.m_time=t.time,this.m_sign=t.sign},t.prototype.get_uid_common=function(){return this.m_uid?this.m_uid:this.getuid()},t.prototype.onInitComplete=function(){Context.operationMgr.onInitComplete()},t.prototype.getURLParam=function(t){return egret.getOption(t)},t.prototype.hasURLParam=function(t){var e=egret.getOption(t);return e&&e.length>0?!0:!1},t.prototype.sendInfoAfterLogin=function(){},t.prototype.sendLoginInfo=function(){var t=new Cmd.muCommonPlatformUserRequestLoginCmd;t.uid=this.get_uid_common(),t.cid=this.getcid(),t.zone=1,t.pid=this.m_id,t.time=this.m_time,t.sign=this.m_sign,Context.sendMsg(t),Context.loadingView.setText("房间打扫中",6),Context.logMgr.addLog("发送登录信息 muCommonPlatformUserRequestLoginCmd uid="+t.uid+" cid="+t.cid+" zone="+t.zone+" pid="+t.pid+" time="+t.time+" sign="+t.sign)},t.prototype.sendReLoginInfo=function(){var t=new Cmd.muCommonPlatformUserRequestReLoginCmd;t.uid=this.get_uid_common(),t.cid=this.getcid(),t.reloginToken=Context.loginData.reloginToken,t.zone=1,t.pid=Context.operationMgr.isNeiwang?Context.loginData.platformType:this.pid,Context.sendMsg(t);var e="muCommonPlatformUserRequestReLoginCmd token="+t.reloginToken+" uid="+t.uid+" cid="+t.cid+" zone="+t.zone+" pid="+t.pid;Context.logMgr.addLog(e),1!=Context.loginData.zoneId&&Context.logMgr.sendServer(e+" (zoneId="+Context.loginData.zoneId+")")},t.prototype.getuid=function(){return Context.platformMgr.getURLParam("uid")},t.prototype.getToken=function(){return Context.platformMgr.getURLParam("token")},t.prototype.getcid=function(){return Context.platformMgr.getURLParam("chn")},t.prototype.isShareOpened=function(){return this.m_shareOpened},t.prototype.isAttentionOpened=function(){return this.m_attentionOpened},t.prototype.hasAttention=function(){return this.m_hasAttention},t.prototype.chongzhi=function(t){},t.prototype.sendRequestExt=function(t){var e=new Cmd.stReqRechargeGameOrderUserCmd;e.goodsId=t,Context.sendMsg(e)},t.prototype._onReturnExt=function(t){this.onReturnExt(t.data)},t.prototype.onReturnExt=function(t){},t.prototype.update_ReqLoginCmd=function(t){},t.prototype.fill_ReqLoginCmd=function(t){t.sdkID=this.m_sdk,t.pid=this.m_id,this.update_ReqLoginCmd(t)},t.prototype.getReqestWriteRecordParam=function(){var t={ryPlatform:this.m_id,uid:this.get_uid_common(),token:this.getToken(),zone:Context.loginData.zoneId,sdk:this.m_sdk};return UtilUrl.jointURLParam(t)},t.prototype.doShare=function(t){void 0===t&&(t=null)},t.prototype.onShareEnd=function(){},t.prototype.doAttention=function(){},t.prototype.onAttentionEnd=function(){},t.prototype.showRewardedVideoAd=function(t,e,i){},t.prototype.showBannerAd=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null)},t.prototype.hideBannerAd=function(){},t.prototype.bShowBannerAd=function(){return!1},t.prototype.loginOut=function(){},t.prototype.shoucangGame=function(){},t.prototype.yaoqing=function(){},t.prototype.onShoucangGameSuccess=function(){},t.prototype.on_uidCheckFail=function(){},t.prototype.report_selectServer=function(){},t.prototype.report_createRole=function(){},t.prototype.report_levelup=function(){},t.prototype.report_enterGame=function(){},t.prototype.sendMakeSignHttpRequest=function(t){if(!this.m_makeSignRequest){t.pid=this.m_id;var e=encodeURIComponent("muYunying/loginrecord/makeSign"),i=Context.bzConfig.php_server_URL,n=i+"?r="+e,o=UtilUrl.jointURLParam(t);this.m_makeSignRequest=new core.HttpRequest_post,this.m_makeSignRequest.send(n,o,this.onMakeSignHttpRequestComplete,this.onMakeSignHttpRequestError,this)}},t.prototype.onMakeSignHttpRequestComplete=function(){var t=this.m_makeSignRequest.getResponse();if(t){var e=JSON.parse(t),i=e.msg;0==e.code&&this.onMakeSignHttpRequestReturn(i)}this.m_makeSignRequest=null},t.prototype.onMakeSignHttpRequestReturn=function(t){},t.prototype.onMakeSignHttpRequestError=function(){},t}();t.OperationBase=e,__reflect(e.prototype,"common.OperationBase")}(common||(common={}));var scene;!function(t){var e=function(){function e(e,i){this.m_element=e,this.m_mapLayer=i,this.m_map=e.map,this.m_eleRoot=t.fMap.s_getSprite(),this.m_eleRoot.name="eleRoot",this.place()}return e.prototype.createAssets=function(){this.m_assetsCreated=!0},Object.defineProperty(e.prototype,"isAssetCreated",{get:function(){return this.m_assetsCreated},enumerable:!0,configurable:!0}),e.prototype.show=function(){this.m_assetsCreated||(this.createAssets(),this.m_element.hasOwnProperty("onCreateAssets")&&this.m_element.onCreateAssets.apply(null,null)),null==this.m_eleRoot.parent&&(this.m_mapLayer.addChild(this.m_eleRoot),(t.SLObject==this.m_element.layer||t.SLSurface==this.m_element.layer)&&(this.m_map.m_depthController.addToDepthSort(this.m_element),this.m_map.m_depthController.m_depthDirty=!0))},e.prototype.hide=function(){this.m_eleRoot.parent==this.m_mapLayer&&(this.m_mapLayer.removeChild(this.m_eleRoot),(t.SLObject==this.m_element.layer||t.SLSurface==this.m_element.layer)&&this.m_map.m_depthController.removeFromDepthSort(this.m_element))},e.prototype.hitTest=function(t,e){return!1},e.prototype.advanceTime=function(t){},Object.defineProperty(e.prototype,"elementRoot",{get:function(){return this.m_eleRoot},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapLayer",{get:function(){return this.m_mapLayer&&this.m_eleRoot.parent==this.m_mapLayer?this.m_mapLayer:null},enumerable:!0,configurable:!0}),e.prototype.place=function(){this.m_eleRoot.x=this.m_element.x,this.m_eleRoot.y=this.m_element.y},Object.defineProperty(e.prototype,"alpha",{set:function(t){this.setAlpha(t)},enumerable:!0,configurable:!0}),e.prototype.setAlpha=function(t){this.m_eleRoot.alpha=t},e.prototype.dispose=function(){this.hide(),this.m_eleRoot.alpha=1,t.fMap.s_collectSprite(this.m_eleRoot),this.m_eleRoot=null},e}();t.fElementRender=e,__reflect(e.prototype,"scene.fElementRender")}(scene||(scene={}));var uicommon;!function(t){var e=function(){function t(t){this.m_ds=t,this.m_dsY=t.y,this.m_cutRect=new egret.Rectangle,this.setCutRect(this.m_ds.width,this.m_ds.height)}return t.prototype.setCutRect=function(t,e){this.m_cutRect.width=t,this.m_cutRect.height=e,this.m_ds.scrollRect=this.m_cutRect},Object.defineProperty(t.prototype,"cutRectW",{get:function(){return this.m_cutRect.width},set:function(t){this.m_cutRect.width=t,this.m_ds.scrollRect=this.m_cutRect},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cutRectH",{get:function(){return this.m_cutRect.height},set:function(t){var e=this.m_ds.height>t?this.m_ds.height-t:0;this.m_cutRect.height=t,this.m_cutRect.y=e,this.m_ds.scrollRect=this.m_cutRect,this.m_ds.y=this.m_dsY+e},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.m_ds=null,this.m_cutRect=null},t}();t.PanelCut=e,__reflect(e.prototype,"uicommon.PanelCut")}(uicommon||(uicommon={}));var dataset;!function(t){var e=function(t){function e(e,i,n,o){void 0===n&&(n=null),void 0===o&&(o=null);var r=t.call(this,i,n,o)||this;return r.m_class=e,r}return __extends(e,t),e.prototype.createObject=function(){return new this.m_class},e}(t.ObjectGCBase);t.GCCommon=e,__reflect(e.prototype,"dataset.GCCommon")}(dataset||(dataset={}));var scene;!function(t){var e=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.m_vx=0,n.m_vy=0,n.m_vel=100,n.m_dx=0,n.m_dy=0,n.m_isCameraTarget=!1,n.m_level=0,n.m_log="",n.m_vx=0,n.m_vy=0,n}return __extends(i,e),i.prototype.addLog=function(t){this.m_log.length>3e3&&(this.m_log=this.m_log.substring(this.m_log.length-1e3)),this.m_log+=t+"\n"},i.prototype.advanceTime=function(t){e.prototype.advanceTime.call(this,t),this.updateMove(t)},i.prototype.updateMove=function(t){if(this.isMoving()){if(this.m_dx==this.m_x&&this.m_dy==this.m_y){if(!(this.m_currentPath&&this.m_currentPath.size>0))return this.dispatchEventWith(egret.Event.COMPLETE),this.stopMoving(),void this.onArrive();var e=this.m_currentPath.getTempPoint(0);this.m_currentPath.remove(0),this.moveToPosNoAIf(e.x,e.y)}var i=this.m_dx-this.m_x,n=this.m_dy-this.m_y,o=Math.pow(i*i+n*n,.5);if(0==o)return;var r=1/o;i*=r,n*=r;var s=t*this.m_vel;s>o&&(s=o);var a=i*s,h=n*s,m=this.m_x+a,c=this.m_y+h;if(m>=this.m_map.widthPx||c>=this.m_map.heightPx){var u="BeingEntity::updateMove() "+UtilTools.keyValueToString_parenthese("newX",m,"newY",c,"mapid",this.m_map.m_config.m_mapID,"m_dx",this.m_dx,"m_dy",this.m_dy,"disx",a,"disy",h,"class",this.__class__);Context.logMgr.sendServer(u)}this.moveTo(this.m_x+a,this.m_y+h)}},i.prototype.stopMoving=function(t){void 0===t&&(t=!0),this.isMoving()&&(this.setAct(UtilModel.TActStand),this.clearPath(),this.m_dx=this.m_x,this.m_dy=this.m_y)},i.prototype.startMoving=function(){},Object.defineProperty(i.prototype,"vel",{get:function(){return this.m_vel},set:function(t){this.m_vel=t},enumerable:!0,configurable:!0}),i.prototype.resetVel=function(){this.m_vel=100},i.prototype.getflash9RendererClass=function(){return t.BeingEntityRender},Object.defineProperty(i.prototype,"name",{get:function(){return this.m_name},set:function(t){this.m_name=t,this.updateNameDesc()},enumerable:!0,configurable:!0}),i.prototype.moveToPos=function(t){return this.moveToPos_XY(t.x,t.y)},i.prototype.moveToPos_XY=function(e,n){if(this.isOut_of_bound(e,n))return void Context.logMgr.sendServer("出界 "+UtilCommon.getStackInfo());i.s_dest3D.x=e,i.s_dest3D.y=n,i.s_cur3D.x=this.m_x,i.s_cur3D.y=this.m_y,null==this.m_currentPath&&(this.m_currentPath=new t.PathFound);var o=this.m_map.AI.findPath(i.s_cur3D,i.s_dest3D);if(o&&o.size>0){this.m_currentPath.copyFrom(o);var r=this.m_currentPath.getTempPoint(0);this.m_currentPath.remove(0),this.moveToPosNoAIf(r.x,r.y)}else{this.m_currentPath.clear();var s=this.m_map.translateToCell(this.m_x,this.m_y),a=this.m_map.translateToCell(i.s_dest3D.x,i.s_dest3D.y);if(s!=a||this.m_x==i.s_dest3D.x&&this.m_y==i.s_dest3D.y)return i.s_cur3D.x!=i.s_dest3D.x||i.s_cur3D.y!=i.s_dest3D.y,!1;this.moveToPosNoAIf(i.s_dest3D.x,i.s_dest3D.y)}return!0},i.prototype.moveToPosNoAIPt=function(t){return this.isOut_of_bound(t.x,t.y)?void Context.logMgr.sendServer("出界 "+UtilCommon.getStackInfo()):(this.setAct(UtilModel.TActRun),this.m_dx=t.x,this.m_dy=t.y,this.angle=UtilMath.getAngle(this.m_x,this.m_y,this.m_dx,this.m_dy),void this.startMoving())},i.prototype.moveToPosNoAIf=function(t,e){return this.isOut_of_bound(t,e)?void Context.logMgr.sendServer("出界 "+UtilCommon.getStackInfo()):(this.setAct(UtilModel.TActRun),this.m_dx=t,this.m_dy=e,this.angle=UtilMath.getAngle(this.m_x,this.m_y,this.m_dx,this.m_dy),void this.startMoving())},i.prototype.goToPosPt=function(t){return this.isOut_of_bound(t.x,t.y)?void Context.logMgr.sendServer("出界 "+UtilCommon.getStackInfo()):(this.setAct(UtilModel.TActRun),void this.moveTo(t.x,t.y))},i.prototype.goToPosf=function(t,e){return this.isOut_of_bound(t,e)?void Context.logMgr.sendServer("出界 "+UtilCommon.getStackInfo()):(this.moveTo(t,e),this.m_dx=this.m_x,void(this.m_dy=this.m_y))},i.prototype.onArrive=function(){},i.prototype.needUpdate=function(){return this.m_visible?!0:this.isMoving()?!0:!1},i.prototype.updateNameDesc=function(){e.prototype.updateNameDesc.call(this)},Object.defineProperty(i.prototype,"level",{get:function(){return this.m_level},set:function(t){this.m_level=t},enumerable:!0,configurable:!0}),i.prototype.isMoving=function(){return this.m_AC.length>0&&this.m_AC.getAction(0).mActID==UtilModel.TActRun?!0:!1},i.prototype.clearPath=function(){this.m_currentPath&&this.m_currentPath.clear()},Object.defineProperty(i.prototype,"canAttacked",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isDie",{get:function(){return!1},enumerable:!0,configurable:!0}),i.prototype.moveTo=function(e,i){var n=this.m_x,o=this.m_y,r=e-n,s=i-o;if(0!=r||0!=s){this.m_x=e,this.m_y=i;var a=this.m_map.translateToCell(this.m_x,this.m_y);if(a&&a!=this.m_cell&&(this.m_cell=a,this.isTranslucent=this.m_cell.isTranslucent),!a){var h="BeingEntity.ts::moveTo() newCell=null "+UtilTools.keyValueToString_parenthese("x",e,"y",i,"mapid",this.m_map.m_config.m_mapID);Context.logMgr.sendServer(h)}this.m_map.m_quadTree.updateNodeForElement(this),this.m_render&&this.m_render.place(),this.updateDepth(!0),this.dispatchEventWith(t.fElement.MOVE)}},Object.defineProperty(i.prototype,"isCameraTarget",{set:function(t){this.m_isCameraTarget=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"followCameraposY",{get:function(){return this.m_y-100},enumerable:!0,configurable:!0}),i.prototype.isOut_of_bound=function(t,e){return this.m_map.isOut_of_bound(t,e)},i.s_dest3D=new egret.Point,i.s_cur3D=new egret.Point,i}(t.fObject);t.BeingEntity=e,__reflect(e.prototype,"scene.BeingEntity",["scene.ICameraTarget"])}(scene||(scene={}));var animation;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_id=0,e.m_bRun=!1,e.m_bDispatchCompleteEvent=!1,e.m_enabled=!0,e.m_isInJuggle=!1,e.m_isCallAdvanceFromOuter=!1,e.m_eventMap={},e}return __extends(e,t),e.prototype.onGTweenComplete=function(t){this._onComplete()},e.prototype.advanceTime=function(t){},e.prototype._onComplete=function(){this.m_bRun=!1,null!=this.m_complete_CallBack&&this.m_complete_CallBack.apply(this.m_complete_CallBack_this,this),this.m_bDispatchCompleteEvent&&this.dispatchEventWith(egret.Event.COMPLETE),this.m_isCallAdvanceFromOuter||0!=this.m_bRun||this.removeFromJuggle()},e.prototype.dispose=function(){this.m_complete_CallBack=null,this.m_complete_CallBack_this=null,this.m_target=null,this.m_initValues=null;var e,i=this.m_eventMap;for(var n in i)if(e=i[n]){for(var o=e.length,r=0;o>r;r++)t.prototype.removeEventListener.call(this,n,e[r].listener,e[r].thisObject);e.length=0}UtilDictionary.clear(i),this.m_eventMap=null,this.removeFromJuggle()},e.prototype.addEventListener=function(e,i,n){var o=this.m_eventMap[e];o||(o=this.m_eventMap[e]=[]);for(var r=o.length,s=0;r>s;s++){var a=o[s];if(a.listener==i&&a.thisObject==n)return}var h={type:e,listener:i,thisObject:n};o.push(h),this.m_bDispatchCompleteEvent=!0,t.prototype.addEventListener.call(this,e,i,n)},e.prototype.removeEventListener=function(e,i,n){var o=this.m_eventMap[e];if(o)for(var r=o.length,s=0;r>s;s++)if(o[s].listener==i&&o[s].thisObject==n){o.splice(s,1);break}t.prototype.removeEventListener.call(this,e,i,n)},Object.defineProperty(e.prototype,"target",{get:function(){return this.m_target},set:function(t){this.m_target=t},enumerable:!0,configurable:!0}),e.prototype.begin=function(){this.m_bRun=!0,this.m_isCallAdvanceFromOuter||this.addToJuggle()},e.prototype.setComplete_callback=function(t,e){this.m_complete_CallBack_this=e,this.m_complete_CallBack=t},Object.defineProperty(e.prototype,"bRun",{get:function(){return this.m_bRun},enumerable:!0,configurable:!0}),e.prototype.stop=function(){this.m_bRun=!1,this.m_isCallAdvanceFromOuter||this.removeFromJuggle()},Object.defineProperty(e.prototype,"enabled",{get:function(){return this.m_enabled},set:function(t){this.m_enabled=t},enumerable:!0,configurable:!0}),e.prototype.parseXML=function(t){if(this.m_id=UtilXml.attributeInt(t,"id"),UtilXml.hasAttribute(t,"initAttributes")){var i=UtilXml.attributeString(t,"initAttributes");this.m_initValues=e.parseAttributes(i)}},e.prototype.getAniByID=function(t){return this.m_id==t?this:null},Object.defineProperty(e.prototype,"timeScale",{set:function(t){},enumerable:!0,configurable:!0}),e.prototype.initValues=function(){if(this.m_initValues){var t;for(t in this.m_initValues)this.m_target[t]=this.m_initValues[t]}},e.prototype.setInitValue=function(t,e){null==this.m_initValues&&(this.m_initValues=new Object),this.m_initValues[t]=e},e.parseAttributes=function(t){var e,i=new dataset.KeyValueParse;i.parse(t);var n=i.dic;e=new Object;var o;for(o in n){var r=i.getNumberValue(o);"rotation"==o&&(r=UtilMath.angle360ToRadian(r)),e[o]=r
}return e},e.prototype.addToJuggle=function(){this.m_isInJuggle||(this.m_isInJuggle=!0,Context.juggle.add(this))},e.prototype.removeFromJuggle=function(){this.m_isInJuggle&&(this.m_isInJuggle=!1,Context.juggle.remove(this))},e}(egret.EventDispatcher);t.DigitAniBase=e,__reflect(e.prototype,"animation.DigitAniBase",["animation.IAnimatable"])}(animation||(animation={}));var scene;!function(t){t.HeadRPosX="_HeadRPosX_",t.HeadRPosY="_HeadRPosY_";var e=function(){function e(t){this.m_nameStr="",this.m_curTop=-16,this.m_fObj=t,this.m_tagHeight=this.m_fObj.tagHeight,this.m_labelInDisplay=[],this.m_displayList=[],this.m_isInvalid=!1,this.m_positionInvalid=!1}return e.prototype.updatePosition=function(){var e,i=this.m_fObj.x,n=this.m_fObj.y+this.m_tagHeight,o=this.m_displayList.length;for(e=0;o>e;e++){var r=this.m_displayList[e];r.y=n+r[t.HeadRPosY],r.x=i+r[t.HeadRPosX]}},e.prototype.invalidPosition=function(){this.m_positionInvalid||(this.m_positionInvalid=!0,this.invalidate())},e.prototype.validPosition=function(){this.m_positionInvalid&&(this.m_positionInvalid=!1,this.updatePosition())},e.prototype.invalidate=function(){this.m_isInvalid||(this.m_isInvalid=!0,Context.stage.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFame,this))},e.prototype.onEnterFame=function(){this.m_isInvalid=!1,Context.stage.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFame,this),this.validPosition()},e.prototype.addAutoData=function(e,i,n,o){void 0===n&&(n=18),void 0===o&&(o=-20);var r=Context.headLabelMgr.get(),s=r.textLabel;s.text=e,s.textColor=i,s.size=n;var a=this.m_curTop+o;r[t.HeadRPosY]=a,r[t.HeadRPosX]=0,this.m_curTop=a,this.m_labelInDisplay.push(r),this.m_displayList.push(r),this.invalidPosition()},e.prototype.clearAutoData=function(){this.m_curTop=0;var t,e=this.m_labelInDisplay.length;for(t=0;e>t;t++){var i=this.m_labelInDisplay[t];Context.headLabelMgr.collect(i),UtilArray.removeItem(this.m_displayList,i)}this.m_labelInDisplay.length=0},e.prototype.setAlpha=function(t){var e,i=this.m_displayList.length;for(e=0;i>e;e++)this.m_displayList[e].alpha=t},e.prototype.setData=function(t){},e.prototype.show=function(){this.updateHeadTopData()},e.prototype.updateHeadTopData=function(){},e.prototype.addToDisplayList=function(t){},e.prototype.dispose=function(){this.m_fObj=null,this.clearAutoData(),this.m_isInvalid&&Context.stage.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFame,this)},e}();t.HeadTopBlockBase=e,__reflect(e.prototype,"scene.HeadTopBlockBase")}(scene||(scene={}));var imageLoad;!function(t){var e=function(){function t(){}return t.prototype.clear=function(){this.loader&&(this.loader.data=null),this.loader=null,this.url=null,this.onLoad=null,this.onFailed=null,this.thisObj=null},t.s_gc=new dataset.GCCommon(t,40,null,null),t}();__reflect(e.prototype,"CItem");var i=function(){function t(){this.m_loader2Item={},this.m_ili2Item={},this.recycler=[]}return t.prototype.load=function(t,i,n,o){var r=e.s_gc.getObject(),s=this.getLoader();r.loader=s,r.onLoad=i,r.onFailed=n,r.thisObj=o,r.url=t,egret.assert(!(s.hashCode in this.m_loader2Item)),egret.assert(!(o.hashCode in this.m_ili2Item)),this.m_loader2Item[s.hashCode]=r,this.m_ili2Item[o.hashCode]=r,s.load(Context.gameVersionController.getVirtualUrl(t))},t.prototype.unLoad=function(t){if(t.hashCode in this.m_ili2Item){var i=this.m_ili2Item[t.hashCode];egret.assert(i.loader.hashCode in this.m_loader2Item),delete this.m_ili2Item[t.hashCode],this.m_loader2Item[i.loader.hashCode]=null,i.clear(),e.s_gc.collect(i)}},t.prototype.getLoader=function(){var t=this.recycler.pop();return t||(t=new egret.ImageLoader),t.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this),t},t.prototype.recycleLoader=function(t){t&&(t.data=null,t.removeEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),t.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this),this.recycler.push(t),t=null)},t.prototype.onLoadFinish=function(t){var i=t.$target;egret.assert(i.hashCode in this.m_loader2Item);var n=this.m_loader2Item[i.hashCode];if(n){if(t.$type==egret.Event.COMPLETE)n.onLoad.call(n.thisObj,i.data);else{n.onFailed.call(n.thisObj);var o="图片加载失败 url="+n.url;Context.logMgr.addLog(o),Context.logMgr.sendServer(o)}delete this.m_ili2Item[n.thisObj.hashCode],n.clear(),e.s_gc.collect(n)}delete this.m_loader2Item[i.hashCode],this.recycleLoader(i)},t}();t.LowImageLoadMgr=i,__reflect(i.prototype,"imageLoad.LowImageLoadMgr")}(imageLoad||(imageLoad={}));var Table;!function(t){var e=function(){function t(){}return t.prototype.parseByteArray=function(t){},t.readString=function(t){var e=t.readUnsignedShort();return t.readUTFBytes(e)},t}();t.TDataItem=e,__reflect(e.prototype,"Table.TDataItem")}(Table||(Table={}));var httpCmd;!function(t){var e=function(){function t(t){this.param=t}return t.prototype.generateObj=function(){return this},t.prototype.toObject=function(){var t=this.generateObj()||{};return t.param=this.param,t},t.prototype.parse=function(t){for(var e in t)this[e]=t[e]},t.CMD_login_request="login_ReqLoginCmd",t.CMD_login_result="login_ResLoginResultCmd",t.CMD_login_ReqWxTextCheck="login_ReqWxTextCheck",t.CMD_monitor_RecordPassLevel="monitor_RecordPassLevel",t.CMD_monitor_RecordOnline="monitor_RecordOnline",t.CMD_monitor_RecordClientData="monitor_RecordClientData",t.CMD_monitor_RecordBannerAd="monitor_RecordBannerAd",t.CMD_recharge_ReqRechargeCmd="recharge_ReqRechargeCmd",t.CMD_recharge_ResRechargeCmd="recharge_ResRechargeCmd",t}();t.CommandBase=e,__reflect(e.prototype,"httpCmd.CommandBase")}(httpCmd||(httpCmd={}));var dataset;!function(t){var e=function(){function t(t){this.m_loaded=!1,this.m_unUsedTime=Number.MAX_VALUE,this.m_Name=t,this.m_userList=new Array}return Object.defineProperty(t.prototype,"name",{get:function(){return this.m_Name},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.m_userList.length=0},t.prototype.onNoUser=function(){},t}();t.TimeResourceBase=e,__reflect(e.prototype,"dataset.TimeResourceBase")}(dataset||(dataset={}));var dataset;!function(t){var e=function(){function t(){this.m_threshold=3e4,this.m_dicResource={},this.m_unusedResource={},t.s_allTimeResourceMgr.push(this)}return t.s_process=function(){var e=t.s_allTimeResourceMgr.length;if(0!=e){var i=Math.floor(Math.random()*e);i>=e&&i--;var n=t.s_allTimeResourceMgr[i];n.process()}},t.prototype.addUser=function(t,e){0==t.m_userList.length&&(egret.assert(!(t.name in this.m_dicResource)),t.m_unUsedTime=Number.MAX_VALUE,this.m_dicResource[t.name]=t);var i=t.m_userList.indexOf(e);egret.assert(-1==i),t.m_userList.push(e)},t.prototype.removeUser=function(t,e){var i=t.m_userList.indexOf(e);egret.assert(-1!=i),t.m_userList.splice(i,1),0==t.m_userList.length&&(egret.assert(t.name in this.m_dicResource),delete this.m_dicResource[t.name],t.m_unUsedTime=Context.timeMgr.platformTime,egret.assert(!(t.name in this.m_unusedResource)),this.m_unusedResource[t.name]=t)},t.prototype.getResource=function(t){var e=this.m_dicResource[t];return e||t in this.m_unusedResource&&(e=this.m_unusedResource[t],delete this.m_unusedResource[t]),e},t.prototype.process=function(){var t,e,i=0,n=Context.timeMgr.platformTime,o=[];for(e in this.m_unusedResource)if(t=this.m_unusedResource[e],n-t.m_unUsedTime>this.m_threshold&&(o.push(e),i++,i>10))break;if(o.length>0)for(i=0;i<o.length;i++)e=o[i],t=this.m_unusedResource[e],delete this.m_unusedResource[e],t.dispose()},t.prototype.dispose=function(){UtilArray.removeItem(t.s_allTimeResourceMgr,this)},t.s_allTimeResourceMgr=[],t}();t.TimeResourceMgrBase=e,__reflect(e.prototype,"dataset.TimeResourceMgrBase")}(dataset||(dataset={}));var common;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.chongzhi=function(t){this.sendChongzhiHttpRequest(t)},e.prototype.sendChongzhiHttpRequest=function(t){if(!this.m_chongzhiRequest){var e=new httpCmd.ReqRechargeCmd;e.uid=this.get_uid_common(),e.goodId=t,e.zone=Context.loginData.zoneId,e.roleName=Context.heroinfoMgr.name,e.charId=Context.heroinfoMgr.charid,e.zoneName=Context.loginData.zoneId+"区",e.sdk=this.m_sdk,e.pid=this.m_id,Context.httpSendMgr.send(e)}},e.prototype.on_ResRechargeCmd=function(t){var e=new httpCmd.ResRechargeCmd;e.parse(t),0==e.code?this.onChongzhiHttpRequestReturn(e.msg):Context.sysPromptMgr.showDialogPrompt(e.msg)},e.prototype.updateChongzhiParam=function(t){},e.prototype.onChongzhiHttpRequestReturn=function(t){},e}(t.OperationBase);t.operation_http_chongzhi_base=e,__reflect(e.prototype,"common.operation_http_chongzhi_base")}(common||(common={}));var uicommon;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._value=0,e._widthInvalid=!1,e._isHorizontal=!0,e.m_bitmap=new egret.Bitmap,e.addChild(e.m_bitmap),e}return __extends(e,t),Object.defineProperty(e.prototype,"isHorizontal",{set:function(t){this._isHorizontal=t},enumerable:!0,configurable:!0}),e.prototype.setSource=function(t){this._source!=t&&(this._source=t,Context.imageAssetAdapter.getAsset(t,this.contentChanged,this))},Object.defineProperty(e.prototype,"source",{set:function(t){this.setSource(t)},enumerable:!0,configurable:!0}),e.prototype.contentChanged=function(t,e){if(!egret.is(t,"egret.Texture"))return!1;if(e!==this._source)return!1;this._source_=e,this._sourceTexture=t,this._texture=new egret.Texture;var i=this._sourceTexture,n=1,o=1;return this._isHorizontal?o=i.$bitmapHeight:n=i.$bitmapWidth,this._texture.$bitmapData=i.bitmapData,this._texture.$initData(i.$bitmapX,i.$bitmapY,n,o,i.$offsetX,i.$offsetY,i.$getTextureWidth(),i.$getTextureHeight(),i.$sourceWidth,i.$sourceHeight),this.m_bitmap.texture=this._texture,this.updateBitmapWidth(),!0},e.prototype.invalidWidth=function(){this._widthInvalid||(this._widthInvalid=!0,this.once(egret.Event.ENTER_FRAME,this.onEnterFame,this))},e.prototype.onEnterFame=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFame,this),this._widthInvalid=!1,this.updateBitmapWidth()},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value!=t&&(this._value=t,this.invalidWidth())},enumerable:!0,configurable:!0}),e.prototype.updateBitmapWidth=function(){if(this._texture){if(this._isHorizontal){var t=this._value*this._sourceTexture.$bitmapWidth;this._texture.$bitmapWidth=1>t?1:t}else{var e=this._value*this._sourceTexture.$bitmapHeight;this._texture.$bitmapHeight=1>e?1:e;var i=this._sourceTexture.$bitmapHeight-e;this._texture.$bitmapY=this._sourceTexture.$bitmapY+i,this.m_bitmap.y=i}this.m_bitmap.$refreshImageData(),this.m_bitmap.$renderDirty=!0}},e.prototype.dispose=function(){this._source_&&(Context.imageAssetAdapter.unattach(this._source_,this),this._source_=null),this._source=null,this._sourceTexture=null,this._texture&&(this._texture.dispose(),this._texture=null)},e}(egret.DisplayObjectContainer);t.PanelCut2=e,__reflect(e.prototype,"uicommon.PanelCut2")}(uicommon||(uicommon={}));var sceneApp;!function(t){var e=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.isTalking=!1,n}return __extends(e,t),e.prototype.getHeadTopClass=function(){return scene.HeadTopPlayer},e.prototype.showSpeak=function(t,e){void 0===e&&(e="left");var i=this.getHeadTopBase();i&&i.showTalk(t,e)},e.prototype.onSpeakEnd=function(){var t=this.getHeadTopBase();t&&t.endTalk()},e.prototype.onOnceSpeakComplete=function(){},e.prototype.addWing=function(t){this.m_wingName!=t&&""!=t&&null!=t&&(this.m_wingName&&this.amMgr.removeAdditionalModel(this.m_wingName),this.m_wingName=t,this.amMgr.addAdditionalModel(t,UtilModel.chibangLayer))},e.prototype.removeWing=function(){this.m_wingName&&(this.amMgr.removeAdditionalModel(this.m_wingName),this.m_wingName=null)},e.prototype.addWeapon=function(t){""!=t&&this.m_weaponName!=t&&(this.m_weaponName&&this.amMgr.removeAdditionalModel(this.m_weaponName),this.m_weaponName=t,this.amMgr.addAdditionalModel(t,UtilModel.wuqiLayer))},e.prototype.removeWeapon=function(){this.m_weaponName&&(this.amMgr.removeAdditionalModel(this.m_weaponName),this.m_weaponName=null)},e}(scene.BeingEntity);t.PlayerBase=e,__reflect(e.prototype,"sceneApp.PlayerBase")}(sceneApp||(sceneApp={}));var Server;!function(t){var e=function(){function t(){this.m_funDic={}}return t.prototype.addFun=function(t,e,i){this.m_funDic[t]={callBack:e,thisObject:i}},t.prototype.process=function(t,e){var i=this.m_funDic[e];i&&i.callBack.call(i.thisObject,t,e)},t}();t.MsgProcessBase=e,__reflect(e.prototype,"Server.MsgProcessBase")}(Server||(Server={}));var scene;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(egret.DisplayObjectContainer);t.SpriteEx=e,__reflect(e.prototype,"scene.SpriteEx")}(scene||(scene={}));var scene;!function(t){var e=function(){function t(){this.m_visibleState=0,this.m_depth=0,this.m_elementList=new Array,this.m_area=new egret.Rectangle,this.m_nodeChildren=new Array(4)}return t.prototype.init=function(e,i,n,o,r,s){if(n=n,o=o,r=r,s=s,this.m_visibleState=t.VS_Not,this.m_root=e,this.m_parent=i,null==this.m_parent?this.m_depth=1:this.m_depth=this.m_parent.m_depth,this.m_area.setTo(n,o,r,s),r>t.MinSize&&s>t.MinSize&&this.m_depth<this.m_root.maxDepth){var a,h=Math.floor(n+r/2),m=Math.floor(o+s/2);a=t.s_gc.getObject(),a.init(this.m_root,this,n,o,h-n,m-o),this.m_nodeChildren[0]=a,a=t.s_gc.getObject(),a.init(this.m_root,this,h,o,this.m_area.right-h,m-o),this.m_nodeChildren[1]=a,a=t.s_gc.getObject(),a.init(this.m_root,this,n,m,h-n,this.m_area.bottom-m),this.m_nodeChildren[2]=a,a=t.s_gc.getObject(),a.init(this.m_root,this,h,m,this.m_area.right-h,this.m_area.bottom-m),this.m_nodeChildren[3]=a}},t.prototype.findNodeByElement=function(t){if(this.m_root==this||t.isInQuadNode(this)){if(this.m_nodeChildren[0]){var e,i=0;for(i=0;4>i;i++)if(e=this.m_nodeChildren[i].findNodeByElement(t))return e}return this}return null},Object.defineProperty(t.prototype,"area",{get:function(){return this.m_area},enumerable:!0,configurable:!0}),t.prototype.collectChildren=function(){if(this.m_nodeChildren[0]){var e=0;for(e=0;4>e;e++)this.m_nodeChildren[e].collectChildren(),t.s_gc.collect(this.m_nodeChildren[e]),this.m_nodeChildren[e]=null}this.m_root=null,this.m_parent=null,this.m_elementList.length=0},t.prototype.addElement=function(e){this.m_elementList.push(e),e.m_quadNode=this,this.m_visibleState==t.VS_Not?e.isInCamera=!1:this.m_visibleState==t.VS_All?e.isInCamera=!0:e.isIntersectWidth(this.m_root.viewRect)?e.isInCamera=!0:e.isInCamera=!1},t.prototype.updateIsInCamer=function(e){this.m_visibleState==t.VS_Not?e.isInCamera=!1:this.m_visibleState==t.VS_All?e.isInCamera=!0:e.isIntersectWidth(this.m_root.viewRect)?e.isInCamera=!0:e.isInCamera=!1},t.prototype.removeElement=function(t){var e=this.m_elementList.indexOf(t);-1!=e&&(this.m_elementList.splice(e,1),t.m_quadNode=null)},t.prototype.updateVisible=function(t){t.containsRect(this.m_area)?this.setVisibleAll():t.intersects(this.m_area)?this.setVisiblePart(t):this.setVisibleNot()},t.prototype.setVisibleAll=function(){if(this.m_visibleState!=t.VS_All){if(this.m_visibleState=t.VS_All,this.m_nodeChildren[0]){var e=0;for(e=0;4>e;e++)this.m_nodeChildren[e].setVisibleAll()}var i,n;for(n in this.m_elementList)i=this.m_elementList[n],i.isInCamera=!0}},t.prototype.setVisiblePart=function(e){if(this.m_visibleState=t.VS_Part,this.m_nodeChildren[0]){var i=0;for(i=0;4>i;i++)this.m_nodeChildren[i].updateVisible(e)}var n,o;for(o in this.m_elementList)n=this.m_elementList[o],n.isIntersectWidth(e)?n.isInCamera=!0:n.isInCamera=!1},t.prototype.setVisibleNot=function(){if(this.m_visibleState!=t.VS_Not){if(this.m_visibleState=t.VS_Not,this.m_nodeChildren[0]){var e=0;for(e=0;4>e;e++)this.m_nodeChildren[e].setVisibleNot()}var i,n;for(n in this.m_elementList)i=this.m_elementList[n],i.isInCamera=!1}},t.prototype.getElementsByHitPos=function(t,e,i){if(this.m_area.contains(t,e)){var n,o;for(o in this.m_elementList)n=this.m_elementList[o],n.isHit(t,e)&&i.push(n);if(this.m_nodeChildren[0]){var r=0;for(r=0;4>r;r++)this.m_nodeChildren[r].getElementsByHitPos(t,e,i)}}},t.prototype.getElementsInCameraByCompare=function(e,i){if(this.m_visibleState!=t.VS_Not){var n;if(this.m_visibleState==t.VS_Part){var o;for(o in this.m_elementList)n=this.m_elementList[o],n.isInCamera&&e(n)&&i.push(n)}else{var o;for(o in this.m_elementList)n=this.m_elementList[o],e(n)&&i.push(n)}if(this.m_nodeChildren[0]){var r,s;for(s in this.m_nodeChildren)r=this.m_nodeChildren[s],r.getElementsInCameraByCompare(e,i)}}},t.VS_All=0,t.VS_Part=1,t.VS_Not=2,t.s_gc=new dataset.GCCommon(t,20,null,null),t.MinSize=256,t}();t.QuadNode=e,__reflect(e.prototype,"scene.QuadNode")}(scene||(scene={}));var Server;!function(t){var e=function(){function e(){}return e.prototype.closeSocket=function(){this.m_socket&&(this.m_socket.close(),this.m_socket=null)},e.prototype.oncloseSocket=function(){this.closeSocket(),Context.logMgr.addLog("-- oncloseSocket --")},e.prototype.createSocket=function(){this.closeSocket(),this.m_socket=new Network.SocketT,this.m_socket.addEventListener(egret.Event.CONNECT,this.onConnect,this),this.m_socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),this.m_socket.addEventListener(egret.Event.CLOSE,this.onClose,this)},e.prototype.onConnect=function(){},e.prototype.onClose=function(t){},e.prototype.onError=function(){var e;e=this instanceof t.ToLoginServer?"连接登录服务器":"连接网关服务器",Context.loadingView.setText("窗户卡死了，请稍后刷新下吧"),Context.logMgr.sendServer(e+"("+this.m_ipInfo+") 连接失败"),Context.reloginMgr.bReLoginInGame&&Context.sysPromptMgr.showUINetConnectClose(e+" 连接失败")},Object.defineProperty(e.prototype,"connected",{get:function(){return this.m_socket&&this.m_socket.connected?!0:!1},enumerable:!0,configurable:!0}),e.prototype.getMessage=function(){return this.m_socket?this.m_socket.getMsg():null},e.prototype.sendMsg=function(t){this.m_socket&&this.m_socket.sendMsg(t)},e}();t.ToServerBase=e,__reflect(e.prototype,"Server.ToServerBase")}(Server||(Server={}));var animation;!function(t){var e=function(e){function i(i){void 0===i&&(i=!1);var n=e.call(this)||this;return n.m_duration=0/0,n.m_speed=0,n.m_bAdjustAngle=!1,n.m_gtWeen=new t.GTween,n.m_gtWeen.target=n,n.m_gtWeen.isUseAdvance=!0,n.m_gtWeen.useFrames=!1,n.m_gtWeen.setCompleteCallback(n._onComplete,n),n.m_gtWeen.repeatCount=1,n.m_isCallAdvanceFromOuter=i,n}return __extends(i,e),i.prototype.advanceTime=function(t){this.m_isCallAdvanceFromOuter||this.m_gtWeen.paused&&this.removeFromJuggle(),this.m_gtWeen.advanceTime(t)},Object.defineProperty(i.prototype,"equation",{set:function(t){this.m_equation=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"duration",{set:function(t){this.m_duration=t,this.m_speed=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bAdjustAngle",{set:function(t){this.m_bAdjustAngle=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"useFrames",{set:function(t){this.m_gtWeen.useFrames=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ease",{set:function(t){this.m_gtWeen.ease=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"speed",{set:function(t){this.m_speed=t,this.m_duration=0},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this.m_gtWeen.paused=!0,this.m_gtWeen.target=null,this.m_gtWeen=null,e.prototype.dispose.call(this)},Object.defineProperty(i.prototype,"t",{get:function(){var t=this.m_equation.t;return t},set:function(t){if(this.m_equation.t=t,this.m_posUpdateName)this.m_target[this.m_posUpdateName](this.m_equation.x,this.m_equation.y);else if(this.m_target.x=this.m_equation.x,this.m_target.y=this.m_equation.y,0==this.m_target.x);this.m_bAdjustAngle&&(this.m_target.rotation=this.getCurAngle()+90)},enumerable:!0,configurable:!0}),i.prototype.begin=function(){this.m_equation.reset(),this.m_target.x=this.m_equation.x,this.m_target.y=this.m_equation.y,this.m_gtWeen.resetValues({t:this.m_equation.tEnd}),this.m_gtWeen.init(),this.m_gtWeen.duration=this.m_duration,this.m_gtWeen.paused=!1,this.m_bAdjustAngle&&(this.m_target.rotation=this.getCurAngle()),e.prototype.begin.call(this)},i.prototype.getCurAngle=function(){return this.m_equation.getCurAngle()},i.prototype.stop=function(){e.prototype.stop.call(this),this.m_gtWeen.paused=!0},Object.defineProperty(i.prototype,"timeScale",{set:function(t){this.m_gtWeen.timeScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"easeConst",{set:function(e){this.m_gtWeen.ease=t.s_getEaseFun(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"posUpdateName",{set:function(t){this.m_posUpdateName=t},enumerable:!0,configurable:!0}),i}(t.DigitAniBase);t.AniPositionParamEquation=e,__reflect(e.prototype,"animation.AniPositionParamEquation")}(animation||(animation={}));var Cmd;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.byCmd=t.stNullUserCmd.TIME_USERCMD,i}return __extends(i,e),i.GAMETIME_TIMER_USERCMD_PARA=1,i.GAME_MERGEZONE_TIME_USERCMD_PARA=5,i}(t.stNullUserCmd);t.stTimerUserCmd=e,__reflect(e.prototype,"Cmd.stTimerUserCmd")}(Cmd||(Cmd={}));var scene;!function(t){var e=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.m_object=t,1!=n.m_object.alpha?n.alpha=n.m_object.alpha:n.m_object.isTranslucent&&(n.isTranslucent=!0),n}return __extends(i,e),i.prototype.createAssets=function(){try{this._baseObj=t.fMap.s_getSprite(),this.m_eleRoot.addChild(this._baseObj),this._currentBitMap=t.fMap.s_getSprite(),this._baseObj.addChild(this._currentBitMap),1!=this.m_object.getScale(),1!=this.m_object.getScaleX()&&(this.m_eleRoot.scaleX=this.m_object.getScaleX()),this.grayChange(this.m_object.bGray());var i=this.m_object.getHeadTopClass();if(i&&(this.m_headTop=new i(this.m_object)),this.createModelMC(),this.m_object.has_additionalModel()){var n,o=this.m_object.amMgr.dicAddtionalModel,r=void 0;for(n in o)r=o[n],r.createAsset()}e.prototype.createAssets.call(this)}catch(s){Context.system.logException(s)}},i.prototype.place=function(){e.prototype.place.call(this),this.m_headTop&&this.m_headTop.invalidPosition()},Object.defineProperty(i.prototype,"isTranslucent",{set:function(t){t?this.setAlpha(.5):this.setAlpha(1)},enumerable:!0,configurable:!0}),i.prototype.setAlpha=function(t){this.m_eleRoot.alpha=t,this.m_headTop&&this.m_headTop.setAlpha(t)},i.prototype.grayChange=function(t){this._baseObj.filters=t?[UtilFlilter.createGrayFilter()]:null},i.prototype.show=function(){e.prototype.show.call(this),this.m_headTop&&this.m_headTop.show()},i.prototype.dispose=function(){this.clearModelMC(),this.m_curImage&&(this.m_curImage.parent&&this.m_curImage.parent.removeChild(this.m_curImage),this.m_curImage=null),this._baseObj&&(this._baseObj.scaleX=1,this._baseObj.scaleY=1,this._baseObj.filters=null,t.fMap.s_collectSprite(this._baseObj),this._baseObj=null,t.fMap.s_collectSprite(this._currentBitMap),this._currentBitMap=null),this.m_uiLay&&(t.fMap.s_collectSprite(this.m_uiLay),this.m_uiLay=null),this.m_topLayer&&(t.fMap.s_collectSprite(this.m_topLayer),this.m_topLayer=null),this.m_headTop&&(this.m_headTop.dispose(),this.m_headTop=null),e.prototype.dispose.call(this)},i.prototype.getHeadTop=function(){return this.m_headTop},i.prototype.createModelMC=function(){if(this.m_modelMC){if(this.m_modelMC.modelData==this.m_object.model)return;this.clearModelMC()}this.m_modelMC=new t.ModelMovieclip(this.m_object.model.name)},i.prototype.clearModelMC=function(){this.m_modelMC&&(this.m_modelMC.dispose(),this.m_modelMC=null)},i.prototype.hitTest=function(t,e){if(!this.m_modelMC)return!1;var i=this.m_modelMC.modelData.config,n=-this.m_object.x+t,o=-this.m_object.y+e,r=n+i.tModelItem.m_pivotX,s=o+i.tModelItem.m_pivotY;if(0>r||0>s)return!1;var a=this.m_modelMC.modelData.getActData(this.m_object.act);return a?(r-=a.getDirSx(this.m_object.dir),s-=a.getDirSy(this.m_object.dir),0>r||0>s?!1:r>a.getDirW(this.m_object.dir)||s>a.getDirH(this.m_object.dir)?!1:!0):!1},i.prototype.hitTestPoint=function(t,e,i){return this._currentBitMap.hitTestPoint(t,e,i)},Object.defineProperty(i.prototype,"topLayer",{get:function(){return this.isAssetCreated?(null==this.m_topLayer&&(this.m_topLayer=t.fMap.s_getSprite(),this.m_eleRoot.addChild(this.m_topLayer)),this.m_topLayer):null},enumerable:!0,configurable:!0}),i.prototype.onAddEffect=function(t){if(this.isAssetCreated){var e=this.m_object.effectOnBody.getEffectByID(t);e.createEffectEntity(this.topLayer)}},i.prototype.advanceTime=function(e){var i;if(this.m_modelMC){var n,o=0;o=this.m_object.m_ACfresh?0:this.m_object.m_ACIndex;var r=this.m_object.m_AC.getAction(o);if(this.m_object.m_ACfresh?(this.m_object.m_ACfresh=!1,this.m_object.m_ACIndex=0,this.m_object.m_AC.m_curIndex=this.m_object.m_ACIndex,n=!0):this.m_object.m_ACIndex!=this.m_object.m_AC.m_curIndex&&(this.m_object.m_AC.m_curIndex=this.m_object.m_ACIndex,n=!0),i=this.m_modelMC.getActMovieClip(r.mActID),n&&(i.setActParam(r),i.currentFrame=0,i.play()),i!=this.m_curImage&&(this.m_curImage&&(this._currentBitMap.removeChild(this.m_curImage),this.m_curImage.stop()),this.m_curImage=i,this.m_curImage&&this._currentBitMap.addChild(this.m_curImage)),this.m_curImage&&(this.m_curImage.advanceTime(e,this.m_object.dir),this.m_curImage.isComplete&&(this.m_object.m_ACIndex+1<this.m_object.m_AC.length?this.m_object.m_ACIndex++:this.m_object.onActListComplete()),this.m_object.has_additionalModel())){var s=void 0,a=void 0;for(s in this.m_object.amMgr.dicAddtionalModel)a=this.m_object.amMgr.dicAddtionalModel[s],a.isAssetCreated||a.createAsset(),a.show(this.m_object.act,this.m_object.dir,this.m_curImage.currentFrame),a.container.parent!=this._baseObj&&this._baseObj.addChild(a.container);var h=this.m_object.amMgr.getLayerList(this.m_object.dir),m=h.length,c=void 0,u=void 0;for(c=0;m>c;c++)u=h[c],u instanceof t.AdditionalModel?(a=u,this._baseObj.getChildAt(c)!=a.container&&this._baseObj.setChildIndex(a.container,c)):this._baseObj.getChildAt(c)!=this._currentBitMap&&this._baseObj.setChildIndex(this._currentBitMap,c)}}},i}(t.fElementRender);t.fObjectRender=e,__reflect(e.prototype,"scene.fObjectRender")}(scene||(scene={}));var animation;!function(t){var e=function(){function t(){this.m_tInit=0,this.m_tEnd=0,this.m_t=0,this.m_xOffset=0,this.m_yOffset=0}return t.prototype.reset=function(){this.t=this.m_tInit},Object.defineProperty(t.prototype,"t",{get:function(){return this.m_t},set:function(t){this.m_t=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tInit",{get:function(){return this.m_tInit},set:function(t){this.m_tInit=t},enumerable:!0,configurable:!0}),t.prototype.getCurAngle=function(){return 0},Object.defineProperty(t.prototype,"tEnd",{get:function(){return this.m_tEnd},set:function(t){this.m_tEnd=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xOffset",{set:function(t){this.m_xOffset=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yOffset",{set:function(t){this.m_yOffset=t},enumerable:!0,configurable:!0}),t}();t.EquationBase=e,__reflect(e.prototype,"animation.EquationBase")}(animation||(animation={}));var scene;!function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i.m_titleName="",i}return __extends(e,t),e.prototype.updateHeadTopData=function(){this.clearAutoData();var t=this.m_fObj;if(null!=t){var e=UtilColor.WHITE;this.addAutoData(t.name,e)}},e.prototype.showTalk=function(t,e){void 0===e&&(e="left")},e.prototype.hideTalk=function(){},e.prototype.endTalk=function(){},e.prototype.onOnceSpeakComplete=function(){this.hideTalk();var t=this.m_fObj;t&&t.onOnceSpeakComplete()},e.prototype.bTalk=function(){return!1},e.prototype.dispose=function(){this.endTalk(),t.prototype.dispose.call(this)},e}(t.HeadTopBlockBase);t.HeadTopPlayer=e,__reflect(e.prototype,"scene.HeadTopPlayer")}(scene||(scene={}));var scene;!function(t){var e=function(){function t(){this.m_list=new Array}return Object.defineProperty(t.prototype,"size",{get:function(){return this.m_list.length/2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"list",{get:function(){return this.m_list},enumerable:!0,configurable:!0}),t.prototype.add=function(t,e){this.m_list.push(t),this.m_list.push(e)},t.prototype.remove=function(t){t+=t,this.m_list.splice(t,2)},t.prototype.clear=function(){this.m_list.length=0},t.prototype.reverse=function(){var e=this.m_list.length;t.s_help.length<e&&(t.s_help.length=e);var i=0,n=0;for(i=e-2,n=0;i>=0;i-=2,n+=2)t.s_help[n]=this.m_list[i],t.s_help[n+1]=this.m_list[i+1];for(i=0;e>i;i++)this.m_list[i]=t.s_help[i]},t.prototype.getPoint=function(t,e){return void 0===e&&(e=null),t+=t,null==e&&(e=new egret.Point),e.x=this.m_list[t],e.y=this.m_list[t+1],e},t.prototype.getTempPoint=function(e){return e+=e,t.s_tempPoint.x=this.m_list[e],t.s_tempPoint.y=this.m_list[e+1],t.s_tempPoint},t.prototype.copyFrom=function(t){var e=0,i=t.m_list.length;for(this.m_list.length!=i&&(this.m_list.length=i),e=0;i>e;e++)this.m_list[e]=t.m_list[e]},t.prototype.appendPath=function(t){var e=0,i=t.m_list.length,n=this.m_list.length;for(e=0;i>e;e++,n++)this.m_list[n]=t.m_list[e]},t.prototype.deserialize=function(t,e){void 0===e&&(e=1);var i=0;1==e?i=t.readUnsignedByte():2==e&&(i=t.readUnsignedShort());var n=0;for(i+=i,this.m_list.length=i,n=0;i>n;n++)this.m_list[n]=t.readUnsignedInt()},t.prototype.hasPoint=function(t,e){var i=0,n=this.m_list.length;for(i=0;n>i;i+=2)if(this.list[i]==t&&this.list[i+1]==e)return!0;return!1},t.s_help=new Array,t.s_tempPoint=new egret.Point,t}();t.PathFound=e,__reflect(e.prototype,"scene.PathFound")}(scene||(scene={}));var Form=function(t){function e(){var e=t.call(this)||this;return e.exitMode="destroy",e.bAniFormFadeInOut=!0,e.m_bInAniFadeOut=!1,e.bDarkeOthers=!1,e.addEventListener(eui.UIEvent.MOVE,e.onUIMove,e),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.onUIMove=function(t){this.bDarkeOthers&&this.darkOthers()},e.prototype.updateData=function(t){void 0===t&&(t=null)},e.prototype.openPage=function(t){},e.prototype.onStageReSize=function(){},e.prototype.darkOthers=function(t,e){void 0===t&&(t=0),void 0===e&&(e=.6),this.darkBG||(this.darkBG=new eui.Image("common.pixel_png"),this.darkBG.scale9Grid=new egret.Rectangle(1,1,2,2),this.darkBG.width=Context.width,this.darkBG.height=Context.height,this.darkBG.touchEnabled=!0,this.darkBG.alpha=e),this.contains(this.darkBG)||this.addChildAt(this.darkBG,0),this.darkBG.x=-this.x,this.darkBG.y=-this.y,this.bDarkeOthers=!0},e.prototype.exit=function(){e.ExitMode_hide==this.exitMode?Context.uimgr.hideForm(this.id):Context.uimgr.destroyForm(this.id)},e.prototype.show=function(){Context.uimgr.showForm(this.id)},e.prototype.hide=function(){Context.uimgr.hideForm(this.id)},e.prototype.onShow=function(){this.m_bInAniFadeOut=!1,this.bDarkeOthers&&this.darkOthers(),this.bAniFormFadeInOut?this.formGroup?UtilEffect.MovieTweenBox(this.formGroup,500,egret.Ease.quadIn,this.onShowEnd,this):(this.alpha=0,UtilEffect.aniFadeIn(this,120,1,this.onShowEnd,this)):(this.alpha=1,this.onShowEnd())},e.prototype.onShowEnd=function(){},e.prototype.onOpenCallback=function(t){},e.prototype.onHide=function(){this.m_bInAniFadeOut=!1,this.parent&&this.parent.removeChild(this)},e.prototype.dispose=function(){this.onHide(),this.removeEventListener(eui.UIEvent.MOVE,this.onUIMove,this),core.ui_call_supper_dispose(eui.Component,this),Context.uimgr.destroyGroupRes(this.id)},e.prototype.isVisible=function(){return null!=this.parent},e.prototype.hideForm=function(){this.bAniFormFadeInOut?(this.m_bInAniFadeOut=!0,this.formGroup?UtilEffect.reMovieTweenBox(this.formGroup,this.onHide,this):UtilEffect.aniFadeOut(this,200,this.onHide,this)):this.onHide()},e.prototype.destroyForm=function(){this.bAniFormFadeInOut?(this.m_bInAniFadeOut=!0,this.formGroup?UtilEffect.reMovieTweenBox(this.formGroup,this.dispose,this):UtilEffect.aniFadeOut(this,200,this.dispose,this)):this.dispose()
},e.prototype.onExitBtnClick=function(t){t.target;this.exit()},e.ExitMode_hide="hide",e.ExitMode_destroy="destroy",e}(eui.Component);__reflect(Form.prototype,"Form");var systemPrompt;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.bgImage=new eui.Image,e.bgImage.source="pix_bantou_png",e.bgImage.height=20,e.addChild(e.bgImage),e.tf=new eui.Label,e.tf.textColor=UtilColor.DEFAULT,e.tf.size=18,e.tf.fontFamily=UtilFont.SimHei,e.tf.x=0,e.tf.y=1,e.addChild(e.tf),e.height=e.bgImage.height,e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.setData=function(t){this.tf.textFlow=(new egret.HtmlTextParser).parser(t),this.tf.validateNow(),this.bgImage.width=this.tf.textWidth+2,this.width=this.bgImage.width},e.prototype.addPromptRichText=function(t){this.tf.textFlow=t,this.tf.validateNow(),this.bgImage.width=this.tf.textWidth+2,this.width=this.bgImage.width},e.prototype.show=function(){Context.uimgr.getFourthLayer().addChild(this),this.x=Context.width,this.y=100+200*Math.random();var t=Context.width/540*8e3;egret.Tween.get(this).to({x:-this.width},t).call(this.onMoveOutEnd,this)},e.prototype.onMoveOutEnd=function(){},e.prototype.clear=function(){this.tf.text="",egret.Tween.removeTweens(this)},e}(eui.Component);t.DanmuCtrl=e,__reflect(e.prototype,"systemPrompt.DanmuCtrl")}(systemPrompt||(systemPrompt={}));var systemPrompt;!function(t){var e=function(t){function e(){var e=t.call(this)||this;e.bgImage=new eui.Image,e.bgImage.source="bg_tips_png",e.bgImage.width=347,e.bgImage.height=56;var i=new egret.Rectangle(25,5,100,3);return e.bgImage.scale9Grid=i,e.addChild(e.bgImage),e.tf=new eui.Label,e.tf.textColor=UtilColor.BLUE,e.tf.verticalCenter=0,e.tf.horizontalCenter=0,e.tf.size=26,e.tf.width=e.bgImage.width-100,e.tf.fontFamily=UtilFont.SimHei,e.tf.textAlign="center",e.tf.verticalAlign="middle",e.addChild(e.tf),e.height=e.bgImage.height,e.width=Context.width,e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.setDataWithArray=function(t){var e=this.tf;e.textFlow=t,e.validateNow();var i=this.tf.textWidth;this.bgImage.width=i>167?i+80:247,this.width=this.bgImage.width,e.width=this.width},e.prototype.setDataWithJson=function(t){var e=this.tf;e.textFlow=UtilRichText.stringToTextFlow(t),e.validateNow();var i=this.tf.textWidth;this.bgImage.width=i>167?i+80:247,this.width=this.bgImage.width,e.width=this.width},e.prototype.setData=function(t){var e=this.tf;e.textFlow=UtilRichText.htmlTextToTextFlow(t),e.validateNow();var i=e.textWidth;this.bgImage.width=i>167?i+80:247,this.width=this.bgImage.width,e.width=this.width},e.prototype.setDataWithColor=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=16777215);var o=this.tf;UtilRichText.beginCompose(),UtilRichText.add(t,e,o.size),o.textFlow=UtilRichText.getComposedContent(),o.validateNow(),o.stroke=i,o.strokeColor=n;var r=o.width;this.bgImage.width=r>167?r+120:247,this.bgImage.width>Context.width&&(this.bgImage.width=Context.width),this.width=this.bgImage.width,o.width=this.width-90},e.prototype.clear=function(){this.tf.text="",this.alpha=1,this.state=e.STATE_none,egret.Tween.removeTweens(this)},e.prototype.show=function(){Context.uimgr.getFourthLayer().addChild(this),this.x=.5*(Context.width-this.width),egret.Tween.get(this).to({y:this.y-this.height},300).wait(800).to({alpha:0},140).call(this.onFadeOutEnd,this)},e.prototype.hide=function(){egret.Tween.get(this).to({alpha:0},140).call(this.onFadeOutEnd,this)},e.prototype.moveTo=function(t,e){egret.Tween.removeTweens(this),egret.Tween.get(this).to({y:t},300).wait(e).to({alpha:0},140).call(this.onFadeOutEnd,this)},e.prototype.onFadeOutEnd=function(){Context.sysPromptMgr.onCtrlFadeOut(this)},e.STATE_none=0,e.STATE_fadeIn=1,e.STATE_move=2,e.STATE_fadeOut=3,e}(eui.Component);t.PromptCtrl=e,__reflect(e.prototype,"systemPrompt.PromptCtrl")}(systemPrompt||(systemPrompt={}));var uicommon;!function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i._value=0,i._max=1,i.m_currentV=0/0,i.m_inInitFun=!1,i.m_durationRatio=1,i._initValue=0,i}return __extends(e,t),Object.defineProperty(e.prototype,"maximum",{get:function(){return this._max},set:function(t){this._max=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initValue",{get:function(){return this._initValue},set:function(t){t>this._max&&(t=this._max),this._initValue=t,this.m_inInitFun=!0,this._value=t,this.currentV=t,this.m_inInitFun=!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){egret.assert(!isNaN(t),"BarInProgress2::value 传入Nan"),this._value=t>this._max?this._max:t,null==this.m_ani&&(this.m_ani=new animation.AniPropertys,this.m_ani.target=this,this.m_ani.setComplete_callback(this.aniEndCallBack,this)),this.m_ani.duration=Math.abs(this._value-this.m_currentV)*this.m_durationRatio,this.m_ani.resetValues({currentV:this._value}),this.m_ani.begin()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentV",{get:function(){return this.m_currentV},set:function(t){if(null!=this.m_funCallOnNewLine&&0==this.m_inInitFun){var e=this.m_currentV/this._max,i=t/this._max;i!=e&&this.m_funCallOnNewLine.call(this.m_callbackThisObj)}this.m_currentV=t,t=this.m_currentV%this._max,0==t&&this.m_currentV>0&&(t=this._max),t=t/this._max*this.m_ds.width,this.cutRectW=t,null!=this.m_funOnCurrentVChange&&this.m_funOnCurrentVChange.call(this.m_callbackThisObj,this.m_currentV)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"durationRatio",{set:function(t){this.m_durationRatio=t},enumerable:!0,configurable:!0}),e.prototype.setAniEndCallBack=function(t,e,i,n){void 0===i&&(i=null),void 0===n&&(n=null),this.m_callbackThisObj=t,this.m_funCallOnAniEnd=e,this.m_funCallOnNewLine=i,this.m_funOnCurrentVChange=n},e.prototype.aniEndCallBack=function(){null!=this.m_funCallOnAniEnd&&this.m_funCallOnAniEnd.call(this.m_callbackThisObj)},e.prototype.dispose=function(){this.m_ani&&(this.m_ani.dispose(),this.m_ani=null),this.m_callbackThisObj=null,this.m_funCallOnAniEnd=null,this.m_funCallOnNewLine=null,this.m_funOnCurrentVChange=null,t.prototype.dispose.call(this)},e}(t.PanelCut);t.BarInProgress=e,__reflect(e.prototype,"uicommon.BarInProgress")}(uicommon||(uicommon={}));var Table;!function(t){var e=function(){function t(t){this.m_dicOffset={},this.m_dicItem={},this.m_tableClass=t}return t.prototype.init=function(t){this.m_byteArray=t,this.m_byteArray.endian=egret.Endian.LITTLE_ENDIAN;var e,i,n,o=this.m_byteArray.readUnsignedInt();for(e=0;o>e;e++)i=this.m_byteArray.readUnsignedInt(),n=this.m_byteArray.readUnsignedInt(),this.m_dicOffset[i]=n},t.prototype.getItem=function(t){var e=this.m_dicItem[t];return null==e&&(this.createItem(t),e=this.m_dicItem[t]),e},t.prototype.createItem=function(t){var e,i=this.m_dicOffset[t];return i?(this.m_byteArray.position=i,e=new this.m_tableClass,e.m_uID=t,e.parseByteArray(this.m_byteArray),this.m_dicItem[t]=e,e):null},t.prototype.getItems=function(){if(this.m_areadyReadAll)return this.m_dicItem;var t;for(t in this.m_dicOffset)void 0==this.m_dicItem[t]&&this.createItem(parseInt(t));return this.m_areadyReadAll=!0,this.m_dicItem},t}();t.CTable=e,__reflect(e.prototype,"Table.CTable")}(Table||(Table={}));var uicommon;!function(t){var e=function(t){function e(e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var o=t.call(this)||this;return o.m_parent=null,o.m_parent=e,o.x=i,o.y=n,o}return __extends(e,t),e.prototype.show=function(){this.parent!=this.m_parent&&(this.m_parent.addChild(this),this.onShow())},e.prototype.hide=function(){this.parent&&(this.onHide(),this.parent.removeChild(this))},e.prototype.onShow=function(){},e.prototype.onHide=function(){},e.prototype.updateData=function(){},e.prototype.isVisible=function(){return null!=this.parent},e.prototype.dispose=function(){this.onHide(),core.ui_call_supper_dispose(eui.Component,this)},e}(eui.Component);t.PanelShowAndHide=e,__reflect(e.prototype,"uicommon.PanelShowAndHide")}(uicommon||(uicommon={}));var scene;!function(t){var e=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.m_floor=t,n}return __extends(i,e),i.prototype.createAssets=function(){this.m_imageBimap=t.fMap.s_getBitmap(),this.m_eleRoot.addChild(this.m_imageBimap);var i=this.m_map.m_config.thumbnailTexture;i&&this.onThumbnailLoaded();var n=this.m_floor.getFloorImageURL();Context.imageLoaderMgr.isLoaded(n)?(this.m_imageLoader=Context.imageLoaderMgr.getImageLoadItem(n),this.onLoaded()):Context.imageLoaderMgr.isLoadFailed(n)||(this.m_imageLoader=Context.imageLoaderMgr.load(n,this.onLoaded,this.onLoadFailed,this)),this.m_imageLoader&&(this.m_imageLoader.increment(),this.m_imageLoader.useTextures(),this.m_map.getFloorImageMgr().add(this.m_imageLoader)),this.m_isImageLoaded||this.m_map.m_config.isThumbnailLoaded&&this.onThumbnailLoaded(),e.prototype.createAssets.call(this)},i.prototype.onLoaded=function(){this.m_imageBimap.texture=this.m_imageLoader.texture,this.m_imageBimap.scaleX=1,this.m_imageBimap.scaleY=1,this.m_isImageLoaded=!0},i.prototype.onLoadFailed=function(){},i.prototype.dispose=function(){t.fMap.s_collectBitmap(this.m_imageBimap),this.m_imageBimap=null,this.m_imageLoader&&(this.m_imageLoader.disuseTextures(),this.m_imageLoader.discrease(),Context.imageLoaderMgr.removeListener(this.m_imageLoader,this.onLoaded,this.onLoadFailed,this)),this.m_thumbnailTexture&&(this.m_thumbnailTexture=null),e.prototype.dispose.call(this)},i.prototype.onThumbnailLoaded=function(){if(!this.m_imageLoader||!this.m_imageLoader.loaded){var e=this.m_map.m_config.thumbnailTexture;this.m_thumbnailTexture=new egret.Texture,this.m_thumbnailTexture.$bitmapData=e.bitmapData;var i=this.m_floor.x/this.m_map.widthPx*e.textureWidth,n=this.m_floor.y/this.m_map.heightPx*e.textureHeight,o=t.fMapConfig.Image_SIZE/this.m_map.widthPx*e.textureWidth,r=t.fMapConfig.Image_SIZE/this.m_map.heightPx*e.textureHeight;this.m_thumbnailTexture.$initData(i,n,o,r,0,0,256,256,e.$sourceWidth,e.$sourceHeight),this.m_imageBimap.texture=this.m_thumbnailTexture,this.m_imageBimap.scaleX=t.fMapConfig.Image_SIZE/o,this.m_imageBimap.scaleY=t.fMapConfig.Image_SIZE/r}},i}(t.fElementRender);t.fFloorRenderer=e,__reflect(e.prototype,"scene.fFloorRenderer")}(scene||(scene={}));var httpCmd;!function(t){var e=function(e){function i(){return e.call(this,t.CommandBase.CMD_login_request)||this}return __extends(i,e),i.prototype.generateObj=function(){var t={sdkID:this.sdkID,pid:this.pid,extra:this.extra||{}};return t},i}(t.CommandBase);t.ReqLoginCmd=e,__reflect(e.prototype,"httpCmd.ReqLoginCmd")}(httpCmd||(httpCmd={}));var httpCmd;!function(t){var e=function(e){function i(){return e.call(this,t.CommandBase.CMD_login_ReqWxTextCheck)||this}return __extends(i,e),i.prototype.generateObj=function(){var t={text:this.text};return t},i}(t.CommandBase);t.ReqWxTextCheck=e,__reflect(e.prototype,"httpCmd.ReqWxTextCheck")}(httpCmd||(httpCmd={}));var httpCmd;!function(t){var e=function(e){function i(){return e.call(this,t.CommandBase.CMD_login_result)||this}return __extends(i,e),i}(t.CommandBase);t.ResLoginResultCmd=e,__reflect(e.prototype,"httpCmd.ResLoginResultCmd")}(httpCmd||(httpCmd={}));var httpCmd;!function(t){var e=function(e){function i(){return e.call(this,t.CommandBase.CMD_monitor_RecordBannerAd)||this}return __extends(i,e),i.prototype.generateObj=function(){var t=Context.heroinfoMgr.mainData,e=Context.operationMgr.operation,i=Context.commonSetMgr.isSet(CommonSetMgr.COMMONSET_EntryGame_byShare)?1:2,n={groupID:Context.bzConfig.groupID,pid:e.pid,zone:e.getABTestVersion()+1,accid:Context.loginData.accid,charid:t.charid,name:Context.heroinfoMgr.name,type:this.type,share:i};return n},i}(t.CommandBase);t.RecordBannerAd=e,__reflect(e.prototype,"httpCmd.RecordBannerAd")}(httpCmd||(httpCmd={}));var httpCmd;!function(t){var e=function(e){function i(){return e.call(this,t.CommandBase.CMD_monitor_RecordClientData)||this}return __extends(i,e),i.prototype.generateObj=function(){var t=Context.operationMgr.operation,e={groupID:Context.bzConfig.groupID,pid:t?t.pid:0,zone:t?t.getABTestVersion()+1:0,type:this.type,osType:Context.system.osType};return e},i}(t.CommandBase);t.RecordClientData=e,__reflect(e.prototype,"httpCmd.RecordClientData")}(httpCmd||(httpCmd={}));var httpCmd;!function(t){var e=function(e){function i(){return e.call(this,t.CommandBase.CMD_monitor_RecordOnline)||this}return __extends(i,e),i.prototype.generateObj=function(){var t=Context.heroinfoMgr.mainData,e=Context.operationMgr.operation,i={groupID:Context.bzConfig.groupID,pid:e.pid,zone:e.getABTestVersion()+1,charid:t.charid};return i},i}(t.CommandBase);t.RecordOnline=e,__reflect(e.prototype,"httpCmd.RecordOnline")}(httpCmd||(httpCmd={}));var httpCmd;!function(t){var e=function(e){function i(){return e.call(this,t.CommandBase.CMD_monitor_RecordPassLevel)||this}return __extends(i,e),i.prototype.generateObj=function(){var t=Context.heroinfoMgr.mainData,e=Context.operationMgr.operation,i={groupID:Context.bzConfig.groupID,pid:e.pid,zone:e.getABTestVersion()+1,accid:0,charid:t.charid,level:t.guan+1,regTime:t.regtime};return i},i}(t.CommandBase);t.RecordPassLevel=e,__reflect(e.prototype,"httpCmd.RecordPassLevel")}(httpCmd||(httpCmd={}));var httpCmd;!function(t){var e=function(e){function i(){return e.call(this,t.CommandBase.CMD_recharge_ReqRechargeCmd)||this}return __extends(i,e),i.prototype.generateObj=function(){var t={sdk:this.sdk,pid:this.pid,uid:this.uid,goodId:this.goodId,zone:this.zone,roleName:this.roleName,charId:this.charId,zoneName:this.zoneName};return t},i}(t.CommandBase);t.ReqRechargeCmd=e,__reflect(e.prototype,"httpCmd.ReqRechargeCmd")}(httpCmd||(httpCmd={}));var httpCmd;!function(t){var e=function(e){function i(){return e.call(this,t.CommandBase.CMD_recharge_ResRechargeCmd)||this}return __extends(i,e),i}(t.CommandBase);t.ResRechargeCmd=e,__reflect(e.prototype,"httpCmd.ResRechargeCmd")}(httpCmd||(httpCmd={}));var common;!function(t){var e=function(){function t(){this.m_JSVersion="1.0.0",this.m_serverLogs=[],this.m_nSendServer=0,this.m_log="",this.m_JSVersion=platform.jsVersion}return t.prototype.bShowDebugBtn=function(){return Context.bzConfig.bShowDebugBtn},t.prototype.bTest_205=function(){return"bTest_205"in window&&1==window.bTest_205},t.prototype.addLog=function(t){Context.timeMgr&&Context.timeMgr.isInit?this.m_log+=Context.timeMgr.getServerTimeL().formatString_hms()+" "+t+"\n":this.m_log+=t+"\n",egret.log(t)},t.prototype.clearLog=function(){this.m_log=""},t.prototype.getLog=function(){return this.m_log},Object.defineProperty(t.prototype,"jsversion",{get:function(){return this.m_JSVersion},enumerable:!0,configurable:!0}),t.prototype.sendServer=function(t){return void this.addLog(t)},t.prototype.send=function(){if(!(this.m_request||0==this.m_serverLogs.length||this.m_nSendServer>20)){this.m_nSendServer++;var t=this.m_serverLogs.shift(),e=encodeURIComponent("gameDataCollect/insert/crashData"),i=Context.bzConfig.php_server_URL+"?r="+e;this.m_request=new egret.HttpRequest,this.m_request.responseType=egret.HttpResponseType.TEXT,this.m_request.once(egret.Event.COMPLETE,this.onHttpComplete,this),this.m_request.once(egret.IOErrorEvent.IO_ERROR,this.onHttpError,this),this.m_request.open(i,egret.HttpMethod.POST),this.m_request.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.m_request.send(t)}},t.prototype.onHttpComplete=function(){this.m_request.response;this.m_request=null,this.send()},t.prototype.onHttpError=function(t){this.m_request=null,this.send()},t.prototype.showError=function(t){if(this.bShowDebugBtn()||this.bTest_205()){var e=Context.uimgr.showForm(UIFormID.UIError);e.setText(t)}else this.addLog(t)},t.prototype.showWarning=function(t){if(this.bShowDebugBtn()||this.bTest_205()){var e=Context.uimgr.showForm(UIFormID.UIError);e.setTextWarning(t)}else this.addLog(t)},t.prototype.sendLogWeb=function(t){if(!this.m_requestLogWeb){var e=UtilUrl.getYunyingURL()+"clientInfoCopy/SaveContentToFile.php";this.m_requestLogWeb=new core.HttpRequest_post,this.m_requestLogWeb.send(e,t,this.onRequestLogWebComplete,this.onRequestLogWebError,this)}},t.prototype.onRequestLogWebComplete=function(){this.m_requestLogWeb=null,Context.sysPromptMgr.addGreenPrompt("copy 成功")},t.prototype.onRequestLogWebError=function(){this.m_requestLogWeb=null},t.prototype.sendSynOsType=function(){var t=new Cmd.synOsTypeUserCmd;t.osType=Context.system.osType,Context.sendMsg(t)},t.prototype.showPerformanceInfo=function(){Context.bzConfig.bShowMemoryInfo&&!function(){var t=egret.$hashCount;setInterval(function(){var e=egret.$hashCount,i=e-t;t=e,console.log("diff="+i)},1e3)}()},t}();t.logMgr=e,__reflect(e.prototype,"common.logMgr")}(common||(common={}));var common;!function(t){var e=function(){function t(){this.m_queue=new dataset.QueueVec(300)}return t.prototype.receive=function(t){var e=t.byCmd,i=t.byParam;if(!this.filterMessage(e,i)){this.m_queue.isFull&&this.m_queue.pop(),t.__logFlag__="r",t.__time__=Context.timeMgr.getServerTimeL().formatString_hms(),this.m_queue.push(t)}},t.prototype.filterMessage=function(t,e){return 0==t?!0:!1},t.prototype.getQueueVec=function(){return this.m_queue},t.prototype.send=function(t){var e=t.byCmd,i=t.byParam;if(!this.filterMessage(e,i)){this.m_queue.isFull&&this.m_queue.pop(),t.__logFlag__="s",t.__time__=Context.timeMgr.getServerTimeL().formatString_hms(),this.m_queue.push(t)}},t.prototype.getLatestMsgBy_Cmd_param=function(t,e){var i=this.m_queue.size;if(i>0)for(var n=i-1;n>=0;n--){var o=this.m_queue.getData(n);if(o.byCmd==t&&o.byParam==e)return o}return null},t.prototype.getDesc=function(){var t="",e=this.m_queue.size,i=0;for(i=0;e>i;i++){var n,o=this.m_queue.getData(i),r=o>>8&255,s=255&o,a=o>>16&255;n=a?"rev 	":"send 	",t+=n+"cmd="+r+"   		param="+s+"\n"}return t},t}();t.MsgRecordMgr=e,__reflect(e.prototype,"common.MsgRecordMgr")}(common||(common={}));var LanguageMgr=function(){function t(){}return t.prototype.init=function(){},t.prototype.loadConfig=function(){null==this.m_strData&&(this.m_strData=Context.dataXmlMgr.getJson(dataXml.XML_BaseStr))},t.prototype.getEleStr=function(t,e,i){void 0===i&&(i=null),this.loadConfig();var n="";return this.m_strData.set[t]&&this.m_strData.set[t][""+e]?n=this.m_strData.set[t][e]:Context.logMgr.sendServer("[getEleStr] set id="+t+" 缺少ele id="+e),UtilTools.replaceStr(n,i)},t.prototype.getProptypeStr=function(t){return this.getEleStr("roleInfo",100+t)},t.prototype.getJobStr=function(t){return this.getEleStr("tips",100+t)},t}();__reflect(LanguageMgr.prototype,"LanguageMgr");var PackageMgr=function(t){function e(){var e=t.call(this)||this;return e.bshowProcessGameEnd=!1,e.m_objData=[],e}return __extends(e,t),e.prototype.computeObjNumInPackage=function(t){for(var e=this.m_objData,i=0;i<e.length;i++)if(e[i].objid==t)return e[i].num;return 0},e.prototype._getObjListByType=function(t){for(var e=[],i=this.m_objData,n=0;n<i.length;n++){var o=Context.dataTableMgr.getItem(Table.TABLE_OBJECT,i[n].objid);o&&o.m_type==t&&e.push(o)}return e},e.prototype.getObjColorValue=function(t){var e=Context.dataTableMgr.getItem(Table.TABLE_OBJECT,t);return e?UtilColor.colorValue(e.m_color):UtilColor.WHITE},e.prototype.getObjColor=function(t){var e=Context.dataTableMgr.getItem(Table.TABLE_OBJECT,t);return e?e.m_color:UtilColor.COLOR_WHITE},e.prototype.getObjZuanShiPrice=function(t){var e=Context.dataTableMgr.getItem(Table.TABLE_OBJECT,t);return e?e.m_zuanshiPrice:0},e.prototype.getObjJinBiPrice=function(t){var e=Context.dataTableMgr.getItem(Table.TABLE_OBJECT,t);return e?e.m_jinbiPrice:0},e.prototype.getObjType=function(t){var e=Context.dataTableMgr.getItem(Table.TABLE_OBJECT,t);return e?e.m_type:0},e.prototype.getObjName=function(t){var e=Context.dataTableMgr.getItem(Table.TABLE_OBJECT,t);return e?e.m_name:""},e.prototype.getObjDesc=function(t){var e=Context.dataTableMgr.getItem(Table.TABLE_OBJECT,t);if(e){var i=e.m_iDesc,n=e.m_iDescParams.split(";");return"&"==i.charAt(0)&&(i=Context.dataTableMgr.getItem(Table.TABLE_OBJECT,parseInt(i.slice(1))).m_iDesc),UtilTools.replaceStr(i,n)}return""},e.prototype.getObjIconRes=function(t){var e=Context.dataTableMgr.getItem(Table.TABLE_OBJECT,t);return e?e.pathIconName():""},e.prototype.process_onlineSendUserObjectUserCmd=function(t){var e=new Cmd.onlineSendUserObjectUserCmd;e.deserialize(t),this.m_objData=e.data},e.prototype.process_addUserObjectUserCmd=function(t){var e=new Cmd.addUserObjectUserCmd;e.deserialize(t);var i=new Cmd.t_ObjData;i.objid=e.id,i.num=e.num,this.m_objData.push(i)},e.prototype.process_updateUserObjectUserCmd=function(t){var e=new Cmd.updateUserObjectUserCmd;e.deserialize(t);for(var i=0,n=0;n<this.m_objData.length;n++)if(this.m_objData[n].objid==e.id){e.num>this.m_objData[n].num&&(i=e.num-this.m_objData[n].num),this.m_objData[n].num=e.num;break}Context.dataTableMgr.getItem(Table.TABLE_OBJECT,e.id)},e.prototype.reqUseObject=function(t,e){void 0===e&&(e=1);var i=new Cmd.reqUseObjectUserCmd;i.id=t,i.num=e,Context.sendMsg(i),egret.log("[use Object] reqUseObjectUserCmd id="+t+" num="+e)},e.prototype.process_stReturnNewNameUserCmd=function(t){var e=new Cmd.stReturnNewNameUserCmd;e.deserialize(t),egret.log("[modifyname] stReturnNewNameUserCmd name="+e.name)},e.prototype.reqChangeNameModifyName=function(t){var e=new Cmd.stReqChangeNameModifyNameUserCmd;e.sex=t,Context.sendMsg(e),egret.log("[modifyname] stReqChangeNameModifyNameUserCmd sex="+t)},e.prototype.reqChangeNameVerifyUseName=function(t,e){var i=new Cmd.stReqChangeNameVerifyUseNameUserCmd;i.name=t,i.sex=e,Context.sendMsg(i),egret.log("[modifyname] stReqChangeNameVerifyUseNameUserCmd name="+t+" sex="+e)},e.prototype.process_stRetChangeNameVerifyUseNameUserCmd=function(t){var e=new Cmd.stRetChangeNameVerifyUseNameUserCmd;if(e.deserialize(t),egret.log("[modifyname] stRetChangeNameVerifyUseNameUserCmd name="+e.name+" sex="+e.sex+" valid="+e.valid),1==e.valid){Context.commonSetMgr.isSet(CommonSetMgr.COMMONSET_FIRST_SETNAME)||Context.commonSetMgr.setAndSend(CommonSetMgr.COMMONSET_FIRST_SETNAME),Context.uimgr.exitForm(UIFormID.UIModifyName),Context.heroinfoMgr.onModifyName(e.name,e.sex);var i=Context.playerMgr.getPlayerMain();i&&(i.name=e.name)}else Context.sysPromptMgr.addErrorPrompt(Context.languageMgr.getEleStr("createhero",2))},e.prototype.process_matchGameEndSendObjTypeTwoUserCmd=function(t){var e=new Cmd.matchGameEndSendObjTypeTwoUserCmd;e.deserialize(t);e.data,e.countDay;Context.logMgr.addLog("-- showUIVictoryWeCat --"),Context.logMgr.sendServer("收到关卡结算返回消息matchGameEndSendObjTypeTwoUserCmd guan"+Context.heroinfoMgr.guan+", state="+e.state+", countDay="+e.countDay),this.bshowProcessGameEnd=!0,e.state&&Context.soundMgr.play(sound.SOUND_pass);for(var i=0;i<e.data.length;i++){var n=0;for(n=0;n<this.m_objData.length;n++)if(e.data[i].objid==this.m_objData[n].objid){this.m_objData[n].num=e.data[i].num;break}if(n>=this.m_objData.length||!this.m_objData.length){var o=new Cmd.t_ObjData;o.objid=e.data[i].objid,o.num=e.data[i].num,this.m_objData.push(o)}}},e.prototype.reset_to_beforeLogin=function(){this.m_objData.length=0},e.ObjID_JinBi=1,e.ObjID_ZuanShi=3,e.ObjID_GaiMingKa=6,e.ObjID_JinBiFashionBox=11,e.ObjID_SmallZuanShiFashionBox=12,e.ObjID_BigZuanShiFashionBox=13,e}(egret.EventDispatcher);__reflect(PackageMgr.prototype,"PackageMgr");var common;!function(t){var e=function(){function t(){}return t.prototype.reqAbTestUserVersion=function(){var t=Context.operationMgr.operation,e=t.getABTestVersion(),i=new Cmd.synAbTestUserVersionUserCmd;i.version=e,Context.sendMsg(i),Context.logMgr.addLog("synAbTestUserVersionUserCmd version="+e)},t}();t.ABTestMgr=e,__reflect(e.prototype,"common.ABTestMgr")}(common||(common={}));var common;!function(t){var e=function(){function e(){}return e.prototype.reqNotifyUserRecordToServer=function(t,e){void 0===e&&(e=1);var i=new Cmd.notifyUserRecordToServerUserCmd;i.func=e,i.type=t,Context.sendMsg(i),Context.logMgr.addLog("reqNotifyUserRecordToServer() func="+e+" type="+t)},e.prototype.sendRecordClientData=function(t){var e=new httpCmd.RecordClientData;e.type=t,Context.httpSendMgr.send(e),Context.logMgr.addLog("sendRecordClientData() type="+t)},e.prototype.sendRecordBannerAd=function(t){var e=new httpCmd.RecordBannerAd;e.type=t,Context.httpSendMgr.send(e),Context.logMgr.addLog("sendRecordBannerAd() type="+t)},e.prototype.updateStateActivate=function(e){if(!e){var i=Context.operationMgr.operation;i instanceof t.operation_wx&&i.m_bShowBannerAd&&this.sendRecordBannerAd(2)}},e.Type_loadResStart=1,e.Type_loadResComplete=2,e.Type_authorize_wx=3,e}();t.MonitorDataMgr=e,__reflect(e.prototype,"common.MonitorDataMgr")}(common||(common={}));var common;!function(t){var e=function(){function t(){if(this.sdk=0,this.pid=0,this.groupID=0,this.game_hideConsoleLog=!1,this.bShowDebugBtn=!1,this.bShowMemoryInfo=!1,this.isWSS=!1,"bzConfig"in window){var t=window.bzConfig;this.cdnroot=t.cdnroot,this.php_server_URL=t.php_server_URL,this.sdk=t.sdk,this.pid=t.pid,this.groupID=t.groupID,this.game_hideConsoleLog=t.game_hideConsoleLog,this.bShowDebugBtn=t.bShowDebugBtn,this.bShowMemoryInfo=t.bShowMemoryInfo,this.isWSS=t.isWSS,this.loginServer=t.loginServer}else this.cdnroot="",this.loginServer={ip:"",port:8080}}return t.prototype.updateData=function(t){void 0===t&&(t=0);var e=window.bzConfigList[t];e&&(this.cdnroot=e.cdnroot,this.php_server_URL=e.php_server_URL,this.sdk=e.sdk,this.pid=e.pid,this.groupID=e.groupID,this.game_hideConsoleLog=e.game_hideConsoleLog,this.bShowDebugBtn=e.bShowDebugBtn,this.bShowMemoryInfo=e.bShowMemoryInfo,this.isWSS=e.isWSS,this.loginServer=e.loginServer)},t}();t.BZConfig=e,__reflect(e.prototype,"common.BZConfig")}(common||(common={}));var common;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_isSupportRelogin=!0,e.m_isSupportABTest=!0,e}return __extends(e,t),e.prototype.init=function(e,i){t.prototype.init.call(this,e,i),this.sysInfo=CMPlay.getSystemInfoSync(),CMPlay.setRewardVideoADId("908427047");var n=CMPlay.getABTestVersion();return this.setABTestVersion(n),Context.logMgr.addLog("ABTest version="+n),!0},e.prototype.update_ReqLoginCmd=function(t){t.extra={gameToken:this.sysInfo.gameToken}},e.prototype.showRewardedVideoAd=function(t,e,i){function n(){Context.logMgr.addLog("Ad - showRewardedVideoAd callback"),e.call(i,!0)}CMPlay.startRewardVideo(n())},e.prototype.showBannerAd=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),CMPlay.showBanner()},e.prototype.hideBannerAd=function(){CMPlay.hideBanner()},e.prototype.bShowBannerAd=function(){return!1},e}(t.OperationBase);t.Operation_happy=e,__reflect(e.prototype,"common.Operation_happy")}(common||(common={}));var Cmd;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.byCmd=t.stNullUserCmd.ACTIVITY_USERCMD,i}return __extends(i,e),i.ONLINE_SHARED_LIST_USERCMD=1,i.SYN_SHARED_DATA_USERCMD=2,i.ADD_SHARE_ITEM_USERCMD=3,i.SEND_ZHE_KOU_LI_BAO_DATA_USERCMD=11,i.SEND_BUY_ZHE_KOU_LI_BAO_ID_USERCMD=12,i}(t.stNullUserCmd);t.stActivityCmd=e,__reflect(e.prototype,"Cmd.stActivityCmd");var i=function(){function t(){this.name="",this.head=""}return t.prototype.deserialize=function(t){this.name=UtilByteArray.readStr_MAX_NAMESIZE(t),this.head=UtilByteArray.readStr(t)},t}();t.SharedItem=i,__reflect(i.prototype,"Cmd.SharedItem");var n=function(t){function n(){var i=t.call(this)||this;return i.byParam=e.ONLINE_SHARED_LIST_USERCMD,i.datas=[],i}return __extends(n,t),n.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);for(var n,o=e.readUnsignedByte(),r=0;o>r;r++)n=new i,n.deserialize(e),this.datas.push(n)},n}(e);t.onlineSharedListUserCmd=n,__reflect(n.prototype,"Cmd.onlineSharedListUserCmd");var o=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SYN_SHARED_DATA_USERCMD,i.url="",i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.charid),UtilByteArray.writeStr(e,this.url,1)},i}(e);t.synSharedDataUserCmd=o,__reflect(o.prototype,"Cmd.synSharedDataUserCmd");var r=function(t){function n(){var n=t.call(this)||this;return n.byParam=e.ADD_SHARE_ITEM_USERCMD,n.data=new i,n}return __extends(n,t),n.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.data.deserialize(e)},n}(e);t.addSharedItemUserCmd=r,__reflect(r.prototype,"Cmd.addSharedItemUserCmd");var s=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SEND_ZHE_KOU_LI_BAO_DATA_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.boxId=e.readUnsignedByte(),this.boxDay=e.readUnsignedShort()},i}(e);t.sendZheKouLiBaoDataUserCmd=s,__reflect(s.prototype,"Cmd.sendZheKouLiBaoDataUserCmd");var a=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SEND_BUY_ZHE_KOU_LI_BAO_ID_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.boxId=e.readUnsignedByte()},i}(e);t.sendBuyZheKouLiBaoIdUserCmd=a,__reflect(a.prototype,"Cmd.sendBuyZheKouLiBaoIdUserCmd")}(Cmd||(Cmd={}));var common;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_shareOpened=!0,e.m_isSupportRelogin=!0,e}return __extends(e,t),e.prototype.init=function(e,i){return t.prototype.init.call(this,e,i),!0},e.prototype.getReqestLoginRecordParam=function(){var t="abc",e={uid:t};return e},e.prototype.showRewardedVideoAd=function(t,e,i){function n(){e.call(i,!0)}CMPlay.startRewardVideo(n()),Context.logMgr.addLog("Ad - showRewardedVideoAd")},e.prototype.showBannerAd=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),CMPlay.showBanner(),Context.logMgr.addLog("Ad - showBannerAd")},e.prototype.hideBannerAd=function(){CMPlay.hideBanner(),Context.logMgr.addLog("Ad - hideBannerAd")},e}(t.OperationBase);t.Operation_test=e,__reflect(e.prototype,"common.Operation_test")}(common||(common={}));var common;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.isLoaded=!1,t.subChannelPid=0,t.m_curGoodid=0,t.m_spid=0,t.m_isSharing=!1,t.m_isShareTimeComplete=!0,t.m_shareTime=0,t.m_bShowBannerAd=!1,t.m_videoAdShowCallback=null,t.m_videoAdHideCallback=null,t.m_shareOpened=!0,t.m_isSupportRelogin=!0,t.m_sdkAuthority=window.g_sdkAuthority,t}return __extends(i,e),i.prototype.init=function(t,i){e.prototype.init.call(this,t,i),window.wx.getSystemInfo({success:this.onSystemInfoSuccess.bind(this),fail:this.onSystemInfoFail.bind(this),complete:this.onSystemInfocomplete.bind(this)}),console.log("getSystemInfo");var n=Context.commonCfg.getConfig(4);n&&(window._shareData_=n.shareData),Context.system.versionType_wx?this.m_subChannel="default_tiyan":this.m_subChannel=this.m_sdkAuthority.getSubChannel(platform.getLaunchOptionsSync(),"default"),this.getPidByChannel(this.m_subChannel),this.isLoaded=!1,platform.login().then(this.onLogin);var o=function(){RES.profile(),Context.logMgr.sendServer("onMemoryWarningReceive")};return platform.memoryWarning(o),!1},i.prototype.getPidByChannel=function(t){var e={channel:t,v:Math.random()},i=UtilUrl.jointURLParam(e),n=UtilUrl.getYunyingURL()+"platforms/common/GetPidByChannel.php?"+i;this.pidRequest=new core.HttpRequest_get,this.pidRequest.send(n,this.onRequestComplete,this.onHttpError,this)},i.prototype.onRequestComplete=function(){var t=this.pidRequest.getResponse(),e=JSON.parse(t);this.subChannelPid=e.pid,this.setPlatformID(e.pid),this.isLoaded&&Context.operationMgr.operation.onInitComplete(),Context.logMgr.addLog("wxgame getPidByChannel OK! pid="+this.subChannelPid+" m_subChannel="+this.m_subChannel)},i.prototype.onHttpError=function(t){this.subChannelPid=Context.bzConfig.pid,this.isLoaded&&Context.operationMgr.operation.onInitComplete(),Context.logMgr.sendServer("wxgame getPidByChannel error! pid="+this.subChannelPid+" m_subChannel="+this.m_subChannel)},i.prototype.setAuthorize=function(t){console.log("setAuthorize()"),Context.loginData.authorize_wx=t,egret.log("Context.loginData.authorize_wx:"),egret.log(t),t["scope.userInfo"]?(platform.getUserInfo().then(function(t){Context.loginData.userInfo_wx.nickName=t.nickName,Context.loginData.userInfo_wx.avatarUrl=t.avatarUrl,Context.loginData.userInfo_wx.gender=t.gender
}),Context.operationMgr.operation.isLoaded&&Context.operationMgr.operation.onInitComplete()):Context.operationMgr.operation.onShowAuthorizeBtn(0,0,Context.width,Context.height)},i.prototype.onLogin=function(t){console.log("operation_wx::onLogin code="+t.code);var e=Context.operationMgr.operation;e.code=t.code,e.isLoaded=!0,e.subChannelPid&&Context.operationMgr.operation.onInitComplete()},i.prototype.set_uid=function(t){e.prototype.set_uid.call(this,t),Context.loginData.userInfo_wx.openid=t},i.prototype.setLoginParam=function(t){e.prototype.setLoginParam.call(this,t),this.setPlatformID(t.pid)},i.prototype.chongzhi=function(t){return Context.system.isIos?void Context.sysPromptMgr.showDialogPrompt("IOS系统暂不支持充值，请使用安卓设备充值",!0):(this.m_curGoodid=t,void this.sendChongzhiHttpRequest(t))},i.prototype.sendChongzhiHttpRequest=function(t){if(!this.m_chongzhiRequest){var e=Context.bzConfig.php_server_URL,i={r:"muYunying/chongzhi/chongzhiServer",pid:this.m_id};e+"?"+UtilUrl.jointURLParam(i)}},i.prototype.onChongzhiHttpRequestComplete=function(){var t=this.m_chongzhiRequest.getResponse();if(t){var e=JSON.parse(t),i=e.code,n=e.msg;0==i?(Context.logMgr.addLog("code == 0"),Context.sysPromptMgr.showDialogPrompt("支付成功")):1==i?(delete e.code,e.success=this.onPaySuccess.bind(this),e.fail=this.onPayFail.bind(this),e.complete=this.onPayComplete.bind(this),platform.pay(e)):Context.sysPromptMgr.showDialogPrompt(n)}this.m_chongzhiRequest=null},i.prototype.chongzhiAgain=function(){console.log("chongzhiAgain 1"),this.m_curGoodid&&(console.log("chongzhiAgain 2"),this.chongzhi(this.m_curGoodid))},i.prototype.onPaySuccess=function(t){Context.sysPromptMgr.showDialogPrompt("调用微信支付成功"),this.chongzhiAgain()},i.prototype.onPayFail=function(t){Context.sysPromptMgr.showDialogPrompt("用户取消支付")},i.prototype.onPayComplete=function(t){},i.prototype.onSystemInfoSuccess=function(t){Context.system.systemInfo_wx=t,this.m_systemInfo=t;var e=JSON.stringify(t);console.log(e)},i.prototype.onSystemInfoFail=function(t){},i.prototype.onSystemInfocomplete=function(t){},i.prototype.getShareCfg=function(t){var e,i=Context.commonCfg.getConfig(4);if(i&&i.shareData){for(var n in i.shareData)if(i.shareData[n].funcType==t){e=i.shareData[n];break}e||(e=UtilRandom.random(i.shareData))}e||(e={title:"代表星星消灭你！",img:"share"});var o="resource/share/"+e.img+".png";return{title:e.title,imageUrl:Context.gameVersionController.getVirtualUrl(o)}},i.prototype.doShare=function(t){void 0===t&&(t=null),this.m_isSharing=!0,this.m_isShareTimeComplete=!1;var e=(Context.heroinfoMgr.charid,t),i=this.getShareCfg(e);platform.share(Context.heroinfoMgr.charid,e,i)},i.prototype.onShareEnd=function(){this.m_isShareTimeComplete&&window.wx.showToast({title:"分享成功",icon:"none",duration:2e3}),Context.logMgr.addLog("wx share result="+this.m_isShareTimeComplete)},Object.defineProperty(i.prototype,"isSharing",{get:function(){return this.m_isSharing},enumerable:!0,configurable:!0}),i.prototype.updateStateActivate=function(t){if(this.m_isSharing)if(t){var e=egret.getTimer(),i=Date.now()-this.m_shareTime;i>=e&&(this.m_isShareTimeComplete=!0),this.onShareEnd(),this.m_isSharing=!1,Context.logMgr.sendServer("wx share end: defTime="+e+" useTime="+i+" shareTime="+this.m_shareTime)}else this.m_shareTime=Date.now()},i.prototype.showRewardedVideoAd=function(t,e,i){this.m_videoAdShowCallback||(this.m_videoAdShowCallback=function(){Context.logMgr.addLog("Ad - showRewardedVideoAd showCallback"),t.call(i)}),this.m_videoAdHideCallback||(this.m_videoAdHideCallback=function(t){Context.logMgr.addLog("Ad - showRewardedVideoAd hideCallback"),e.call(i,t)}),platform.startRewardVideo(this.m_videoAdShowCallback,this.m_videoAdHideCallback)},i.prototype.showBannerAd=function(t,e){function i(i){var n=window.wx.getSystemInfoSync(),o=Math.floor(i*Context.height/n.windowHeight);Context.logMgr.addLog("Ad - showBannerAd callback"),Context.operationMgr.operation.m_bShowBannerAd=!0,Context.monitorDataMgr.sendRecordBannerAd(1),t&&t.call(e,o)}void 0===t&&(t=null),void 0===e&&(e=null),platform.showBanner(i)},i.prototype.hideBannerAd=function(){Context.operationMgr.operation.m_bShowBannerAd=!1,platform.hideBanner()},i.prototype.bShowBannerAd=function(){return!0},i.prototype.loginOut=function(){Context.logMgr.sendServer("wxgame loginOut()"),window.wx.removeStorageSync("account"),platform.loginOut()},i.prototype.update_ReqLoginCmd=function(t){t.extra={code:this.code}},i.prototype.onShowAuthorizeBtn=function(e,i,n,o){if(!Context.loginData.authorize_wx["scope.userInfo"]){egret.log("stageSize="+Context.width+","+Context.height+" loginBtn pos="+e+","+i);var r=e/Context.width,s=i/Context.height,a=n/Context.width,h=o/Context.height;platform.authorize(r,s,a,h).then(function(e){e&&(Context.loginData.userInfo_wx.nickName=e.nickName,Context.loginData.userInfo_wx.avatarUrl=e.avatarUrl,Context.loginData.userInfo_wx.gender=e.gender,Context.loginData.authorize_wx["scope.userInfo"]=!0),egret.log("Context.loginData.userInfo_wx"),egret.log(e),Context.commonSetMgr.isSet(CommonSetMgr.COMMONSET_Authorize_wx)?Context.commonSetMgr.setAndSend(CommonSetMgr.COMMONSET_Authorize_wx):Context.monitorDataMgr.sendRecordClientData(t.MonitorDataMgr.Type_authorize_wx),Context.operationMgr.operation.onAuthorizeEnd(),Context.uimgr.exitForm(UIFormID.UILoginWXAuthorize)})}},i.prototype.onAuthorizeEnd=function(){Context.loginData.authorize_wx["scope.userInfo"]},i.prototype.onLoadResOfOpenDataContext=function(){platform.sendMsgToOpenDataContext({command:"loadRes"})},i.prototype.openCustomerService=function(){var t=window.wx;t&&t.openCustomerServiceConversation&&t.openCustomerServiceConversation({sessionFrom:"",showMessageCard:!0,sendMessageTitle:"每日奖励",sendMessagePath:"?scene=1073",sendMessageImg:Context.bzConfig.cdnroot+"resource/share/share.png",success:function(t){console.log("success:"+t)},fail:function(t){console.log("fail:"+t)},complete:function(t){console.log("complete:"+t)}})},i.prototype.showFeedbackButton=function(t,e,i,n){var o=window.wx;if(o&&o.openCustomerServiceConversation){var r=o.getSystemInfoSync(),s=t/Context.width,a=e/Context.height,h=i/Context.width,m=n/Context.height;this.hideFeedbackButton(),this.m_feedbackBtn=o.createFeedbackButton({type:"text",text:"",style:{left:s*r.screenWidth,top:a*r.screenHeight,width:h*r.screenWidth,height:m*r.screenHeight}})}},i.prototype.hideFeedbackButton=function(){var t=window.wx;t&&(this.m_feedbackBtn&&(this.m_feedbackBtn.hide(),this.m_feedbackBtn.destroy()),this.m_feedbackBtn=null)},i}(t.operation_http_chongzhi_base);t.operation_wx=e,__reflect(e.prototype,"common.operation_wx")}(common||(common={}));var Cmd;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.byCmd=t.stNullUserCmd.CHAT_USERCMD,i}return __extends(i,e),i.CHANNEL_CHAT_USERCMD_PARAMETER=1,i.CHAT_SYS=1,i.CHAT_TOOLTIP=3,i.CHAT_SCREEN=6,i.CHAT_ALL=7,i.CHAT_GM=11,i.CHAT_DIALOG=21,i.CHAT_NATION=23,i.CHAT_HTML=26,i.CHAT_ERROR=27,i.CHAT_HISTORY_CHAT=28,i.CHAT_GREEN=29,i.CHAT_GM_COLLECT=30,i}(t.stNullUserCmd);t.stChatUserCmd=e,__reflect(e.prototype,"Cmd.stChatUserCmd");var i=function(i){function n(){var t=i.call(this)||this;return t.country=0,t.vip=0,t.job=1,t.sex=0,t.yueka=0,t.byParam=e.CHANNEL_CHAT_USERCMD_PARAMETER,t}return __extends(n,i),n.prototype.serialize=function(e){i.prototype.serialize.call(this,e),e.writeByte(this.type),e.writeByte(this.country),e.writeByte(this.vip),UtilByteArray.writeStr_FixedLength(e,this.name,t.MAX_NAMESIZE),e.writeByte(this.job),e.writeByte(this.sex),e.writeByte(this.yueka),UtilByteArray.writeStr(e,this.chat)},n.prototype.deserialize=function(t){i.prototype.deserialize.call(this,t),this.type=t.readUnsignedByte(),this.country=t.readUnsignedByte(),this.vip=t.readUnsignedByte(),this.name=UtilByteArray.readStr_MAX_NAMESIZE(t),this.job=t.readUnsignedByte(),this.sex=t.readUnsignedByte(),this.yueka=t.readUnsignedByte();var e=t.readUnsignedShort();this.chat=t.readUTFBytes(e)},n}(e);t.stChannelChatUserCmd=i,__reflect(i.prototype,"Cmd.stChannelChatUserCmd")}(Cmd||(Cmd={}));var common;!function(t){t.webServerhost="https://mu.8zhong.cn/",t.op_Neiwang=100,t.op_Neiwang2=2,t.op_Neiwang3=3,t.op_Neiwang_YunyingTest=4,t.op_Neiwang_wanba=5,t.op_wanba_android=111,t.op_wanba_ios=211,t.sdk_test=1,t.sdk_happy=2,t.sdk_wxgame=4,t.sdk_neiwang=100,t.op_test=120;var e=function(){function e(){}return e.prototype.init=function(e,i){if(Context.httpRecMgr.registerProcessor(httpCmd.CommandBase.CMD_login_result,this.on_ResLoginResultCmd,this),Context.httpRecMgr.registerProcessor(httpCmd.CommandBase.CMD_recharge_ResRechargeCmd,this.on_ResRechargeCmd,this),e)switch(e){case t.sdk_test:this.m_operation=new t.Operation_test;break;case t.sdk_happy:this.m_operation=new t.Operation_happy;break;case t.sdk_wxgame:this.m_operation=new t.operation_wx;break;case t.sdk_neiwang:this.m_operation=new t.operationNeiwang}if(!this.m_operation)switch(i){case t.op_Neiwang:case t.op_Neiwang3:this.m_operation=new t.operationNeiwang}return this.m_operation?this.m_operation.init(e,i):(Context.logMgr.showError("OperationMgr::init 不存在id="+i),!0)},e.prototype.onInitComplete=function(){Context.platformMgr.onInitComplete()},Object.defineProperty(e.prototype,"operation",{get:function(){return this.m_operation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTencent",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNeiwang",{get:function(){return this.m_operation instanceof t.operationNeiwang},enumerable:!0,configurable:!0}),e.prototype.isShowShoucangBtn=function(){return this.m_operation.isSupportSendDesk},e.prototype.onShowShoucangUI=function(){},e.prototype.login_to_webserver=function(){var t=new httpCmd.ReqLoginCmd;this.m_operation.fill_ReqLoginCmd(t),Context.httpSendMgr.send(t)},e.prototype.on_ResLoginResultCmd=function(e){var i=new httpCmd.ResLoginResultCmd;return i.parse(e),Context.httpSendMgr.setParam(i.token,i.uid,i.pid),Context.monitorDataMgr.sendRecordClientData(t.MonitorDataMgr.Type_loadResStart),Context.logMgr.addLog("on_ResLoginResultCmd "+JSON.stringify(i)),0!=i.code?void Context.sysPromptMgr.showDialogPrompt(i.msg):(this.m_loginInfo=i,Context.logMgr.addLog("on_ResLoginResultCmd "+JSON.stringify(i)),Context.operationMgr.operation.set_uid(i.uid),void(Context.loginCC.isComplete()&&Context.loginCC.showLoginForm()))},e.prototype.sendLoginInfo=function(){if(Context.loginOutnetPlayerMgr.isLoginByGM())return void Context.loginOutnetPlayerMgr.send();if(!this.m_loginInfo)return void this.m_operation.sendLoginInfo();var e=this.m_loginInfo,i=new Cmd.muCommonPlatformUserRequestLoginCmd;i.uid=e.uid,i.cid="",i.zone=1,i.pid=e.pid,i.time=e.time,i.sign=e.sign,this.m_operation instanceof t.operationNeiwang&&(i.zone=Context.loginData.zoneId),Context.sendMsg(i),Context.loadingView.setText("房间打扫中",6),Context.logMgr.addLog("发送登录信息 sendLoginInfo uid="+i.uid+" zone="+i.zone+" pid="+i.pid+" time="+i.time+" sign="+i.sign)},e.prototype.on_ResRechargeCmd=function(t){this.m_operation.on_ResRechargeCmd(t)},e}();t.OperationMgr=e,__reflect(e.prototype,"common.OperationMgr")}(common||(common={}));var common;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.m_shareOpened=!0,t.m_isSupportRelogin=!0,t.m_isSupportABTest=!0,t}return __extends(i,e),i.prototype.init=function(t,i){return e.prototype.init.call(this,t,i),window._shareData_=Context.commonCfg.getConfig(4).shareData,Context.loginData.userInfo_wx.avatarUrl="",platform.shareCharid=parseInt(egret.localStorage.getItem("shareCharid")),platform.funcType=parseInt(egret.localStorage.getItem("funcType")),!1},i.prototype.update_ReqLoginCmd=function(t){t.extra={uid:Context.loginData.uId}},i.prototype.setParam=function(t,e){this.m_zone=t,this.m_uid=e,this.onInitComplete()},i.prototype.sendLoginInfo=function(){var t=new Cmd.stUserRequestLoginCmd;t.uid=this.get_uid_common(),t.zoneid=Context.loginData.zoneId,t.platformType=Context.loginData.platformType,Context.sendMsg(t),console.log("stUserRequestLoginCmd uid="+t.uid+" zoneid="+t.zoneid+" platformType="+t.platformType)},i.prototype.loginOut=function(){window.location.reload()},i.prototype.showRewardedVideoAd=function(t,e,i){e.call(i,!0),egret.log("Ad - showRewardedVideoAd")},i.prototype.showBannerAd=function(t,e){function i(){Context.logMgr.addLog("Ad - showRewardedVideoAd callback"),Context.monitorDataMgr.sendRecordBannerAd(1),t&&t.call(e,!0)}void 0===t&&(t=null),void 0===e&&(e=null),egret.log("Ad - showBannerAd"),i()},i.prototype.hideBannerAd=function(){egret.log("Ad - hideBannerAd"),Context.monitorDataMgr.sendRecordBannerAd(2)},i.prototype.bShowBannerAd=function(){return!0},i.prototype.doShare=function(t){void 0===t&&(t=null);var e=Context.heroinfoMgr.charid,i=t;platform.funcType=i,platform.shareCharid=e,egret.localStorage.setItem("funcType",""+i),egret.localStorage.setItem("shareCharid",""+e),Context.sysPromptMgr.addGreenPrompt("分享成功！ funcType="+i)},i.prototype.onShowAuthorizeBtn=function(e,i,n,o){if(!Context.loginData.authorize_wx["scope.userInfo"]){egret.log("stageSize="+Context.width+","+Context.height+" loginBtn pos="+e+","+i);var r=e/Context.width,s=i/Context.height,a=n/Context.width,h=o/Context.height;platform.authorize(r,s,a,h).then(function(e){Context.loginData.userInfo_wx.nickName=e.nickName,Context.loginData.userInfo_wx.avatarUrl=e.avatarUrl,Context.loginData.userInfo_wx.gender=e.gender,egret.log("Context.loginData.userInfo_wx"),egret.log(e),Context.loginData.authorize_wx["scope.userInfo"]=!0,Context.commonSetMgr.isSet(CommonSetMgr.COMMONSET_Authorize_wx)?Context.commonSetMgr.setAndSend(CommonSetMgr.COMMONSET_Authorize_wx):Context.monitorDataMgr.sendRecordClientData(t.MonitorDataMgr.Type_authorize_wx),Context.operationMgr.operation.isLoaded&&Context.operationMgr.operation.onInitComplete(),Context.uimgr.exitForm(UIFormID.UILoginWXAuthorize)})}},i}(t.operation_http_chongzhi_base);t.operationNeiwang=e,__reflect(e.prototype,"common.operationNeiwang")}(common||(common={}));var common;!function(t){var e=function(){function t(){this.id=0,this.groupID=0,this.isWSS=!1}return Object.defineProperty(t.prototype,"isValid",{get:function(){return!!this.loginIP},enumerable:!0,configurable:!0}),t}();t.PlatformConfig=e,__reflect(e.prototype,"common.PlatformConfig")}(common||(common={}));var common;!function(t){var e=function(){function e(){this.m_zone=1}return e.prototype.setZone=function(t){this.m_zone=t},Object.defineProperty(e.prototype,"zone",{get:function(){return this.m_zone},enumerable:!0,configurable:!0}),e.prototype.init=function(){Context.logMgr.addLog("PlatformMgr.ts::init() url="+window.location.href),this.m_config=Context.dataXmlMgr.getJson(dataXml.XML_platform);var t=Context.bzConfig.sdk,e=Context.bzConfig.pid;return console.log("init pid="+e+", "+JSON.stringify(Context.bzConfig)),Context.bzConfig.game_hideConsoleLog&&(egret.log=function(){}),Context.operationMgr.init(t,e)},e.prototype.initByGM=function(t){return this.m_platformID=t,this.initNeiwangInfo(t),Context.operationMgr.init(0,t)},e.prototype.getGroupCfg=function(t){return this.m_config.group[t]},e.prototype.setPlatformID=function(t){console.log("PlatformMgr::setPlatformID = "+t),this.m_platformID=t},e.prototype.onInitComplete=function(){Context.loginCC2.onPlatformMgrInit()},e.prototype.sendLoginInfo=function(){Context.reloginMgr.bReLoginInGame?Context.operationMgr.operation.sendReLoginInfo():Context.operationMgr.sendLoginInfo()},Object.defineProperty(e.prototype,"platformIP",{get:function(){return this.m_curPlatformConfig?this.m_curPlatformConfig.loginIP:Context.bzConfig.loginServer.ip},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"platformPort",{get:function(){return this.m_curPlatformConfig?this.m_curPlatformConfig.loginPort:Context.bzConfig.loginServer.port},enumerable:!0,configurable:!0}),e.prototype.getURLParam=function(t){return egret.getOption(t)},Object.defineProperty(e.prototype,"platformID",{get:function(){return this.m_platformID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groupID",{get:function(){return this.m_curPlatformConfig?this.m_curPlatformConfig.groupID:Context.bzConfig.groupID},enumerable:!0,configurable:!0}),e.prototype.getisWss=function(){return this.m_curPlatformConfig?this.m_curPlatformConfig.isWSS:Context.bzConfig.isWSS},e.prototype.selectCanSetTimeServer=function(e){var i;i=e?t.op_Neiwang2:t.op_Neiwang,this.initNeiwangInfo(i),this.setPlatformID(i)},e.prototype.initNeiwangInfo=function(e){this.m_config=Context.dataXmlMgr.getJson(dataXml.XML_platform),this.m_curPlatformConfig=new t.PlatformConfig;var i=this.m_config.platform[e];i&&(this.m_curPlatformConfig.groupID=i.groupID,this.m_curPlatformConfig.loginIP=i.login.text,this.m_curPlatformConfig.loginPort=i.login.port,this.m_curPlatformConfig.isWSS=i.isWSS?!0:!1)},Object.defineProperty(e.prototype,"curPlatformConfig",{get:function(){return this.m_curPlatformConfig},enumerable:!0,configurable:!0}),e}();t.PlatformMgr=e,__reflect(e.prototype,"common.PlatformMgr")}(common||(common={}));var sceneApp;!function(t){var e=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.prototype.getHeadTopClass=function(){return scene.HeadTopNpc},e.prototype.onClick=function(){Context.sysPromptMgr.addPrompt("更多玩家")},e}(scene.BeingEntity);t.Npc=e,__reflect(e.prototype,"sceneApp.Npc")}(sceneApp||(sceneApp={}));var sceneApp;!function(t){var e=function(){function t(){this.m_dic={}}return t.prototype.reset_to_beforeLogin=function(){this.removeAll()},t.prototype.add=function(t){t.tempid in this.m_dic||(this.m_dic[t.tempid]=t,egret.log("[添加 Npc] (name="+t.name+" id="+t.tempid))},t.prototype.remove=function(t){var e=Context.mapMgr.currentMap,i=this.getNpc(t);i&&(egret.log("[删除 Npc] (name="+i.name+" id="+i.tempid),e.removeObject(i,!0),delete this.m_dic[t])},t.prototype.getNpc=function(t){return this.m_dic[t]},t.prototype.removeAll=function(){var t,e,i=Context.mapMgr.currentMap;for(t in this.m_dic)e=this.m_dic[t],i.removeObject(e);UtilDictionary.clear(this.m_dic)},t}();t.NpcMgr=e,__reflect(e.prototype,"sceneApp.NpcMgr")}(sceneApp||(sceneApp={}));var Cmd;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.byCmd=t.stNullUserCmd.FRIEND_USERCMD,i}return __extends(i,e),i.PARA_FRIEND_LIST_FRIENDCMD=1,i.PARA_BLACK_LIST_FRIENDCMD=2,i.PARA_FRIEND_APPLY_LIST_FRIENDCMD=3,i.PARA_REQ_ADD_FRIEND_BY_CHARID_FRIENDCMD=4,i.PARA_REQ_ADD_FRIEND_BY_NAME_FRIENDCMD=5,i.PARA_RET_ADD_FRIEND_BY_NAME_FRIENDCMD=6,i.PARA_RET_FRIEND_BASEINFO_FRIENDCMD=7,i.PARA_MOVE_FRIEND_TO_BLACKLIST_FRIENDCMD=8,i.PARA_DELETE_FRIEND_FRIENDCMD=9,i.PARA_NOTIFY_FRIEND_APPLY_FRIENDCMD=10,i.PARA_NOTIFY_FRIEND_ONLINE_FRIENDCMD=11,i.PARA_NOTIFY_FRIEND_LEVEL_CHANGE_FRIENDCMD=12,i.PARA_HANDLE_FRIEND_APPLY_FRIENDCMD=15,i.PARA_BAT_HANDLE_FRIEND_APPLY_FRIENDCMD=16,i.PARA_VIEW_FRIEND_DATA_FRIENDCMD=17,i.PARA_RET_BLACK_BASEINFO_FRIENDCMD=19,i.PARA_FRIEND_FOCUS_CHANGE_FRIENDCMD=22,i.PARA_MOVE_USER_TO_BLACKLIST_FRIENDCMD=23,i.PARA_ADD_FRIEND_BROAD_FRIENDCMD=24,i.ONLINE_SEND_CLEAN_FRIEND_HOME_NUM_USERCMD=25,i.REQ_VISIT_FRIEND_USERCMD=26,i.RET_FRIEND_DATA_USERCMD=27,i.REQ_CLEAN_FRIEND_HOME_USERCMD=28,i.ONLINE_SEND_VISITOR_DATA_USERCMD=29,i.REQ_VISITOR_REWARD_USERCMD=30,i.RET_VISITOR_REWARD_USERCMD=31,i.REQ_RANDOM_NEW_FRIEND_USERCMD=32,i.RET_RANDOM_NEW_FRIEND_USERCMD=33,i.SYN_USER_HEAD_URL_FRIENDCMD=34,i}(t.stNullUserCmd);t.stFriendCmd=e,__reflect(e.prototype,"Cmd.stFriendCmd");var i=function(){function e(){}return e.prototype.deserialize=function(e){this.charid=e.readUnsignedInt(),this.job=e.readUnsignedByte(),this.level=e.readUnsignedShort(),this.zhengjie=e.readUnsignedByte(),this.cleanHome=e.readUnsignedByte(),this.online=e.readUnsignedByte(),this.focus=e.readUnsignedByte(),this.name=UtilByteArray.readStr_MAX_NAMESIZE(e),this.head=e.readUTFBytes(t.FRIEND_HEAD_URL_LEN)},e}();t.stUBaseInfo=i,__reflect(i.prototype,"Cmd.stUBaseInfo");var n=function(){function t(){}return t.VIEWTYPE_NONE=0,t.VIEWTYPE_FRIEND=1,t.VIEWTYPE_BLACKLIST=2,t.VIEWTYPE_CORPS=3,t.VIEWTYPE_RANK=4,t}();t.eViewType=n,__reflect(n.prototype,"Cmd.eViewType");var o=function(t){function n(){var i=t.call(this)||this;return i.byParam=e.PARA_FRIEND_LIST_FRIENDCMD,i.flist=[],i}return __extends(n,t),n.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);for(var n,o=e.readUnsignedShort(),r=0;o>r;r++)n=new i,n.deserialize(e),this.flist.push(n)},n}(e);t.stFriendListFriendCmd=o,__reflect(o.prototype,"Cmd.stFriendListFriendCmd");var r=function(t){function n(){var i=t.call(this)||this;return i.byParam=e.PARA_BLACK_LIST_FRIENDCMD,i.blist=[],i}return __extends(n,t),n.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);for(var n,o=e.readUnsignedShort(),r=0;o>r;r++)n=new i,n.deserialize(e),this.blist.push(n)},n}(e);t.stBlackListFriendCmd=r,__reflect(r.prototype,"Cmd.stBlackListFriendCmd");var s=function(t){function n(){var i=t.call(this)||this;return i.byParam=e.PARA_FRIEND_APPLY_LIST_FRIENDCMD,i.applylist=[],i}return __extends(n,t),n.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);for(var n,o=e.readUnsignedShort(),r=0;o>r;r++)n=new i,n.deserialize(e),this.applylist.push(n)},n}(e);t.stFriendApplyListFriendCmd=s,__reflect(s.prototype,"Cmd.stFriendApplyListFriendCmd");var a=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.PARA_REQ_ADD_FRIEND_BY_CHARID_FRIENDCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.charid)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.charid=e.readUnsignedInt(),this.result=e.readUnsignedByte()},i}(e);t.stReqAddFriendByCharIDFriendCmd=a,__reflect(a.prototype,"Cmd.stReqAddFriendByCharIDFriendCmd");var h=function(i){function n(){var t=i.call(this)||this;return t.byParam=e.PARA_REQ_ADD_FRIEND_BY_NAME_FRIENDCMD,t}return __extends(n,i),n.prototype.serialize=function(e){i.prototype.serialize.call(this,e),e.writeUnsignedShort(this.num),UtilByteArray.writeStr_FixedLength(e,this.name,t.MAX_NAMESIZE)},n}(e);t.stReqAddFriendByNameFriendCmd=h,__reflect(h.prototype,"Cmd.stReqAddFriendByNameFriendCmd");var m=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.PARA_RET_ADD_FRIEND_BY_NAME_FRIENDCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.result=e.readUnsignedByte(),this.name=UtilByteArray.readStr_MAX_NAMESIZE(e)},i}(e);t.stRetAddFriendByNameFriendCmd=m,__reflect(m.prototype,"Cmd.stRetAddFriendByNameFriendCmd");var c=function(t){function n(){var i=t.call(this)||this;return i.byParam=e.PARA_RET_FRIEND_BASEINFO_FRIENDCMD,i}return __extends(n,t),n.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.fbase=new i,this.fbase.deserialize(e)},n}(e);t.stRetFriendBaseInfoFriendCmd=c,__reflect(c.prototype,"Cmd.stRetFriendBaseInfoFriendCmd");var u=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.PARA_MOVE_FRIEND_TO_BLACKLIST_FRIENDCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.charid),e.writeByte(this.result)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.charid=e.readUnsignedInt(),this.result=e.readUnsignedByte()},i}(e);t.stMoveFriendToBlackListFriendCmd=u,__reflect(u.prototype,"Cmd.stMoveFriendToBlackListFriendCmd");var l=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.PARA_DELETE_FRIEND_FRIENDCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.charid),e.writeByte(this.type),e.writeByte(this.result)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.charid=e.readUnsignedInt(),this.type=e.readUnsignedByte(),this.result=e.readUnsignedByte()},i}(e);t.stDeleteFriendFriendCmd=l,__reflect(l.prototype,"Cmd.stDeleteFriendFriendCmd");var p=function(t){function n(){var i=t.call(this)||this;return i.byParam=e.PARA_NOTIFY_FRIEND_APPLY_FRIENDCMD,i}return __extends(n,t),n.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.applyinfo=new i,this.applyinfo.deserialize(e)},n}(e);t.stNotifyFriendApplyFriendCmd=p,__reflect(p.prototype,"Cmd.stNotifyFriendApplyFriendCmd");var d=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.PARA_NOTIFY_FRIEND_ONLINE_FRIENDCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.friendid=e.readUnsignedInt(),this.online=e.readUnsignedByte()},i}(e);t.stNotifyFriendOnlineFriendCmd=d,__reflect(d.prototype,"Cmd.stNotifyFriendOnlineFriendCmd");var _=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.PARA_NOTIFY_FRIEND_LEVEL_CHANGE_FRIENDCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.friendid=e.readUnsignedInt(),this.level=e.readUnsignedShort()},i}(e);t.stNotifyFriendLevelChangeFriendCmd=_,__reflect(_.prototype,"Cmd.stNotifyFriendLevelChangeFriendCmd");var f=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.PARA_HANDLE_FRIEND_APPLY_FRIENDCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.charid),e.writeByte(this.handle)},i}(e);t.stHandleFriendApplyFriendCmd=f,__reflect(f.prototype,"Cmd.stHandleFriendApplyFriendCmd");var g=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.PARA_BAT_HANDLE_FRIEND_APPLY_FRIENDCMD,i.idlist=[],i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.handle),e.writeShort(this.num);for(var i in this.idlist)e.writeUnsignedInt(this.idlist[i].charid)},i}(e);t.stBatHandleFriendApplyFriendCmd=g,__reflect(g.prototype,"Cmd.stBatHandleFriendApplyFriendCmd");var y=function(i){function n(){var t=i.call(this)||this;return t.byParam=e.PARA_VIEW_FRIEND_DATA_FRIENDCMD,t}return __extends(n,i),n.prototype.serialize=function(e){i.prototype.serialize.call(this,e),UtilByteArray.writeStr_FixedLength(e,this.name,t.MAX_NAMESIZE),e.writeByte(this.type)},n}(e);t.stViewFriendDataFriendCmd=y,__reflect(y.prototype,"Cmd.stViewFriendDataFriendCmd");var C=function(t){function n(){var i=t.call(this)||this;return i.byParam=e.PARA_RET_BLACK_BASEINFO_FRIENDCMD,i}return __extends(n,t),n.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.fbase=new i,this.fbase.deserialize(e)},n}(e);t.stRetBlackBaseInfoFriendCmd=C,__reflect(C.prototype,"Cmd.stRetBlackBaseInfoFriendCmd");var v=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.PARA_FRIEND_FOCUS_CHANGE_FRIENDCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.friendid=e.readUnsignedInt(),this.focus=e.readUnsignedByte()},i}(e);t.stFriendFocusChangeFriendCmd=v,__reflect(v.prototype,"Cmd.stFriendFocusChangeFriendCmd");var E=function(i){function n(){var t=i.call(this)||this;return t.byParam=e.PARA_MOVE_USER_TO_BLACKLIST_FRIENDCMD,t}return __extends(n,i),n.prototype.deserialize=function(t){i.prototype.deserialize.call(this,t),this.name=UtilByteArray.readStr_MAX_NAMESIZE(t),this.result=t.readUnsignedByte()},n.prototype.serialize=function(e){i.prototype.serialize.call(this,e),UtilByteArray.writeStr_FixedLength(e,this.name,t.MAX_NAMESIZE),e.writeByte(this.result)},n}(e);t.stMoveUserToBlackListFriendCmd=E,__reflect(E.prototype,"Cmd.stMoveUserToBlackListFriendCmd");var b=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.PARA_ADD_FRIEND_BROAD_FRIENDCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e)},i}(e);t.stAddFriendBroadFriendCmd=b,__reflect(b.prototype,"Cmd.stAddFriendBroadFriendCmd");var T=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.ONLINE_SEND_CLEAN_FRIEND_HOME_NUM_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.num=e.readUnsignedByte()},i}(e);t.onlineSendCleanFriendHomeNumUserCmd=T,__reflect(T.prototype,"Cmd.onlineSendCleanFriendHomeNumUserCmd");var S=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_VISIT_FRIEND_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.charid)},i}(e);t.reqVisitFriendUserCmd=S,__reflect(S.prototype,"Cmd.reqVisitFriendUserCmd");var M=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RET_FRIEND_DATA_USERCMD,i.data=[],i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.charid=e.readUnsignedInt(),this.name=UtilByteArray.readStr_MAX_NAMESIZE(e),this.bgid=e.readUnsignedInt(),this.zhengjie=e.readUnsignedByte();for(var i,n=e.readUnsignedByte(),o=0;n>o;o++)i=new Object,i.id=e.readUnsignedInt(),i.level=e.readUnsignedByte(),i.change=e.readUnsignedInt(),this.data.push(i)},i}(e);t.retFriendDataUserCmd=M,__reflect(M.prototype,"Cmd.retFriendDataUserCmd");var x=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_CLEAN_FRIEND_HOME_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.charid)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.charid=e.readUnsignedInt(),this.money=e.readUnsignedInt()},i}(e);t.reqCleanFriendHomeUserCmd=x,__reflect(x.prototype,"Cmd.reqCleanFriendHomeUserCmd");var I=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.ONLINE_SEND_VISITOR_DATA_USERCMD,i.visitorList=[],i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.visitorList.length=0;for(var i=e.readUnsignedByte(),n=0;i>n;n++)this.visitorList.push({name:UtilByteArray.readStr_MAX_NAMESIZE(e),id:e.readUnsignedInt(),level:e.readUnsignedInt()})},i}(e);t.onlineSendVisitorDataUserCmd=I,__reflect(I.prototype,"Cmd.onlineSendVisitorDataUserCmd");var U=function(t){function i(){var i=t.call(this)||this;return i.money=0,i.byParam=e.REQ_VISITOR_REWARD_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.money)},i}(e);t.reqVisitorRewardUserCmd=U,__reflect(U.prototype,"Cmd.reqVisitorRewardUserCmd");var D=function(t){function i(){var i=t.call(this)||this;return i.money=0,i.byParam=e.ONLINE_SEND_VISITOR_DATA_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.state=e.readBoolean(),this.money=e.readUnsignedInt()},i}(e);t.retVisitorRewardUserCmd=D,__reflect(D.prototype,"Cmd.retVisitorRewardUserCmd");var A=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_RANDOM_NEW_FRIEND_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e)},i}(e);t.reqRandomNewFriendUserCmd=A,__reflect(A.prototype,"Cmd.reqRandomNewFriendUserCmd");var R=function(t){function n(){var i=t.call(this)||this;return i.byParam=e.RET_RANDOM_NEW_FRIEND_USERCMD,i.data=[],i}return __extends(n,t),n.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);for(var n,o=e.readUnsignedByte(),r=0;o>r;r++)n=new i,n.deserialize(e),this.data.push(n)},n}(e);t.retRandomNewFriendUserCmd=R,__reflect(R.prototype,"Cmd.retRandomNewFriendUserCmd");var P=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SYN_USER_HEAD_URL_FRIENDCMD,i.url="",i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),UtilByteArray.writeStr(e,this.url,2)},i}(e);t.synUserHeadUrlFriendCmd=P,__reflect(P.prototype,"Cmd.synUserHeadUrlFriendCmd")}(Cmd||(Cmd={}));var sceneApp;!function(t){var e=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.m_bMoveToVisitor=!1,n.m_name=Context.heroinfoMgr.name,n}return __extends(e,t),e.prototype.moveToDesPos=function(t){if(this.isOut_of_bound(t.x,t.y))return void Context.logMgr.sendServer("出界 "+UtilCommon.getStackInfo());if(t.x==this.x&&t.y==this.y){"move to same pos! pos=("+this.x+","+this.y+")";
this.onArrive()}else this.moveToPos_XY(t.x,t.y)},e.prototype.moveToVisitor=function(t){this.m_visitor=t;var e=UtilMath.distance(this.x,this.y,t.x,t.y);if(e>80){this.m_bMoveToVisitor=!0;var i=80/e,n=UtilMath.getPosInSegment(t.x,t.y,this.x,this.y,i,null);this.moveToPos_XY(n.x,n.y)}else{var o=UtilMath.getAngle(this.x,this.y,t.x,t.y);this.stopMoving(),this.setAct(UtilModel.TActStand),this.angle=o}},e.prototype.onArrive=function(){this.m_bMoveToVisitor&&(this.m_bMoveToVisitor=!1)},e.prototype.stopTalk=function(){this.m_visitor&&(this.m_visitor.onTalkEnd(),this.m_visitor=null)},e}(t.PlayerBase);t.PlayerMain=e,__reflect(e.prototype,"sceneApp.PlayerMain")}(sceneApp||(sceneApp={}));var sceneApp;!function(t){var e=function(){function t(){this.m_playerTempid=1e4,this.m_curMapID=0,this.m_delayTime=1,this.m_pro=50,this.m_visitorReward=1,this.m_bOpenFirst=!1,this.m_bShowGuest=!1,this.m_tempPoint=new egret.Point,this.m_dic={},this.m_visitorDataList=[{name:"张三",id:1,level:1},{name:"李四",id:2,level:1},{name:"赵五",id:2,level:1}],this.m_tempVisitorList=[]}return t.prototype.reset_to_beforeLogin=function(){this.removeAll(),this.m_timer&&this.m_timer.stop(),this.m_bShowGuest=!1,this.m_curMapID=0,this.m_playerTempid=1e4,this.m_playerMain=null},t.prototype.loadPlayerConfig=function(){if(!this.m_dicNumWeight){var t=Context.dataXmlMgr.getJson(dataXml.XML_gameinit).visitor[0];this.m_delayTime=parseInt(t.delay),this.m_pro=parseInt(t.pro);var e=new dataset.KeyValueParse;e.parse(t.refreshnum),this.m_dicNumWeight=e.dic}},t.prototype.updateVisitorReward=function(){this.loadPlayerConfig()},t.prototype.getGreeterConfig=function(){var t=this.m_greeterConfig;return t||(t=Context.dataXmlMgr.getJson(dataXml.XML_mapfurniture).greeter[0],this.m_greeterConfig=t),t},t.prototype.getPathConfig=function(){var t=Context.mapMgr.currentMap;if(this.m_curMapID!=t.m_config.m_mapID){var e=Context.dataXmlMgr.getJson(dataXml.XML_mapfurniture);for(var i in e.map)if(e.map[i].id==t.m_config.m_mapID){this.m_pathConfig=e.map[i].path;break}}return UtilRandom.random(this.m_pathConfig)},t.prototype.add=function(t){t.tempid in this.m_dic||(this.m_dic[t.tempid]=t)},t.prototype.remove=function(t){if(t in this.m_dic){var e=this.m_dic[t],i=Context.mapMgr.currentMap;egret.log("----[删除 player] (name="+e.name+" id="+e.tempid+" pos=("+Math.floor(e.x)+","+Math.floor(e.y)+"))"),i.removeObject(e,!0),delete this.m_dic[e.tempid]}},t.prototype.removeAll=function(){var t,e,i=Context.mapMgr.currentMap;for(t in this.m_dic)e=this.m_dic[t],i.removeObject(e);UtilDictionary.clear(this.m_dic),this.m_playerMain=null},t.prototype.onStopGuest=function(){this.removeAll(),this.m_timer&&this.m_timer.stop(),this.m_bShowGuest=!1},t.prototype.updateStateActivate=function(t){this.m_timer&&this.m_bShowGuest&&(t?this.m_timer.start():this.m_timer.stop())},t.prototype.onShowGuest=function(t){void 0===t&&(t=!1),this.m_bOpenFirst=t,this.loadPlayerConfig(),this.m_bShowGuest=!0;var e=t?300*this.m_delayTime:1e3*this.m_delayTime;this.m_timer||(this.m_timer=new egret.Timer(e,0),this.m_timer.addEventListener(egret.TimerEvent.TIMER,this.onTimerFunc,this)),this.m_timer.delay=e,this.m_timer.reset(),this.m_timer.start(),this.m_tempVisitorList.length=0;for(var i in this.m_visitorDataList)this.m_tempVisitorList.push(this.m_visitorDataList[i])},t.prototype.onTimerFunc=function(t){if(this.m_bOpenFirst&&this.m_timer.currentCount>=30)return this.m_bOpenFirst=!1,this.m_timer.delay=1e3*this.m_delayTime,this.m_timer.reset(),void this.m_timer.start();for(var e=UtilRandom.randomID(this.m_dicNumWeight),i=0;e>i;i++)egret.setTimeout(this.createVisitor,this,20+1e3*i)},t.prototype.createVisitor=function(){var t=this.getOneVisitorData()},t.prototype.getOneVisitorData=function(){if(0==this.m_tempVisitorList.length)for(var t in this.m_visitorDataList)this.m_tempVisitorList.push(this.m_visitorDataList[t]);var e=UtilRandom.random(this.m_tempVisitorList),i=this.m_tempVisitorList.indexOf(e);return this.m_tempVisitorList.splice(i,1),e},t.prototype.getPlayerMain=function(){return this.m_playerMain},t.prototype.createMainPlayer=function(){if(!this.m_playerMain){var t=Context.mapMgr.currentMap;if(t){this.getGreeterConfig()}}},t.prototype.process_onlineSendVisitorDataUserCmd=function(t){var e=new Cmd.onlineSendVisitorDataUserCmd;e.deserialize(t),this.m_visitorDataList=e.visitorList},t.prototype.process_retVisitorRewardUserCmd=function(t){var e=new Cmd.retVisitorRewardUserCmd;e.deserialize(t),egret.log("retVisitorRewardUserCmd 获得金币 money="+e.money+" state="+e.state)},t.prototype.reqVisitorReward=function(){var t=new Cmd.reqVisitorRewardUserCmd;t.money=this.m_visitorReward,Context.sendMsg(t)},t}();t.PlayerMgr=e,__reflect(e.prototype,"sceneApp.PlayerMgr")}(sceneApp||(sceneApp={}));var sceneApp;!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.m_waitTimeNum=0,o.m_leaveTime=0,o.m_name="路人甲",o.m_pathData=new i,o}return __extends(e,t),e.prototype.getHeadTopClass=function(){return scene.HeadTopPlayerOther},e.prototype.setPathData=function(t,e){void 0===e&&(e=!1),this.m_pathData.setData(t,e)},e.prototype.onBegin=function(){this.m_pathData.curStep=0;var t=this.m_pathData.getPos(),e=1e3*t.waittime;e>0&&t.furnitureid>0?(this.m_waitTimeNum&&egret.clearTimeout(this.m_waitTimeNum),this.m_waitTimeNum=egret.setTimeout(this.onWaitEnd,this,e)):(this.m_pathData.curStep++,this.onMoveNext())},e.prototype.onMoveNext=function(){if(!this.m_pathData)return void Context.logMgr.sendServer("onMoveNext() error!");if(this.m_pathData.curStep>=this.m_pathData.pointList.length)this.m_leaveTime=Context.timeMgr.platformTime;else{var t=this.m_pathData.getPos();if(this.x==t.x&&this.y==t.y);this.moveToPos_XY(t.x,t.y)}},e.prototype.onArrive=function(){var t=this.m_pathData.getPos();this.angle=t.angle;var e=1e3*t.waittime;if(e>0&&t.furnitureid>0){this.m_waitTimeNum&&egret.clearTimeout(this.m_waitTimeNum),this.m_waitTimeNum=egret.setTimeout(this.onWaitEnd,this,e);var i=this.getHeadTopBase();i&&this.m_pathData.stepReward==this.m_pathData.curStep&&i.showBubbleReward(e)}else this.m_pathData.curStep++,this.onMoveNext()},e.prototype.onWaitEnd=function(){this.m_waitTimeNum=0,this.m_pathData&&this.m_pathData.curStep<this.m_pathData.pointList.length?(this.m_pathData.curStep++,this.onMoveNext()):this.m_leaveTime=Context.timeMgr.platformTime},e.prototype.onClick=function(){var t=Context.playerMgr.getPlayerMain();if(t){var e=UtilMath.getAngle(this.x,this.y,t.x,t.y);this.stopMoving(),this.setAct(UtilModel.TActStand),this.angle=e,t.moveToVisitor(this)}},e.prototype.advanceTime=function(e){if(t.prototype.advanceTime.call(this,e),this.m_leaveTime>0){var i=Context.timeMgr.platformTime-this.m_leaveTime;i>2e3?Context.playerMgr.remove(this.tempid):i>1e3&&(this.bAniFading||this.fadeOut())}},e.prototype.dispose=function(){this.m_waitTimeNum>0&&(egret.clearTimeout(this.m_waitTimeNum),this.m_waitTimeNum=0),this.m_pathData.curStep=0,this.m_pathData=null,this.m_leaveTime=0,t.prototype.dispose.call(this)},e.prototype.showTalk=function(e,i){void 0===i&&(i="left"),t.prototype.showSpeak.call(this,e,i),this.m_waitTimeNum>0&&(egret.clearTimeout(this.m_waitTimeNum),this.m_waitTimeNum=0)},e.prototype.onTalkEnd=function(){t.prototype.onSpeakEnd.call(this),this.isTalking=!1,this.onMoveNext()},e}(t.PlayerBase);t.PlayerOther=e,__reflect(e.prototype,"sceneApp.PlayerOther");var i=function(){function t(){this.m_bHasReward=!1,this.m_stepReward=0,this.curStep=0}return t.prototype.setData=function(t,e){void 0===e&&(e=!1),this.m_pointList=t,this.m_bHasReward=e;for(var i=[],n=0;n<t.length;n++)t[n].waittime>0&&t[n].furnitureid>0&&i.push(n);this.m_stepReward=i.length>0?UtilRandom.random(i):0},Object.defineProperty(t.prototype,"pointList",{get:function(){return this.m_pointList},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bHasReward",{get:function(){return this.m_bHasReward},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stepReward",{get:function(){return this.m_stepReward},enumerable:!0,configurable:!0}),t.prototype.getPos=function(){var t=this.m_pointList;return 0<=this.curStep&&this.curStep<t.length?t[this.curStep]:t[t.length-1]},t}();__reflect(i.prototype,"PathData")}(sceneApp||(sceneApp={}));var sceneApp;!function(t){var e=function(){function t(){this.m_index=0}return t.prototype.showTalkWithVisitor=function(t){this.m_curTalkList=this.getTalk(101,1),this.m_curTalkList&&(this.m_curVisitor&&this.m_curVisitor.onTalkEnd(),this.m_curVisitor=t,this.onTalkBegin(),t.isTalking=!0,Context.playerMgr.getPlayerMain().isTalking=!0)},t.prototype.onOnceSpeakComplete=function(){this.m_index++,this.m_index<this.m_curTalkList.length?this.onShowTalk():this.onTalkEnd()},t.prototype.onTalkBegin=function(){this.m_index=0,this.onShowTalk()},t.prototype.onShowTalk=function(){var t=this.m_curTalkList[this.m_index];if(t){var e;"self"==t.name?e=Context.playerMgr.getPlayerMain():"visitor"==t.name&&(e=this.m_curVisitor),e&&e.showSpeak(t.desc)}},t.prototype.onTalkEnd=function(){this.m_curVisitor&&(this.m_curVisitor.onTalkEnd(),this.m_curVisitor=null),Context.playerMgr.getPlayerMain().isTalking=!0},t.prototype.getTalk=function(t,e){void 0===e&&(e=0);var i=this.m_dicTalk;if(!i){i={};var n=void 0,o={0:[],1:[]},r=Context.dataXmlMgr.getJson(dataXml.XML_mapfurniture).talk[0];for(var s in r.furnitureid){n=r.furnitureid[s].menu;for(var a in n)n[a].hasreward?o[1].push(n[a].item):o[0].push(n[a].item);i[r.furnitureid[s].id]=o}this.m_dicTalk=i}if(!i[t])return null;var h=i[t][e];return h&&h.length?UtilRandom.random(h):null},t}();t.PlayerTalkMgr=e,__reflect(e.prototype,"sceneApp.PlayerTalkMgr")}(sceneApp||(sceneApp={}));var sensitiveword;!function(t){var e=function(){function t(){this.m_regExpList=[]}return t.prototype.init=function(){var t,e,i,n,o,r,s=this.m_regExpList,a=Context.dataTableMgr.getTable(Table.TABLE_SENSITIVEWORD);for(var h in a)if(o=a[h].m_strWord){for(e="",n=o.length,i=0;n>i;i++)r=o.charAt(i),("*"==r||"("==r||")"==r||"+"==r||"["==r||"."==r||"{"==r||"$"==r||"?"==r)&&(e+="\\"),e+=o.charAt(i);t=new RegExp(e,"g"),s.push(t)}Context.httpRecMgr.registerProcessor(httpCmd.CommandBase.CMD_login_ReqWxTextCheck,this.on_ReqWxTextCheck,this)},t.prototype.filter=function(e){for(var i,n=e,o=this.m_regExpList,r=0,s=o;r<s.length;r++)i=s[r],-1!=n.search(i)&&(n=n.replace(i,t.replFN));return n},t.replFN=function(){var t=arguments[0].length;return 2==t?"**":"***"},t.prototype.isValid=function(t){for(var e,i=this.m_regExpList,n=0,o=i;n<o.length;n++)if(e=o[n],-1!=t.search(e))return Context.sysPromptMgr.addErrorPrompt(Context.languageMgr.getEleStr("con",404)),!1;return!0},t.prototype.reqWxTextCheck=function(t){var e=new httpCmd.ReqWxTextCheck;e.text=t,Context.httpSendMgr.send(e)},t.prototype.on_ReqWxTextCheck=function(t){var e=new httpCmd.ReqWxTextCheck;e.parse(t),Context.logMgr.addLog("on_ReqWxTextCheck: "+JSON.stringify(e)),0==e.errcode||Context.sysPromptMgr.addErrorPrompt(Context.languageMgr.getEleStr("con",404))},t.prototype.msgSecCheck_wx=function(t,e,i){egret.log("msgSecCheck_wx str="+t),this.m_checkStr=t,this.m_checkCallback=e,this.m_checkThisAny=i;var n={content:t},o=(UtilUrl.jointURLParam(n),"https://mu.8zhong.cn/tool_n/msn/monitor/muYunying/channel/wx/MsgSecCheck.php?content="+t);this.m_request=new core.HttpRequest_get,this.m_request.send(o,this.onRequestComplete,this.onHttpError,this)},t.prototype.onRequestComplete=function(){var t=Context.SWMgr,e=t.m_request.getResponse(),i=JSON.parse(e);0==i.errcode?t.m_checkCallback&&t.m_checkCallback.call(t.m_checkThisAny):Context.sysPromptMgr.addErrorPrompt(Context.languageMgr.getEleStr("con",404)),egret.log("msgSecCheck_wx->onRequestComplete:"+e)},t.prototype.onHttpError=function(t){egret.log("msgSecCheck_wx->onHttpError:"+t)},t}();t.SensitiveWordMgr=e,__reflect(e.prototype,"sensitiveword.SensitiveWordMgr")}(sensitiveword||(sensitiveword={}));var Cmd;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.byCmd=t.stNullUserCmd.FUNCTION_USERCMD,i}return __extends(i,e),i.SEND_MONTH_CARD_LIST_USERCMD=1,i.REQ_MONTH_CARD_REWARD_USERCMD=2,i.UPDATE_MONTH_CARD_STATE_USERCMD=3,i}(t.stNullUserCmd);t.stFunctionCmd=e,__reflect(e.prototype,"Cmd.stFunctionCmd");var i=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SEND_MONTH_CARD_LIST_USERCMD,i.data=[],i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);for(var i,n=e.readUnsignedByte(),o=0;n>o;o++)i=new Object,i.type=e.readUnsignedByte(),i.state=e.readUnsignedByte(),i.lastTime=e.readUnsignedInt(),this.data.push(i)},i}(e);t.sendMonthCardArrayUserCmd=i,__reflect(i.prototype,"Cmd.sendMonthCardArrayUserCmd");var n=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_MONTH_CARD_REWARD_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.type)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.type=e.readUnsignedByte()},i}(e);t.reqMonthCardRewardUserCmd=n,__reflect(n.prototype,"Cmd.reqMonthCardRewardUserCmd");var o=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.UPDATE_MONTH_CARD_STATE_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.type=e.readUnsignedByte(),this.flag=e.readUnsignedByte()},i}(e);t.updareMonthCardStateUserCmd=o,__reflect(o.prototype,"Cmd.updareMonthCardStateUserCmd")}(Cmd||(Cmd={}));var Server;!function(t){var e=function(){function t(){this.lastTime=0,this.m_processDic={},this.m_delayProcessMsgDic={},this.m_1minTime=0,this.m_1SecTime=0,egret.startTick(this.onTick,this)}return t.prototype.addProcess=function(t,e){this.m_processDic[t]=e},t.prototype.getProcess=function(t){return this.m_processDic[t]},Object.defineProperty(t.prototype,"isStart",{set:function(t){this.m_isStart=t},enumerable:!0,configurable:!0}),t.prototype.onTick=function(t){var e=.001*(t-this.lastTime);this.lastTime=t,Context.timeMgr.advanceTime(e),t-this.m_1SecTime>=1e3&&(Context.juggle1Sec.advanceTime(0),this.m_1SecTime=t,t-this.m_1minTime>=6e4&&(Context.juggle1min.advanceTime(.001*(t-this.m_1minTime)),this.m_1minTime=t));try{Context.juggle.advanceTime(e)}catch(i){Context.system.logException(i)}if(this.m_isStart){var n=0;for(n=0;6>n&&this.processMessage();n++);return!1}},t.prototype.processMessage=function(){var t;if(t=Context.gatewayServer.connected?Context.gatewayServer.getMessage():Context.loginServer.getMessage()){t.position=0;var e=t.readUnsignedByte(),i=t.readUnsignedByte();if(0==e&&0==i)return;13==e&&6==i&&Context.logMgr.addLog(" msg:cmd="+e+" param="+i),t.position=0;var n=this.m_processDic[e];if(n)try{n.process(t,i)}catch(o){var r=Context.msgRecordMgr.getLatestMsgBy_Cmd_param(e,i),s=Context.system.ExceptionToString(o);r&&(s+="msgName"+r.__class__+" msgDesc="+UtilObject.dump(r)),Context.logMgr.sendServer(s),egret.log(s)}return!0}return!1},t.prototype.setMsgReceived=function(t){var e=this.m_delayProcessMsgDic[t];if(e){e.bReceived=!0;for(var i in e.funcList){var n=e.funcList[i];n.callBack.call(n.thisObject,n.bytes)}e.funcList.length=0}else e={bReceived:!0,funcList:[]},this.m_delayProcessMsgDic[t]=e},t.prototype.addDelayProcessMsg=function(t,e,i,n){var o=this.m_delayProcessMsgDic[t];if(o){if(o.bReceived)return!1}else o={bReceived:!1,funcList:[]},this.m_delayProcessMsgDic[t]=o;return o.funcList.push({callBack:e,bytes:i,thisObject:n}),!0},t}();t.ReceiveMessageMgr=e,__reflect(e.prototype,"Server.ReceiveMessageMgr")}(Server||(Server={}));var Server;!function(t){var e=function(){function t(){this.m_msgQueue=new dataset.QueueVec(10)}return t.prototype.addMsg=function(t){this.m_msgQueue.push(t)},t.prototype.sendMsgOfOffLine=function(){for(;!this.m_msgQueue.isEmpty;)Context.sendMsg(this.m_msgQueue.pop())},t}();t.SendMessageMgr=e,__reflect(e.prototype,"Server.SendMessageMgr")}(Server||(Server={}));var Server;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.connect=function(){this.createSocket();var t=Context.loginData.pstrIP;this.m_ipInfo=t+":"+Context.loginData.wdPort,Context.loadingView.setText("打开窗户透透气 ",7),Context.logMgr.addLog("连接网关服务器 "+this.m_ipInfo),this.m_socket.connect(t,Context.loginData.wdPort,Context.platformMgr.getisWss())},e.prototype.onConnect=function(){Context.loadingView.setText("阳光与风一起进来了呢",8),Context.logMgr.addLog("网关服务器 连上了"),Context.loginCC3.promise.then(this.send_stPasswdLogonUserCmd.bind(this))},e.prototype.send_stPasswdLogonUserCmd=function(){var t=new Cmd.stPasswdLogonUserCmd;t.accid=Context.loginData.accid,t.loginTempID=Context.loginData.loginTempID,Context.sendMsg(t),Context.logMgr.addLog("stPasswdLogonUserCmd accid="+t.accid+" loginTempID="+t.loginTempID)},e.prototype.onClose=function(t){this.m_socket.connected&&Context.logMgr.sendServer("error: connected = true. ToGateWayServer onClose!"),Context.logMgr.addLog("ToGateWayServer onClose!"),Context.reloginMgr.bLoginFailed||Context.system.isActivate&&(Context.reloginMgr.bFirstReLoginInGame?(Context.reloginMgr.bFirstReLoginInGame=!1,Context.reloginMgr.reLoginInGame()):Context.sysPromptMgr.showUINetConnectClose())},e.prototype.process_stReturnNoCharUserCmd=function(t){var e=new Cmd.stReturnNoCharUserCmd;e.deserialize(t),Context.logMgr.addLog("stReturnNoCharUserCmd name="+e.name);var i=e.name;Context.loginData.randomName||Context.loginData.userInfo_wx.nickName&&(i=Context.loginData.userInfo_wx.nickName);var n=new Cmd.stReqVerifyUseNameUserCmd;n.name=i,Context.sendMsg(n),Context.loginData.randomName=e.name,Context.heroinfoMgr.bFirstEntryGame=!0},e.prototype.reset_to_beforeLogin=function(){this.m_socket&&(this.m_socket.close(),this.m_socket=null)},e}(t.ToServerBase);t.ToGateWayServer=e,__reflect(e.prototype,"Server.ToGateWayServer")}(Server||(Server={}));var Server;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.connect=function(){this.createSocket(),this.m_ipInfo=Context.platformMgr.platformIP+":"+Context.platformMgr.platformPort,Context.loadingView.setText("准备好吃的招待客人",4),Context.logMgr.addLog("连接登录服务器 "+this.m_ipInfo),this.m_socket.connect(Context.platformMgr.platformIP,Context.platformMgr.platformPort,Context.platformMgr.getisWss())},e.prototype.onConnect=function(){Context.logMgr.addLog("登陆服务器 连上了"),Context.loadingView.setText("准备好了~",5),Context.platformMgr.sendLoginInfo()},e.prototype.onClose=function(t){this.m_socket.connected&&Context.logMgr.sendServer("error: connected = true. ToLoginServer onClose!"),Context.logMgr.addLog("ToLoginServer onClose!")},e.prototype.process_stReturnUserVerifyVerCmd=function(t){var e=new Cmd.stReturnUserVerifyVerCmd;e.deserialize(t),Context.loginData.selfIP=e.ip},e.prototype.process_stServerReturnLoginFailedCmd=function(t){var e=new Cmd.stServerReturnLoginFailedCmd;e.deserialize(t),Context.reloginMgr.bLoginFailed=!0,Context.loadingView.setText(e.errorStr),Context.loadingView.stopBarByLoginFailed(),Context.logMgr.addLog("登陆失败:"+e.errorStr),Context.sysPromptMgr.showUINetConnectClose(e.errorStr)},e.prototype.process_stServerReturnLoginSuccessCmd=function(t){Context.logMgr.addLog("关闭与登录服务器的连接"),this.m_socket.close();var e=new Cmd.stServerReturnLoginSuccessCmd;e.deserialize(t),Context.bzConfig.isWSS&&(e.pstrIP=Context.bzConfig.loginServer.ip),Context.loginData.accid=e.accid,Context.loginData.loginTempID=e.loginTempID,Context.loginData.userID=e.uid,Context.loginData.pstrIP=e.pstrIP,Context.loginData.wdPort=e.wdPort,Context.gatewayServer.connect()},e}(t.ToServerBase);t.ToLoginServer=e,__reflect(e.prototype,"Server.ToLoginServer")}(Server||(Server={}));var Cmd;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.byCmd=t.stNullUserCmd.GIFT_USERCMD,i}return __extends(i,e),i.ONLINE_DIAMOND_GIFT_LIST_USERCMD=41,i.ADD_DIAMOND_GIFT_USERCMD=42,i.GET_DIAMOND_GIFT_USERCMD=43,i.UPDATE_DIAMOND_GIFT_EXTRA_USERCMD=44,i.SYN_DIAMOND_GIFT_SHARED_DATA_USERCMD=45,i}(t.stNullUserCmd);t.stGiftCmd=e,__reflect(e.prototype,"Cmd.stGiftCmd");var i=function(){function t(){}return t.prototype.deserialize=function(t){this.state=t.readUnsignedByte(),this.charid=t.readUnsignedInt();var e=t.readUnsignedShort();this.head=t.readUTFBytes(e)},t}();t.DiamondGiftItem=i,__reflect(i.prototype,"Cmd.DiamondGiftItem");var n=function(t){function n(){var i=t.call(this)||this;return i.byParam=e.ONLINE_DIAMOND_GIFT_LIST_USERCMD,i.DiamondGiftItem=[],i}return __extends(n,t),n.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.extraGiftState=e.readUnsignedByte();for(var n,o=e.readUnsignedByte(),r=0;o>r;r++)n=new i,n.deserialize(e),this.DiamondGiftItem.push(n)},n}(e);t.onlineDiamondGiftListUserCmd=n,__reflect(n.prototype,"Cmd.onlineDiamondGiftListUserCmd");var o=function(t){function n(){var i=t.call(this)||this;return i.byParam=e.ADD_DIAMOND_GIFT_USERCMD,i}return __extends(n,t),n.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.DiamondGiftItem=new i,this.DiamondGiftItem.deserialize(e)},n}(e);t.addDiamondGiftUserCmd=o,__reflect(o.prototype,"Cmd.addDiamondGiftUserCmd");var r=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.GET_DIAMOND_GIFT_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.charid),e.writeByte(this.state)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.charid=e.readUnsignedInt(),this.state=e.readUnsignedByte()},i}(e);t.getDiamondGiftUserCmd=r,__reflect(r.prototype,"Cmd.getDiamondGiftUserCmd");var s=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.UPDATE_DIAMOND_GIFT_EXTRA_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.extraGiftState=e.readUnsignedByte()},i}(e);t.updateDiamondGiftExtraUserCmd=s,__reflect(s.prototype,"Cmd.updateDiamondGiftExtraUserCmd");var a=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SYN_DIAMOND_GIFT_SHARED_DATA_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.charid),UtilByteArray.writeStr(e,this.url,1)},i}(e);t.synDiamondGiftSharedDataUserCmd=a,__reflect(a.prototype,"Cmd.synDiamondGiftSharedDataUserCmd")}(Cmd||(Cmd={}));var sound;!function(t){t.SOUND_mainbg="mainbg.mp3",t.SOUND_match3bg="match3bg.mp3",t.SOUND_clickBtn="clickBtn.mp3",t.SOUND_pieceMoveFail="pieceMoveFail.mp3",t.SOUND_pieceMoveSuccess="pieceMoveSuccess.mp3",t.SOUND_coverFragment="coverFragment.mp3",t.SOUND_coverBox="coverBox.mp3",t.SOUND_coverCooky="coverCooky.mp3",t.SOUND_coverHeTao="coverHeTao.mp3",t.SOUND_coverCherry="coverCherry.mp3",t.SOUND_coverJelly="coverJelly.mp3",t.SOUND_coverPaomo="coverPaomo.mp3",t.SOUND_coverFruitDisc="coverFruitDisc.mp3",t.SOUND_coverTTQ="coverTTQ.mp3",t.SOUND_coverDangban="coverDangban.mp3",t.SOUND_coverDiaoXiang="coverDiaoXiang.mp3",t.SOUND_iceBombburst="coverIceBombburst.mp3",t.SOUND_iceBombClean="coverIceBombClean.mp3",t.SOUND_coverVBubble="coverVBubble.mp3",t.SOUND_floorOli="floorOli.mp3",t.SOUND_floorGrassland="floorGrassland.mp3",t.SOUND_windblows="windblows.mp3",t.SOUND_composeProp="composeProp.mp3",t.SOUND_pieceClear="pieceClear.mp3",t.SOUND_airplane="airplane.mp3",t.SOUND_rainbowball="rainbowball.mp3",t.SOUND_bomb="bomb.mp3",t.SOUND_rocket="rocket.mp3",t.SOUND_taskComplete="taskComplete.mp3",t.SOUND_money="money.mp3",t.SOUND_furnitureLevelup="furnitureLevelup.mp3",t.SOUND_pass="passComplete.mp3",t.SOUND_addLife="addLife.mp3",t.SOUND_evaluate_lianxiao="evaluate_lianxiao.mp3",t.SOUND_evaluate1_good="evaluate1_good.mp3",t.SOUND_evaluate2_great="evaluate2_great.mp3",t.SOUND_evaluate3_perfect="evaluate3_perfect.mp3",t.SOUND_evaluate4_amazing="evaluate4_amazing.mp3",t.SOUND_evaluate5_unbelievable="evaluate5_unbelievable.mp3",t.SOUND_zhuanpan="zhuanpan.mp3";var e=function(){function e(){this.m_isMusicClosed_local=!1,this.m_isEffectClosed_local=!1,this.m_bPlaySoundByClickStage=!0,this.m_dicSI={},this.m_dicSIBg={},Context.system.isWXGame&&(this.m_wxSoundMgr=new t.WXSoundMgr),this.init()}return e.prototype.reset_to_beforeLogin=function(){this.stopAll()},e.prototype.leaveMatch3=function(){if(this.m_wxSoundMgr)this.m_wxSoundMgr.clearAllSound();else{var t=this.m_dicSI;for(var e in t)t[e].stop()}},e.prototype.updateLocal_isMusicClosed=function(t){void 0===t&&(t=!1),this.m_isMusicClosed_local=t,Context.system.isWXGame?window.wx.setStorage({key:"isMusicClosed",data:t.toString()}):egret.localStorage.setItem("isMusicClosed",t.toString())},e.prototype.updateLocal_isEffectClosed=function(t){void 0===t&&(t=!1),this.m_isEffectClosed_local=t,Context.system.isWXGame?window.wx.setStorage({key:"isSoundEffectClosed",data:t.toString()}):egret.localStorage.setItem("isSoundEffectClosed",t.toString())},e.prototype.init=function(){if(egret.localStorage){var t=Context.system.isWXGame?window.wx.getStorageSync("isMusicClosed"):egret.localStorage.getItem("isMusicClosed");t&&"true"==t&&(this.m_isMusicClosed_local=!0);var e=Context.system.isWXGame?window.wx.getStorageSync("isSoundEffectClosed"):egret.localStorage.getItem("isSoundEffectClosed");e&&"true"==e&&(this.m_isEffectClosed_local=!0)}this.bOnMusic&&this.m_bPlaySoundByClickStage&&Context.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTouchTab,this)},e.prototype.onStageTouchTab=function(){Context.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTouchTab,this),this.playAll(),this.m_bPlaySoundByClickStage=!1},e.prototype.play=function(e,i){if(void 0===i&&(i=1),this.m_wxSoundMgr)return void(this.bOnEffect&&this.m_wxSoundMgr.playSound(e));if(t.SOUND_match3bg==e||t.SOUND_mainbg==e);else if(!this.bOnEffect)return;var n=this.getSoundItem(e);return!n||n&&!n.loaded?void this.load(e,i):void(n.loaded&&(n.loops=i,n.play()))},e.prototype.playDirect=function(t,e){void 0===e&&(e=1);var i=this.getSoundItem(t);return!i||i&&!i.loaded?void this.load(t,e):(i.loaded&&(i.loops=e,i.play()),void Context.logMgr.addLog("playDirect play() si.loaded="+i.loaded+" "+t+" loops="+e))},e.prototype.playBgMusic=function(t){if(this.bOnMusic){if(this.m_wxSoundMgr)return void this.m_wxSoundMgr.playBgMusic(t);var e=this.m_dicSIBg;for(var i in e)1==e[i]&&this.stop(i);this.play(t,-1),e[t]=1}},e.prototype.stop=function(t){var e=this.getSoundItem(t);e&&e.stop();var i=this.m_dicSIBg;i[t]&&(i[t]=0)},e.prototype.stopAll=function(){if(this.m_wxSoundMgr)return this.m_wxSoundMgr.pauseBgMusic(),void this.m_wxSoundMgr.stopAllSound();var t=this.m_dicSI;for(var e in t)t[e].stop();t=this.m_dicSIBg;for(var e in t)t[e]=0},e.prototype.playAll=function(){if(this.bOnMusic){var e=t.SOUND_mainbg;this.playBgMusic(e)}},e.prototype.updateMusicState=function(e){void 0===e&&(e=!1);var i=!e;if(this.updateLocal_isMusicClosed(i),this.bOnMusic){var n=t.SOUND_mainbg;this.playBgMusic(n)}else this.stopAll()},e.prototype.updateEffectState=function(t){void 0===t&&(t=!1);var e=!t;this.updateLocal_isEffectClosed(e)},e.prototype.load=function(t,e){void 0===e&&(e=1);var n=this.getSoundItem(t);n||(n=new i(t,e),n.sound=new egret.Sound,n.sound.addEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),n.sound.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadIOError,this),this.m_dicSI[n.sound.hashCode]=n);var o="resource/sound/"+t,r=Context.gameVersionController.getVirtualUrl(o);n.sound.load(r),n.url=r,Context.logMgr.addLog("[sound load] url="+r)},e.prototype.onLoadComplete=function(e){var i=e.target;i.removeEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),i.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadIOError,this);var n=this.m_dicSI[i.hashCode];n.loaded=!0,n.name==t.SOUND_mainbg||n.name==t.SOUND_match3bg?(n.sound.type=egret.Sound.MUSIC,this.playAll(),Context.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTouchTab,this)):(n.sound.type=egret.Sound.EFFECT,n.play()),Context.logMgr.addLog("[sound load] ok! name="+n.name)},e.prototype.onLoadIOError=function(t){var e=t.target;e.removeEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadIOError,this);var i=this.m_dicSI[e.hashCode];Context.logMgr.addLog("[sound load] error! name="+i.name+" data="),delete this.m_dicSI[e.hashCode]},e.prototype.getSoundItem=function(t){var e=this.m_dicSI;for(var i in e)if(e[i].name==t)return e[i];return null},Object.defineProperty(e.prototype,"bOnMusic",{get:function(){return!this.m_isMusicClosed_local},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bOnEffect",{get:function(){return!this.m_isEffectClosed_local},enumerable:!0,configurable:!0}),e.prototype.updateOnOff=function(){if(this.bOnMusic){var e=t.SOUND_mainbg;this.playBgMusic(e)}else this.stopAll();Context.logMgr.addLog("updateOnOff() this.bOnOff="+this.bOnMusic)},e}();t.SoundMgr=e,__reflect(e.prototype,"sound.SoundMgr");var i=function(){function t(t,e){this.loops=1,this.name=t,this.loops=e,this.sound=null,this.sc=null,this.loaded=!1}return t.prototype.play=function(){if(this.loaded){this.sc;this.sc=this.sound.play(0,this.loops),this.sc.addEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this)}},t.prototype.onSoundComplete=function(t){this.sc&&this.sc.hasEventListener(egret.Event.SOUND_COMPLETE)&&this.sc.removeEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this)},t.prototype.stop=function(){this.loaded&&this.sc&&(this.sc.hasEventListener(egret.Event.SOUND_COMPLETE)&&this.sc.removeEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this),this.sc.stop(),this.sc=null)},t}();__reflect(i.prototype,"SoundItem")}(sound||(sound={}));var sound;!function(t){var e=function(){function t(){this.m_bgMusic=null,this.m_index=0,this.m_MaxSoundNum=9,this.m_soundList=[],window.wx.onAudioInterruptionBegin(function(){Context.logMgr.addLog(""),Context.soundMgr.stopAll()}),window.wx.onAudioInterruptionEnd(function(){Context.soundMgr.playAll()})}return t.prototype.playBgMusic=function(t){this.m_bgMusic||(this.m_bgMusic=window.wx.createInnerAudioContext(),this.m_bgMusic.loop=!0,this.m_bgMusic.autoplay=!0),t==this.m_bgMusicName?this.m_bgMusic.play():(this.m_bgMusic.paused||this.m_bgMusic.stop(),this.m_bgMusicName=t,this.m_bgMusic.src=this.soundPath(t))},t.prototype.isPlayBgMusic=function(){return this.m_bgMusic&&!this.m_bgMusic.paused},t.prototype.pauseBgMusic=function(){this.m_bgMusic&&this.m_bgMusic.pause()},t.prototype.resumeBgMusic=function(){this.m_bgMusicName&&this.playBgMusic(this.m_bgMusicName)},t.prototype.stopBgMusic=function(){this.m_bgMusic&&(this.m_bgMusic.stop(),this.m_bgMusic.destroy(),this.m_bgMusic=null)},t.prototype.playSound=function(t){var e=this.getSoundItem();e&&(e.sound.src=this.soundPath(t),e.sound.play(),e.paused=!1)},t.prototype.stopAllSound=function(){var t=this.m_soundList;for(var e in t)t[e].paused||t[e].sound.stop()},t.prototype.clearAllSound=function(){var t=this.m_soundList;for(var e in t)t[e]&&(t[e].sound.stop(),t[e].sound.destroy());this.m_soundList.length=0,this.m_index=0},t.prototype.getSoundItem=function(){for(var t=this.m_soundList,e=t.length,n=0;e>n;n++)if(t[n].paused)return t[n];var o;return e<this.m_MaxSoundNum?(o=new i,t.push(o)):(this.m_index>=this.m_MaxSoundNum&&(this.m_index=0),o=t[this.m_index],o.sound.stop()),this.m_index++,o},t.prototype.soundPath=function(t){return Context.gameVersionController.getVirtualUrl("resource/sound/"+t)},t}();t.WXSoundMgr=e,__reflect(e.prototype,"sound.WXSoundMgr");var i=function(){function t(){var t=this;this.paused=!0,this.sound=window.wx.createInnerAudioContext(),this.sound.onEnded(function(){t.paused=!0})}return t}();__reflect(i.prototype,"WXSoundItem")}(sound||(sound={}));var animation;!function(t){var e=function(t){function e(e,i){void 0===i&&(i=12);var n=t.call(this)||this;return n.m_numFrames=0,n.mDefaultFrameDuration=0/0,n.mCurrentTime=0/0,n.mCurrentFrame=0,n.mLoop=!1,n.mPlaying=!1,n.m_timeScale=1,n.init(e,i),n}return __extends(e,t),e.prototype.init=function(t,e){this.m_numFrames=t,this.mDefaultFrameDuration=1/e,this.mTotalTime=this.mDefaultFrameDuration*t,this.mLoop=!0,this.mPlaying=!0,this.mCurrentTime=0,this.mCurrentFrame=0,this.mStartTimes=new Array(t);
for(var i=0;t>i;++i)this.mStartTimes[i]=i*this.mDefaultFrameDuration},e.prototype.play=function(){this.mPlaying=!0},e.prototype.pause=function(){this.mPlaying=!1},e.prototype.stop=function(){this.mPlaying=!1,this.currentFrame=0},e.prototype.advanceTime=function(t){if(this.mPlaying&&!(0>=t)){1!=this.m_timeScale&&(t=this.m_timeScale*t);var e=this.mDefaultFrameDuration,i=0,n=(this.mCurrentFrame,0),o=!1,r=!1,s=this.totalTime;if(this.mLoop&&this.mCurrentTime>=s&&(this.mCurrentTime=0,this.mCurrentFrame=0),this.mCurrentTime<s){for(this.mCurrentTime+=t,i=this.m_numFrames-1;this.mCurrentTime>this.mStartTimes[this.mCurrentFrame]+e&&(this.mCurrentFrame==i?this.mLoop&&!this.hasEventListener(egret.Event.COMPLETE)?(this.mCurrentTime-=s,this.mCurrentFrame=0):(o=!0,n=this.mCurrentTime-s,r=!0,this.mCurrentFrame=i,this.mCurrentTime=s):this.mCurrentFrame++,!o););this.mCurrentFrame==i&&this.mCurrentTime==s&&(r=!0)}r&&this.dispatchEventWith(egret.Event.COMPLETE),this.mLoop&&n>0&&this.advanceTime(n)}},Object.defineProperty(e.prototype,"totalTime",{get:function(){return this.mTotalTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this.mCurrentTime},set:function(t){this.mCurrentTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numFrames",{get:function(){return this.m_numFrames},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this.mLoop},set:function(t){this.mLoop=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){return this.mCurrentFrame},set:function(t){this.mCurrentFrame=t,this.mCurrentTime=0;for(var e=0;t>e;++e)this.mCurrentTime+=this.mDefaultFrameDuration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fps",{get:function(){return 1/this.mDefaultFrameDuration},set:function(t){egret.assert(t>0,"Invalid fps: "+t);var e=1/t;this.mDefaultFrameDuration=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPlaying",{get:function(){return this.mPlaying?this.mLoop||this.mCurrentTime<this.totalTime:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isComplete",{get:function(){return!this.mLoop&&this.mCurrentTime>=this.totalTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeScale",{get:function(){return this.m_timeScale},set:function(t){this.m_timeScale=t},enumerable:!0,configurable:!0}),e}(egret.EventDispatcher);t.AnimationTimer=e,__reflect(e.prototype,"animation.AnimationTimer")}(animation||(animation={}));var animation;!function(t){var e=function(){function t(){this.mElapsedTime=0/0,this.mElapsedTime=0,this.mObjects=[]}return t.prototype.add=function(t){t&&-1==this.mObjects.indexOf(t)&&this.mObjects.push(t)},t.prototype.contains=function(t){return-1!=this.mObjects.indexOf(t)},t.prototype.remove=function(t){if(null!=t){var e=this.mObjects.indexOf(t);-1!=e&&(this.mObjects[e]=null)}},t.prototype.advanceTime=function(t){var e=this.mObjects.length,i=0,n=0;if(this.mElapsedTime+=t,0!=e){for(n=0;e>n;++n){var o=this.mObjects[n];o&&(i!=n&&(this.mObjects[i]=o,this.mObjects[n]=null),o.advanceTime(t),++i)}if(i!=n){for(e=this.mObjects.length;e>n;)this.mObjects[i++]=this.mObjects[n++];this.mObjects.length=i}}},Object.defineProperty(t.prototype,"elapsedTime",{get:function(){return this.mElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objects",{get:function(){return this.mObjects},enumerable:!0,configurable:!0}),t}();t.Juggler=e,__reflect(e.prototype,"animation.Juggler",["animation.IAnimatable"])}(animation||(animation={}));var animation;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_speedFlag=!0,e.m_mvSpeed=1,e.m_accelerated_speed=0,e.m_curPos=new egret.Point,e.m_destPos=new egret.Point,e.m_vSpeed=new egret.Point,e}return __extends(e,t),e.prototype.setChangeCallBack=function(t,e){this.m_changeCallBack=t,this.m_changeCallBackThis=e},e.prototype.setCurPos=function(t,e){this.m_curPos.x=t,this.m_curPos.y=e,this.m_speedFlag=!0},e.prototype.setSpeed=function(t,e){void 0===e&&(e=0),this.m_mvSpeed=t,this.m_accelerated_speed=e,this.m_speedFlag=!0},Object.defineProperty(e.prototype,"mvSpeed",{get:function(){return this.m_mvSpeed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isArrive",{get:function(){return this.m_curPos.equals(this.m_destPos)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curPos",{get:function(){return this.m_curPos},enumerable:!0,configurable:!0}),e.prototype.to=function(t,e){this.m_destPos.x=t,this.m_destPos.y=e,this.m_speedFlag=!0,Context.juggle.add(this)},e.prototype.updateVSpeed=function(){if(!this.isArrive){var t=egret.Point.distance(this.m_curPos,this.m_destPos),e=this.mvSpeed/t;this.m_vSpeed.x=(this.m_destPos.x-this.m_curPos.x)*e,this.m_vSpeed.y=(this.m_destPos.y-this.m_curPos.y)*e}},e.prototype.advanceTime=function(t){if(this.isArrive)return void Context.juggle.remove(this);this.m_speedFlag&&(this.updateVSpeed(),this.m_speedFlag=!1);var e=t*this.m_vSpeed.x+this.m_curPos.x,i=t*this.m_vSpeed.y+this.m_curPos.y;Math.abs(this.m_destPos.x-this.m_curPos.x)<=Math.abs(e-this.m_curPos.x)&&Math.abs(this.m_destPos.y-this.m_curPos.y)<=Math.abs(i-this.m_curPos.y)?this.m_curPos.copyFrom(this.m_destPos):(this.m_curPos.x=e,this.m_curPos.y=i),this.m_changeCallBack?this.m_changeCallBack.apply(this.m_changeCallBackThis):this.dispatchEventWith(egret.Event.CHANGE),this.isArrive&&(Context.juggle.remove(this),this.dispatchEventWith(egret.Event.COMPLETE)),this.m_accelerated_speed&&(this.m_mvSpeed+=this.m_accelerated_speed*t,this.m_speedFlag=!0)},e.prototype.stop=function(){Context.juggle.remove(this)},e.prototype.dispose=function(){this.stop(),this.m_changeCallBackThis=null,this.m_changeCallBack=null},e}(egret.EventDispatcher);t.Car2D=e,__reflect(e.prototype,"animation.Car2D",["animation.IAnimatable"])}(animation||(animation={}));var animation;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.m_aniList=new Array,t}return __extends(i,e),i.prototype.begin=function(){if(0==this.m_aniList.length)return void this._onComplete();for(var t,i=0,n=this.m_aniList.length;n>i;i++)t=this.m_aniList[i],t.target=this.target,t.setComplete_callback(this.onAniComposeEnd,this),t.begin();e.prototype.begin.call(this)},i.prototype.stop=function(){e.prototype.stop.call(this);for(var t,i=0,n=this.m_aniList;i<n.length;i++)t=n[i],t.stop()},i.prototype.onAniComposeEnd=function(){for(var t=0,e=this.m_aniList.length;e>t;t++)if(this.m_aniList[t].bRun)return;this._onComplete()},i.prototype.dispose=function(){for(var t=0,i=this.m_aniList.length;i>t;t++)this.m_aniList[t].dispose();this.m_aniList.length=0,e.prototype.dispose.call(this)},i.prototype.setAniList=function(t){this.m_aniList=t},i.prototype.parseXML=function(i){e.prototype.parseXML.call(this,i);for(var n,o=[],r=i.children,s=r.length,a=0;s>a;a++){var h=r[a];if(1==h.nodeType){var m=h,c=t.s_nameToClass(m.localName);n=new c,n.parseXML(m),o.push(n)}}this.setAniList(o)},i.prototype.getAniByID=function(t){for(var e,i,n=0,o=this.m_aniList;n<o.length;n++)if(e=o[n],i=e.getAniByID(t))return i;return i},Object.defineProperty(i.prototype,"timeScale",{set:function(t){for(var e,i=0,n=this.m_aniList;i<n.length;i++)e=n[i],e.timeScale=t},enumerable:!0,configurable:!0}),i}(t.DigitAniBase);t.AniComposeParallel=e,__reflect(e.prototype,"animation.AniComposeParallel")}(animation||(animation={}));var animation;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.m_curIndex=-1,t.m_aniList=new Array,t}return __extends(i,e),i.prototype.begin=function(){if(this.m_curIndex=0,0==this.m_aniList.length)return void this._onComplete();var t=this.m_aniList[0];t.target=this.target,t.setComplete_callback(this.onAniComposeEnd,this),t.begin(),e.prototype.begin.call(this)},i.prototype.stop=function(){e.prototype.stop.call(this);for(var t,i=0,n=this.m_aniList;i<n.length;i++)t=n[i],t.stop()},i.prototype.onAniComposeEnd=function(){if(this.m_curIndex++,this.m_curIndex>=this.m_aniList.length)return void this._onComplete();var t=this.m_aniList[this.m_curIndex];t.target=this.target,t.setComplete_callback(this.onAniComposeEnd,this),t.begin()},i.prototype.dispose=function(){for(var t=0,i=this.m_aniList.length;i>t;t++)this.m_aniList[t].dispose();this.m_aniList.length=0,e.prototype.dispose.call(this)},i.prototype.setAniList=function(t){this.m_aniList=t},i.prototype.parseXML=function(i){e.prototype.parseXML.call(this,i);for(var n,o=[],r=i.children,s=r.length,a=0;s>a;a++){var h=r[a];if(1==h.nodeType){var m=h,c=t.s_nameToClass(m.localName);n=new c,n.parseXML(m),o.push(n)}}this.setAniList(o)},i.prototype.getAniByID=function(t){for(var e,i,n=0,o=this.m_aniList;n<o.length;n++)if(e=o[n],i=e.getAniByID(t))return i;return i},Object.defineProperty(i.prototype,"timeScale",{set:function(t){for(var e,i=0,n=this.m_aniList;i<n.length;i++)e=n[i],e.timeScale=t},enumerable:!0,configurable:!0}),i}(t.DigitAniBase);t.AniComposeSequence=e,__reflect(e.prototype,"animation.AniComposeSequence")}(animation||(animation={}));var animation;!function(t){function e(t){var e=o[t];return i(e)}function i(e){var i;switch(e){case o.EASE_Back_easeIn:i=t.Back.easeIn;break;case o.EASE_Back_easeOut:i=t.Back.easeOut;break;case o.EASE_Back_easeInOut:i=t.Back.easeInOut;break;case o.EASE_Bounce_easeIn:i=t.Bounce.easeIn;break;case o.EASE_Bounce_easeOut:i=t.Bounce.easeOut;break;case o.EASE_Bounce_easeInOut:i=t.Bounce.easeInOut;break;case o.EASE_Circular_easeIn:i=t.Circular.easeIn;break;case o.EASE_Circular_easeOut:i=t.Circular.easeOut;break;case o.EASE_Circular_easeInOut:i=t.Circular.easeInOut;break;case o.EASE_Cubic_easeIn:i=t.Cubic.easeIn;break;case o.EASE_Cubic_easeOut:i=t.Cubic.easeOut;break;case o.EASE_Cubic_easeInOut:i=t.Cubic.easeInOut;break;case o.EASE_Elastic_easeIn:i=t.Elastic.easeIn;break;case o.EASE_Elastic_easeOut:i=t.Elastic.easeOut;break;case o.EASE_Elastic_easeInOut:i=t.Elastic.easeInOut;break;case o.EASE_Exponential_easeIn:i=t.Exponential.easeIn;break;case o.EASE_Exponential_easeOut:i=t.Exponential.easeOut;break;case o.EASE_Exponential_easeInOut:i=t.Exponential.easeInOut;break;case o.EASE_Linear_easeNone:i=t.Linear.easeNone;break;case o.EASE_Quadratic_easeIn:i=t.Quadratic.easeIn;break;case o.EASE_Quadratic_easeOut:i=t.Quadratic.easeOut;break;case o.EASE_Quadratic_easeInOut:i=t.Quadratic.easeInOut;break;case o.EASE_Quartic_easeIn:i=t.Quartic.easeIn;break;case o.EASE_Quartic_easeOut:i=t.Quartic.easeOut;break;case o.EASE_Quartic_easeInOut:i=t.Quartic.easeInOut;break;case o.EASE_Quintic_easeIn:i=t.Quintic.easeIn;break;case o.EASE_Quintic_easeOut:i=t.Quintic.easeOut;break;case o.EASE_Quintic_easeInOut:i=t.Quintic.easeInOut;break;case o.EASE_Sine_easeIn:i=t.Sine.easeIn;break;case o.EASE_Sine_easeOut:i=t.Sine.easeOut;break;case o.EASE_Sine_easeInOut:i=t.Sine.easeInOut}return i}function n(e){switch(e){case"AniComposeParallel":return t.AniComposeParallel;case"AniPropertys":return t.AniPropertys;case"AniComposeSequence":return t.AniComposeSequence;case"AniSetProperty":return t.AniSetProperty;case"AniToDestPostion_BezierCurve1":return t.AniToDestPostion_BezierCurve1;case"AniToDestPostion_BezierCurve2":return t.AniToDestPostion_BezierCurve2}return null}var o=function(){function t(){}return t.EASE_Back_easeIn=1,t.EASE_Back_easeOut=2,t.EASE_Back_easeInOut=3,t.EASE_Bounce_easeIn=4,t.EASE_Bounce_easeOut=5,t.EASE_Bounce_easeInOut=6,t.EASE_Circular_easeIn=7,t.EASE_Circular_easeOut=8,t.EASE_Circular_easeInOut=9,t.EASE_Cubic_easeIn=10,t.EASE_Cubic_easeOut=11,t.EASE_Cubic_easeInOut=12,t.EASE_Elastic_easeIn=13,t.EASE_Elastic_easeOut=14,t.EASE_Elastic_easeInOut=15,t.EASE_Exponential_easeIn=16,t.EASE_Exponential_easeOut=17,t.EASE_Exponential_easeInOut=18,t.EASE_Linear_easeNone=19,t.EASE_Quadratic_easeIn=20,t.EASE_Quadratic_easeOut=21,t.EASE_Quadratic_easeInOut=22,t.EASE_Quartic_easeIn=23,t.EASE_Quartic_easeOut=24,t.EASE_Quartic_easeInOut=25,t.EASE_Quintic_easeIn=26,t.EASE_Quintic_easeOut=27,t.EASE_Quintic_easeInOut=28,t.EASE_Sine_easeIn=29,t.EASE_Sine_easeOut=30,t.EASE_Sine_easeInOut=31,t}();t.AniDef=o,__reflect(o.prototype,"animation.AniDef"),t.s_getEaseFunByName=e,t.s_getEaseFun=i,t.s_nameToClass=n}(animation||(animation={}));var Cmd;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.byCmd=t.stNullUserCmd.LOGON_USERCMD,i}return __extends(i,e),i.USER_VERIFY_VER_PARA=1,i.RETURN_USER_VERIFY_VER_PARA=2,i.USER_REQUEST_LOGIN_PARA=3,i.SERVER_RETURN_LOGIN_FAILED=4,i.SERVER_RETURN_LOGIN_OK=5,i.PASSWD_LOGON_USERCMD_PARA=6,i.RETURN_NO_CHAR_USERCMD_PARA=7,i.REQ_MODIFYNAME_USERCMD_PARA=8,i.REQ_VERIFY_USE_NAME_USERCMD_PARA=9,i.RET_VERIFY_USE_NAME_USERCMD_PARA=10,i.CREATE_CHAR_USERCMD_PARA=11,i.RETURN_RELEASE_VER_PARA=12,i.CLIENT_RESOURCE_LOADOVER_LOGIN_PARA=13,i.SERVER_RETURN_DISCONNECT=14,i.MU_PLATFORM_USER_REQUEST_LOGIN_PARA=18,i.MU_COMMON_PLATFORM_USER_REQUEST_LOGIN_PARA=19,i.MU_PLATFORM_USER_REQUEST_DEBUG_LOGIN_PARA=20,i.SEND_RELOGIN_TOKEN_PARA=121,i.MU_COMMON_PLATFORM_USER_REQUEST_RELOGIN_PARA=122,i}(t.stNullUserCmd);t.stLogonUserCmd=e,__reflect(e.prototype,"Cmd.stLogonUserCmd");var i=function(t){function i(){var i=t.call(this)||this;return i.ver=20180802,i.byParam=e.USER_VERIFY_VER_PARA,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.ver)},i}(e);t.stUserVerifyVerCmd=i,__reflect(i.prototype,"Cmd.stUserVerifyVerCmd");var n=function(i){function n(){var t=i.call(this)||this;return t.byParam=e.RETURN_USER_VERIFY_VER_PARA,t}return __extends(n,i),n.prototype.deserialize=function(e){i.prototype.deserialize.call(this,e),this.ip=e.readUTFBytes(t.MAX_IP_LENGTH)},n.prototype.serialize=function(e){i.prototype.serialize.call(this,e),UtilByteArray.writeStr_FixedLength(e,this.ip,t.MAX_IP_LENGTH)},n}(e);t.stReturnUserVerifyVerCmd=n,__reflect(n.prototype,"Cmd.stReturnUserVerifyVerCmd");var o=function(i){function n(){var t=i.call(this)||this;return t.byParam=e.USER_REQUEST_LOGIN_PARA,t}return __extends(n,i),n.prototype.serialize=function(e){i.prototype.serialize.call(this,e),UtilByteArray.writeStr_FixedLength(e,this.uid,t.MAX_UID_LEN),e.writeShort(this.zoneid),e.writeUnsignedInt(this.platformType)},n}(e);t.stUserRequestLoginCmd=o,__reflect(o.prototype,"Cmd.stUserRequestLoginCmd");var r=function(i){function n(){var t=i.call(this)||this;return t.byParam=e.SERVER_RETURN_LOGIN_FAILED,t}return __extends(n,i),n.prototype.deserialize=function(e){i.prototype.deserialize.call(this,e),this.errorStr=e.readUTFBytes(t.MAX_LOGIN_ERRO_STR)},n}(e);t.stServerReturnLoginFailedCmd=r,__reflect(r.prototype,"Cmd.stServerReturnLoginFailedCmd");var s=function(i){function n(){var t=i.call(this)||this;return t.byParam=e.SERVER_RETURN_LOGIN_OK,t}return __extends(n,i),n.prototype.deserialize=function(e){i.prototype.deserialize.call(this,e),this.accid=e.readUnsignedInt(),this.loginTempID=e.readUnsignedInt(),this.pstrIP=e.readUTFBytes(t.MAX_IP_LENGTH),this.wdPort=e.readUnsignedShort(),this.key=e.readUnsignedByte(),this.uid=e.readUTFBytes(t.MAX_UID_LEN)},n}(e);t.stServerReturnLoginSuccessCmd=s,__reflect(s.prototype,"Cmd.stServerReturnLoginSuccessCmd");var a=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.PASSWD_LOGON_USERCMD_PARA,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.loginTempID),e.writeUnsignedInt(this.accid)},i}(e);t.stPasswdLogonUserCmd=a,__reflect(a.prototype,"Cmd.stPasswdLogonUserCmd");var h=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RETURN_NO_CHAR_USERCMD_PARA,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.name=UtilByteArray.readStr_MAX_NAMESIZE(e)},i}(e);t.stReturnNoCharUserCmd=h,__reflect(h.prototype,"Cmd.stReturnNoCharUserCmd");var m=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_MODIFYNAME_USERCMD_PARA,i}return __extends(i,t),i}(e);t.stReqModifyNameUserCmd=m,__reflect(m.prototype,"Cmd.stReqModifyNameUserCmd");var c=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_VERIFY_USE_NAME_USERCMD_PARA,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),UtilByteArray.writeStr_MAX_NAMESIZE(e,this.name)},i}(e);t.stReqVerifyUseNameUserCmd=c,__reflect(c.prototype,"Cmd.stReqVerifyUseNameUserCmd");var u=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RET_VERIFY_USE_NAME_USERCMD_PARA,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.valid=e.readUnsignedByte(),this.name=UtilByteArray.readStr_MAX_NAMESIZE(e)},i}(e);t.stRetVerifyUseNameUserCmd=u,__reflect(u.prototype,"Cmd.stRetVerifyUseNameUserCmd");var l=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.CREATE_CHAR_USERCMD_PARA,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.career),e.writeByte(this.sex),e.writeByte(this.minor)},i}(e);t.stCreateCharUserCmd=l,__reflect(l.prototype,"Cmd.stCreateCharUserCmd");var p=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SERVER_RETURN_DISCONNECT,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.ret=e.readUnsignedByte()},i}(e);t.stServerReturnDisConnectCmd=p,__reflect(p.prototype,"Cmd.stServerReturnDisConnectCmd");var d=function(i){function n(){var t=i.call(this)||this;return t.byParam=e.MU_COMMON_PLATFORM_USER_REQUEST_LOGIN_PARA,t}return __extends(n,i),n.prototype.serialize=function(e){i.prototype.serialize.call(this,e),UtilByteArray.writeStr_FixedLength(e,this.uid,t.MAX_UID_LEN),UtilByteArray.writeStr_FixedLength(e,this.cid,t.MAX_CID_LEN),e.writeUnsignedShort(this.zone),e.writeUnsignedInt(this.pid),e.writeUnsignedInt(this.time),UtilByteArray.writeStr_FixedLength(e,this.sign,33)},n}(e);t.muCommonPlatformUserRequestLoginCmd=d,__reflect(d.prototype,"Cmd.muCommonPlatformUserRequestLoginCmd");var _=function(i){function n(){var t=i.call(this)||this;return t.byParam=e.MU_PLATFORM_USER_REQUEST_DEBUG_LOGIN_PARA,t}return __extends(n,i),n.prototype.serialize=function(e){i.prototype.serialize.call(this,e),UtilByteArray.writeStr_FixedLength(e,this.uid,t.MAX_UID_LEN),UtilByteArray.writeStr_FixedLength(e,this.mima,t.MAX_NAMESIZE),e.writeUnsignedShort(this.zone),e.writeUnsignedInt(this.pid)},n}(e);t.muPlatformUserRequestDebugLoginCmd=_,__reflect(_.prototype,"Cmd.muPlatformUserRequestDebugLoginCmd");var f=function(i){function n(){var t=i.call(this)||this;return t.byParam=e.SEND_RELOGIN_TOKEN_PARA,t}return __extends(n,i),n.prototype.deserialize=function(e){i.prototype.deserialize.call(this,e),this.reloginToken=e.readUTFBytes(t.MAX_OPEN_KEY_LEN)},n}(e);t.stSendReloginTokenPara=f,__reflect(f.prototype,"Cmd.stSendReloginTokenPara");var g=function(i){function n(){var t=i.call(this)||this;return t.byParam=e.MU_COMMON_PLATFORM_USER_REQUEST_RELOGIN_PARA,t}return __extends(n,i),n.prototype.serialize=function(e){i.prototype.serialize.call(this,e),UtilByteArray.writeStr_FixedLength(e,this.uid,t.MAX_UID_LEN),UtilByteArray.writeStr_FixedLength(e,this.cid,t.MAX_CID_LEN),UtilByteArray.writeStr_FixedLength(e,this.reloginToken,t.MAX_OPEN_KEY_LEN),e.writeUnsignedShort(this.zone),e.writeUnsignedInt(this.pid)},n}(e);t.muCommonPlatformUserRequestReLoginCmd=g,__reflect(g.prototype,"Cmd.muCommonPlatformUserRequestReLoginCmd")}(Cmd||(Cmd={}));var animation;!function(t){var e=function(e){function i(i){void 0===i&&(i=!1);var n=e.call(this)||this;return n.m_gtWeen=new t.GTween,n.m_gtWeen.isUseAdvance=!0,n.m_gtWeen.autoPlay=!1,n.m_gtWeen.useFrames=!1,n.m_gtWeen.setCompleteCallback(n.onGTweenComplete,n),n.m_gtWeen.repeatCount=1,n.m_isCallAdvanceFromOuter=i,n}return __extends(i,e),i.prototype.advanceTime=function(t){this.m_isCallAdvanceFromOuter||this.m_gtWeen.paused&&this.removeFromJuggle(),this.m_gtWeen.advanceTime(t)},i.prototype.resetValues=function(t){this.m_gtWeen.resetValues(t)},Object.defineProperty(i.prototype,"repeatCount",{set:function(t){this.m_gtWeen.repeatCount=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"duration",{set:function(t){this.m_gtWeen.duration=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"useFrames",{set:function(t){this.m_gtWeen.useFrames=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ease",{set:function(t){this.m_gtWeen.ease=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"easeConst",{set:function(e){this.m_gtWeen.ease=t.s_getEaseFun(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"reflect",{set:function(t){this.m_gtWeen.reflect=t},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this.stop(),this.m_gtWeen.paused=!0,this.m_gtWeen.target=null,this.m_gtWeen.repeatCount=1,this.m_gtWeen.useFrames=!1,this.m_gtWeen.reflect=!1,this.m_gtWeen.ease=t.GTween.linearEase,e.prototype.dispose.call(this)},i.prototype.begin=function(){this.m_isCallAdvanceFromOuter||this.addToJuggle(),e.prototype.begin.call(this),this.initValues(),this.m_gtWeen.target=this.m_target,this.m_gtWeen.init(),this.m_gtWeen.beginning(),this.m_gtWeen.paused=!1},i.prototype.stop=function(){e.prototype.stop.call(this),this.m_gtWeen.paused=!0,this.m_isCallAdvanceFromOuter||this.removeFromJuggle()},i.prototype.end=function(){this.m_gtWeen.paused=!0,this.m_isCallAdvanceFromOuter||this.removeFromJuggle()},i.prototype.parseXML=function(i){e.prototype.parseXML.call(this,i);var n=UtilXml.attributeString(i,"attributes");if(n){var o=t.DigitAniBase.parseAttributes(n);this.resetValues(o)}this.duration=UtilXml.attributeNumber(i,"duration"),this.useFrames=UtilXml.attributeBoolean(i,"useFrames"),UtilXml.hasAttribute(i,"repeatCount")&&(this.repeatCount=UtilXml.attributeInt(i,"repeatCount")),n=UtilXml.attributeString(i,"ease"),n&&(this.ease=t.s_getEaseFunByName(n))},Object.defineProperty(i.prototype,"timeScale",{set:function(t){this.m_gtWeen.timeScale=t},enumerable:!0,configurable:!0}),i.prototype.setEaseByConst=function(e){this.m_gtWeen.ease=t.s_getEaseFun(e)},i}(t.DigitAniBase);t.AniPropertys=e,__reflect(e.prototype,"animation.AniPropertys")}(animation||(animation={}));var animation;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setValues=function(t){this.m_values=t},e.prototype.begin=function(){t.prototype.begin.call(this);for(var e in this.m_values)this.target[e]=this.m_values[e];this._onComplete()},e}(t.DigitAniBase);t.AniSetProperty=e,__reflect(e.prototype,"animation.AniSetProperty")}(animation||(animation={}));var animation;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.m_angle=0,i.m_range=0,i.m_duration=0,i.m_xName="x",i.m_yName="y",i.m_gtWeen=new t.GTween,i.m_gtWeen.reflect=!0,i.m_gtWeen.autoPlay=!1,i.m_gtWeen.setCompleteCallback(i._onComplete,i),i.m_gtWeen.target=i,i.m_gtWeen.paused=!0,i.m_equation=new t.EquationBezierCurve1,i}return __extends(i,e),i.prototype.setxyName=function(t,e){this.m_xName=t,this.m_yName=e},i.prototype.setParam=function(t,e,i,n){this.m_angle=t,this.m_range=e,this.m_duration=i,this.m_gtWeen.repeatCount=n+n},i.prototype.begin=function(){var t=this.m_target[this.m_xName]+Math.cos(this.m_angle)*this.m_range,i=this.m_target[this.m_yName]+Math.sin(this.m_angle)*this.m_range;this.m_equation.setPos(this.m_target[this.m_xName],this.m_target[this.m_yName],t,i),this.m_equation.t=0,this.m_gtWeen.resetValues({t:1}),this.m_gtWeen.duration=this.m_duration,this.m_gtWeen.paused=!1,e.prototype.begin.call(this)},i.prototype.stop=function(){e.prototype.stop.call(this),this.m_gtWeen.paused=!0},i.prototype.dispose=function(){this.m_gtWeen.paused=!0,this.m_gtWeen.setCompleteCallback(null,null),this.m_gtWeen.target=null,this.m_gtWeen=null,e.prototype.dispose.call(this)},Object.defineProperty(i.prototype,"t",{get:function(){return this.m_equation.t},set:function(t){this.m_equation.t=t,this.m_target[this.m_xName]=this.m_equation.x,this.m_target[this.m_yName]=this.m_equation.y},enumerable:!0,configurable:!0}),i}(t.DigitAniBase);t.AniShake=e,__reflect(e.prototype,"animation.AniShake")}(animation||(animation={}));var animation;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.m_car=new t.Car1D,i}return __extends(i,e),i.prototype.setParam=function(t,e,i,n,o){this.m_maxSpeed=i,this.m_slowSpeedDistanceRatioBegin=n,this.m_slowSpeedDistanceRatioEnd=o,this.m_beginPos=t,this.m_endPos=e,this.m_distance=e-t,this.m_distanceBegin=this.m_distance*this.m_slowSpeedDistanceRatioBegin,this.m_distanceEnd=this.m_distance*this.m_slowSpeedDistanceRatioEnd,this.m_car.sorPos=t,this.m_car.destPos=e},i.prototype.advanceTime=function(e){var i=this.m_car.hasMovedDistance;if(i<=this.m_distanceBegin){var n=(i/this.m_distanceBegin+.3)*this.m_maxSpeed;n>this.m_maxSpeed&&(n=this.m_maxSpeed),this.m_car.mvSpeed=n}else{var o=this.m_distance-i;if(o<this.m_distanceEnd){var n=(t.Quadratic.easeIn(o/this.m_distanceEnd,0,0,0)+.2)*this.m_maxSpeed;this.m_car.mvSpeed=n}else this.m_car.mvSpeed<this.m_maxSpeed&&(this.m_car.mvSpeed=this.m_maxSpeed)}this.m_car.onTick(e),this.dispatchEventWith(egret.Event.CHANGE),this.m_car.isStop&&this._onComplete()},i.prototype.begin=function(){this.addToJuggle(),this.m_car.begin()},Object.defineProperty(i.prototype,"currentPos",{get:function(){return this.m_car.curPos},enumerable:!0,configurable:!0}),i}(t.DigitAniBase);t.AniTiger=e,__reflect(e.prototype,"animation.AniTiger")}(animation||(animation={}));var animation;!function(t){var e=function(e){function i(i){void 0===i&&(i=!1);var n=e.call(this,i)||this;return n.m_bRelativePos=!1,n.m_xOffset=0,n.m_yOffset=0,n.m_equation=new t.EquationBezierCurve1,n}return __extends(i,e),i.prototype.setDestPos=function(t,e){this.m_xOffset=t,this.m_yOffset=e},i.prototype.begin=function(){var t=this.m_equation;this.m_bRelativePos?t.setPD(this.m_xOffset+this.m_target.x,this.m_yOffset+this.m_target.y):t.setPD(this.m_xOffset,this.m_yOffset),t.setPS(this.m_target.x,this.m_target.y),this.m_speed&&(this.m_duration=t.distance()/this.m_speed),e.prototype.begin.call(this)},Object.defineProperty(i.prototype,"relativePos",{set:function(t){this.m_bRelativePos=t},enumerable:!0,configurable:!0}),i.prototype.parseXML=function(i){if(e.prototype.parseXML.call(this,i),this.relativePos=UtilXml.attributeBoolean(i,"relativePos"),this.setDestPos(UtilXml.attributeInt(i,"destX"),UtilXml.attributeInt(i,"destY")),UtilXml.hasAttribute(i,"speed")&&(this.speed=UtilXml.attributeNumber(i,"speed")),UtilXml.hasAttribute(i,"duration")&&(this.duration=UtilXml.attributeNumber(i,"duration")),UtilXml.hasAttribute(i,"useFrames")&&(this.useFrames=UtilXml.attributeBoolean(i,"useFrames")),UtilXml.hasAttribute(i,"ease")){n=UtilXml.attributeString(i,"ease");var n;n&&(this.ease=t.s_getEaseFunByName(n))}},i}(t.AniPositionParamEquation);t.AniToDestPostion_BezierCurve1=e,__reflect(e.prototype,"animation.AniToDestPostion_BezierCurve1")}(animation||(animation={}));var animation;!function(t){var e=function(e){function i(i){void 0===i&&(i=!1);var n=e.call(this,i)||this;return n.m_useFixedMid=!1,n.m_equation=new t.EquationBezierCurve2,n}return __extends(i,e),i.prototype.setDestPos=function(t,e){this.m_equation.setPD(t,e)},i.prototype.setMidValue=function(t,e){var i=this.m_equation;i.setP(t,e),this.m_useFixedMid=!0},Object.defineProperty(i.prototype,"useFixedMid",{set:function(t){this.m_useFixedMid=t},enumerable:!0,configurable:!0}),i.prototype.begin=function(){var t=this.m_equation;if(t.setPS(this.m_target.x,this.m_target.y),!this.m_useFixedMid){var i=this.m_target.x+(t.m_xPD-this.m_target.x)*Math.random(),n=this.m_target.y+(t.m_yPD-this.m_target.y)*Math.random();t.setP(i,n)}this.m_speed&&(this.m_duration=UtilMath.distance(t.m_xPS,t.m_yPS,t.m_xPD,t.m_yPD)/this.m_speed),e.prototype.begin.call(this)},i.prototype.parseXML=function(i){if(e.prototype.parseXML.call(this,i),this.setDestPos(UtilXml.attributeInt(i,"destX"),UtilXml.attributeInt(i,"destY")),UtilXml.hasAttribute(i,"MidX")&&UtilXml.hasAttribute(i,"MidY")&&this.setMidValue(UtilXml.attributeInt(i,"MidX"),UtilXml.attributeInt(i,"MidY")),UtilXml.hasAttribute(i,"speed")&&(this.speed=UtilXml.attributeNumber(i,"speed")),UtilXml.hasAttribute(i,"duration")&&(this.duration=UtilXml.attributeNumber(i,"duration")),UtilXml.hasAttribute(i,"useFrames")&&(this.useFrames=UtilXml.attributeBoolean(i,"useFrames")),UtilXml.hasAttribute(i,"ease")){n=UtilXml.attributeString(i,"ease");var n;n&&(this.ease=t.s_getEaseFunByName(n))}},i}(t.AniPositionParamEquation);t.AniToDestPostion_BezierCurve2=e,__reflect(e.prototype,"animation.AniToDestPostion_BezierCurve2")}(animation||(animation={}));var animation;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.parseXML=function(i){e.prototype.parseXML.call(this,i);var n,o=i.children,r=0,s=o.length;for(r=0;s>r;r++){var a=o[r];if(1==a.nodeType){n=a;break}}var h=t.s_nameToClass(n.localName);this.m_ani=new h,this.m_ani.setComplete_callback(this._onComplete,this),this.m_ani.parseXML(n)},i.prototype.begin=function(){e.prototype.begin.call(this),this.m_ani.target=this.target,this.m_ani.begin()},i.prototype.dispose=function(){this.m_ani&&this.m_ani.dispose(),e.prototype.dispose.call(this)},i.prototype.getAniByID=function(t){return this.m_ani.getAniByID(t)},i.prototype.stop=function(){e.prototype.stop.call(this),this.m_ani.stop()},Object.defineProperty(i.prototype,"timeScale",{set:function(t){this.m_ani.timeScale=t},enumerable:!0,configurable:!0}),i}(t.DigitAniBase);t.AniXml=e,__reflect(e.prototype,"animation.AniXml")}(animation||(animation={}));var animation;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_mvSpeed=1,e.m_curPos=e.m_destPos=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"curPos",{get:function(){return this.m_curPos},set:function(t){this.m_curPos=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mvSpeed",{get:function(){return this.m_mvSpeed},set:function(t){this.m_mvSpeed=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isArrive",{get:function(){return this.m_curPos==this.m_destPos},enumerable:!0,configurable:!0}),e.prototype.to=function(t){this.m_destPos=t,Context.juggle.add(this)},e.prototype.advanceTime=function(t){if(this.isArrive)return void Context.juggle.remove(this);var e=Math.abs(this.m_destPos-this.m_curPos),i=t*this.m_mvSpeed;i>=e?this.m_curPos=this.m_destPos:this.m_destPos>this.m_curPos?this.m_curPos+=i:this.m_curPos-=i,this.isArrive?(Context.juggle.remove(this),this.dispatchEventWith(egret.Event.COMPLETE)):this.dispatchEventWith(egret.Event.CHANGE)},e.prototype.resetTo=function(t){this.m_curPos=this.m_destPos=t,Context.juggle.remove(this)},e.prototype.clear=function(){this.m_curPos=this.m_destPos=0,Context.juggle.remove(this)},e.prototype.stop=function(){Context.juggle.remove(this)},e}(egret.EventDispatcher);t.Car1D_2=e,__reflect(e.prototype,"animation.Car1D_2",["animation.IAnimatable"])}(animation||(animation={}));var animation;!function(t){var e=function(){function t(){this.m_mvSpeed=1}return Object.defineProperty(t.prototype,"sorPos",{set:function(t){this.m_sorPos=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"destPos",{set:function(t){this.m_destPos=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mvSpeed",{get:function(){return this.m_mvSpeed},set:function(t){this.m_mvSpeed=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"totalTime",{set:function(t){this.m_mvSpeed=Math.abs(this.m_sorPos-this.m_destPos)/t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasMovedDistance",{get:function(){return Math.abs(this.m_curPos-this.m_sorPos)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isStop",{get:function(){return 0==this.m_bRunning},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curPos",{get:function(){return this.m_curPos
},enumerable:!0,configurable:!0}),t.prototype.begin=function(){this.m_bRunning=!0,this.m_curPos=this.m_sorPos,this.m_destPos<this.m_sorPos&&(this.m_mvSpeed=-this.m_mvSpeed)},t.prototype.stop=function(){this.m_bRunning=!1},t.prototype.onTick=function(t){this.isStop||(this.m_curPos+=this.m_mvSpeed*t,Math.abs(this.m_curPos-this.m_sorPos)>=Math.abs(this.m_destPos-this.m_sorPos)&&(this.m_curPos=this.m_destPos,this.m_bRunning=!1))},t}();t.Car1D=e,__reflect(e.prototype,"animation.Car1D")}(animation||(animation={}));var Cmd;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.byCmd=t.stNullUserCmd.MAIL_USERCMD,i}return __extends(i,e),i.REQ_MAIL_LIST_USERCMD=1,i.RET_MAIL_LIST_USERCMD=2,i.REQ_READ_MAIL_USERCMD=3,i.RET_READ_MAIL_USERCMD=4,i.REQ_WRITE_MAIL_USERCMD=5,i.GET_MAIL_FUJIAN_USERCMD=6,i.NOTIFY_NEW_MAIL_USERCMD=8,i.RET_WRITE_MAIL_USERCMD=9,i}(t.stNullUserCmd);t.stMailUserCmd=e,__reflect(e.prototype,"Cmd.stMailUserCmd");var i=function(){function t(){}return t.prototype.deserialize=function(t){this.id=t.readUnsignedInt(),this.type=t.readUnsignedByte(),this.topic=t.readUTFBytes(32),this.time2=t.readUnsignedInt(),this.read=t.readBoolean(),this.fujianGet=t.readBoolean()},t}();t.MailHead=i,__reflect(i.prototype,"Cmd.MailHead");var n=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.objid=t,this.num=e}return t.prototype.deserialize=function(t){this.objid=t.readUnsignedInt(),this.num=t.readUnsignedInt()},t.prototype.serialize=function(t){t.writeUnsignedInt(this.objid),t.writeUnsignedInt(this.num)},t}();t.t_EquipObjData=n,__reflect(n.prototype,"Cmd.t_EquipObjData");var o=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_MAIL_LIST_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e)},i}(e);t.stReqMailListCmd=o,__reflect(o.prototype,"Cmd.stReqMailListCmd");var r=function(t){function n(){var i=t.call(this)||this;return i.byParam=e.RET_MAIL_LIST_USERCMD,i.mailList=[],i}return __extends(n,t),n.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.mailList=UtilArray.deserialize(e,i,2)},n}(e);t.stRetMailListCmd=r,__reflect(r.prototype,"Cmd.stRetMailListCmd");var s=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_READ_MAIL_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.id)},i}(e);t.stReqReadMailUserCmd=s,__reflect(s.prototype,"Cmd.stReqReadMailUserCmd");var a=function(i){function o(){var t=i.call(this)||this;return t.byParam=e.RET_READ_MAIL_USERCMD,t}return __extends(o,i),o.prototype.deserialize=function(e){i.prototype.deserialize.call(this,e),this.id=e.readUnsignedInt(),this.text=UtilByteArray.readStr(e,2),this.objList=UtilArray.deserialize(e,t.t_ObjData,1),this.equipList=UtilArray.deserialize(e,n,1)},o}(e);t.stRetReadMailUserCmd=a,__reflect(a.prototype,"Cmd.stRetReadMailUserCmd");var h=function(i){function n(){var t=i.call(this)||this;return t.byParam=e.REQ_WRITE_MAIL_USERCMD,t}return __extends(n,i),n.prototype.serialize=function(e){i.prototype.serialize.call(this,e),UtilByteArray.writeStr_FixedLength(e,this.name,t.MAX_NAMESIZE),UtilByteArray.writeStr_FixedLength(e,this.topic,t.TOPIC),UtilByteArray.writeStr_FixedLength(e,this.text,t.MAILTEXT)},n}(e);t.stReqWriteMailUserCmd=h,__reflect(h.prototype,"Cmd.stReqWriteMailUserCmd");var m=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.GET_MAIL_FUJIAN_USERCMD,i.idList=[],i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e);var i=this.idList.length,n=0;for(e.writeByte(i),n=0;i>n;n++)e.writeUnsignedInt(this.idList[n])},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);var i=e.readUnsignedByte(),n=0;for(n=0;i>n;n++)this.idList.push(e.readUnsignedInt())},i}(e);t.stGetMailFujianUserCmd=m,__reflect(m.prototype,"Cmd.stGetMailFujianUserCmd");var c=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.NOTIFY_NEW_MAIL_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.size=e.readUnsignedByte()},i}(e);t.stNotifyNewMailUserCmd=c,__reflect(c.prototype,"Cmd.stNotifyNewMailUserCmd");var u=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RET_WRITE_MAIL_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.retcode=e.readUnsignedByte()},i}(e);t.stRetMailUserCmd=u,__reflect(u.prototype,"Cmd.stRetMailUserCmd")}(Cmd||(Cmd={}));var Cmd;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.byCmd=t.stNullUserCmd.OBJECT_USERCMD,i}return __extends(i,e),i.ONLINE_SEND_USER_OBJECT_USERCMD=1,i.ADD_USER_OBJECT_USERCMD=2,i.UPDATE_USER_OBJECT_USERCMD=3,i.REQ_BUY_OBJECT_USERCMD=5,i.RET_BUY_OBJECT_USERCMD=6,i.REQ_USE_OBJECT_USERCMD=7,i.RETURN_NEW_NAME_USERCMD_PARA=21,i.REQ_CHANGE_NAME_MODIFYNAME_USERCMD_PARA=22,i.REQ_CHANGE_NAME_VERIFY_USE_NAME_USERCMD_PARA=23,i.RET_CHANGE_NAME_VERIFY_USE_NAME_USERCMD_PARA=24,i.MATCH_GAME_END_SEND_OBJ_TYPE_TWO_USERCMD=25,i.REQ_CHANGE_NAME_TYPE_USERCMD=26,i}(t.stNullUserCmd);t.stObjectUserCmd=e,__reflect(e.prototype,"Cmd.stObjectUserCmd");var i=function(){function t(){}return t.prototype.deserialize=function(t){this.objid=t.readUnsignedInt(),this.num=t.readUnsignedInt()},t}();t.t_ObjData=i,__reflect(i.prototype,"Cmd.t_ObjData");var n=function(t){function n(){var i=t.call(this)||this;return i.byParam=e.ONLINE_SEND_USER_OBJECT_USERCMD,i.data=[],i}return __extends(n,t),n.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);for(var n,o=e.readUnsignedShort(),r=0;o>r;r++)n=new i,n.deserialize(e),this.data.push(n)},n}(e);t.onlineSendUserObjectUserCmd=n,__reflect(n.prototype,"Cmd.onlineSendUserObjectUserCmd");var o=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.ADD_USER_OBJECT_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.id=e.readUnsignedInt(),this.num=e.readUnsignedInt()},i}(e);t.addUserObjectUserCmd=o,__reflect(o.prototype,"Cmd.addUserObjectUserCmd");var r=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.UPDATE_USER_OBJECT_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.id=e.readUnsignedInt(),this.num=e.readUnsignedInt()},i}(e);t.updateUserObjectUserCmd=r,__reflect(r.prototype,"Cmd.updateUserObjectUserCmd");var s=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_BUY_OBJECT_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.objid),e.writeUnsignedInt(this.num)},i}(e);t.reqBuyObjectUserCmd=s,__reflect(s.prototype,"Cmd.reqBuyObjectUserCmd");var a=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RET_BUY_OBJECT_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.objid=e.readUnsignedInt()},i}(e);t.retBuyObjectUserCmd=a,__reflect(a.prototype,"Cmd.retBuyObjectUserCmd");var h=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_USE_OBJECT_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.id),e.writeUnsignedInt(this.num)},i}(e);t.reqUseObjectUserCmd=h,__reflect(h.prototype,"Cmd.reqUseObjectUserCmd");var m=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RETURN_NEW_NAME_USERCMD_PARA,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.name=UtilByteArray.readStr_MAX_NAMESIZE(e)},i}(e);t.stReturnNewNameUserCmd=m,__reflect(m.prototype,"Cmd.stReturnNewNameUserCmd");var c=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_CHANGE_NAME_MODIFYNAME_USERCMD_PARA,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.sex)},i}(e);t.stReqChangeNameModifyNameUserCmd=c,__reflect(c.prototype,"Cmd.stReqChangeNameModifyNameUserCmd");var u=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_CHANGE_NAME_VERIFY_USE_NAME_USERCMD_PARA,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),UtilByteArray.writeStr_MAX_NAMESIZE(e,this.name),e.writeByte(this.sex)},i}(e);t.stReqChangeNameVerifyUseNameUserCmd=u,__reflect(u.prototype,"Cmd.stReqChangeNameVerifyUseNameUserCmd");var l=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RET_CHANGE_NAME_VERIFY_USE_NAME_USERCMD_PARA,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.valid=e.readUnsignedByte(),this.name=UtilByteArray.readStr_MAX_NAMESIZE(e),this.sex=e.readUnsignedByte()},i}(e);t.stRetChangeNameVerifyUseNameUserCmd=l,__reflect(l.prototype,"Cmd.stRetChangeNameVerifyUseNameUserCmd");var p=function(t){function n(){var i=t.call(this)||this;return i.byParam=e.MATCH_GAME_END_SEND_OBJ_TYPE_TWO_USERCMD,i.data=[],i}return __extends(n,t),n.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.state=e.readBoolean(),this.countDay=e.readUnsignedShort();for(var n,o=e.readUnsignedByte(),r=0;o>r;r++)n=new i,n.deserialize(e),this.data.push(n)},n}(e);t.matchGameEndSendObjTypeTwoUserCmd=p,__reflect(p.prototype,"Cmd.matchGameEndSendObjTypeTwoUserCmd");var d=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_CHANGE_NAME_TYPE_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.type)},i}(e);t.reqChangeNameTypeUserCmd=d,__reflect(d.prototype,"Cmd.reqChangeNameTypeUserCmd")}(Cmd||(Cmd={}));var animation;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_xPS=0,e.m_yPS=0,e.m_xPD=0,e.m_yPD=0,e.m_x=0,e.m_y=0,e.m_tInit=0,e.m_tEnd=1,e}return __extends(e,t),e.prototype.setPos=function(t,e,i,n){this.m_xPS=t,this.m_yPS=e,this.m_xPD=i,this.m_yPD=n},e.prototype.setPS=function(t,e){this.m_xPS=t,this.m_yPS=e},e.prototype.setPD=function(t,e){this.m_xPD=t,this.m_yPD=e},e.prototype.distance=function(){return UtilMath.distance(this.m_xPS,this.m_yPS,this.m_xPD,this.m_yPD)},Object.defineProperty(e.prototype,"t",{get:function(){return this.m_t},set:function(t){this.m_t=t;var e=1-this.t;this.m_x=e*this.m_xPS,this.m_y=e*this.m_yPS,this.m_x+=this.t*this.m_xPD,this.m_y+=this.t*this.m_yPD},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.m_x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.m_y},enumerable:!0,configurable:!0}),e}(t.EquationBase);t.EquationBezierCurve1=e,__reflect(e.prototype,"animation.EquationBezierCurve1")}(animation||(animation={}));var animation;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_xPS=0,e.m_yPS=0,e.m_xP=0,e.m_yP=0,e.m_xPD=0,e.m_yPD=0,e.m_x=0,e.m_y=0,e.m_tInit=0,e.m_tEnd=1,e}return __extends(e,t),e.prototype.setPS=function(t,e){this.m_xPS=t,this.m_yPS=e},e.prototype.setP=function(t,e){this.m_xP=t,this.m_yP=e},e.prototype.setPD=function(t,e){this.m_xPD=t,this.m_yPD=e},e.prototype.getCurAngle=function(){var t=0,e=0,i=0,n=0,o=0,r=0;this.m_t<.97?(t=this.m_t,e=this.m_t+.01):(t=this.m_t-.01,e=this.m_t);var s=this.computePosByT(t);return i=s.x,n=s.y,s=this.computePosByT(e),o=s.x,r=s.y,UtilMath.getAngle(i,n,o,r)},e.prototype.computePosByT=function(t){var i=1-t,n=i*i;return e.s_helpPosByT.x=n*this.m_xPS,e.s_helpPosByT.y=n*this.m_yPS,n=2*t*i,e.s_helpPosByT.x+=n*this.m_xP,e.s_helpPosByT.y+=n*this.m_yP,n=t*t,e.s_helpPosByT.x+=n*this.m_xPD,e.s_helpPosByT.y+=n*this.m_yPD,e.s_helpPosByT},Object.defineProperty(e.prototype,"t",{get:function(){return this.m_t},set:function(t){this.m_t=t;var e=1-this.t,i=e*e;this.m_x=i*this.m_xPS,this.m_y=i*this.m_yPS,i=2*this.t*e,this.m_x+=i*this.m_xP,this.m_y+=i*this.m_yP,i=this.t*this.t,this.m_x+=i*this.m_xPD,this.m_y+=i*this.m_yPD},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.m_x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.m_y},enumerable:!0,configurable:!0}),e.s_helpPosByT=new egret.Point,e}(t.EquationBase);t.EquationBezierCurve2=e,__reflect(e.prototype,"animation.EquationBezierCurve2")}(animation||(animation={}));var animation;!function(t){var e=function(){function t(){}return t.easeIn=function(e,i,n,o){return e*e*((t.s+1)*e-t.s)},t.easeOut=function(e,i,n,o){return(e-=1)*e*((t.s+1)*e+t.s)+1},t.easeInOut=function(e,i,n,o){return(e*=2)<1?.5*(e*e*((1.525*t.s+1)*e-1.525*t.s)):.5*((e-=2)*e*((1.525*t.s+1)*e+1.525*t.s)+2)},t.s=1.70158,t}();t.Back=e,__reflect(e.prototype,"animation.Back")}(animation||(animation={}));var animation;!function(t){var e=function(){function t(){}return t.easeIn=function(e,i,n,o){return 1-t.easeOut(1-e,0,0,0)},t.easeOut=function(t,e,i,n){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},t.easeInOut=function(e,i,n,o){return(e*=2)<1?.5*t.easeIn(e,0,0,0):.5*t.easeOut(e-1,0,0,0)+.5},t}();t.Bounce=e,__reflect(e.prototype,"animation.Bounce")}(animation||(animation={}));var animation;!function(t){var e=function(){function t(){}return t.easeIn=function(t,e,i,n){return-(Math.sqrt(1-t*t)-1)},t.easeOut=function(t,e,i,n){return Math.sqrt(1-(t-1)*(t-1))},t.easeInOut=function(t,e,i,n){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},t}();t.Circular=e,__reflect(e.prototype,"animation.Circular")}(animation||(animation={}));var animation;!function(t){var e=function(){function t(){}return t.easeIn=function(t,e,i,n){return t*t*t},t.easeOut=function(t,e,i,n){return(t-=1)*t*t+1},t.easeInOut=function(t,e,i,n){return.5>t?4*t*t*t:4*(t-=1)*t*t+1},t}();t.Cubic=e,__reflect(e.prototype,"animation.Cubic")}(animation||(animation={}));var animation;!function(t){var e=function(){function t(){}return t.easeIn=function(e,i,n,o){return 0==e||1==e?e:-(t.a*Math.pow(2,10*(e-=1))*Math.sin((e-t.s)*(2*Math.PI)/t.p))},t.easeOut=function(e,i,n,o){return 0==e||1==e?e:t.a*Math.pow(2,-10*e)*Math.sin((e-t.s)*(2*Math.PI)/t.p)+1},t.easeInOut=function(e,i,n,o){return 0==e||1==e?e:(e=2*e-1,0>e?-.5*(t.a*Math.pow(2,10*e)*Math.sin((e-1.5*t.s)*(2*Math.PI)/(1.5*t.p))):.5*t.a*Math.pow(2,-10*e)*Math.sin((e-1.5*t.s)*(2*Math.PI)/(1.5*t.p))+1)},t.a=1,t.p=.3,t.s=t.p/4,t}();t.Elastic=e,__reflect(e.prototype,"animation.Elastic")}(animation||(animation={}));var animation;!function(t){var e=function(){function t(){}return t.easeIn=function(t,e,i,n){return 0==t?0:Math.pow(2,10*(t-1))},t.easeOut=function(t,e,i,n){return 1==t?1:1-Math.pow(2,-10*t)},t.easeInOut=function(t,e,i,n){return 0==t||1==t?t:0>(t=2*t-1)?.5*Math.pow(2,10*t):1-.5*Math.pow(2,-10*t)},t}();t.Exponential=e,__reflect(e.prototype,"animation.Exponential")}(animation||(animation={}));var animation;!function(t){var e=function(t){function e(i,n,o,r,s){void 0===i&&(i=null),void 0===n&&(n=1),void 0===o&&(o=null),void 0===r&&(r=null),void 0===s&&(s=null);var a=t.call(this)||this;return a._delay=0,a._paused=!0,a._position=0/0,a._inited=!1,a.autoPlay=!1,a.duration=0/0,a.reflect=!1,a.repeatCount=1,a.useFrames=!1,a.timeScale=1,a.positionOld=0/0,a.ratio=0/0,a.ratioOld=0/0,a.isUseAdvance=!1,a.calculatedPosition=0/0,a.calculatedPositionOld=0/0,a.suppressEvents=!1,a.dispatchEvents=!1,a.ease=e.defaultEase,a.dispatchEvents=e.defaultDispatchEvents,a.target=i,a.duration=n,a.pluginData=a.copy(s,{}),a.copy(r,a),a.resetValues(o),0==a.duration&&0==a.delay&&a.autoPlay&&(a.position=0),a}return __extends(e,t),e.linearEase=function(t,e,i,n){return t},e.staticInit=function(){e._lastTime=egret.getTimer(),egret.ticker?egret.ticker.$startTick(e.staticTick,null):egret.sys.$ticker.$startTick(e.staticTick,null)},e.staticTick=function(t){var i=.001*(t-e._lastTime);e._lastTime=t;var n,o=e.tickList.concat(),r=o.length,s=0;for(s=0;r>s;s++)n=o[s],n.position=n._position+(n.useFrames?1:i);return!1},Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){t!=this._paused&&(this._paused=t,this._paused?this.isUseAdvance||UtilArray.removeItem(e.tickList,this):((isNaN(this._position)||0!=this.repeatCount&&this._position>=this.repeatCount*this.duration)&&(this._inited=!1,this.calculatedPosition=this.calculatedPositionOld=this.ratio=this.ratioOld=this.positionOld=0,this._position=-this.delay),this.isUseAdvance||e.tickList.push(this)))},enumerable:!0,configurable:!0}),e.prototype.advanceTime=function(t){this._paused||(this.position=this._position+(this.useFrames?1:t))},Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){this.positionOld=this._position,this.ratioOld=this.ratio,this.calculatedPositionOld=this.calculatedPosition;var e=this.repeatCount*this.duration,i=t>=e&&this.repeatCount>0;if(i){if(this.calculatedPositionOld==e)return;this._position=e,this.calculatedPosition=!this.reflect||1&this.repeatCount?this.duration:0}else if(this._position=t,this.reflect){var n=this._position/this.duration,o=Math.floor(n);this._position<0?this.calculatedPosition=0:n==o?this.calculatedPosition=0:this.calculatedPosition=this._position%this.duration,1&o&&(this.calculatedPosition=this.duration-this.calculatedPosition)}else this.calculatedPosition=this._position<0?0:this._position%this.duration;if(this.ratio=0==this.duration&&this._position>=0?1:this.ease(this.calculatedPosition/this.duration,0,1,1),this.target&&(this._position>=0||this.positionOld>=0)&&this.calculatedPosition!=this.calculatedPositionOld){this._inited||this.init();for(var r in this._values){var s=this._initValues[r],a=this._rangeValues[r],h=s+a*this.ratio;this.target[r]=h}}this.suppressEvents||(this.dispatchEvents&&this.dispatchEvt("change"),null!=this.onChange&&this.onChange(this)),i&&(this.paused=!0,this.suppressEvents||(this.dispatchEvents&&this.dispatchEvt("complete"),null!=this.m_onComplete_callback&&this.m_onComplete_callback.apply(this.m_onComplete_this,this)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){return this._delay},set:function(t){this._position<=0&&(this._position=-t),this._delay=t},enumerable:!0,configurable:!0}),e.prototype.setValue=function(t,e){this._values[t]=e,this.invalidate()},e.prototype.getValue=function(t){return this._values[t]},e.prototype.setValues=function(t){this.copy(t,this._values,!0),this.invalidate()},e.prototype.resetValues=function(t){void 0===t&&(t=null),this._values={},this.setValues(t)},e.prototype.getValues=function(){return this.copy(this._values,{})},e.prototype.getInitValue=function(t){return this._initValues[t]},e.prototype.setCompleteCallback=function(t,e){this.m_onComplete_callback=t,this.m_onComplete_this=e},e.prototype.swapValues=function(){this._inited||this.init();var t=this._values;this._values=this._initValues,this._initValues=t;for(var e in this._rangeValues)this._rangeValues[e]*=-1;if(this._position<0){var i=this.positionOld;this.position=0,this._position=this.positionOld,this.positionOld=i}else this.position=this._position},e.prototype.init=function(){this._inited=!0,this._initValues={},this._rangeValues={};for(var t in this._values)this._rangeValues[t]=this._values[t]-(this._initValues[t]=this.target[t]);this.suppressEvents||(this.dispatchEvents&&this.dispatchEvt("init"),null!=this.onInit&&this.onInit(this))},e.prototype.beginning=function(){this.position=0,this.paused=!0},e.prototype.end=function(){this.position=this.repeatCount>0?this.repeatCount*this.duration:this.duration},e.prototype.invalidate=function(){this._inited=!1,this._position>0&&(this._position=0,this.calculatedPosition=0),this.autoPlay&&(this.paused=!1)},e.prototype.copy=function(t,e,i){void 0===i&&(i=!1);for(var n in t)i&&null==t[n]?delete e[n]:e[n]=t[n];return e},e.prototype.dispatchEvt=function(t){var e=this;e.hasEventListener(t)&&e.dispatchEvent(new egret.Event(t))},e.defaultDispatchEvents=!1,e.defaultEase=e.linearEase,e.tickList=[],e}(egret.EventDispatcher);t.GTween=e,__reflect(e.prototype,"animation.GTween")}(animation||(animation={}));var animation;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.easeNone=function(t,e,i,n){return t},e}(egret.HashObject);t.Linear=e,__reflect(e.prototype,"animation.Linear")}(animation||(animation={}));var animation;!function(t){var e=function(){function t(){}return t.easeIn=function(t,e,i,n){return t*t},t.easeOut=function(t,e,i,n){return-t*(t-2)},t.easeInOut=function(t,e,i,n){return.5>t?2*t*t:-2*t*(t-2)-1},t}();t.Quadratic=e,__reflect(e.prototype,"animation.Quadratic")}(animation||(animation={}));var animation;!function(t){var e=function(){function t(){}return t.easeIn=function(t,e,i,n){return t*t*t*t},t.easeOut=function(t,e,i,n){return 1-(t-=1)*t*t*t},t.easeInOut=function(t,e,i,n){return.5>t?8*t*t*t*t:-8*(t-=1)*t*t*t+1},t}();t.Quartic=e,__reflect(e.prototype,"animation.Quartic")}(animation||(animation={}));var animation;!function(t){var e=function(){function t(){}return t.easeIn=function(t,e,i,n){return t*t*t*t*t},t.easeOut=function(t,e,i,n){return 1+(t-=1)*t*t*t*t},t.easeInOut=function(t,e,i,n){return.5>t?16*t*t*t*t*t:16*(t-=1)*t*t*t*t+1},t}();t.Quintic=e,__reflect(e.prototype,"animation.Quintic")}(animation||(animation={}));var animation;!function(t){var e=function(){function t(){}return t.easeIn=function(t,e,i,n){return 1-Math.cos(t*(Math.PI/2))},t.easeOut=function(t,e,i,n){return Math.sin(t*(Math.PI/2))},t.easeInOut=function(t,e,i,n){return-.5*(Math.cos(t*Math.PI)-1)},t}();t.Sine=e,__reflect(e.prototype,"animation.Sine")}(animation||(animation={}));var core;!function(t){var e=function(){function t(){this.users=[],this.asynclist=[]}return t.prototype.isUnused=function(){return 0==this.users.length&&0==this.asynclist.length},t.prototype.onLoaded=function(t){this.data=t;for(var e=this.asynclist.length,i=0;e>i;i++){var n=this.asynclist[i];n.compFunc.call(n.thisObject,t,this.source)&&this.users.push(n.thisObject)}this.asynclist.length=0},t.prototype.getAsset=function(t,e){var i=!1;if(!this.data)if(RES.hasRes(this.source)){var n=RES.getRes(this.source);n&&(this.data=n)}else i=!0;if(this.data)t.call(e,this.data,this.source)&&this.users.push(e);else{var o={compFunc:t,thisObject:e};if(this.asynclist.push(o),i){var r=this.source;"http"!=r.substr(0,4)&&(r=Context.gameVersionController.getVirtualUrl(r)),RES.getResByUrl(r,this.onLoaded,this,RES.ResourceItem.TYPE_IMAGE)}else RES.getResAsync(this.source,this.onLoaded,this)}},t.prototype.unattach=function(t){if(this.data)UtilArray.removeItem(this.users,t);else{var e=this.asynclist.length,i=0;for(i=0;e>i;e++)this.asynclist[i].thisObject==t&&this.asynclist.splice(i,1)}},t.prototype.clear=function(){},t}();__reflect(e.prototype,"AssetItem");var i=function(){function t(){this.m_dicAsset={},this.m_dicSheet={},RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onResLOAD_ERROR,this)}return t.prototype.onResLOAD_ERROR=function(t){var e="资源下载失败:";t.resItem&&(e+=t.resItem.name+" url:"+t.resItem.url),Context.loadingView.isVisible()&&Context.logMgr.showError(e),Context.logMgr.sendServer(e)},t.prototype.getAsset=function(t,i,n){if(t.length>5){var o=t.substr(t.length-5);if("/.png"==o){var r=UtilCommon.getStackInfo("下载的资源是空 "+t);return void Context.logMgr.sendServer(r)}}var s=this.m_dicAsset[t];if(!s){var o=RES.hasRes(t);if(o&&t.indexOf(".")>=0)return void RES.getResAsync(t,i,n);s=new e,s.source=t,this.m_dicAsset[t]=s}s.getAsset(i,n)},t.prototype.unattach=function(t,e){var i=this.m_dicAsset[t];i&&(i.unattach(e),i.isUnused()&&(delete this.m_dicAsset[t],RES.hasRes(t)&&RES.destroyRes(t)))},t.prototype.getSnapshot=function(){var t,e="",i=0;for(t in this.m_dicAsset)e+=", "+t,i++;return i.toString()+"@"+e},t.prototype.profile=function(){console.log("Asset list:"),console.log(this.m_dicAsset)},t}();t.ImageAssetAdapter=i,__reflect(i.prototype,"core.ImageAssetAdapter",["eui.IAssetAdapter"])}(core||(core={}));var Cmd;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.byCmd=t.stNullUserCmd.TASK_USERCMD,i}return __extends(i,e),i.SEND_USER_TASK_CMD=1,i.REQ_EXECUTE_TASK_USER_CMD=2,i.REQ_TASK_DAY_REWARD_USER_CMD=3,i.SEND_MU_BIAO_TASK_DATA_PARA=11,i.UPDATE_MU_BIAO_TASK_DATA_PARA=12,i.GET_MU_BIAO_TASK_REWARD_PARA=13,i.RET_MU_BIAO_TASK_REWARD_RESULT_PARA=14,i.SEND_DAILY_TASK_DATA_USERCMD=21,i.UPDATE_DAILY_TASK_VALUE_USERCMD=22,i.GET_DAILY_TASK_VALUE_USERCMD=23,i.GET_WEEK_HUO_YUE_USERCMD=24,i}(t.stNullUserCmd);t.stQuestUserCmd=e,__reflect(e.prototype,"Cmd.stQuestUserCmd");var i=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SEND_USER_TASK_CMD,i.datas=[],i.task=[],i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.map=e.readUnsignedInt(),this.day=e.readUnsignedInt(),this.value=e.readUnsignedInt(),this.datas.length=0;for(var i=e.readUnsignedByte(),n=0;i>n;n++)this.datas.push(e.readUnsignedByte());for(var o=e.readUnsignedByte(),n=0;o>n;n++)this.task.push(e.readUnsignedByte())},i}(e);t.sendUserTaskCmd=i,__reflect(i.prototype,"Cmd.sendUserTaskCmd");var n=function(t){function i(){var i=t.call(this)||this;return i.task=0,i.byParam=e.REQ_EXECUTE_TASK_USER_CMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedShort(this.task)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.task=e.readUnsignedShort()},i}(e);t.reqExecuteTaskUserCmd=n,__reflect(n.prototype,"Cmd.reqExecuteTaskUserCmd");var o=function(t){function i(){var i=t.call(this)||this;return i.task=0,i.byParam=e.REQ_TASK_DAY_REWARD_USER_CMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e)},i}(e);t.reqTaskDayRewardUserCmd=o,__reflect(o.prototype,"Cmd.reqTaskDayRewardUserCmd");var r=function(t){function i(){var i=t.call(this)||this;return i.task=0,i.byParam=e.SEND_MU_BIAO_TASK_DATA_PARA,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.task=e.readUnsignedInt(),this.cur=e.readUnsignedInt()},i}(e);t.sendMuBiaoTaskDataUserCmd=r,__reflect(r.prototype,"Cmd.sendMuBiaoTaskDataUserCmd");var s=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.UPDATE_MU_BIAO_TASK_DATA_PARA,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.cur=e.readUnsignedInt()},i}(e);t.updateMuBiaoTaskDataUserCmd=s,__reflect(s.prototype,"Cmd.updateMuBiaoTaskDataUserCmd");var a=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.GET_MU_BIAO_TASK_REWARD_PARA,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e)},i}(e);t.getMuBiaoTaskRewardUserCmd=a,__reflect(a.prototype,"Cmd.getMuBiaoTaskRewardUserCmd");var h=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RET_MU_BIAO_TASK_REWARD_RESULT_PARA,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.result=e.readUnsignedByte()},i}(e);t.retMuBiaoTaskRewardResultUserCmd=h,__reflect(h.prototype,"Cmd.retMuBiaoTaskRewardResultUserCmd");var m=function(){function t(){this.id=0,this.state=0,this.value=0}return t}();t.meiriTaskData=m,__reflect(m.prototype,"Cmd.meiriTaskData");var c=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SEND_DAILY_TASK_DATA_USERCMD,i.huoyue=0,i.DailyTask=[],i.HuoYue=[],i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.huoyue=e.readUnsignedShort();for(var i,n=e.readUnsignedByte(),o=0;n>o;o++)i=new m,i.id=e.readUnsignedByte(),i.state=e.readUnsignedByte(),i.value=e.readUnsignedInt(),this.DailyTask.push(i);for(var r,s=e.readUnsignedByte(),o=0;s>o;o++)r=new Object,r.id=e.readUnsignedByte(),r.level=e.readUnsignedByte(),this.HuoYue.push(r)},i}(e);t.sendDailyTaskDataUserCmd=c,__reflect(c.prototype,"Cmd.sendDailyTaskDataUserCmd");var u=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.UPDATE_DAILY_TASK_VALUE_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.id=e.readUnsignedByte(),this.value=e.readUnsignedInt()},i}(e);t.updateDailyTaskValueUserCmd=u,__reflect(u.prototype,"Cmd.updateDailyTaskValueUserCmd");var l=function(t){function i(){var i=t.call(this)||this;return i.id=0,i.byParam=e.GET_DAILY_TASK_VALUE_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.id)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.id=e.readUnsignedByte()},i}(e);t.getDailyTaskValueUserCmd=l,__reflect(l.prototype,"Cmd.getDailyTaskValueUserCmd");var p=function(t){function i(){var i=t.call(this)||this;return i.id=0,i.viplevel=0,i.byParam=e.GET_WEEK_HUO_YUE_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.id),e.writeByte(this.viplevel)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.id=e.readUnsignedByte(),this.viplevel=e.readUnsignedByte()},i}(e);t.getWeekHuoYueUserCmd=p,__reflect(p.prototype,"Cmd.getWeekHuoYueUserCmd")}(Cmd||(Cmd={}));var dataset;!function(t){var e=function(){function e(){this._dic={}}return e.s_get=function(){return null==e.s_gc&&(e.s_gc=new t.GCCommon(e,5,null,null)),e.s_gc.getObject()},e.s_collect=function(t){t.clear(),e.s_gc.collect(t)},e.prototype.clear=function(){this._cmd=null,this._dic={}},e.prototype.parse=function(t){var e=UtilString.parseTokens(t);e.length>0&&(this._cmd=e[0]);var i=1,n=e.length;for(i=1;n>i+2;i+=3)this._dic[e[i]]=e[i+2]},Object.defineProperty(e.prototype,"cmd",{get:function(){return this._cmd},enumerable:!0,configurable:!0}),e.prototype.getValue=function(t){return this._dic[t]?this._dic[t]:null},e.prototype.getIntValue=function(t){var e=0,i=this.getValue(t);return null==i?0:e=parseInt(i,10)},e.prototype.getBooleanValue=function(t){var e=this.getValue(t);return null==e?!1:"true"==e.toLocaleLowerCase()?!0:!1},e.prototype.hasName=function(t){return this._dic.hasOwnProperty(t)},Object.defineProperty(e.prototype,"dic",{get:function(){return this._dic},enumerable:!0,configurable:!0}),e}();t.CmdParse=e,__reflect(e.prototype,"dataset.CmdParse")}(dataset||(dataset={}));var dataset;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_units=[],e}return __extends(e,t),e.prototype.add=function(t,e){this.m_units.push([t,e])},e.prototype.compute=function(){var t=this,e=new Promise(function(e,i){function n(){e()}t.m_index=0,Context.juggle.add(t),t.addEventListener(egret.Event.COMPLETE,n,null)});return e},e.prototype.advanceTime=function(t){if(this.m_index>=this.m_units.length)return Context.juggle.remove(this),this.dispatchEventWith(egret.Event.CHANGING,!1,1),void this.dispatchEventWith(egret.Event.COMPLETE);var e=this.m_units[this.m_index];e[0].call(e[1]),this.m_index++,this.dispatchEventWith(egret.Event.CHANGING,!1,this.m_index/this.m_units.length)},e.prototype.clear=function(){this.m_units=[]},e}(egret.EventDispatcher);t.ComputeProcess=e,__reflect(e.prototype,"dataset.ComputeProcess",["animation.IAnimatable"])}(dataset||(dataset={}));var dataset;!function(t){var e=function(){function t(){this.m_isAdvance1Min=!1,this.m_isJuggler=!1,this.m_advanceThis=null,this.m_advanceFun=null}return t.prototype.setAdvanceFunction=function(t,e){this.m_advanceThis=t,this.m_advanceFun=e},t.prototype.start=function(t){this.m_initPlatformTime=Context.timeMgr.platformTime_second,this.m_remainedTime=t,this.addToJuggler()},t.prototype.stop=function(){this.removeFromJuggler()},t.prototype.getCurTime=function(){var t=Context.timeMgr.platformTime_second-this.m_initPlatformTime;return t<this.m_remainedTime?this.m_remainedTime-t:0},Object.defineProperty(t.prototype,"timeIsUp",{get:function(){var t=Context.timeMgr.platformTime_second-this.m_initPlatformTime;
return t>=this.m_remainedTime},enumerable:!0,configurable:!0}),t.prototype.addToJuggler=function(){this.m_isJuggler||(this.m_isAdvance1Min?Context.juggle1min.add(this):Context.juggle.add(this),this.m_isJuggler=!0)},t.prototype.removeFromJuggler=function(){this.m_isJuggler&&(this.m_isAdvance1Min?Context.juggle1min.remove(this):Context.juggle.remove(this),this.m_isJuggler=!1)},Object.defineProperty(t.prototype,"isAdvance1Min",{set:function(t){this.m_isAdvance1Min!=t&&(this.m_isJuggler&&this.removeFromJuggler(),this.m_isAdvance1Min=t,this.m_isJuggler&&this.addToJuggler())},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.removeFromJuggler()},t.prototype.advanceTime=function(t){this.m_advanceThis&&this.m_advanceFun.call(this.m_advanceThis,this),this.timeIsUp&&this.stop()},t}();t.Daojishi=e,__reflect(e.prototype,"dataset.Daojishi",["animation.IAnimatable"])}(dataset||(dataset={}));var dataset;!function(t){var e=function(){function e(){this._dic={}}return e.s_get=function(){return null==e.s_gc&&(e.s_gc=new t.GCCommon(e,5,null,null)),e.s_gc.getObject()},e.s_collect=function(t){t.clear(),e.s_gc.collect(t)},e.prototype.clear=function(){this._dic={}},e.prototype.parse=function(t){var e=UtilString.parseTokens(t),i=0,n=e.length;for(i=0;n>i+2;i+=3)this._dic[e[i]]=e[i+2]},e.prototype.parseInt=function(t){var e=UtilString.parseTokens(t),i=0,n=e.length;for(i=0;n>i+2;i+=3)this._dic[e[i]]=parseInt(e[i+2])},e.prototype.getValue=function(t){return this._dic[t]?this._dic[t]:null},e.prototype.haseKey=function(t){return void 0!=this._dic[t]?!0:!1},e.prototype.getIntValue=function(t){var e=0,i=this.getValue(t);return null==i?0:e=parseInt(i)},e.prototype.getNumberValue=function(t){var e=0,i=this.getValue(t);return null==i?0:e=parseFloat(i)},e.prototype.getBooleanValue=function(t){var e=this.getValue(t);return null==e?!1:"true"==e.toLocaleLowerCase()?!0:!1},e.prototype.getInt16Value=function(t){var e,i=this.getValue(t);return null==i?0:e=parseInt(i,16)},Object.defineProperty(e.prototype,"dic",{get:function(){return this._dic},enumerable:!0,configurable:!0}),e}();t.KeyValueParse=e,__reflect(e.prototype,"dataset.KeyValueParse")}(dataset||(dataset={}));var dataset;!function(t){var e=function(){function t(t){void 0===t&&(t=1),this.m_unitSize=0,this.m_unitSize=t,this.m_list=new Array}return Object.defineProperty(t.prototype,"size",{get:function(){return this.m_list.length/this.m_unitSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unitSize",{get:function(){return this.m_unitSize},set:function(t){this.m_unitSize!=t&&(this.m_unitSize=t,this.m_list.length=0)},enumerable:!0,configurable:!0}),t.prototype.add=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=0,n=t.length;for(i=0;n>i;i++)this.m_list.push(t[i])},t.prototype.remove=function(t,e){void 0===e&&(e=1),t*=this.m_unitSize,this.m_list.splice(t,this.m_unitSize*e)},t.prototype.getTempUnit=function(e){null==t.s_helpList&&(t.s_helpList=new Array),t.s_helpList.length!=this.m_unitSize&&(t.s_helpList.length=this.m_unitSize),e*=this.m_unitSize;var i=0;for(i=0;i<this.m_unitSize;i++,e++)t.s_helpList[i]=this.m_list[e];return t.s_helpList},Object.defineProperty(t.prototype,"list",{get:function(){return this.m_list},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){var e=this.m_list.length;if(t.m_list.length!=e||this.m_unitSize!=t.m_unitSize)return!1;var i=0;for(i=0;e>i;i++)if(this.m_list[i]!=t.m_list[i])return!1;return!0},t.prototype.deserialize=function(t,e,i){void 0===i&&(i=1);var n=0;1==i?n=t.readUnsignedByte():2==i&&(n=t.readUnsignedShort()),this.unitSize=e.length;var o=0,r=0;for(o=0;n>o;o++){var s=UtilByteArray.deserialize(t,e),a=0;for(a=0;a<this.m_unitSize;a++,r++)this.m_list[r]=s[a]}},t}();t.ListNumber=e,__reflect(e.prototype,"dataset.ListNumber")}(dataset||(dataset={}));var dataset;!function(t){var e=function(){function t(){}return t}();__reflect(e.prototype,"Pair");var i=function(){function t(){this.m_list=[]}return t.prototype.value=function(t){for(var e=this.m_list.length,i=0;e>i;i++)if(this.m_list[i].key==t)return this.m_list[i].value;return null},t.prototype.key=function(t){for(var e=this.m_list.length,i=0;e>i;i++)if(this.m_list[i].value==t)return this.m_list[i].key;return null},t.prototype.add=function(t,i){if(!this.value(t)){var n=new e;n.key=t,n.value=i,this.m_list.push(n)}},t.prototype.removeByKey=function(t){for(var e=this.m_list.length,i=0;e>i;i++)this.m_list[i].key==t&&this.m_list.splice(i,1)},t.prototype.values=function(){for(var t=[],e=this.m_list.length,i=0;e>i;i++)t.push(this.m_list[i].value);return t},t}();t.MapBijection=i,__reflect(i.prototype,"dataset.MapBijection")}(dataset||(dataset={}));var dataset;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.m_bufferSize=0,i.m_capacity=0,i.m_size=0,i.m_head=0,i.m_tail=0,i.m_vec=[],i.m_bufferSize=e+1,i.m_vec.length=i.m_bufferSize,i.m_capacity=e,i.m_head=0,i.m_tail=0,i.m_size=0,i}return __extends(e,t),e.prototype.push=function(t){return this.m_capacity==this.m_size?!1:(this.m_vec[this.m_tail]=t,this.m_tail=(this.m_tail+1)%this.m_bufferSize,this.m_size++,!0)},e.prototype.pop=function(){if(0==this.m_size)return null;var t=this.m_vec[this.m_head];return this.m_vec[this.m_head]=null,this.m_head=(this.m_head+1)%this.m_bufferSize,this.m_size--,t},Object.defineProperty(e.prototype,"size",{get:function(){return this.m_size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFull",{get:function(){return this.m_capacity==this.m_size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0==this.m_size},enumerable:!0,configurable:!0}),e.prototype.getData=function(t){return t<this.m_size?this.m_vec[(t+this.m_head)%this.m_bufferSize]:null},e.prototype.setData=function(t,e){return t<this.m_size?this.m_vec[(t+this.m_head)%this.m_bufferSize]=e:void 0},e.prototype.findData=function(t){var e=0,i=this.m_size;for(e=0;i>e;e++)if(this.getData(e)==t)return e;return-1},e.prototype.getLastData=function(){return this.m_size>0?this.getData(this.m_size-1):null},e}(egret.HashObject);t.QueueVec=e,__reflect(e.prototype,"dataset.QueueVec")}(dataset||(dataset={}));var Cmd;!function(t){var e=function(){function t(){this.sex=0,this.zhanli=0,this.zuanshi=0,this.yinbi=0,this.yinbiEff=0,this.expEff=0,this.xiuwei=0,this.bossId=0,this.liehunValue=0,this.vipValue=0,this.regtime=0,this.level=0,this.guan=0,this.juqingID=0,this.vip=0,this.country=0,this.exp=0,this.nextexp=0}return t.prototype.deserialize=function(t){this.charid=t.readUnsignedInt(),this.name=UtilByteArray.readStr_MAX_NAMESIZE(t),this.guanqiaName=UtilByteArray.readStr_MAX_NAMESIZE(t),this.sex=t.readUnsignedByte(),this.zhanli=t.readUnsignedInt(),this.zuanshi=t.readUnsignedInt(),this.yinbi=t.readUnsignedInt(),this.mapid=t.readUnsignedInt(),this.yinbiEff=t.readUnsignedInt(),this.expEff=t.readUnsignedInt(),this.xiuwei=t.readUnsignedInt(),this.bossId=t.readUnsignedInt(),this.liehunValue=t.readUnsignedInt(),this.vipValue=t.readUnsignedInt(),this.regtime=t.readUnsignedInt(),this.level=t.readUnsignedShort(),this.guan=t.readUnsignedShort(),this.juqingID=t.readUnsignedShort(),this.vip=t.readUnsignedByte(),this.desvic=t.readUnsignedByte(),this.curvic=t.readUnsignedByte(),this.country=t.readUnsignedByte(),this.exp=t.readDouble(),this.nextexp=t.readDouble()},t}();t.MainData=e,__reflect(e.prototype,"Cmd.MainData")}(Cmd||(Cmd={}));var dataset;!function(t){var e=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.m_createFun=i,o.m_thisObj=n,o}return __extends(e,t),e.prototype.createObject=function(){return this.m_createFun.call(this.m_thisObj)},e.prototype.dispose=function(){this.m_createFun=null,t.prototype.dispose.call(this)},e}(t.ObjectGCBase);t.GCCreateFunction=e,__reflect(e.prototype,"dataset.GCCreateFunction")}(dataset||(dataset={}));var Cmd;!function(t){var e=function(e){function i(){var n=e.call(this)||this;return n.byCmd=t.stNullUserCmd.GAME_USERCMD,n.cmdCount=i.s_count++,n}return __extends(i,e),i.s_count=0,i.RETURN_USER_REG_SCENE_PARA=1,i.MAIN_USER_DATA_USERCMD_PARA=2,i.SYN_ONLINE_FIN_DATA_USERCMD=3,i.UPDATE_USER_YUANBAO_USERCMD_PARA=9,i.SEND_OFFLINE_REWARD_USERCMD_PARA=51,i.st0_CLOCK_USERCMD=52,i.REQ_SET_COMMONSET_USERCMD_PARA=55,i.RET_COMMONSET_USERCMD_PARA=56,i.REQ_RECHARGE_GAME_ORDER_USERCMD_PARA=57,i.ADD_RECHARGE_DOUBLE_REWARD_GOODSID_USERCMD_PARA=60,i.SEND_RECHARGE_DOUBLE_REWARD_GOODSID_LIST_USERCMD_PARA=61,i.NOTIFY_CLEAR_CHONG_ZHI_DANG_USERCMD=116,i.SEND_USER_PASS_USERCMD=118,i.REQ_INTO_MATCH_GAME_USERCMD=120,i.RET_INTO_MATCH_GAME_USERCMD=121,i.NOTIFY_MATCH_GAME_RESULT_USERCMD=122,i.UPDATE_MONEY_NUM_USERCMD=123,i.UPDATE_LOVE_NUM_USERCMD=124,i.UPDATE_STARS_USERCMD=125,i.REQ_OPEN_FURNITURE_MODEL_USERCMD=126,i.ONLINE_SEND_FURNITURE_DATA_USERCMD=127,i.REQ_FURNITURE_LEVEL_USERCMD=128,i.REQ_UPDATE_FURNITURE_USERCMD=129,i.ONLINE_SEND_FASHION_DATA_USERCMD=130,i.ONLINE_SEND_OPEN_FASHION_USERCMD=131,i.ONLINE_SEND_FASHION_DEBRIS_LIST_USERCMD=132,i.REQ_DRESS_FASHION_USERCMD=133,i.RET_DRESS_FASHION_USERCMD=134,i.UPDATE_USER_CHARM_VALUE_USERCMD=135,i.REQ_LEVEL_FASHION_USERCMD=136,i.ONLINE_SEND_USER_BOX_USERCMD=137,i.REQ_BUY_BOX_USERCMD=138,i.RET_BUY_BOX_USERCMD=139,i.ONLINE_SEND_VITALITY_VALUE_DATA_USERCMD=140,i.REQ_BUY_VITALITY_VALUE_USERCMD=141,i.UPDATE_VITALITY_VALUE_USERCMD=142,i.GET_VITALITY_ZHUAN_PAN_REWARD_USERCMD=143,i.SEND_FAKE_USER_DATA_USERCMD=144,i.REQ_OPEN_ACTION_USERCMD=145,i.RET_ACTION_END_REWARD_USERCMD=146,i.SEND_PK_FAKE_USER_DATA_USERCMD=147,i.REQ_OPNE_PK_FAKE_USER_USERCMD=148,i.RET_PK_FAKE_USER_CMDUSER=149,i.SEND_LOVE_COUNT_DOWN_USERCMD=150,i.REQ_BUY_LOVE_NUM_USERCMD=151,i.ONLINE_SEND_FRIENDS_SHARE_USERCMD=152,i.NOTIFY_FRIENDS_SHARE_END_USERCMD=153,i.UPDATE_FRIENDS_SHARE_COUNT_USERCMD=154,i.GET_PASS_SHARE_REWARD_USERCMD=155,i.REQ_OFFLINE_REWARD_USERCMD=157,i.RET_OFFLINE_REWARD_USERCMD=158,i.ONLINE_SEND_QIAN_DAO_DATA_USERCMD=159,i.REQ_QIAN_DAO_REWARD_USERCMD=160,i.REQ_ONLINE_MONEY_REWARD_DATA_USERCMD=161,i.RET_ONLINE_MONEY_REWARD_DATA_USERCMD=162,i.GET_ONLINE_MONEY_REWARD_DATA_USERCMD=163,i.SEND_USER_SHOU_CHONG_ENERGY_USERCMD=165,i.NOTIFY_USER_ADD_SHOU_CHONG_ENERGY_USERCMD=166,i.NOTIFY_USER_RECORD_TO_SERVER_USERCMD=167,i.REQ_CHANGE_SEX_USERCMD=168,i.SEND_USER_WATCH_VIDEO_AND_SHARE_USERCMD=170,i.UPDATE_USER_WATCH_VIDEO_OR_SHARE_USERCMD=171,i.SEND_USER_GET_MIN_DIAMOND_GIFT_COUNT_USERCMD=172,i.GET_MIN_DIAMOND_GIFT_USERCMD=173,i.SYN_INTO_GAME_SHARE_TYPE_USERCMD=174,i.SYN_USER_AD_SHARE_USERCMD=175,i.SYN_USER_WATCH_VIDEO_USERCMD=176,i.SEND_CLOSE_FUNCTION_LIST_USERCMD=177,i.SEND_USER_BUFF_LIST_USERCMD=178,i.SYN_ADD_BUFF_USERCMD=179,i.SYN_DELETE_BUFF_USERCMD=180,i.SET_MONEY_NUM_USERCMD=200,i.SET_FASHION_LEVEL_USERCMD=201,i.SET_ADD_OBJECT_USERCMD=202,i.SYN_AB_TEST_USER_VERSION_USERCMD=203,i.SYN_OS_TYPE_USERCMD=204,i.TEST_CONNECT_STATE_USERCMD=205,i}(t.stNullUserCmd);t.stSceneUserCmd=e,__reflect(e.prototype,"Cmd.stSceneUserCmd");var i=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RETURN_USER_REG_SCENE_PARA,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.byResult=e.readUnsignedByte()},i}(e);t.stReturnUserRegSceneCmd=i,__reflect(i.prototype,"Cmd.stReturnUserRegSceneCmd");var n=function(i){function n(){var n=i.call(this)||this;return n.byParam=e.MAIN_USER_DATA_USERCMD_PARA,n.maindata=new t.MainData,n}return __extends(n,i),n.prototype.deserialize=function(t){i.prototype.deserialize.call(this,t),this.maindata.deserialize(t)},n}(e);t.stMainUserDataUserCmd=n,__reflect(n.prototype,"Cmd.stMainUserDataUserCmd");var o=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SYN_ONLINE_FIN_DATA_USERCMD,i}return __extends(i,t),i}(e);t.synOnlineFinDataUserCmd=o,__reflect(o.prototype,"Cmd.synOnlineFinDataUserCmd");var r=function(t){function i(){var i=t.call(this)||this;return i.num=0,i.byParam=e.UPDATE_USER_YUANBAO_USERCMD_PARA,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.num=e.readUnsignedInt()},i}(e);t.stUpdateUserYuanbaoUserCmd=r,__reflect(r.prototype,"Cmd.stUpdateUserYuanbaoUserCmd");var s=function(t){function i(){var i=t.call(this)||this;return i.offlineTime=0,i.yinbi=0,i.guest=0,i.friends=0,i.byParam=e.SEND_OFFLINE_REWARD_USERCMD_PARA,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.offlineTime=e.readUnsignedInt(),this.yinbi=e.readUnsignedInt(),this.guest=e.readUnsignedInt(),this.friends=e.readUnsignedInt()},i}(e);t.sendOffLineRewardCmd=s,__reflect(s.prototype,"Cmd.sendOffLineRewardCmd");var a=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.st0_CLOCK_USERCMD,i}return __extends(i,t),i}(e);t.st0ClockUserCmd=a,__reflect(a.prototype,"Cmd.st0ClockUserCmd");var h=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_SET_COMMONSET_USERCMD_PARA,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedShort(this.state),e.writeByte(this.clear)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.state=e.readUnsignedShort(),this.clear=e.readUnsignedByte()},i}(e);t.stReqSetCommonSetUserCmd=h,__reflect(h.prototype,"Cmd.stReqSetCommonSetUserCmd");var m=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RET_COMMONSET_USERCMD_PARA,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);e.readUnsignedShort()},i}(e);t.stRetCommonSetUserCmd=m,__reflect(m.prototype,"Cmd.stRetCommonSetUserCmd");var c=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_RECHARGE_GAME_ORDER_USERCMD_PARA,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.goodsId)},i}(e);t.stReqRechargeGameOrderUserCmd=c,__reflect(c.prototype,"Cmd.stReqRechargeGameOrderUserCmd");var u=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.ADD_RECHARGE_DOUBLE_REWARD_GOODSID_USERCMD_PARA,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.goodsId=e.readUnsignedByte()},i}(e);t.addRechargeDoubleRewardGoodIdUserCmd=u,__reflect(u.prototype,"Cmd.addRechargeDoubleRewardGoodIdUserCmd");var l=function(t){function i(){var i=t.call(this)||this;return i.goodsIds={},i.byParam=e.SEND_RECHARGE_DOUBLE_REWARD_GOODSID_LIST_USERCMD_PARA,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);var i=e.readUnsignedByte(),n=0;for(n=0;i>n;n++){var o=e.readUnsignedByte();this.goodsIds[o]=!0}},i}(e);t.sendRechargeDoubleRewardGoodIdListUserCmd=l,__reflect(l.prototype,"Cmd.sendRechargeDoubleRewardGoodIdListUserCmd");var p=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.NOTIFY_CLEAR_CHONG_ZHI_DANG_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e)},i}(e);t.notifyClearChongZhiDangUserCmd=p,__reflect(p.prototype,"Cmd.notifyClearChongZhiDangUserCmd");var d=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SEND_USER_PASS_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.pass=e.readUnsignedInt()},i}(e);t.sendUserPassUserCmd=d,__reflect(d.prototype,"Cmd.sendUserPassUserCmd");var _=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_INTO_MATCH_GAME_USERCMD,i.data=[],i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.pass);var i=this.data.length;e.writeByte(i);for(var n=0;i>n;n++)e.writeUnsignedInt(this.data[n])},i}(e);t.reqIntoMatchGameUserCmd=_,__reflect(_.prototype,"Cmd.reqIntoMatchGameUserCmd");var f=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RET_INTO_MATCH_GAME_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.money=e.readUnsignedInt(),this.difficultyValue=e.readUnsignedInt()},i}(e);t.retIntoMatchGameUserCmd=f,__reflect(f.prototype,"Cmd.retIntoMatchGameUserCmd");var g=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.NOTIFY_MATCH_GAME_RESULT_USERCMD,i.buyObj=new Array(3),i.conObj=new Array(3),i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.addMoney),e.writeByte(this.gameResult),e.writeByte(this.quit),e.writeByte(this.isReviveCard),e.writeByte(this.revive),e.writeByte(this.diamonRevive),e.writeByte(this.isPassZhuanpan);for(var i=0;3>i;i++)this.diamondBuyObj[i].serialize(e);for(var i=0;3>i;i++)this.buyObj[i].serialize(e);for(var n=0;3>n;n++)this.conObj[n].serialize(e)},i}(e);t.notifyMatchGameResultUserCmd=g,__reflect(g.prototype,"Cmd.notifyMatchGameResultUserCmd");var y=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.UPDATE_MONEY_NUM_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.money=e.readUnsignedInt()},i}(e);t.updateMoneyNumUserCmd=y,__reflect(y.prototype,"Cmd.updateMoneyNumUserCmd");var C=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.UPDATE_LOVE_NUM_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.loveNum=e.readUnsignedByte()},i}(e);t.updateLoveNumUserCmd=C,__reflect(C.prototype,"Cmd.updateLoveNumUserCmd");var v=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.UPDATE_STARS_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.stars=e.readUnsignedInt()},i}(e);t.updateStarsUserCmd=v,__reflect(v.prototype,"Cmd.updateStarsUserCmd");var E=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_OPEN_FURNITURE_MODEL_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.id=e.readUnsignedInt(),this.changeid=e.readUnsignedInt()},i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.id),e.writeUnsignedInt(this.changeid)},i}(e);t.reqOpenFurnitureModelUserCmd=E,__reflect(E.prototype,"Cmd.reqOpenFurnitureModelUserCmd");var b=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.ONLINE_SEND_FURNITURE_DATA_USERCMD,i.list=[],i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.list.length=0;for(var i,n=e.readUnsignedByte(),o=0;n>o;o++)i=new T,i.deserialize(e),this.list.push(i)},i}(e);t.onlineSendFurnitureDataUserCmd=b,__reflect(b.prototype,"Cmd.onlineSendFurnitureDataUserCmd");var T=function(){function t(t){void 0===t&&(t=0),this.id=t,this.level=0,this.maxLevel=1,this.change=0,this.changeList=[]}return t.prototype.deserialize=function(t){this.id=t.readUnsignedInt(),this.level=t.readUnsignedInt(),this.maxLevel=t.readUnsignedInt(),this.change=t.readUnsignedInt();var e=t.readUnsignedByte();this.changeList.length=0;for(var i=0;e>i;i++)this.changeList.push(t.readUnsignedInt())},t}();t.FurnitureData=T,__reflect(T.prototype,"Cmd.FurnitureData");var S=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_FURNITURE_LEVEL_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.id=e.readUnsignedInt(),this.level=e.readUnsignedInt()},i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.id),e.writeUnsignedInt(this.level)},i}(e);t.reqFurnitureLevelUserCmd=S,__reflect(S.prototype,"Cmd.reqFurnitureLevelUserCmd");var M=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_UPDATE_FURNITURE_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.id=e.readUnsignedInt(),this.changeid=e.readUnsignedInt()},i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.id),e.writeUnsignedInt(this.changeid)},i}(e);t.reqUpdateFurnitureUserCmd=M,__reflect(M.prototype,"Cmd.reqUpdateFurnitureUserCmd");var x=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.ONLINE_SEND_FASHION_DATA_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.fashionId=e.readUnsignedByte(),this.fashionLevel=e.readUnsignedByte(),this.meiLi=e.readUnsignedInt()},i}(e);t.onlineSendFashionDataUserCmd=x,__reflect(x.prototype,"Cmd.onlineSendFashionDataUserCmd");var I=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.ONLINE_SEND_OPEN_FASHION_USERCMD,i.data=[],i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);for(var i,n=e.readUnsignedByte(),o=0;n>o;o++)i={},i.id=e.readUnsignedByte(),i.level=e.readUnsignedByte(),this.data.push(i)},i}(e);t.onlineSendOpenFashionUserCmd=I,__reflect(I.prototype,"Cmd.onlineSendOpenFashionUserCmd");var U=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.ONLINE_SEND_FASHION_DEBRIS_LIST_USERCMD,i.data=[],i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);for(var i=e.readUnsignedShort(),n=0;i>n;n++)this.data.push(e.readUnsignedInt())},i}(e);t.onlineSendFashionDebrisListUserCmd=U,__reflect(U.prototype,"Cmd.onlineSendFashionDebrisListUserCmd");var D=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_DRESS_FASHION_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.fashionId),e.writeByte(this.fashionLevel)},i}(e);t.reqDressFashionUserCmd=D,__reflect(D.prototype,"Cmd.reqDressFashionUserCmd");var A=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RET_DRESS_FASHION_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.fashionId=e.readUnsignedByte(),this.fashionLevel=e.readUnsignedByte()},i}(e);t.retDressFashionUserCmd=A,__reflect(A.prototype,"Cmd.retDressFashionUserCmd");var R=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.UPDATE_USER_CHARM_VALUE_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.charm=e.readUnsignedInt()},i}(e);t.updateUserCharmValueUserCmd=R,__reflect(R.prototype,"Cmd.updateUserCharmValueUserCmd");var P=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_LEVEL_FASHION_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.fashionId),e.writeByte(this.fashionLevel)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.fashionId=e.readUnsignedByte(),this.fashionLevel=e.readUnsignedByte()},i}(e);t.reqLevelFashionUserCmd=P,__reflect(P.prototype,"Cmd.reqLevelFashionUserCmd");var L=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.ONLINE_SEND_USER_BOX_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.jinBiBox=e.readUnsignedInt(),this.smallBoxLastTime=e.readUnsignedInt(),this.bigBoxLastTime=e.readUnsignedInt()},i}(e);t.onlineSendUserBoxUserCmd=L,__reflect(L.prototype,"Cmd.onlineSendUserBoxUserCmd");var w=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_BUY_BOX_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.type)},i}(e);t.reqBuyBoxUserCmd=w,__reflect(w.prototype,"Cmd.reqBuyBoxUserCmd");var O=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RET_BUY_BOX_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.type=e.readUnsignedByte(),this.flag=e.readUnsignedByte(),this.debris=e.readUnsignedInt()},i}(e);t.retBuyBoxUserCmd=O,__reflect(O.prototype,"Cmd.retBuyBoxUserCmd");var B=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.ONLINE_SEND_VITALITY_VALUE_DATA_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.vitalityValue=e.readUnsignedByte(),this.lastTime=e.readUnsignedInt()},i}(e);t.onlineSendVitalityValueDataUserCmd=B,__reflect(B.prototype,"Cmd.onlineSendVitalityValueDataUserCmd");var N=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_BUY_VITALITY_VALUE_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e)},i}(e);t.reqBuyVitalityValueUserCmd=N,__reflect(N.prototype,"Cmd.reqBuyVitalityValueUserCmd");var F=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.UPDATE_VITALITY_VALUE_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.vitalityValue=e.readUnsignedByte()},i}(e);t.updateVitalityValueUserCmd=F,__reflect(F.prototype,"Cmd.updateVitalityValueUserCmd");var k=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.GET_VITALITY_ZHUAN_PAN_REWARD_USERCMD,i.data=[],i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.state)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.state=e.readUnsignedByte(),this.type=e.readUnsignedByte();for(var i=e.readUnsignedByte(),n=0;i>n;n++)this.data.push(e.readUnsignedInt())},i}(e);t.getVitalityZhuanPanRewardUserCmd=k,__reflect(k.prototype,"Cmd.getVitalityZhuanPanRewardUserCmd");var j=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SEND_FAKE_USER_DATA_USERCMD,i.data=[],i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.name=UtilByteArray.readStr_MAX_NAMESIZE(e),this.bgid=e.readUnsignedInt(),this.zhengjie=e.readUnsignedByte(),this.fakeProfit=e.readUnsignedInt();for(var i,n=e.readUnsignedByte(),o=0;n>o;o++)i=new Object,i.id=e.readUnsignedInt(),i.level=e.readUnsignedByte(),i.change=e.readUnsignedInt(),this.data.push(i)},i}(e);t.sendFakeUserDataUserCmd=j,__reflect(j.prototype,"Cmd.sendFakeUserDataUserCmd");var G=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_OPEN_ACTION_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.type)},i}(e);t.reqOpenActionUserCmd=G,__reflect(G.prototype,"Cmd.reqOpenActionUserCmd");var z=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RET_ACTION_END_REWARD_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.type=e.readUnsignedByte(),this.victory=e.readUnsignedByte(),this.state=e.readUnsignedByte(),this.zuanshi=e.readUnsignedShort(),this.money=e.readUnsignedInt()},i}(e);t.retActionEndRewardUserCmd=z,__reflect(z.prototype,"Cmd.retActionEndRewardUserCmd");var H=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SEND_PK_FAKE_USER_DATA_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.name=UtilByteArray.readStr_MAX_NAMESIZE(e),this.fashionID=e.readUnsignedInt(),this.fashionLevel=e.readUnsignedInt(),this.fakeCharm=e.readUnsignedInt()},i}(e);t.sendPkFakeUserDataUserCmd=H,__reflect(H.prototype,"Cmd.sendPkFakeUserDataUserCmd");var V=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_OPNE_PK_FAKE_USER_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e)},i}(e);t.reqOpenPkFakeUserUserCmd=V,__reflect(V.prototype,"Cmd.reqOpenPkFakeUserUserCmd");var X=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RET_PK_FAKE_USER_CMDUSER,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.victory=e.readUnsignedByte(),this.money=e.readUnsignedInt(),this.zuanshi=e.readUnsignedShort(),this.state=e.readUnsignedByte()},i}(e);t.retPkFakeUserCmdUser=X,__reflect(X.prototype,"Cmd.retPkFakeUserCmdUser");var Y=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SEND_LOVE_COUNT_DOWN_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.loveCountDown=e.readUnsignedShort()},i}(e);t.sendLoveCountDownUserCmd=Y,__reflect(Y.prototype,"Cmd.sendLoveCountDownUserCmd");var W=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_BUY_LOVE_NUM_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.id)},i}(e);t.reqBuyLoveNumUserCmd=W,__reflect(W.prototype,"Cmd.reqBuyLoveNumUserCmd");var q=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.ONLINE_SEND_FRIENDS_SHARE_USERCMD,i.datas=[],i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.datas.length=0;for(var i=e.readUnsignedByte(),n=0;i>n;n++)this.datas.push({activity:e.readUnsignedByte(),count:e.readUnsignedByte()})},i}(e);t.onlineSendFriendsShareUserCmd=q,__reflect(q.prototype,"Cmd.onlineSendFriendsShareUserCmd");var Q=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.NOTIFY_FRIENDS_SHARE_END_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.activity)},i}(e);t.notifyFriendsShareEndUserCmd=Q,__reflect(Q.prototype,"Cmd.notifyFriendsShareEndUserCmd");var Z=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.UPDATE_FRIENDS_SHARE_COUNT_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.activity=e.readUnsignedByte(),this.count=e.readUnsignedByte()},i}(e);t.updateFriendsShareCountUserCmd=Z,__reflect(Z.prototype,"Cmd.updateFriendsShareCountUserCmd");var J=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.GET_PASS_SHARE_REWARD_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.type)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.type=e.readUnsignedByte(),this.result=e.readUnsignedByte()},i}(e);t.getPassShareRewardUserCmd=J,__reflect(J.prototype,"Cmd.getPassShareRewardUserCmd");var K=function(t){function i(){var i=t.call(this)||this;return i.share=1,i.byParam=e.REQ_OFFLINE_REWARD_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.share)},i}(e);t.reqOfflineRewardUserCmd=K,__reflect(K.prototype,"Cmd.reqOfflineRewardUserCmd");var $=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RET_OFFLINE_REWARD_USERCMD,i}return __extends(i,t),i}(e);t.retOfflineRewardUserCmd=$,__reflect($.prototype,"Cmd.retOfflineRewardUserCmd");var te=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.ONLINE_SEND_QIAN_DAO_DATA_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.today=e.readUnsignedByte(),this.day=e.readUnsignedByte()},i}(e);t.onlineSendQianDaoDataUserCmd=te,__reflect(te.prototype,"Cmd.onlineSendQianDaoDataUserCmd");var ee=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_QIAN_DAO_REWARD_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.day),e.writeByte(this.state)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.day=e.readUnsignedByte(),this.state=e.readUnsignedByte()},i}(e);t.reqQianDaoRewardUserCmd=ee,__reflect(ee.prototype,"Cmd.reqQianDaoRewardUserCmd");var ie=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_ONLINE_MONEY_REWARD_DATA_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e)},i}(e);t.reqOnlineMoneyRewardDataUserCmd=ie,__reflect(ie.prototype,"Cmd.reqOnlineMoneyRewardDataUserCmd");var ne=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.RET_ONLINE_MONEY_REWARD_DATA_USERCMD,i
}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.money=e.readUnsignedInt(),this.visitor=e.readUnsignedInt(),this.rewardMoney=e.readUnsignedInt()},i}(e);t.retOnlineMoneyRewardDataUserCmd=ne,__reflect(ne.prototype,"Cmd.retOnlineMoneyRewardDataUserCmd");var oe=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.GET_ONLINE_MONEY_REWARD_DATA_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.type)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.type=e.readUnsignedByte()},i}(e);t.getOnlineMoneyRewardDataUserCmd=oe,__reflect(oe.prototype,"Cmd.getOnlineMoneyRewardDataUserCmd");var re=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SEND_USER_SHOU_CHONG_ENERGY_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.energy=e.readUnsignedInt(),this.video=e.readUnsignedInt()},i}(e);t.sendUserShouChongEnergyUserCmd=re,__reflect(re.prototype,"Cmd.sendUserShouChongEnergyUserCmd");var se=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.NOTIFY_USER_ADD_SHOU_CHONG_ENERGY_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.type)},i}(e);t.notifyUserAddShouChongEnergyUserCmd=se,__reflect(se.prototype,"Cmd.notifyUserAddShouChongEnergyUserCmd");var ae=function(t){function i(){var i=t.call(this)||this;return i.func=1,i.byParam=e.NOTIFY_USER_RECORD_TO_SERVER_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.func),e.writeByte(this.type)},i}(e);t.notifyUserRecordToServerUserCmd=ae,__reflect(ae.prototype,"Cmd.notifyUserRecordToServerUserCmd");var he=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.REQ_CHANGE_SEX_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.sex)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.sex=e.readUnsignedByte()},i}(e);t.reqChangeSexUserCmd=he,__reflect(he.prototype,"Cmd.reqChangeSexUserCmd");var me=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SEND_USER_WATCH_VIDEO_AND_SHARE_USERCMD,i.data=[],i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);for(var i,n=e.readUnsignedByte(),o=0;n>o;o++)i=new Object,i.funID=e.readUnsignedByte(),i.watchCount=e.readUnsignedShort(),i.shareCount=e.readUnsignedShort(),this.data.push(i)},i}(e);t.sendUserWatchVideoAndShareUserCmd=me,__reflect(me.prototype,"Cmd.sendUserWatchVideoAndShareUserCmd");var ce=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.UPDATE_USER_WATCH_VIDEO_OR_SHARE_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.funID=e.readUnsignedByte(),this.watchCount=e.readUnsignedShort(),this.shareCount=e.readUnsignedShort()},i}(e);t.updateUserWatchVideoOrShareUserCmd=ce,__reflect(ce.prototype,"Cmd.updateUserWatchVideoOrShareUserCmd");var ue=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SEND_USER_GET_MIN_DIAMOND_GIFT_COUNT_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.count=e.readUnsignedByte(),this.lasttime=e.readUnsignedInt()},i}(e);t.sendUserGetMinDiamondGiftCountUserCmd=ue,__reflect(ue.prototype,"Cmd.sendUserGetMinDiamondGiftCountUserCmd");var le=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.GET_MIN_DIAMOND_GIFT_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.type)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.type=e.readUnsignedByte(),this.count=e.readUnsignedByte()},i}(e);t.getMinDiamondGiftUserCmd=le,__reflect(le.prototype,"Cmd.getMinDiamondGiftUserCmd");var pe=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SYN_INTO_GAME_SHARE_TYPE_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.fun),e.writeUnsignedInt(this.charid),UtilByteArray.writeStr(e,this.url,1)},i}(e);t.synIntoGameShareTypeUserCmd=pe,__reflect(pe.prototype,"Cmd.synIntoGameShareTypeUserCmd");var de=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SYN_USER_AD_SHARE_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.fun)},i}(e);t.synUserAnShareUserCmd=de,__reflect(de.prototype,"Cmd.synUserAnShareUserCmd");var _e=function(t){function i(){var i=t.call(this)||this;return i.flag=1,i.byParam=e.SYN_USER_WATCH_VIDEO_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.fun),e.writeByte(this.flag)},i}(e);t.synUserWatchVideoUserCmd=_e,__reflect(_e.prototype,"Cmd.synUserWatchVideoUserCmd");var fe=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SEND_CLOSE_FUNCTION_LIST_USERCMD,i.data=[],i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);for(var i=e.readUnsignedByte(),n=0;i>n;n++)this.data.push(e.readUnsignedInt())},i}(e);t.sendCloseFunctionListUserCmd=fe,__reflect(fe.prototype,"Cmd.sendCloseFunctionListUserCmd");var ge=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SEND_USER_BUFF_LIST_USERCMD,i.data=[],i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e);for(var i,n=e.readUnsignedByte(),o=0;n>o;o++)i=new Object,i.buff=e.readUnsignedInt(),i.time=e.readUnsignedInt(),this.data.push(i)},i}(e);t.sendUserBuffListUserCmd=ge,__reflect(ge.prototype,"Cmd.sendUserBuffListUserCmd");var ye=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SYN_ADD_BUFF_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.buff=e.readUnsignedInt(),this.time=e.readUnsignedInt()},i}(e);t.synAddBuffUserCmd=ye,__reflect(ye.prototype,"Cmd.synAddBuffUserCmd");var Ce=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SYN_DELETE_BUFF_USERCMD,i}return __extends(i,t),i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e),this.buff=e.readUnsignedInt()},i}(e);t.synDeleteBuffUserCmd=Ce,__reflect(Ce.prototype,"Cmd.synDeleteBuffUserCmd");var ve=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SET_MONEY_NUM_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.type),e.writeUnsignedInt(this.num)},i}(e);t.setMoneyNumUserCmd=ve,__reflect(ve.prototype,"Cmd.setMoneyNumUserCmd");var Ee=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SET_FASHION_LEVEL_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeByte(this.fashionId),e.writeByte(this.fashionLevel)},i}(e);t.setFashionLevelUserCmd=Ee,__reflect(Ee.prototype,"Cmd.setFashionLevelUserCmd");var be=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.SET_ADD_OBJECT_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.id),e.writeUnsignedInt(this.num)},i}(e);t.setAddObjObjectUserCmd=be,__reflect(be.prototype,"Cmd.setAddObjObjectUserCmd");var Te=function(t){function i(){var i=t.call(this)||this;return i.version=0,i.byParam=e.SYN_AB_TEST_USER_VERSION_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.version)},i}(e);t.synAbTestUserVersionUserCmd=Te,__reflect(Te.prototype,"Cmd.synAbTestUserVersionUserCmd");var Se=function(t){function i(){var i=t.call(this)||this;return i.osType=4,i.byParam=e.SYN_OS_TYPE_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e),e.writeUnsignedInt(this.osType)},i}(e);t.synOsTypeUserCmd=Se,__reflect(Se.prototype,"Cmd.synOsTypeUserCmd");var Me=function(t){function i(){var i=t.call(this)||this;return i.byParam=e.TEST_CONNECT_STATE_USERCMD,i}return __extends(i,t),i.prototype.serialize=function(e){t.prototype.serialize.call(this,e)},i.prototype.deserialize=function(e){t.prototype.deserialize.call(this,e)},i}(e);t.testConnectStateUserCmd=Me,__reflect(Me.prototype,"Cmd.testConnectStateUserCmd")}(Cmd||(Cmd={})),function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.id=t,this.num=e}return t.prototype.serialize=function(t){t.writeUnsignedInt(this.id),t.writeUnsignedInt(this.num)},t}();t.t_Obj=e,__reflect(e.prototype,"Cmd.t_Obj")}(Cmd||(Cmd={}));var dataset;!function(t){var e=function(){function e(e,i,n){this.m_listUsing=new Array,this.m_gc=new t.GCCreateFunction(e,i,n)}return e.prototype.add=function(){var t=this.m_gc.getObject();return t.setUser(this),this.m_listUsing.push(t),t},e.prototype.onItemComplete=function(t){var e=t,i=this.m_listUsing.indexOf(e);-1!=i&&this.m_listUsing.splice(i,1),this.m_gc.collect(e)},e.prototype.dispose=function(){var t,e;for(e in this.m_listUsing)t=this.m_listUsing[e],t.dispose();this.m_gc.dispose()},Object.defineProperty(e.prototype,"isListUsing_Empty",{get:function(){return 0==this.m_listUsing.length},enumerable:!0,configurable:!0}),e}();t.GCUsing=e,__reflect(e.prototype,"dataset.GCUsing",["dataset.IGCUser"])}(dataset||(dataset={}));var Cmd;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.byParam=t.stTimerUserCmd.GAME_MERGEZONE_TIME_USERCMD_PARA,i}return __extends(i,e),i.prototype.deserialize=function(t){e.prototype.deserialize.call(this,t),this.mergeservertime=t.readUnsignedInt()},i}(t.stTimerUserCmd);t.stGameMergeTimeUserCmd=e,__reflect(e.prototype,"Cmd.stGameMergeTimeUserCmd")}(Cmd||(Cmd={}));var Cmd;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.byParam=t.stTimerUserCmd.GAMETIME_TIMER_USERCMD_PARA,i}return __extends(i,e),i.prototype.deserialize=function(t){e.prototype.deserialize.call(this,t),this.qwGameTime=t.readUnsignedInt(),this.openservertime=t.readUnsignedInt()},i}(t.stTimerUserCmd);t.stGameTimeTimerUserCmd=e,__reflect(e.prototype,"Cmd.stGameTimeTimerUserCmd")}(Cmd||(Cmd={}));var core;!function(t){var e=function(t){function e(e,i,n,o){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=0),void 0===o&&(o=0);var r=t.call(this)||this;return r.m_curPlayTimes=1,r.m_timeScale=1,r.m_playType=0,r.m_gotoAndStopByTimeIsPlaying=!1,r.m_bDisposed=!1,r.m_dicPlayData={},r}return __extends(e,t),e.prototype._set_param=function(t,e){this.m_dss=t,this.m_dbName=e},e.prototype.set_armatureDisplay=function(t){this.m_armatureDisplay=t,this.addChild(t),t.addDBEventListener(dragonBones.EventObject.COMPLETE,this.on_ani_complete,this),this.m_playFun&&this.m_playFun.call(null)},e.prototype.on_ani_complete=function(){this.dispatchEventWith(egret.Event.COMPLETE)},e.prototype.onLoadFailed=function(){},e.prototype.hide=function(){this.parent&&(this.parent.removeChild(this),this.m_dss.onHideDB(this))},e.prototype.play=function(t,i){function n(){var e=o.m_armatureDisplay;e.name=t,e.animation.reset();var n=e.animation.play(t,i);n&&(n.timeScale=o.m_timeScale)}void 0===t&&(t=null),void 0===i&&(i=1),this.m_curActionsName=t,this.m_playType=e.PlayType_play,this.m_dicPlayData[e.PlayType_play]={actionsName:t,playTimes:i};var o=this;if(this.m_armatureDisplay){if(n(),this.animation&&this.animation.animations){var r=this.m_armatureDisplay,s="";r.armature&&r.armature.armatureData&&r.armature.armatureData.defaultAnimation&&(s=r.armature.armatureData.defaultAnimation.name),UtilDictionary.isEmpty(r.animation.animations)&&Context.logMgr.sendServer("DBones play warning! d.animation.animations isEmpty. defaultName="+s);var a=!0,h="";for(var m in r.animation.animations)m==s&&s&&(a=!1,h+="-"+m);a&&Context.logMgr.sendServer("DBones play warning! d.animation.animations no in! defaultName="+s+" logStr="+h)}}else this.m_playFun=n},e.prototype.delayPlay=function(t,e,i){void 0===e&&(e=200),void 0===i&&(i=1),egret.Tween.removeTweens(this);egret.Tween.get(this).wait(e).call(this.play,this,[t,i])},e.prototype.gotoAndMoveToPos=function(t,i,n,o,r){function s(){var e=a.m_armatureDisplay;e.name=t,e.animation.reset();var s=e.animation.play(t,0);s&&(s.timeScale=a.m_timeScale),egret.Tween.removeTweens(a),egret.Tween.get(a).to({x:i.x,y:i.y,scaleX:o,scaleY:r},n).call(a.on_ani_complete,a)}void 0===n&&(n=200),void 0===o&&(o=1),void 0===r&&(r=1),this.m_curActionsName=t,this.m_playType=e.PlayType_gotoAndMoveToPos,this.m_dicPlayData[this.m_playType]={actionsName:t,destPos:i,moveTime:n,desScaleX:o,desScaleY:r};var a=this;this.m_armatureDisplay?s():this.m_playFun=s},e.prototype.gotoAndStopByTime=function(t,i,n,o){function r(){var e=s.m_armatureDisplay;s.m_curActionsName||Context.logMgr.sendServer("gotoAndStopByTime() m_curActionsName is null! name"+s.dbName),e.name=t,s.addEventListener(egret.Event.ENTER_FRAME,s.onEnterFrame,s);var n=e.animation.gotoAndStopByTime(t,i);n&&(n.timeScale=s.m_timeScale),s.m_gotoAndStopByTimeIsPlaying=!0}void 0===i&&(i=0),void 0===n&&(n=null),void 0===o&&(o=null),this.m_curActionsName=t,this.m_playType=e.PlayType_gotoAndStopByTime,this.m_dicPlayData[this.m_playType]={actionsName:t,time:i,complete:n,thisObj:o};var s=this;this.m_armatureDisplay?r():this.m_playFun=r},e.prototype.gotoAndStopByProgress=function(t,i,n,o){function r(){var e=s.m_armatureDisplay;e.name=t;var n;s.addEventListener(egret.Event.ENTER_FRAME,s.onEnterFrame,s),n=e.animation.gotoAndStopByProgress(t,i),n&&(n.timeScale=s.m_timeScale),s.m_gotoAndStopByTimeIsPlaying=!0}void 0===i&&(i=0),void 0===n&&(n=null),void 0===o&&(o=null),this.m_curActionsName=t,this.m_playType=e.PlayType_gotoAndStopByTime,this.m_dicPlayData[this.m_playType]={actionsName:t,progress:i,complete:n,thisObj:o};var s=this;s.m_armatureDisplay?r():this.m_playFun=r},e.prototype.onEnterFrame=function(t){var i=t.target,n=i.m_armatureDisplay;if(n){this.m_curActionsName||Context.logMgr.sendServer("m_curActionsName is null! name"+this.m_dbName);var o=n.animation.getState(this.m_curActionsName);if(egret.log("onFrame name="+this.m_curActionsName+" totalTime="+o.totalTime+" curTime="+o.currentTime),this.m_gotoAndStopByTimeIsPlaying&&!o.isPlaying){this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this);var r=this.m_dicPlayData[e.PlayType_gotoAndStopByTime];r&&r.complete&&r.complete.call(r.thisObj,this)}}},e.prototype.clear=function(){if(!this.m_bDisposed){this.hide();var t=this.m_armatureDisplay;t&&(t.removeDBEventListener(dragonBones.EventObject.COMPLETE,this.on_ani_complete,this),egret.Tween.removeTweens(t),this.removeChild(t),t.dispose(),this.m_armatureDisplay=null,console.log("this.m_armatureDisplay = null")),this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.m_curActionsName=null,this.m_curPlayTimes=1,egret.Tween.removeTweens(this),UtilDictionary.clear(this.m_dicPlayData),this.m_bDisposed=!0,this.m_dss&&(this.m_dss.onClearDB(this),this.m_dss=null),this.m_playFun=null,this.m_dbName=""}},Object.defineProperty(e.prototype,"timeScale",{set:function(t){this.m_timeScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animation",{get:function(){var t=this.m_armatureDisplay;return t?t.animation:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"armatureDisplay",{get:function(){return this.m_armatureDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dbName",{get:function(){return this.m_dbName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPlaying",{get:function(){var t=this.m_armatureDisplay;return t&&t.animation?t.animation.isPlaying:!1},enumerable:!0,configurable:!0}),e.PlayType_play=0,e.PlayType_gotoAndMoveToPos=1,e.PlayType_gotoAndStopByTime=2,e.PlayType_fadeIn=3,e}(egret.DisplayObjectContainer);t.DBones=e,__reflect(e.prototype,"core.DBones")}(core||(core={}));var core;!function(t){var e=function(){function e(){this.m_dicDBSS={},this.m_dicConfig={},this.m_dbTexDataMgr=new t.DBTexDataMgr,this.m_dicDBPlay={}}return e.prototype.load=function(){this.m_zip=new JSZip;var t=RES.getRes("db_zip");this.m_zip.load(t,{}),this.m_factory=dragonBones.EgretFactory.factory},e.prototype.createDBones=function(e){var i=this.m_dicDBSS[e];return i||(i=dragonBones.BaseObject.borrowObject(t.DBonesSameNameMgr),i.m_isCleared=!1,i.set_param(this.m_factory,e),this.m_dicDBSS[e]=i),i.createDBones()},e.prototype.getDBConfig=function(t){var e=this.m_dicConfig[t];if(!e){var n=void 0,o=t+"_ske.json",r=this.m_zip.file(o);if(!r)return Context.logMgr.showError("缺少文件:"+o),null;var s=r.asText();n=JSON.parse(s);var a=void 0,h=t+"_tex.json",m=this.m_zip.file(h);if(!m)return Context.logMgr.showError("缺少文件:"+h),null;var s=m.asText();a=JSON.parse(s),e=new i(t,n,a),this.m_dicConfig[t]=e}return e},e.prototype.on_dss_clear=function(t){delete this.m_dicDBSS[t.name],t.returnToPool()},e}();t.DBonesMgr=e,__reflect(e.prototype,"core.DBonesMgr");var i=function(){function t(t,e,i){this.name=t,this.skeData=e,this.texData=i}return t}();__reflect(i.prototype,"DBConfig")}(core||(core={}));var core;!function(t){var e=function(e){function i(){var n=e.call(this)||this;return n.m_timeoutID=0,n.m_isCleared=!1,n.m_dbones_list=[],i.s_gc||(i.s_gc=new dataset.GCCommon(t.DBones,50)),n}return __extends(i,e),i.toString=function(){return"[class core.DBonesSameNameMgr]"},i.prototype._onClear=function(){this.m_imageLoader=null,this.m_dbConfig=null,this.name=null,this.m_factory=null,this.m_timeoutID=0},i.prototype.set_param=function(t,e){this.m_factory=t,this.name=e},i.prototype.createDBones=function(){if(!this.m_dbConfig){if(this.m_dbConfig=Context.dBonesMgr.getDBConfig(this.name),!this.m_dbConfig)return null;this.m_factory.getDragonBonesData(this.name)||this.m_factory.parseDragonBonesData(this.m_dbConfig.skeData)}var t=i.s_gc.getObject();if(t.m_bDisposed=!1,t._set_param(this,this.name),this.m_dbones_list.push(t),this.m_timeoutID&&(egret.clearTimeout(this.m_timeoutID),this.m_timeoutID=0),!this.m_factory.getTextureAtlasData(this.name)&&!this.m_imageLoader){var e=this.name+"_tex_png",n=!1;RES.getResourceInfo(e)?n=!0:e="resource/assets/db/"+this.name+"_tex.png",this.m_imageLoader=Context.imageLoaderMgr.load(e,this.onLoaded,this.onLoadFailed,this,n),this.m_imageLoader.increment(),this.m_imageLoader.loaded&&this.m_factory.parseTextureAtlasData(this.m_dbConfig.texData,this.m_imageLoader.texture)}return this.m_factory.getTextureAtlasData(this.name)&&this._buildDisplayForDB(t),t},i.prototype._buildDisplayForDB=function(t){var e=this.m_factory.buildArmatureDisplay(this.name);t.set_armatureDisplay(e)},i.prototype.onLoaded=function(t){this.m_factory.parseTextureAtlasData(this.m_dbConfig.texData,this.m_imageLoader.texture);for(var e=this.m_dbones_list,i=e.length,n=0;i>n;n++){var o=this.m_factory.buildArmatureDisplay(this.name);e[n].set_armatureDisplay(o)}},i.prototype.onLoadFailed=function(){for(var t=this.m_dbones_list,e=t.length,i=0;e>i;i++)t[i].onLoadFailed()},i.prototype.onHideDB=function(e){for(var i=this.m_dbones_list,n=i.length,o=0;n>o;o++)if(i[o].parent)return;var r=this.m_imageLoader;r&&r.loaded&&t.texture_clearGPUTexture(r.texture)},i.prototype.onClearDB=function(t){t.x=0,t.y=0,t.alpha=1,t.rotation=0,t.scaleX=1,t.scaleY=1,UtilArray.removeItem(this.m_dbones_list,t),0==this.m_dbones_list.length&&(egret.assert(0==this.m_timeoutID),this.m_timeoutID=egret.setTimeout(this.on_tryClear,this,15e3)),i.s_gc.collect(t)},i.prototype.on_tryClear=function(){if(this.m_timeoutID=0,0==this.m_dbones_list.length){egret.assert(0==this.m_isCleared),this.m_isCleared=!0;var t=this.m_imageLoader;t&&(Context.imageLoaderMgr.removeListener(this.m_imageLoader,this.onLoaded,this.onLoadFailed,this),t.loaded&&(this.m_factory.removeTextureAtlasData(this.name),this.m_factory.removeDragonBonesData(this.name)),t.discrease()),Context.dBonesMgr.on_dss_clear(this)}},i}(dragonBones.BaseObject);t.DBonesSameNameMgr=e,__reflect(e.prototype,"core.DBonesSameNameMgr")}(core||(core={}));var core;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(dataset.TimeResourceMgrBase);t.DBTexDataMgr=e,__reflect(e.prototype,"core.DBTexDataMgr")}(core||(core={}));var core;!function(t){var e=function(){function t(t,e){this.m_name=t,this.m_config=e,this.m_tEffectItem=Context.dataTableMgr.getItemByKey(Table.TABLE_EFFECT,t),this.m_sw=this.m_config.sw,this.m_sh=this.m_config.sh}return Object.defineProperty(t.prototype,"name",{get:function(){return this.m_name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tEffectItem",{get:function(){return this.m_tEffectItem},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this.m_config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nFrame",{get:function(){var t=this.m_config.frames;return t.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sw",{get:function(){return this.m_sw},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sh",{get:function(){return this.m_sh},enumerable:!0,configurable:!0}),t}();t.EffectConfig=e,__reflect(e.prototype,"core.EffectConfig")}(core||(core={}));var core;!function(t){var e=function(){function e(){this.m_dicConfig={}}return e.prototype.load=function(){this.m_zip=new JSZip;var t=RES.getRes("effect_zip");this.m_zip.load(t,{})},e.prototype.getModelConfig=function(e){var i=this.m_dicConfig[e];if(!i){var n=e+".json",o=this.m_zip.file(n);if(o){var r=this.m_zip.file(n).asText(),s=JSON.parse(r);i=new t.EffectConfig(e,s),this.m_dicConfig[e]=i}else Context.logMgr.showError("缺少文件:"+n)}return i},e}();t.EffectConfigMgr=e,__reflect(e.prototype,"core.EffectConfigMgr")}(core||(core={}));var core;!function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;i.m_gpuTexureUse=!1,i.m_mvList=[],i.m_effectConfig=Context.effectConfigMgr.getModelConfig(e);var n="resource/assets/effect/"+i.m_effectConfig.name+".png";if(Context.imageLoaderMgr.isLoaded(n))i.m_imageLoader=Context.imageLoaderMgr.getImageLoadItem(n),i.createTextures();else{if(Context.imageLoaderMgr.isLoadFailed(n))return i;i.m_imageLoader=Context.imageLoaderMgr.load(n,i.onLoaded,i.onLoadFailed,i)}return i.m_imageLoader&&i.m_imageLoader.increment(),i}return __extends(e,t),e.prototype.addMV=function(t){var e=this.m_mvList.indexOf(t);egret.assert(-1==e),this.m_mvList.push(t)},e.prototype.removeMV=function(t){var e=this.m_mvList.indexOf(t);egret.assert(e>=0),this.m_mvList.splice(e,1)},e.prototype.onUseTextures=function(t){this.m_gpuTexureUse||(this.m_gpuTexureUse=!0,this.m_imageLoader.useTextures())},e.prototype.onNotUseTextures=function(t){if(this.m_gpuTexureUse){var e=0,i=this.m_mvList.length;for(e=0;i>e;e++)if(this.m_mvList[e].getIsGPUTexureUse())return;this.m_gpuTexureUse=!1,this.m_imageLoader.disuseTextures()}},Object.defineProperty(e.prototype,"loaded",{get:function(){return this.m_imageLoader.loaded},enumerable:!0,configurable:!0}),e.prototype.onLoaded=function(){this.createTextures()},e.prototype.onLoadFailed=function(){},e.prototype.createTextures=function(){var t=this.m_imageLoader.texture,e=this.m_effectConfig.config,i=e.frames,n=i.length,o=0;this.m_textures=[];var r=e.sw,s=e.sh;for(o=0;n>o;o++){var a=i[o],h=a.frame,m=new egret.Texture;m.$bitmapData=t.bitmapData,m.$initData(h.x,h.y,h.w,h.h,a.sx,a.sy,r,s,t.$sourceWidth,t.$sourceHeight),this.m_textures[o]=m}},Object.defineProperty(e.prototype,"textures",{get:function(){return this.m_textures},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectConfig",{get:function(){return this.m_effectConfig},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){if(this.m_imageLoader&&(Context.imageLoaderMgr.removeListener(this.m_imageLoader,this.onLoaded,this.onLoadFailed,this),this.m_imageLoader.discrease(),this.m_imageLoader=null),this.m_effectConfig=null,this.m_mvList.length=null,this.m_textures){for(var e=this.m_textures.length,i=void 0,n=e-1;n>=0;n--)i=this.m_textures[n],i.dispose(),i=null;this.m_textures.length=0}t.prototype.dispose.call(this)},e}(dataset.TimeResourceBase);t.EffectData=e,__reflect(e.prototype,"core.EffectData")}(core||(core={}));var core;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.getModelData=function(e){var i=this.getResource(e);return i||(i=new t.EffectData(e)),i},i}(dataset.TimeResourceMgrBase);t.EffectDataMgr=e,__reflect(e.prototype,"core.EffectDataMgr")}(core||(core={}));var core;!function(t){var e=function(t){function e(e,i,n,o){void 0===i&&(i=null),void 0===n&&(n=0),void 0===o&&(o=0);var r=t.call(this)||this;r.m_dicMV={},r.m_dicEffData={},r.m_isAddToJuggle=!0,r.m_duration=0,r.m_currentTime=0,i&&i.addChild(r),r.x=n,r.y=o,r.touchEnabled=!1,r.m_name=e,r.addEventListener(egret.Event.REMOVED_FROM_STAGE,r.onRemoveFromStage,r),r.m_effConfig=Context.effectConfigMgr.getModelConfig(r.getDirName(0));try{var s=r.m_effConfig.nFrame;r.m_effTimer=new animation.AnimationTimer(s,s/r.m_effConfig.tEffectItem.m_duration),r.m_effTimer.stop()}catch(a){Context.system.logException(a),Context.logMgr.showError("错误:Effname="+e)}return r}return __extends(e,t),e.prototype.getDirName=function(t){return this.m_name+"_"+t},Object.defineProperty(e.prototype,"name",{get:function(){return this.m_name},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.parent&&this.parent.removeChild(this),this.stop(),this.clearMV(),this.m_isAddToJuggle&&Context.juggle.remove(this)},e.prototype.onRemoveFromStage=function(){this.clearMV()},e.prototype.clearMV=function(){this.m_mv&&(this.m_mv.parent&&this.m_mv.parent.removeChild(this.m_mv),this.m_mv=null);var t,e;for(t in this.m_dicMV)e=this.m_dicMV[t],e.dispose();this.m_dicMV={};var i;for(t in this.m_dicEffData)i=this.m_dicEffData[t],Context.effectDataMgr.removeUser(i,this);this.m_dicEffData={}},e.prototype.play=function(){this.m_effTimer.isPlaying||(this.m_currentTime=0,this.m_effTimer.currentFrame=0,this.m_effTimer.currentTime=0,this.m_effTimer.play(),this.m_isAddToJuggle&&Context.juggle.add(this))},e.prototype.hide=function(){this.stop(),this.m_mv&&this.m_mv.parent&&this.m_mv.parent.removeChild(this.m_mv)},e.prototype.show=function(){this.play(),this.m_mv&&this.m_mv.parent&&this.m_mv.parent.addChild(this.m_mv)},e.prototype.stop=function(){this.m_effTimer.stop(),this.m_isAddToJuggle&&Context.juggle.remove(this)},Object.defineProperty(e.prototype,"loop",{get:function(){return this.m_effTimer.loop},set:function(t){this.m_effTimer.loop=t},enumerable:!0,configurable:!0}),e.prototype.advanceTime=function(t){this.m_effTimer.advanceTime(t),this.m_currentTime+=t;var e=!1;this.m_effTimer.isComplete?(this.dispatchEventWith(egret.Event.COMPLETE),e=!0):this.m_duration>0&&this.m_currentTime>t&&(this.m_effTimer.stop(),this.dispatchEventWith(egret.Event.COMPLETE),e=!0),this.m_isAddToJuggle&&e&&Context.juggle.remove(this);var i=this.m_effTimer.currentFrame,n=this.m_dicMV[this.m_dir];if(null==n&&this.stage&&(n=this.createMV(this.m_dir)),this.m_mv!=n){if(this.m_mv&&this.m_mv.parent&&this.m_mv.parent.removeChild(this.m_mv),this.m_mv=n,null==this.m_mv)return;this.m_mv.parent||this.addChild(this.m_mv)}this.m_mv&&(this.m_mv.currentFrame=i)},e.prototype.createMV=function(t){var e=UtilModel.angle2ResAngle(t),i=this.m_dicEffData[e];i||(i=Context.effectDataMgr.getModelData(this.getDirName(e)),Context.effectDataMgr.addUser(i,this),this.m_dicEffData[e]=i);var n=this.m_dicMV[t];return n?void 0:i.loaded?(n=new scene.MovieClip_NoAni(i.textures,this.m_effConfig.sw,this.m_effConfig.sh),n.anchorOffsetX=i.effectConfig.tEffectItem.m_pivotX,n.anchorOffsetY=i.effectConfig.tEffectItem.m_pivotY,e!=t&&(n.scaleX=-1),0!=i.effectConfig.tEffectItem.m_scalePer&&100!=i.effectConfig.tEffectItem.m_scalePer&&(n.width=100*n.width/i.effectConfig.tEffectItem.m_scalePer,n.height=100*n.height/i.effectConfig.tEffectItem.m_scalePer),this.m_dicMV[t]=n,n):void 0},Object.defineProperty(e.prototype,"isAddToJuggle",{set:function(t){this.m_isAddToJuggle=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.m_duration},set:function(t){this.m_duration=t,this.m_effTimer.loop=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration_1",{get:function(){return this.m_effConfig.tEffectItem.m_duration},enumerable:!0,configurable:!0}),e.prototype.setParent=function(t){this.parent!=t&&t.addChild(this)},Object.defineProperty(e.prototype,"angle",{set:function(t){this.m_angle=t,this.m_dir=UtilModel.angle360ToDir8(t)},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);t.Effect8DirMovieClip=e,__reflect(e.prototype,"core.Effect8DirMovieClip")}(core||(core={}));var core;!function(t){var e=function(t){function e(e,i,n,o){void 0===i&&(i=null),void 0===n&&(n=0),void 0===o&&(o=0);var r=t.call(this)||this;r.m_isAddToJuggle=!0,r.m_duration=0,r.m_currentTime=0,r.m_delayTimeOfOverHide=0,r.m_gpuTexureUse=!1,i&&i.addChild(r),r.addEventListener(egret.Event.REMOVED_FROM_STAGE,r.onRemoveFromStage,r),r.addEventListener(egret.Event.ADDED_TO_STAGE,r.onAddToStage,r),r.x=n,r.y=o,r.touchEnabled=!1,r.touchChildren=!1,r.m_effConfig=Context.effectConfigMgr.getModelConfig(e);try{var s=r.m_effConfig.nFrame;r.m_effTimer=new animation.AnimationTimer(s,s/r.m_effConfig.tEffectItem.m_duration),r.m_effTimer.stop()}catch(a){Context.system.logException(a),Context.logMgr.showError("错误:Effname="+e)}return r}return __extends(e,t),Object.defineProperty(e.prototype,"effectName",{get:function(){return this.m_effConfig.name},enumerable:!0,configurable:!0}),e.prototype.increaseUseTextures=function(){this.m_mv&&!this.m_gpuTexureUse&&(this.m_gpuTexureUse=!0,this.m_effData.onUseTextures(this))},e.prototype.decreaseUseTextures=function(){this.m_mv&&this.m_gpuTexureUse&&(this.m_gpuTexureUse=!1,this.m_effData.onNotUseTextures(this))},e.prototype.getIsGPUTexureUse=function(){return this.m_gpuTexureUse},e.prototype.onRemoveFromStage=function(){this.decreaseUseTextures()},e.prototype.onAddToStage=function(){this.increaseUseTextures()},e.prototype.clearMV=function(){this.m_mv&&(this.m_mv.parent&&this.m_mv.parent.removeChild(this.m_mv),this.m_mv.dispose(),this.m_mv=null),this.m_effData&&(Context.effectDataMgr.removeUser(this.m_effData,this),this.m_effData.removeMV(this),this.m_effData=null)},e.prototype.dispose=function(){this.stop(),this.clearMV(),this.clearParent(),this.m_isAddToJuggle&&Context.juggle.remove(this)},e.prototype.play=function(){this.m_effTimer.isPlaying||(this.m_currentTime=0,this.m_effTimer.currentFrame=0,this.m_effTimer.currentTime=0,this.m_effTimer.play(),this.m_isAddToJuggle&&Context.juggle.add(this))},e.prototype.hide=function(){this.stop(),this.m_mv&&this.m_mv.parent&&this.m_mv.parent.removeChild(this.m_mv)},e.prototype.show=function(){this.m_effTimer.isPlaying||(this.play(),this.m_mv&&this.m_mv.parent&&this.m_mv.parent.addChild(this.m_mv))},e.prototype.stop=function(){this.m_effTimer.stop(),this.m_isAddToJuggle&&Context.juggle.remove(this)},Object.defineProperty(e.prototype,"delayTimeOfOverHide",{set:function(t){this.m_delayTimeOfOverHide=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this.m_effTimer.loop},set:function(t){this.m_effTimer.loop!=t&&(this.m_effTimer.loop=t)},enumerable:!0,configurable:!0}),e.prototype.advanceTime=function(t){this.m_effTimer.advanceTime(t),this.m_currentTime+=t;var e=!1;if(this.m_effTimer.isComplete?(this.dispatchEventWith(egret.Event.COMPLETE),e=!0):this.m_duration>0&&this.m_currentTime>t&&(this.m_effTimer.stop(),this.dispatchEventWith(egret.Event.COMPLETE),e=!0),e)return void(this.m_delayTimeOfOverHide>0?(this.stop(),egret.setTimeout(this.hide,this,this.m_delayTimeOfOverHide)):this.hide());var i=this.m_effTimer.currentFrame;null==this.m_mv&&this.stage&&this.createMV(),null!=this.m_mv&&(this.m_mv.parent||this.addChild(this.m_mv),this.m_mv.currentFrame=i)
},e.prototype.createMV=function(){null==this.m_effData&&(this.m_effData=Context.effectDataMgr.getModelData(this.m_effConfig.name),Context.effectDataMgr.addUser(this.m_effData,this),this.m_effData.addMV(this)),this.m_mv||this.m_effData.loaded&&(this.m_mv=new scene.MovieClip_NoAni(this.m_effData.textures,this.m_effConfig.sw,this.m_effConfig.sh),this.m_mv.anchorOffsetX=this.m_effConfig.tEffectItem.m_pivotX,this.m_mv.anchorOffsetY=this.m_effConfig.tEffectItem.m_pivotY,0!=this.m_effConfig.tEffectItem.m_scalePer&&100!=this.m_effConfig.tEffectItem.m_scalePer&&(this.m_mv.width=100*this.m_mv.width/this.m_effConfig.tEffectItem.m_scalePer,this.m_mv.height=100*this.m_mv.height/this.m_effConfig.tEffectItem.m_scalePer),this.increaseUseTextures())},e.prototype.$hitTest=function(t,e){return null},e.prototype.hitTestPoint=function(t,e,i){return!1},Object.defineProperty(e.prototype,"isAddToJuggle",{set:function(t){this.m_isAddToJuggle=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.m_duration},set:function(t){this.m_duration=t,this.m_effTimer.loop=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration_1",{get:function(){return this.m_effConfig.tEffectItem.m_duration},enumerable:!0,configurable:!0}),e.prototype.setParent=function(t){this.parent!=t&&t.addChild(this)},e.prototype.clearParent=function(){this.parent&&this.parent.removeChild(this)},Object.defineProperty(e.prototype,"isPlaying",{get:function(){return this.m_effTimer.isPlaying},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);t.EffectMovieclip=e,__reflect(e.prototype,"core.EffectMovieclip")}(core||(core={}));var imageLoad;!function(t){var e=0,i=1,n=2,o=3,r=function(r){function s(){var t=r.call(this)||this;return t.m_loadState=e,t.m_useCount=0,t.m_isDisposed=!1,t.m_gpuTextureUseCount=0,t}return __extends(s,r),s.prototype.reset=function(){this.m_loadState=e,this.m_texture=null,this.m_url=null,this.m_isDisposed=!1},s.prototype.loadFile=function(t,e){if(void 0===e&&(e=!1),this.m_url=t,this.m_is_in_defalt_res=e,e){var i=RES.getRes(t);i?this.onLoaded_in_defalt_res(i,t):RES.getResByUrl(t,this.onLoaded_in_defalt_res,this)}else s.lowMgr.load(t,this.onLoadFinish,this.onLoadFailed,this)},s.prototype.onLoaded_in_defalt_res=function(t,e){var i=RES.getRes(this.m_url);i?(this.m_loadState=o,this.m_texture=i,i.$bitmapData.$deleteSource=!1,s.s_nTotalTexture++,s.s_sizeTotalTexture+=this.m_texture.$sourceWidth*this.m_texture.$sourceHeight,this.dispatchEventWith(egret.Event.COMPLETE,!1,this.m_texture)):this.m_loadState=n},s.prototype.onLoadFailed=function(){this.m_loadState=n},s.prototype.onLoadFinish=function(t){this.m_loadState=o,t instanceof egret.BitmapData&&(t.$deleteSource=!1),s.s_nTotalTexture++,this.m_texture=new egret.Texture,this.m_texture._setBitmapData(t),s.s_sizeTotalTexture+=this.m_texture.$sourceWidth*this.m_texture.$sourceHeight,this.dispatchEventWith(egret.Event.COMPLETE,!1,this.m_texture)},Object.defineProperty(s.prototype,"loaded",{get:function(){return this.m_loadState==o},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"loadFailed",{get:function(){return this.m_loadState==n},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"loading",{get:function(){return this.m_loadState==i},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"texture",{get:function(){return this.m_texture},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"url",{get:function(){return this.m_url},enumerable:!0,configurable:!0}),s.prototype.increment=function(){this.m_useCount++},s.prototype.discrease=function(){this.m_useCount--,this.m_useCount<=0&&(this.dispose(),this.m_is_in_defalt_res&&RES.hasRes(this.m_url)&&RES.destroyRes(this.m_url),s.s_mgr.unload(this))},s.prototype.dispose=function(){this.m_texture&&(s.s_sizeDisposeTexture-=this.m_texture.$sourceWidth*this.m_texture.$sourceHeight,s.s_nDisposeTexture++,this.m_texture.dispose(),this.m_texture=null),s.lowMgr.unLoad(this),this.m_isDisposed=!0},s.prototype.disuseTextures=function(){this.m_gpuTextureUseCount--,this.m_gpuTextureUseCount<=0&&this.m_texture&&core.texture_clearGPUTexture(this.m_texture)},s.prototype.useTextures=function(){this.m_gpuTextureUseCount++},s.prototype.getIsDisposed=function(){return this.m_isDisposed},s.lowMgr=new t.LowImageLoadMgr,s.s_nTotalTexture=0,s.s_nDisposeTexture=0,s.s_sizeTotalTexture=0,s.s_sizeDisposeTexture=0,s.s_gc=new dataset.GCCommon(s,40,null,null),s}(egret.EventDispatcher);t.ImageLoadItem=r,__reflect(r.prototype,"imageLoad.ImageLoadItem")}(imageLoad||(imageLoad={}));var imageLoad;!function(t){var e=function(){function e(){this.m_items={},this.m_count=0,t.ImageLoadItem.s_mgr=this}return e.prototype.load=function(e,i,n,o,r){void 0===r&&(r=!1);var s=this.m_items[e];return s&&(s.loaded||s.loadFailed)?s:(s||(s=t.ImageLoadItem.s_gc.getObject(),s.reset(),s.loadFile(e,r),this.m_items[e]=s,this.m_count++),s.once(egret.Event.COMPLETE,i,o),s.once(egret.IOErrorEvent.IO_ERROR,n,o),s)},e.prototype.removeListener=function(t,e,i,n){t.removeEventListener(egret.Event.COMPLETE,e,n),t.removeEventListener(egret.IOErrorEvent.IO_ERROR,i,n)},e.prototype.unload=function(e){var e=this.m_items[e.url];e&&(this.m_count--,delete this.m_items[e.url],t.ImageLoadItem.s_gc.collect(e))},e.prototype.isLoaded=function(t){var e=this.m_items[t];return e&&e.loaded},e.prototype.isLoadFailed=function(t){var e=this.m_items[t];return e&&e.loadFailed},e.prototype.getImageLoadItem=function(t){var e=this.m_items[t];return e},e}();t.ImageLoadMgr=e,__reflect(e.prototype,"imageLoad.ImageLoadMgr")}(imageLoad||(imageLoad={}));var Main=function(t){function e(){var e=t.call(this)||this;return Context.bzConfig=new common.BZConfig,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),Context.system=new core.System,Context.logMgr=new common.logMgr,Context.monitorDataMgr=new common.MonitorDataMgr,core.initUIComponent(),core.initTexture(),e}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.ImageLoader.crossOrigin="anonymous";var e=egret.StageScaleMode.SHOW_ALL;egret.Capabilities.isMobile&&(this.stage.orientation=egret.OrientationMode.PORTRAIT,e=egret.StageScaleMode.FIXED_NARROW),this.stage.scaleMode=e,Context.gameAreaMgr=new core.GameAreaMgr(this),Context.stage=this.stage,Context.width=Context.stage.stageWidth,Context.height=Context.stage.stageHeight,Context.logMgr.addLog("stage width="+Context.stage.stageWidth),Context.logMgr.addLog("stage height="+Context.stage.stageHeight),Context.juggle=new animation.Juggler,animation.GTween.staticInit(),this.stage.addEventListener(egret.Event.RESIZE,this.onStageResize,this),this.stage.addEventListener(egret.Event.ACTIVATE,this.onActivate,this),this.stage.addEventListener(egret.Event.DEACTIVATE,this.onDeactivate,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this),Context.loginCC=new Login.LoginLoadControl,Context.loginCC.begin()},e.prototype.onStageResize=function(){Context.gameAreaMgr.adjustWindowPos()},e.prototype.onActivate=function(){Context.system.isActivate=!0,Context.loginCC.m_finalMsgreceived&&(Context.logMgr.addLog("game onActivate() connected="+Context.gatewayServer.connected),Context.soundMgr&&Context.soundMgr.playAll(),Context.playerMgr.updateStateActivate(!0)),platform.triggerGC()},e.prototype.onDeactivate=function(){Context.system.isActivate=!1,Context.logMgr.addLog("game onDeactivate()"),Context.soundMgr&&Context.soundMgr.stopAll(),Context.loginCC.m_finalMsgreceived&&(Context.playerMgr.updateStateActivate(!1),Context.monitorDataMgr.updateStateActivate(!1))},e.prototype.onTouchTab=function(t){if(Context.loginCC.m_finalMsgreceived&&t.target instanceof eui.Button){var e=this.m_btnClickDB;e||(e=Context.dBonesMgr.createDBones("dianji"),e.scaleX=.5,e.scaleY=.5,e.addEventListener(egret.Event.COMPLETE,this.on_btnClickDB_complete,this),this.m_btnClickDB=e),e.parent||Context.uimgr.getFourthLayer().addChild(e),e.x=t.stageX,e.y=t.stageY,e.play()}},e.prototype.on_btnClickDB_complete=function(){this.m_btnClickDB.hide()},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var core;!function(t){var e=function(){function t(){}return t.prototype.send=function(t,e,i,n){this.m_request=new egret.HttpRequest,this.m_request.responseType=egret.HttpResponseType.TEXT,this.m_request.once(egret.Event.COMPLETE,e,n),this.m_request.once(egret.IOErrorEvent.IO_ERROR,i,n),this.m_request.open(t,egret.HttpMethod.GET),this.m_request.send()},t.prototype.getResponse=function(){return this.m_request.response},t}();t.HttpRequest_get=e,__reflect(e.prototype,"core.HttpRequest_get")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.prototype.send=function(t,e,i,n,o){this.m_request=new egret.HttpRequest,this.m_request.responseType=egret.HttpResponseType.TEXT,this.m_request.once(egret.Event.COMPLETE,i,o),this.m_request.once(egret.IOErrorEvent.IO_ERROR,n,o),this.m_request.open(t,egret.HttpMethod.POST),this.m_request.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.m_request.send(e)},t.prototype.getResponse=function(){return this.m_request.response},t}();t.HttpRequest_post=e,__reflect(e.prototype,"core.HttpRequest_post")}(core||(core={}));var Network;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.m_head=0,i.m_tail=0,i.m_max=0,i.m_count=0,i.m_MaxBytes=0,i.init(),i.m_max=t,i.m_CircleBuffer.length=t,i}return __extends(i,e),i.prototype.init=function(){this.m_CircleBuffer=new egret.ByteArray,this.m_CircleBuffer.endian=egret.Endian.LITTLE_ENDIAN,this.m_dataTmp=new egret.ByteArray,this.m_dataTmp.endian=egret.Endian.LITTLE_ENDIAN,this.m_head=0,this.m_tail=0,this.m_max=0,this.m_count=0,this.m_MaxBytes=8388608},i.prototype.Write=function(t,e){var i=0;if(this.m_count+e>this.m_max-1){var n=this.m_max;do n*=2;while(this.m_count+e>n-1);if(n>this.m_MaxBytes)return n/=2,!1;if(this.m_CircleBuffer.length=n,this.m_tail<this.m_head){var o=this.m_CircleBuffer.length-this.m_max;this.m_tail>=o?(i=this.m_tail-o,this.m_CircleBuffer.position=0,this.m_CircleBuffer.readBytes(this.m_dataTmp,0,o),this.m_CircleBuffer.position=this.m_max,this.m_CircleBuffer.writeBytes(this.m_dataTmp,0,o),this.m_tail=i):(this.m_CircleBuffer.position=0,this.m_CircleBuffer.readBytes(this.m_dataTmp,0,this.m_tail),this.m_CircleBuffer.position=this.m_max,this.m_CircleBuffer.writeBytes(this.m_dataTmp,0,this.m_tail),this.m_tail=this.m_max+this.m_tail)}this.m_max=this.m_CircleBuffer.length}return this.m_count+=e,this.m_tail+e>this.m_max?(i=e-(this.m_max-this.m_tail),this.m_CircleBuffer.position=this.m_tail,this.m_CircleBuffer.writeBytes(t,0,this.m_max-this.m_tail),this.m_CircleBuffer.position=0,this.m_CircleBuffer.writeBytes(t,this.m_max-this.m_tail,i),this.m_tail=i):(this.m_CircleBuffer.position=this.m_tail,this.m_CircleBuffer.writeBytes(t,0,e),this.m_tail+=e),!0},i.prototype.read=function(t,e){if(t.position=0,e<=this.m_max-this.m_head)this.m_CircleBuffer.position=this.m_head,this.m_CircleBuffer.readBytes(t,0,e),this.m_head+=e,this.m_head%=this.m_max;else{this.m_CircleBuffer.position=this.m_head;var i=e-(this.m_max-this.m_head);this.m_CircleBuffer.readBytes(t,0,this.m_max-this.m_head),this.m_CircleBuffer.position=0,this.m_CircleBuffer.readBytes(t,this.m_max-this.m_head,i),this.m_head=i,this.m_head%=this.m_max}this.m_count-=e},i.prototype.readOneMsg=function(t){if(0==this.hasCompleteMsg())return 0;var e=this.msgLengthWithHead;return this.read(t,e),e},Object.defineProperty(i.prototype,"dataLength",{get:function(){return(this.m_tail+this.m_max-this.m_head)%this.m_max},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"msgLengthWithHead",{get:function(){var e=this.dataLength;if(e>=4){var i=void 0;if(this.m_CircleBuffer.position=this.m_head,this.m_head+4<=this.m_max)i=this.m_CircleBuffer.readUnsignedInt();else{var n=this.m_max-this.m_head;this.m_CircleBuffer.readBytes(this.m_dataTmp,0,n),this.m_CircleBuffer.position=0,this.m_CircleBuffer.readBytes(this.m_dataTmp,n,4-n),this.m_dataTmp.position=0,i=this.m_dataTmp.readUnsignedInt()}return i&t.PACKET_ZIP&&(i&=~t.PACKET_ZIP),i+4}return 0},enumerable:!0,configurable:!0}),i.prototype.hasCompleteMsg=function(){var t=this.msgLengthWithHead;return 0==t?!1:this.dataLength>=t},i}(egret.HashObject);t.CircularBuffer=e,__reflect(e.prototype,"Network.CircularBuffer")}(Network||(Network={}));var Network;!function(t){var e=function(){function e(t){this.m_CBuffer=t,this.m_tempBuffer=new egret.ByteArray,this.m_tempBuffer.endian=egret.Endian.LITTLE_ENDIAN,this.m_queue=new dataset.QueueVec(2e3)}return e.prototype.tryAdd=function(){for(;;){var e=this.m_CBuffer.readOneMsg(this.m_tempBuffer);if(0==e)break;this.m_tempBuffer.position=0;var i=this.m_tempBuffer.readUnsignedInt(),n=void 0;if(t.isCompressed(i)){var o=new Uint8Array(this.m_tempBuffer.buffer,4);o=UtilCompress.uncompress(o),n=UtilByteArray.fromUint8Array(o)}else n=new egret.ByteArray,this.m_tempBuffer.readBytes(n);n.endian=egret.Endian.LITTLE_ENDIAN,n.position=0;var r=n.readUnsignedByte(),s=n.readUnsignedByte();n.position=0,this.m_queue.isFull&&(this.m_queue.pop(),Context.logMgr.addLog("ReceivedMessages more! msg:cmd="+r+" param="+s)),this.m_queue.push(n)}},e.prototype.getMsg=function(){if(this.m_queue.isEmpty)return null;var t=this.m_queue.pop();return t},e}();t.ReceivedMessages=e,__reflect(e.prototype,"Network.ReceivedMessages")}(Network||(Network={}));var Network;!function(t){function e(e){return e&t.PACKET_ZIP?!0:!1}t.isCompressed=e}(Network||(Network={}));var Network;!function(t){t.PACKET_ZIP=1073741824,t.PACKET_ZIP_MIN=32,t.PACKET_HEAD_SIZE=4;var e=function(e){function i(){var i=e.call(this)||this;return i.m_CBuffer=new t.CircularBuffer(2048),i.m_tempByteArrayRev=new egret.ByteArray,i.m_tempByteArrayRev.endian=egret.Endian.LITTLE_ENDIAN,i.m_tempByteArray=new egret.ByteArray,i.m_tempByteArray.endian=egret.Endian.LITTLE_ENDIAN,i.m_tempByteArray2=new egret.ByteArray,i.m_tempByteArray2.endian=egret.Endian.LITTLE_ENDIAN,i.m_receiveMessages=new t.ReceivedMessages(i.m_CBuffer),i}return __extends(i,e),i.prototype.connect=function(t,e,i){void 0===i&&(i=!1),Context.logMgr.addLog("SocketT connect() host="+t+" port="+e+" isWss="+i+" m_socket="+this.m_socket),this.m_socket&&close(),this.m_socket=new egret.WebSocket,this.m_socket.type=egret.WebSocket.TYPE_BINARY,this.m_socket.addEventListener(egret.Event.CONNECT,this.onConnect,this),this.m_socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),i?this.m_socket.connectByUrl("wss://"+t+":"+e):this.m_socket.connect(t,e)},i.prototype.onConnect=function(t){this.m_socket.removeEventListener(egret.Event.CONNECT,this.onConnect,this),this.m_socket.addEventListener(egret.Event.CLOSE,this.onClose,this),this.m_socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketData,this),this.dispatchEventWith(egret.Event.CONNECT)},i.prototype.onError=function(t){this.dispatchEventWith(egret.IOErrorEvent.IO_ERROR)},i.prototype.onClose=function(t){this.dispatchEventWith(egret.Event.CLOSE)},i.prototype.close=function(){this.m_socket&&(this.m_socket.connected&&this.m_socket.close(),this.m_socket.removeEventListener(egret.Event.CONNECT,this.onConnect,this),this.m_socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),this.m_socket.removeEventListener(egret.Event.CLOSE,this.onClose,this),this.m_socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketData,this))},Object.defineProperty(i.prototype,"connected",{get:function(){return this.m_socket&&this.m_socket.connected?!0:!1},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){close()},i.prototype.onSocketData=function(t){this.m_socket.connect||Context.logMgr.addLog("SocketT onSocketData()"),this.m_tempByteArrayRev.length=0,this.m_socket.readBytes(this.m_tempByteArrayRev);this.m_tempByteArrayRev.readUnsignedInt();this.m_CBuffer.Write(this.m_tempByteArrayRev,this.m_tempByteArrayRev.length),this.m_receiveMessages.tryAdd()},i.prototype.getMsg=function(){return this.m_receiveMessages.getMsg()},i.prototype.sendMsg=function(e){if(this.m_socket&&!this.m_socket.connected&&Context.logMgr.addLog("SocketT sendMsg()"),this.connected){this.m_tempByteArray.position=0,e.serialize(this.m_tempByteArray);var i=this.m_tempByteArray.position,n=i;if(i>32){var o=UtilByteArray.toUint8Array(this.m_tempByteArray,0,i);o=UtilCompress.compress(o),this.m_tempByteArray.position=0,UtilByteArray.readFromUint8Array(this.m_tempByteArray,o),i=this.m_tempByteArray.position,n=i|t.PACKET_ZIP}this.m_tempByteArray2.position=0,this.m_tempByteArray2.writeUnsignedInt(n),this.m_tempByteArray2.writeBytes(this.m_tempByteArray,0,i),this.m_socket.writeBytes(this.m_tempByteArray2,0,this.m_tempByteArray2.position)}},i}(egret.EventDispatcher);t.SocketT=e,__reflect(e.prototype,"Network.SocketT")}(Network||(Network={}));var core;!function(t){var e=function(){function t(){this.m_dicLoadingGroup={},this.m_dicLoadedGroup={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceLoadProgress,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this)}return t.prototype.loadGroupQuiet=function(t){var e=this.combGroupName(t);RES.loadGroup(e)},t.prototype.loadGroup=function(t,e,i,n){void 0===n&&(n=0);var o=this.combGroupName(t),r=this.m_dicLoadingGroup;r[o]||(r[o]=[e,null,i],RES.loadGroup(o,n))},t.prototype.loadGroupWithPro=function(t,e,i,n){var o=this.combGroupName(t),r=this.m_dicLoadingGroup;r[o]||(r[o]=[e,i,n],RES.loadGroup(o))},t.prototype.combGroupName=function(t){var e="";"string"==typeof t&&(t=[t]);for(var i=t.length,n=0;i>n;n++)e+=t[n];return RES.createGroup(e,t,!1),e},t.prototype.onResourceLoadComplete=function(t){var e=t.groupName;Context.logMgr.addLog("GroupRes load complete:"+e),this.m_dicLoadedGroup[e]=e;var i=this.m_dicLoadingGroup;if(i[e]){var n=i[e][0],o=i[e][2];null!=n&&n.call(o,e),delete i[e]}},t.prototype.onResourceLoadProgress=function(t){var e=t.groupName;if(this.m_dicLoadingGroup[e]){var i=this.m_dicLoadingGroup[e][1],n=this.m_dicLoadingGroup[e][2];null!=i&&i.call(n,t)}},t.prototype.onResourceLoadError=function(t){var e="Group:"+t.groupName+" has failed to load";console.warn(e),Context.logMgr.sendServer(e),this.onResourceLoadComplete(t)},t.prototype.isGroupLoaded=function(t){var e=this.combGroupName(t);return this.m_dicLoadedGroup[e]?RES.isGroupLoaded(e):!1},t.prototype.destroyRes=function(t,e){var i=this.combGroupName(t);return delete this.m_dicLoadedGroup[i],RES.isGroupLoaded(i)?RES.destroyRes(i,e):(Context.logMgr.addLog("GroupRes destroyRes. no group:"+name),!1)},t}();t.ResourceGroupProloadMgr=e,__reflect(e.prototype,"core.ResourceGroupProloadMgr")}(core||(core={}));var CommonSetMgr=function(t){function e(){var i=t.call(this)||this,n=Math.floor((e.COMMONSET_NUM+UtilCommon.UNITSIZE-1)/UtilCommon.UNITSIZE);return i.m_sysOptions=new Array(n),i}return __extends(e,t),e.prototype.reset_to_beforeLogin=function(){for(var t=this.m_sysOptions.length,e=0;t>e;e++)this.m_sysOptions[e]=0},e.prototype.init=function(){},e.prototype.isSet=function(t){return UtilCommon.isSet(this.m_sysOptions,t)},e.prototype.set=function(t){UtilCommon.setState(this.m_sysOptions,t)},e.prototype.clear=function(t){UtilCommon.clearState(this.m_sysOptions,t)},e.prototype.process_stReqSetCommonSetUserCmd=function(t){var i=new Cmd.stReqSetCommonSetUserCmd;switch(i.deserialize(t),i.clear?this.clear(i.state):this.set(i.state),this.dispatchEventWith(e.Event_State_Change,!1,i.state),i.state){case e.COMMONSET_SHOUCHONG:break;case e.COMMONSET_MIANFEI_XUNBAO:}},e.prototype.process_stRetCommonSetUserCmd=function(t){var e=new Cmd.stRetCommonSetUserCmd;e.deserialize(t);var i,n="[设置] stRetCommonSetUserCmd ";for(i=0;i<this.m_sysOptions.length;i++)this.m_sysOptions[i]=t.readUnsignedInt(),n+=" ["+this.m_sysOptions[i]+"]";Context.logMgr.addLog(n)},e.prototype.setAndSend=function(t){if(!this.isSet(t)){this.set(t);var e=new Cmd.stReqSetCommonSetUserCmd;e.state=t,e.clear=0,Context.sendMsg(e)}},e.prototype.clearAndSend=function(t){if(this.isSet(t)){this.clear(t);var e=new Cmd.stReqSetCommonSetUserCmd;e.state=t,e.clear=1,Context.sendMsg(e)}},e.Event_State_Change="Event_State_Change",e.COMMONSET_Authorize_wx=1,e.COMMONSET_First_Show_UIQuest=2,e.COMMONSET_EntryGame_byShare=3,e.COMMONSET_CLIENT_Music=55,e.COMMONSET_CLIENT_SoundEffect=56,e.COMMONSET_FIRST_SETNAME=57,e.COMMONSET_FIRST_OPENFASHION=58,e.COMMONSET_YINDAO_QUEST_SHOW=61,e.COMMONSET_SHOUCAO=62,e.COMMONSET_SHOUCHONG=63,e.COMMONSET_MIANFEI_XUNBAO=64,e.COMMONSET_NUM=65,e}(egret.EventDispatcher);__reflect(CommonSetMgr.prototype,"CommonSetMgr");var common;!function(t){var e=function(){function t(){this.m_dic={}}return t.prototype.load=function(){var t=Context.dataXmlMgr.getFileText(dataXml.XML_ani);this.m_xml=egret.XML.parse(t);var e,i=this.m_xml.children,n=0,o=i.length;for(n=0;o>n;n++){e=i[n];var r=e,s=r.attributes.name;this.m_dic[s]=r}},t.prototype.createAniXML=function(t){var e=this.m_dic[t],i=new animation.AniXml;return i.parseXML(e),i},t}();t.AniXmlMgr=e,__reflect(e.prototype,"common.AniXmlMgr")}(common||(common={}));var dataXml;!function(t){var e=function(){function e(){}return e.prototype.load=function(){if(!this.m_dic){var e=Context.dataXmlMgr.getJson(t.XML_common);this.m_dic=e.index,this.m_caodiCfg=e.caodi}},e.prototype.getConfig=function(t){return this.m_dic[t]},e}();t.CommonConfig=e,__reflect(e.prototype,"dataXml.CommonConfig")}(dataXml||(dataXml={}));var dataXml;!function(t){t.XML_BaseStr="_basestr.json",t.XML_common="_common.json",t.XML_platform="_platform.json",t.XML_gonggao="_gonggao.json",t.XML_ani="ani.xml",t.XML_chongzhidang="chongzhidang.json",t.XML_shouchong="shouchong.json",t.XML_yueka="yueka.json",t.XML_goods="goods.json",t.XML_task="task.json",t.XML_objpiece="objpiece.json",t.XML_revive="revive.json",t.XML_gameinit="gameinit.json",t.XML_mapfurniture="_mapfurniture.json",t.XML_furniture="furniture.json",t.XML_fashion="fashion.json",t.XML_huolizhuanpan="huolizhuanpan.json",t.XML_friendsShare="friendsShare.json",t.XML_qiandao="qiandao.json",t.XML_yindao="yindao.json",t.XML_openlevel="openlevel.json",t.XML_talk="talk.json",t.XML_huodonghall="huodonghall.json",t.XML_mubiao="mubiao.json",t.XML_tiaojian="tiaojian.json",t.XML_instructions="instructions.json",t.XML_settlement="settlement.json",t.XML_platformShare="platformShare.json",t.XML_xingongneng="xingongnengkaifang.json",t.XML_meirirenwu="meiritask.json",t.XML_zhekoulibao="zhekoulibao.json",t.XML_passzhuanpan="_passzhuanpan.json";var e=function(){function e(){this.m_dicData={}}return e.prototype.load=function(){this.m_zip=new JSZip;var e=RES.getRes("xml_zip");this.m_zip.load(e,{}),RES.destroyRes("xml_zip"),Context.commonCfg=new t.CommonConfig,Context.commonCfg.load()},e.prototype.getJson=function(t){var e=t,i=this.m_dicData[e];if(null==i){var n=this.m_zip.file(e).asText();i=JSON.parse(n),this.m_dicData[e]=i}return i},e.prototype.getFileText=function(t){var e=t,i=this.m_zip.file(e).asText();return i},e}();t.DataXmlMgr=e,__reflect(e.prototype,"dataXml.DataXmlMgr")}(dataXml||(dataXml={}));var Table;!function(t){var e=function(t){function e(e,i){var n=t.call(this,e)||this;return n.m_dic={},n.m_keyName=i,n}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e);var i;for(i in this.m_dicOffset){var n=this.createItem(parseFloat(i));this.m_dic[n[this.m_keyName]]=n}},e.prototype.getItemByKey=function(t){return this.m_dic[t]},e}(t.CTable);t.CTable_Dictionary=e,__reflect(e.prototype,"Table.CTable_Dictionary")}(Table||(Table={}));var scene;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_maxDepth=1e3,e.m_viewRect=new egret.Rectangle,e}return __extends(e,t),e.prototype.dispose=function(){this.collectChildren()},e.prototype.updateNodeForElement=function(t){var e=this.findNodeByElement(t);t.m_quadNode!=e?(t.m_quadNode&&t.m_quadNode.removeElement(t),e?e.addElement(t):t.isInCamera=!1):e&&e.updateIsInCamer(t)},e.prototype.setViewRect=function(t){this.m_viewRect.setTo(t.x,t.y,t.width,t.height),this.updateVisible(this.m_viewRect)},Object.defineProperty(e.prototype,"viewRect",{get:function(){return this.m_viewRect},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxDepth",{get:function(){return this.m_maxDepth},set:function(t){this.m_maxDepth=t},enumerable:!0,configurable:!0}),e}(t.QuadNode);t.QuadTree=e,__reflect(e.prototype,"scene.QuadTree")}(scene||(scene={}));var scene;!function(t){var e=function(t){function e(e,i,n){var o=t.call(this)||this;return o.mCurrentFrame=0,o.mFrameWidth=i,o.mFrameHeight=n,o.init(e),o}return __extends(e,t),e.prototype.init=function(t){t.length;this.mTextures=t.concat(),this.currentFrame=0},e.prototype.hitTest=function(t,e){return void 0===e&&(e=!1),null},e.prototype.getFrameTexture=function(t){return(0>t||t>=this.numFrames)&&egret.assert(!1,"Invalid frame id"),this.mTextures[t]},Object.defineProperty(e.prototype,"numFrames",{get:function(){return this.mTextures.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){return this.mCurrentFrame},set:function(t){this.mCurrentFrame=t;var e=this.mTextures[this.mCurrentFrame];e!=this.texture&&(this.texture=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameWidth",{get:function(){return this.mFrameWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameHeight",{get:function(){return this.mFrameHeight},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.mTextures=null,this.texture=null},e}(egret.Bitmap);t.MovieClip_NoAni=e,__reflect(e.prototype,"scene.MovieClip_NoAni")}(scene||(scene={}));var scene;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.offx=0,i.offy=0,i.destx=0,i.desty=0,i.elasticity=0,i.m_hasViewChangeLinstner=!1,i.m_scene=t,i.m_rect=new egret.Rectangle,i.m_rect.width=Context.width,i.m_rect.height=Context.height,i.m_MapScope=new egret.Rectangle,i}return __extends(i,e),i.prototype.initByPos=function(t,e){this.gotoPos(t,e)},i.prototype.follow=function(e,i){void 0===i&&(i=5),this.m_target!=e&&(this.clearTarget(),this.m_target=e,this.offx=0,this.offy=0,this.m_target.isCameraTarget=!0,this.elasticity=1+i,e.addEventListener(t.fElement.MOVE,this.moveListener,this),this.isOutRange(this.m_target.x,this.m_target.followCameraposY)&&this.gotoPos(e.x,e.followCameraposY))},i.prototype.clearTarget=function(e){void 0===e&&(e=null),(null==e||e==this.m_target)&&this.m_target&&(this.m_target.isCameraTarget=!1,this.m_target.removeEventListener(t.fElement.MOVE,this.moveListener,this),this.m_target=null)},i.prototype.isOutRange=function(t,e){return t-=this.m_rect.x,e-=this.m_rect.y,150>t||t>this.m_rect.width-150||150>e||e>this.m_rect.height-150?!0:!1},i.prototype.moveListener=function(){!this.isOutRange(this.m_target.x,this.m_target.followCameraposY);var t=!1;if(t=this.adjustPos(this.m_target.x,this.m_target.followCameraposY)){this.destx=this.m_rect.x+this.m_rect.width/2,this.desty=this.m_rect.y+this.m_rect.height/2;var e=this.destx-this.m_x,i=this.desty-this.m_y;1==this.elasticity||Math.abs(e)+Math.abs(i)<20?this.moveTo(this.destx,this.desty):1>e&&e>-1&&1>i&&i>-1||this.m_scene.addToJuggle(this)}else{var n=this.m_target.x-this.offx,o=this.m_target.followCameraposY-this.offy;1==this.elasticity||Math.abs(n-this.m_x)+Math.abs(o-this.m_y)<20?this.moveTo(n,o):(this.destx=n,this.desty=o,this.m_scene.addToJuggle(this))}},i.prototype.advanceTime=function(t){var e=this.destx-this.m_x,i=this.desty-this.m_y;return this.moveTo(this.m_x+e/this.elasticity,this.m_y+i/this.elasticity),1>e&&e>-1&&1>i&&i>-1&&this.m_scene.removeFromJuggle(this),!1},i.prototype.dispose=function(){this.clearTarget(),this.m_scene.removeFromJuggle(this),e.prototype.dispose.call(this)},i.prototype.moveTo=function(t,e){this.m_x=t,this.m_y=e,this.m_scene.m_quadTree&&this.m_scene.m_quadTree.setViewRect(this.m_rect),this.m_scene.setCameraPosition(this),this.m_hasViewChangeLinstner&&this.dispatchEventWith(i.VIEWCHANGE)},i.prototype.adjustPos=function(t,e){var i=!1,n=t-this.offx,o=e-this.offy;return this.m_rect.x=Math.round(-this.m_rect.width/2+n),this.m_rect.y=Math.round(-this.m_rect.height/2+o),this.m_rect.x>this.m_MapScope.right-this.m_rect.width&&(this.m_rect.x=this.m_MapScope.right-this.m_rect.width,i=!0),this.m_rect.x<this.m_MapScope.x&&(this.m_rect.x=this.m_MapScope.x,i=!0),this.m_rect.y>this.m_MapScope.bottom-this.m_rect.height&&(this.m_rect.y=this.m_MapScope.bottom-this.m_rect.height,i=!0),this.m_rect.y<this.m_MapScope.y&&(this.m_rect.y=this.m_MapScope.y,i=!0),i},i.prototype.gotoPos=function(t,e){this.adjustPos(t,e)?this.moveTo(this.m_rect.x+this.m_rect.width/2,this.m_rect.y+this.m_rect.height/2):this.moveTo(t,e)},i.prototype.onViewPortSizeChange=function(){this.m_rect.width=Context.width,this.m_rect.height=Context.height;var t=0,e=0;this.m_target?(t=this.m_target.x,e=this.m_target.followCameraposY):(t=this.m_x,e=this.m_y),this.gotoPos(t,e),this.m_hasViewChangeLinstner&&this.dispatchEventWith(i.VIEWCHANGE)},i.prototype.setMapScope=function(t,e,i,n){this.m_MapScope.x=t,this.m_MapScope.y=e,this.m_MapScope.width=i,this.m_MapScope.height=n},Object.defineProperty(i.prototype,"rect",{get:function(){return this.m_rect},enumerable:!0,configurable:!0}),i.VIEWCHANGE="viewChange",i}(t.fElement);t.fCamera=e,__reflect(e.prototype,"scene.fCamera")}(scene||(scene={}));var scene;!function(t){var e=function(e){function i(i,n,o){var r=e.call(this,i)||this;return r.m_delayTime=5e3,r.m_delayNO=0,r.m_floorX=n,r.m_floorY=o,r.m_x=r.m_floorX*t.fMapConfig.Image_SIZE,r.m_y=r.m_floorY*t.fMapConfig.Image_SIZE,r.m_width=t.fMapConfig.Image_SIZE,r.m_height=t.fMapConfig.Image_SIZE,r.m_screenArea.setTo(0,0,r.m_width,r.m_height),r.m_delayTime=Context.system.delayTimeForDeleteGPUTexture,r}return __extends(i,e),i.prototype.getflash9RendererClass=function(){return t.fFloorRenderer},i.prototype.onThumbnailLoaded=function(){this.m_render&&this.m_render.onThumbnailLoaded()},i.prototype.dispose=function(){this.clearDelayCall(),e.prototype.dispose.call(this)},i.prototype.getFloorImageURL=function(){return this.m_map.m_config.getImagePathName(this.m_floorX,this.m_floorY)},i.prototype.clearDelayCall=function(){this.m_delayNO&&(egret.clearTimeout(this.m_delayNO),this.m_delayNO=0)},i.prototype.tryClearRender_OnUpdateRenderVisible=function(){this.clearDelayCall(),this.m_delayNO=egret.setTimeout(this.onDelayCall,this,this.m_delayTime)},i.prototype.onDelayCall=function(){this.clearDelayCall(),0==this.m_isVisibleNow&&this.clearRender()},i.prototype.clearRender=function(){this.m_render&&(this.m_render.dispose(),this.m_render=null)},i}(t.fRenderableElement);t.fFloor=e,__reflect(e.prototype,"scene.fFloor")}(scene||(scene={}));var Context;!function(t){function e(){t.mapConfigMgr=new scene.fMapConfigMgr,t.headLabelMgr=new scene.HeadLabelMgr,t.sceneTransitionMgr=new scene.SceneTransitionMgr,t.effectConfigMgr=new core.EffectConfigMgr,t.effectDataMgr=new core.EffectDataMgr,t.dBonesMgr=new core.DBonesMgr,t.loginServer=new Server.ToLoginServer,t.gatewayServer=new Server.ToGateWayServer,t.modelConfigMgr=new scene.ModelConfigMgr,t.modelDataMgr=new scene.ModelDataMgr,t.playerMgr=new sceneApp.PlayerMgr,t.npcMgr=new sceneApp.NpcMgr,t.dataTableMgr=new Table.DataTableMgr,t.commonSetMgr=new CommonSetMgr,t.ABTestMgr=new common.ABTestMgr,t.languageMgr=new LanguageMgr,t.soundMgr=new sound.SoundMgr,t.SWMgr=new sensitiveword.SensitiveWordMgr,t.sysPromptMgr=new systemPrompt.SystemPromptMgr,t.heroinfoMgr=new HeroInfoMgr,t.danmuPromptMgr=new systemPrompt.DanmuPromptMgr,t.packageMgr=new PackageMgr,t.rankMgr=new rank.RankMgr,t.tipsMgr=new tips.TipsMgr,t.settingMgr=new settings.SettingMgr,t.lobbyMgr=new uimain.LobbyMgr,t.loginOutnetPlayerMgr=new LoginOutnetPlayerMgr,t.guideprompMgr=new systemPrompt.GuidePrompMgr,t.bitmapStatsMgr=new core.BitmapStatsMgr,t.revMessageMgr.isStart=!0}function i(e){t.gatewayServer.connected?t.gatewayServer.sendMsg(e):t.loginServer.connected?t.loginServer.sendMsg(e):(t.sendMessageMgr.addMsg(e),t.sysPromptMgr.showUINetConnectClose())
}t.createMgrs=e,t.sendMsg=i}(Context||(Context={}));var scene;!function(t){var e=function(){function e(){this.m_bNeedAutoNpcfind=!1,this.m_bMoveInitiative=!1,this.m_bPickupFallObj=!1,this.m_bMoveToDesAddFight=!1,this.m_bCloseAutoNpcfind=!1,this.m_bCloseAutoNpcfindRecord=!1,this.m_foundPosList=[]}return e.prototype.getAroundPos=function(i){var n=Context.mapMgr.currentMap,o=(n.m_config.m_mapID,Math.floor(7*Math.random())+1),r=i.x+e.s_PosRandom[o][0]*t.fMapConfig.GRID_SIZE;0>r?r=0:r>=n.widthPx&&(r=n.widthPx-1);var s=i.y+e.s_PosRandom[o][1]*t.fMapConfig.GRID_SIZE;return 0>s?s=0:s>=n.heightPx&&(s=n.heightPx-1),egret.Point.create(r,s)},e.prototype.setParam=function(t){this.m_foundPosList.length=0;var e=t.length;if(e>0){this.m_bNeedAutoNpcfind=!0;var n=void 0,o=void 0,r=void 0;for(n=0;e>n;n++)o=t[n],r=new i(o.x,o.y,o.interval),this.m_foundPosList.push(r)}},e.prototype.findNpcPosNearest=function(t,e){if(null==Context.mapMgr.currentMap)return null;this.updateFoundPosList();for(var i,n=this.m_foundPosList.length,o=[],r=0;n>r;r++)i=this.m_foundPosList[r],i.bRefresh&&o.push(new egret.Point(i.x,i.y));return this.findPosNearest(new egret.Point(t,e),o,!1)},e.prototype.updateFoundPosList=function(){var t,e,i=this.m_foundPosList.length;for(t=i-1;t>=0;t--)e=this.m_foundPosList[t],e.bRefresh&&e.clearState()},e.prototype.updateStateFoundPos=function(t){var e,i,n=this.m_foundPosList.length;for(e=0;n>e;e++)if(i=this.m_foundPosList[e],i.x==t.x&&i.y==t.y){i.setState();break}},e.prototype.getRefreshNpcPos=function(t,e){var i,n=this.m_foundPosList.length;for(i=0;n>i;i++)if(this.m_foundPosList[i].x==t&&this.m_foundPosList[i].y==e)return this.m_foundPosList[i];return null},Object.defineProperty(e.prototype,"bNeedAutoNpcfind",{get:function(){return this.m_bNeedAutoNpcfind},enumerable:!0,configurable:!0}),e.prototype.leaveMap=function(){this.m_bNeedAutoNpcfind=!1,this.m_foundPosList.length=0},e.prototype.findPosNearest=function(t,e,i){void 0===i&&(i=!0);var n,o,r=i?t:null,s=e.length,a=Number.MAX_VALUE,h=0;for(o=0;s>o;o++)n=e[o],h=UtilMath.distance(t.x,t.y,n.x,n.y),h>0&&a>h&&(a=h,r=n);return r},e.prototype.beginMoveInitiative=function(t){this.m_bMoveInitiative=!0,this.m_bMoveToDesAddFight=!1},e.prototype.onMoveToNextDestination=function(){if(null!=Context.mapMgr.currentMap&&!Context.mapMgr.bSwitchMaping){var e;if(null!=e){var i=t.coordinateC2S(e.x,e.y),n=this.findNpcPosNearest(i.x,i.y);if(null!=n){var o=t.coordinateS2C(n.x,n.y);o.equals(e)||this.updateStateFoundPos(n)}}}},e.prototype.createFallObjInMap=function(){},e.prototype.createNpcInMap=function(){this.m_bPickupFallObj},e.prototype.bCloseAutoNpcfind=function(){return this.m_bCloseAutoNpcfind},e.prototype.beginAutoNpcfind=function(){this.m_bCloseAutoNpcfind=!1,this.m_bCloseAutoNpcfindRecord=this.m_bCloseAutoNpcfind,this.onMoveToNextDestination()},e.prototype.endAutoNpcfind=function(){this.m_bCloseAutoNpcfind=!0,this.m_bCloseAutoNpcfindRecord=this.m_bCloseAutoNpcfind,this.m_bPickupFallObj=!1},e.prototype.closeAutoNpcfind=function(){this.m_bCloseAutoNpcfind=!0,this.m_bPickupFallObj=!1},e.prototype.recoverAutoNpcfind=function(){0==this.m_bCloseAutoNpcfindRecord&&this.beginAutoNpcfind()},e.s_PosRandom=[[0,0],[0,1],[0,-1],[1,0],[1,1],[1,-1],[-1,-1],[-1,0],[-1,1]],e}();t.AutoNpcfindMgr=e,__reflect(e.prototype,"scene.AutoNpcfindMgr");var i=function(){function t(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.time=0,this.x=t,this.y=e,this.interval=i}return Object.defineProperty(t.prototype,"bRefresh",{get:function(){return 0==this.time||this.time>0&&this.time+1e3*this.interval<egret.getTimer()},enumerable:!0,configurable:!0}),t.prototype.clearState=function(){this.time=0},t.prototype.setState=function(){this.time=egret.getTimer()},t}();__reflect(i.prototype,"refreshNpcPos")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(t){this.m_depthDirty=!1,this.m_depthDirtySingle=!1,this.m_map=t,this.m_dicDepthSortArr={},this.m_dicSingleDirtyArr={}}return e.prototype.addToDepthSort=function(e){var i=this.m_dicDepthSortArr[e.layer];i||(i=[],this.m_dicDepthSortArr[e.layer]=i),i.indexOf(e)<0&&(i.push(e),e.addEventListener(t.fRenderableElement.DEPTHCHANGE,this.depthChangeListener,this))},e.prototype.removeFromDepthSort=function(e){var i=this.m_dicDepthSortArr[e.layer];if(i){var n=i.indexOf(e);-1!=n&&(i.splice(n,1),e.removeEventListener(t.fRenderableElement.DEPTHCHANGE,this.depthChangeListener,this))}},e.prototype.depthChangeListener=function(t){if(!this.m_depthDirty){this.m_depthDirtySingle=!0;var e=t.target,i=this.m_dicSingleDirtyArr[e.layer];i||(i=[],this.m_dicSingleDirtyArr[e.layer]=i),i.push(e)}},e.prototype.depthSortSingle=function(){var t,e,i,n=this.m_dicSingleDirtyArr;for(var o in n)t=this.m_map.getLayer(parseInt(o)),e=this.m_dicDepthSortArr[o],i=n[o],t&&i.length>0&&this._depthSortSingle(t,e,i)},e.prototype._depthSortSingle=function(t,i,n){e.insertSort(i);var o=i.length;if(0!=o){o=n.length;var r,s=0;for(s=0;o>s;s++){r=n[s];var a=r.depthOrder,h=i.indexOf(r);h!=a&&(r.depthOrder=h,t.getChildIndex(r.elementRoot)!=h&&t.setChildIndex(r.elementRoot,h))}}},e.prototype.depthSort=function(){var t,e,i=this.m_dicDepthSortArr;for(var n in i)t=this.m_map.getLayer(parseInt(n)),e=i[n],t&&e.length>0&&this._depthSort(t,e)},e.prototype._depthSort=function(t,i){e.insertSort(i);var n=i.length;if(0!=n)for(;n--;)t.getChildAt(n)!=i[n].elementRoot&&(t.setChildIndex(i[n].elementRoot,n),i[n].depthOrder=n)},e.prototype.onFrameEnd=function(){var t,e=this.m_dicSingleDirtyArr;if(1==this.m_depthDirty){this.depthSort(),this.m_depthDirty=!1,this.m_depthDirtySingle=!1;for(var i in e)t=e[i],t&&(t.length=0);UtilDictionary.clear(this.m_dicSingleDirtyArr)}else if(1==this.m_depthDirtySingle){this.depthSortSingle(),this.m_depthDirtySingle=!1;for(var i in e)t=e[i],t&&(t.length=0);UtilDictionary.clear(this.m_dicSingleDirtyArr)}},e.insertSort=function(t){var e=0,i=0,n=null,o=t.length;for(e=1;o>e;e++){for(i=e-1,n=t[e];i>=0&&t[i].depth>n.depth;)t[i+1]=t[i],i--;t[i+1]=n,i>=0&&t[i].depth==n.depth&&n.x<t[i].x&&(t[i+1]=t[i],t[i]=n)}},e}();t.DepthController=e,__reflect(e.prototype,"scene.DepthController")}(scene||(scene={}));var scene;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.i=0,e.j=0,e.x=0,e.y=0,e.g=0,e.heuristic=0,e.cost=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"totalScore",{get:function(){return this.g+this.heuristic},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isStop",{get:function(){return(1&this.m_stopFlag)>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTranslucent",{get:function(){return(4&this.m_stopFlag)>0},enumerable:!0,configurable:!0}),e.prototype.release=function(){this.parent=null,this.m_map=null,this.heuristic=0,e.s_gc.collect(this)},e.s_gc=new dataset.GCCommon(e,200,null,null),e}(egret.HashObject);t.fCell=e,__reflect(e.prototype,"scene.fCell")}(scene||(scene={}));var scene;!function(t){t.SLTerrain=0,t.SLSurface=1,t.SLObject=2,t.SLHeadEffect=3,t.SLHeadLabel=4,t.SLHeadTalk=5,t.SLUILayer=6,t.SLSelectFurniture=7,t.SLRoomShade=8;var e=function(){function e(){this.m_dicLayer={},this.m_grids={},this.m_root_anchorOffsetX_offset=0,this.m_root_anchorOffsetY_offset=0,this.m_root_anchorOffsetX=0,this.m_root_anchorOffsetY=0,this.m_mapRootScaleX=1,this.m_mapRootScaleY=1,this.m_Layers=[t.SLTerrain,t.SLSurface,t.SLObject,t.SLHeadEffect,t.SLHeadLabel,t.SLHeadTalk,t.SLUILayer,t.SLSelectFurniture,t.SLRoomShade],this.m_mapRoot=e.s_getSprite(),this.m_mapRoot.name="mapRoot",this.m_mapRoot.x=.5*Context.width,this.m_mapRoot.y=.5*Context.height,this.m_floors=[],this.m_everything=[],this.m_juggle=new animation.Juggler,this.m_depthController=new t.DepthController(this),this.AI=new t.fAiContainer(this),this.m_mapFloorImageMgr=new t.MapFloorImageMgr,this.m_mapEventProcesser=new t.MapEventProcesser(this)}return e.prototype.updatebShowCanTouch=function(t){this.m_mapEventProcesser.canTouch=t},e.prototype.getFloorImageMgr=function(){return this.m_mapFloorImageMgr},e.s_getSprite=function(){return e.s_LayerGc.getObject()},e.s_collectSprite=function(t){t.x=0,t.y=0,t.scaleX=1,t.scaleY=1,t.name&&(t.name=""),t.removeChildren(),t.parent&&t.parent.removeChild(t),e.s_LayerGc.collect(t)},e.s_getBitmap=function(){return e.s_bitmapGc.getObject()},e.s_collectBitmap=function(t){t.x=0,t.y=0,0!=t.anchorOffsetX&&(t.anchorOffsetX=0),0!=t.anchorOffsetY&&(t.anchorOffsetY=0),1!=t.scaleX&&(t.scaleX=1),1!=t.scaleY&&(t.scaleY=1),t.name&&(t.name=""),t.$setBitmapData(null),t.texture=null,t.parent&&t.parent.removeChild(t),e.s_bitmapGc.collect(t)},e.prototype.hideLayer=function(t){var e=this.getLayer(t);e&&e.parent&&e.parent.removeChild(e)},e.prototype.showLayer=function(t){var e=this.getLayer(t);e&&!e.parent&&this.m_mapRoot.addChildAt(e,t)},e.prototype.updateShowObject=function(e){e?(this.showLayer(t.SLObject),this.showLayer(t.SLHeadEffect),this.showLayer(t.SLHeadLabel),this.showLayer(t.SLHeadTalk),this.showLayer(t.SLUILayer)):(this.hideLayer(t.SLObject),this.hideLayer(t.SLHeadEffect),this.hideLayer(t.SLHeadLabel),this.hideLayer(t.SLHeadTalk),this.hideLayer(t.SLUILayer))},e.prototype.init=function(i){this.m_config=i;for(var n,o=this.m_Layers.length,r=0;o>r;){n=e.s_getSprite();var s=this.m_Layers[r];this.m_dicLayer[s]=n,n.name="mapLayer"+s,this.m_mapRoot.addChild(n),++r}var a,h;if(this.m_option&&this.m_option[e.SO_CameraInitPos]){var m=this.m_option[e.SO_CameraInitPos];a=m.x,h=m.y}else a=this.widthPx/2,h=this.heightPx/2;this.currentCamera=new t.fCamera(this),this.setMapScope(0,0,this.widthPx,this.heightPx),this.currentCamera.gotoPos(a,h),this.m_quadTree=new t.QuadTree,this.m_quadTree.maxDepth=100,this.m_quadTree.init(this.m_quadTree,null,0,0,this.widthPx,this.heightPx),this.m_quadTree.setViewRect(this.currentCamera.rect);var c,u;r=0;var l;for(u=0;u<this.m_config.m_floorYCnt;u++)for(c=0;c<this.m_config.m_floorXCnt;c++)this.m_floors[r]=l=new t.fFloor(this,c,u),l.layer=t.SLTerrain,this.m_quadTree.updateNodeForElement(l),r++;this.m_config.isThumbnailLoaded||this.m_config.once(egret.Event.COMPLETE,this.onThumbnailLoaded,this)},Object.defineProperty(e.prototype,"mapRoot",{get:function(){return this.m_mapRoot},enumerable:!0,configurable:!0}),e.prototype.getObjectLayer=function(){return this.m_dicLayer[t.SLObject]},e.prototype.setCameraPosition=function(t){this.rootAnchorOffsetX=Math.round(t.x),this.rootAnchorOffsetY=Math.round(t.y);var e=this.m_darkOthersOfSLSelectFurniture;e&&e.parent&&(e.x=t.x,e.y=t.y)},Object.defineProperty(e.prototype,"rootAnchorOffsetX",{get:function(){return this.m_root_anchorOffsetX},set:function(t){this.m_root_anchorOffsetX=t,this.m_mapRoot.anchorOffsetX=this.m_root_anchorOffsetX+this.m_root_anchorOffsetX_offset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rootAnchorOffsetY",{get:function(){return this.m_root_anchorOffsetY},set:function(t){this.m_root_anchorOffsetY=t,this.m_mapRoot.anchorOffsetY=this.m_root_anchorOffsetY+this.m_root_anchorOffsetY_offset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root_anchorOffsetX_offset",{get:function(){return this.m_root_anchorOffsetX_offset},set:function(t){this.m_root_anchorOffsetX_offset=t,this.m_mapRoot.anchorOffsetX=this.m_root_anchorOffsetX+this.m_root_anchorOffsetX_offset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root_anchorOffsetY_offset",{get:function(){return this.m_root_anchorOffsetY_offset},set:function(t){this.m_root_anchorOffsetY_offset=t,this.m_mapRoot.anchorOffsetY=this.m_root_anchorOffsetY+this.m_root_anchorOffsetY_offset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapScaleX",{get:function(){return this.m_mapRootScaleX},set:function(t){this.m_mapRootScaleX=t,this.m_mapRoot.scaleX=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapScaleY",{get:function(){return this.m_mapRootScaleY},set:function(t){this.m_mapRootScaleY=t,this.m_mapRoot.scaleY=t},enumerable:!0,configurable:!0}),e.prototype.setMapScope=function(t,e,i,n){this.currentCamera.setMapScope(t,e,i,n)},Object.defineProperty(e.prototype,"widthPx",{get:function(){return this.m_config.m_widthInPixel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heightPx",{get:function(){return this.m_config.m_heightInPixel},enumerable:!0,configurable:!0}),e.prototype.getLayer=function(t){return this.m_dicLayer[t]},e.prototype.getUILayer=function(){return this.m_dicLayer[t.SLUILayer]},e.prototype.getSelectFurnitureLayer=function(){return this.m_dicLayer[t.SLSelectFurniture]},e.prototype.onShowDarkOthersOfSelectFurnitureLayer=function(e){void 0===e&&(e=!1);var i=this.m_darkOthersOfSLSelectFurniture;if(e){if(i||(i=new eui.Image("common.pixel_png"),i.scale9Grid=new egret.Rectangle(1,1,2,2),i.alpha=0,i.touchEnabled=!0,this.m_darkOthersOfSLSelectFurniture=i),!i.parent){var n=Math.round(1.4*Context.width),o=Math.round(1.4*Context.height);n>2048&&(n=2048),o>2048&&(o=2048),i.width=n,i.height=o,i.anchorOffsetX=.5*i.width,i.anchorOffsetY=.5*i.height,i.alpha=0,i.x=this.rootAnchorOffsetX,i.y=this.rootAnchorOffsetY,this.m_dicLayer[t.SLSelectFurniture].addChildAt(i,0),UtilEffect.aniFadeIn(i,120,.5)}}else i&&UtilEffect.aniFadeOut(i,200,this.aniFadeOutEnd,this)},e.prototype.aniFadeOutEnd=function(){var t=this.m_darkOthersOfSLSelectFurniture;t&&t.parent&&(t.parent.removeChild(t),t.width=4,t.height=4)},e.prototype.hasRenderableElement=function(t){return-1!=this.m_everything.indexOf(t)},e.prototype.createObject=function(e,i,n,o,r,s){void 0===s&&(s=t.SLObject);var a=new e(i,this);return this.addObject(a,n,o,r,s),a},e.prototype.removeObject=function(t,e){void 0===e&&(e=!0),UtilArray.removeItem(this.m_everything,t),t.hide(),t.m_quadNode&&t.m_quadNode.removeElement(t),this.m_juggle.remove(t),e?t.dispose():t.onRemoveFromMap()},e.prototype.addObject=function(e,i,n,o,r){void 0===r&&(r=t.SLObject),e.setPos(i,n),e instanceof t.fObject&&(e.angle=o),e.layer=r,this.m_quadTree.updateNodeForElement(e),e.updateDepth(),this.m_juggle.add(e),this.m_everything.push(e)},e.prototype.showObject=function(t){t.show(),this.m_juggle.add(t)},e.prototype.hideObject=function(t){t.hide(),this.m_juggle.remove(t)},e.prototype.updateElementVisible=function(){var t,e=0,i=this.m_floors.length;for(e=0;i>e;e++)t=this.m_floors[e],t&&t.updateRenderVisible();for(i=this.m_everything.length,e=0;i>e;e++)t=this.m_everything[e],t&&t.updateRenderVisible()},Object.defineProperty(e.prototype,"isBeingRendered",{get:function(){return this.m_isBeingRendered},enumerable:!0,configurable:!0}),e.prototype.addToJuggle=function(t){Context.juggle.add(t)},e.prototype.removeFromJuggle=function(t){Context.juggle.remove(t)},e.prototype.startRendering=function(){this.m_isBeingRendered||(this.m_isBeingRendered=!0,Context.juggle.add(this.m_juggle),this.updateElementVisible())},e.prototype.stopRendering=function(){this.m_isBeingRendered&&(this.m_isBeingRendered=!1,Context.juggle.remove(this.m_juggle),this.updateElementVisible())},e.prototype.isStopPoint_PixelPos=function(t,e){var i=this.translateToCell(t,e);return i?i.isStop:!0},e.prototype.translateToCell=function(e,i){return this.getCellAt(Math.floor(e/t.fMapConfig.GRID_SIZE),Math.floor(i/t.fMapConfig.GRID_SIZE))},e.prototype.getCellAt=function(e,i){if(0>e||0>i)return null;if(e>=this.m_config.m_widthInGrid||i>=this.m_config.m_heightInGrid)return null;var n=(i<<16)+e,o=this.m_grids[n];return o||(o=t.fCell.s_gc.getObject(),o.m_map=this,o.i=e,o.j=i,o.x=t.fMapConfig.GRID_SIZE_HALF+t.fMapConfig.GRID_SIZE*e,o.y=t.fMapConfig.GRID_SIZE_HALF+t.fMapConfig.GRID_SIZE*i,this.m_config.m_stop?o.m_stopFlag=this.m_config.m_stop.getPoint(e,i):o.m_stopFlag=0,this.m_grids[n]=o),o},e.prototype.onFrameEnd=function(){this.m_depthController.onFrameEnd()},e.prototype.onThumbnailLoaded=function(){var t,e=0,i=this.m_floors.length;for(e=0;i>e;e++)t=this.m_floors[e],t&&t.onThumbnailLoaded()},e.prototype.convertStageToScene=function(t,e,i){return void 0===i&&(i=null),null==i&&(i=new egret.Point),i.x=t+this.rootAnchorOffsetX,i.y=e+this.rootAnchorOffsetY,i},e.prototype.getFloorAt=function(e,i){var n=i*this.m_config.m_floorXCnt+e,o=this.m_floors[n];return o?o:(o=this.m_floors[n]=new t.fFloor(this,e,i),this.m_quadTree.updateNodeForElement(o),o)},e.prototype.getFloorAtByPos=function(e,i){if(0>e||0>i)return null;var n=Math.floor(e/t.fMapConfig.Image_SIZE),o=Math.floor(i/t.fMapConfig.Image_SIZE);return this.getFloorAt(n,o)},e.prototype.translateStageCoordsToElements=function(t,i){if(0==this.m_isBeingRendered)return null;e.s_help_re.length=0;var n;if(0>t||0>i||t>=this.m_config.m_widthInPixel||i>=this.m_config.m_heightInPixel)return e.s_help_re;if(n=this.getFloorAtByPos(t,i),null==n)return null;this.m_quadTree.getElementsByHitPos(t,i,e.s_help_re);var o=function(t,e){return t.depth<e.depth?1:t.depth>e.depth?-1:0};return e.s_help_re.sort(o),e.s_help_re.push(n),e.s_help_re},e.prototype.dispose=function(){this.stopRendering();var t,i=this.m_floors.length,n=0;for(n=0;i>n;n++)this.m_floors[n].dispose();for(this.m_floors=null,i=this.m_everything.length,n=0;i>n;n++)this.m_everything[n].dispose();this.m_everything=null;for(t in this.m_grids)this.m_grids[t].release();this.currentCamera.dispose(),this.currentCamera=null,this.m_quadTree.dispose(),this.m_quadTree=null,this.m_depthController=null,this.m_mapFloorImageMgr.dispose(),this.m_mapFloorImageMgr=null,this.m_mapEventProcesser.dispose(),this.m_mapEventProcesser=null;var o;for(t in this.m_dicLayer)o=this.m_dicLayer[t],e.s_collectSprite(o);this.m_dicLayer=null,e.s_collectSprite(this.m_mapRoot),this.m_mapRoot=null,this.m_config.removeEventListener(egret.Event.COMPLETE,this.onThumbnailLoaded,this)},e.prototype.drawStopPt=function(){null==this.stopPtCP&&(this.stopPtCP=new egret.Sprite,this.stopPtList=[]);var e,i,n=this.stopPtList.length;for(e=0;n>e;e++)i=this.stopPtList[e],i.parent&&i.parent.removeChild(i);this.stopPtCP.graphics.clear(),this.stopPtCP.graphics.lineStyle(1,UtilColor.GREEN);var o;for(e=0;e<this.m_config.m_widthInGrid;e++)this.stopPtCP.graphics.moveTo(0,e*t.fMapConfig.GRID_SIZE),this.stopPtCP.graphics.lineTo(this.m_config.m_widthInPixel,e*t.fMapConfig.GRID_SIZE);for(e=0;e<this.m_config.m_heightInGrid;e++)for(this.stopPtCP.graphics.moveTo(e*t.fMapConfig.GRID_SIZE,0),this.stopPtCP.graphics.lineTo(e*t.fMapConfig.GRID_SIZE,this.m_config.m_heightInPixel),o=0;o<this.m_config.m_widthInGrid;o++)e*this.m_config.m_heightInGrid+o<n?i=this.stopPtList[e*this.m_config.m_heightInGrid+o]:(i=new eui.Label,this.stopPtList.push(i)),i.text="("+o+","+e+")",i.x=o*t.fMapConfig.GRID_SIZE+10,i.y=e*t.fMapConfig.GRID_SIZE+25,i.size=14,this.stopPtCP.addChild(i);if(this.m_config.m_stop){this.stopPtCP.graphics.lineStyle(1,UtilColor.RED);for(var r=this.m_config.m_stop.getAllStopPoint(),s=void 0,a=0,h=r;a<h.length;a++){s=h[a];var m=s.x*t.fMapConfig.GRID_SIZE,c=s.y*t.fMapConfig.GRID_SIZE;this.stopPtCP.graphics.moveTo(m,c),this.stopPtCP.graphics.lineTo(m+t.fMapConfig.GRID_SIZE,c+t.fMapConfig.GRID_SIZE),this.stopPtCP.graphics.moveTo(m,c+t.fMapConfig.GRID_SIZE),this.stopPtCP.graphics.lineTo(m+t.fMapConfig.GRID_SIZE,c)}this.stopPtCP.graphics.lineStyle(1,UtilColor.GOLD),r=this.m_config.m_stop.getAllTranslucent();for(var u=0,l=r;u<l.length;u++){s=l[u];var m=s.x*t.fMapConfig.GRID_SIZE,c=s.y*t.fMapConfig.GRID_SIZE;this.stopPtCP.graphics.moveTo(m,c),this.stopPtCP.graphics.lineTo(m+t.fMapConfig.GRID_SIZE,c+t.fMapConfig.GRID_SIZE),this.stopPtCP.graphics.moveTo(m,c+t.fMapConfig.GRID_SIZE),this.stopPtCP.graphics.lineTo(m+t.fMapConfig.GRID_SIZE,c)}}this.stopPtCP.graphics.endFill(),this.m_mapRoot.addChild(this.stopPtCP)},e.prototype.clearStopPt=function(){this.stopPtCP&&this.stopPtCP.parent&&this.stopPtCP.parent.removeChild(this.stopPtCP)},Object.defineProperty(e.prototype,"mapName",{get:function(){return this.m_mapName},set:function(t){this.m_mapName=t},enumerable:!0,configurable:!0}),e.prototype.isOut_of_bound=function(t,e){return t>=this.widthPx||e>=this.heightPx||0>t||0>e?(Context.logMgr.sendServer("出界 mapid="+this.m_config.m_mapID+" w="+this.m_config.m_widthInPixel+" h="+this.m_config.m_heightInPixel+" ("+t+","+e+") "+UtilCommon.getStackInfo()),!0):!1},e.SO_CameraInitPos="CameraInitPos",e.s_LayerGc=new dataset.GCCommon(t.SpriteEx,10,null,null),e.s_bitmapGc=new dataset.GCCommon(egret.Bitmap,10,null,null),e.s_help_re=new Array,e}();t.fMap=e,__reflect(e.prototype,"scene.fMap")}(scene||(scene={}));var scene;!function(t){function e(t,e,i){return void 0===i&&(i=null),null==i&&(i=new egret.Point),i.x=n.GRID_SIZE*t,i.y=n.GRID_SIZE*e,i}function i(t,e,i){return void 0===i&&(i=null),null==i&&(i=new egret.Point),i.x=Math.floor(t/n.GRID_SIZE),i.y=Math.floor(e/n.GRID_SIZE),i}t.coordinateS2C=e,t.coordinateC2S=i;var n=function(e){function i(n,o){void 0===o&&(o=null);var r=e.call(this)||this;return r.m_tArtMapItem=n,r.m_mapID=r.m_tArtMapItem.m_uID,o&&(r.m_stop=new t.fMapStop,r.m_stop.parse(o)),r.m_widthInPixel=r.m_tArtMapItem.m_w,r.m_heightInPixel=r.m_tArtMapItem.m_h,r.m_widthInGrid=r.m_widthInPixel/i.GRID_SIZE,r.m_heightInGrid=r.m_heightInPixel/i.GRID_SIZE,r.m_floorXCnt=r.m_widthInPixel/i.Image_SIZE,r.m_floorYCnt=r.m_heightInPixel/i.Image_SIZE,r.loadThumbnailLoader(),r}return __extends(i,e),i.s_posS2C=function(t,e){return i.s_helpPoint.x=t*i.GRID_SIZE,i.s_helpPoint.y=e*i.GRID_SIZE,i.s_helpPoint},i.prototype.loadThumbnailLoader=function(){var t="resource/assets/map/"+this.m_mapID+"/thumbnail.jpg";this.m_thumbnailLoader=Context.imageLoaderMgr.load(t,this.onThumbnailLoaded,this.onThumbnailFailed,this),this.m_thumbnailLoader.increment()},i.prototype.updateMapStop=function(t){this.m_stop&&this.m_stop.resetStop(t)},Object.defineProperty(i.prototype,"isThumbnailLoaded",{get:function(){return this.m_thumbnailLoader&&this.m_thumbnailLoader.loaded?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"thumbnailTexture",{get:function(){return this.m_thumbnailLoader&&this.m_thumbnailLoader.loaded?this.m_thumbnailLoader.texture:null},enumerable:!0,configurable:!0}),i.prototype.onThumbnailLoaded=function(){this.dispatchEventWith(egret.Event.COMPLETE)},i.prototype.onThumbnailFailed=function(){},i.prototype.getImagePathName=function(t,e){var i=e*this.m_floorXCnt+t;return"resource/assets/map/"+this.m_mapID+"/t-"+i+".jpg"},i.Image_SIZE=256,i.Image_SIZE_HALF=128,i.GRID_SIZE=64,i.GRID_SIZE_HALF=32,i.s_helpPoint=new egret.Point,i}(egret.EventDispatcher);t.fMapConfig=n,__reflect(n.prototype,"scene.fMapConfig")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){this.m_dicConfig={},this.m_dicEffect={},this.m_dicStop={}}return e.prototype.loadMapStop=function(){this.m_stopZip=new JSZip;var t=RES.getRes("stop_zip");this.m_stopZip.load(t,{})},e.prototype.getStopData=function(t){if(this.m_stopZip){var e=this.m_dicStop[t];if(null==e){var i=t+".mps",n=this.m_stopZip.file(i);if(!n)return void Context.logMgr.showWarning("缺少文件:"+i);var o=n.asArrayBuffer();e=new egret.ByteArray(o),e.endian=egret.Endian.LITTLE_ENDIAN,this.m_dicStop[t]=e}return e.position=0,e}},e.prototype.getSceneConfig=function(e){var i=this.m_dicConfig[e];if(null==i){var n=Context.dataTableMgr.getItem(Table.TABLE_ARTMAP,e);this.m_dicConfig[e]=i=new t.fMapConfig(n,this.getStopData(""+e))}return i},e.prototype.getEffectConfig=function(t){var e=this.m_dicEffect[t];if(!e){var i=Context.commonCfg.getConfig(5).map;for(var n in i)if(i[n].id==t){e=i[n];break}e&&(this.m_dicEffect[t]=e)}return e},e}();t.fMapConfigMgr=e,__reflect(e.prototype,"scene.fMapConfigMgr")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){}return e.prototype.init=function(e,i){this.m_thisID=e,this.m_mapID=i,this.m_map||(this.m_map=new t.fMap,this.m_map.init(Context.mapConfigMgr.getSceneConfig(this.m_mapID)),Context.mapMgr.m_effectMgr.onEnterMap(this))},Object.defineProperty(e.prototype,"thisID",{get:function(){return this.m_thisID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapID",{get:function(){return this.m_mapID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"map",{get:function(){return this.m_map},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.hide(),this.m_map.dispose(),this.m_map=null},e.prototype.show=function(){Context.mapMgr.m_effectMgr.onEnterMap(this),Context.mapMgr.m_roomShadeMgr.onEnterMap(this),this.m_map.mapRoot.parent||Context.mapMgr.sceneRoot.addChild(this.m_map.mapRoot),this.m_map.startRendering()},e.prototype.hide=function(){Context.mapMgr.m_effectMgr.onLeaveMap(this),Context.mapMgr.m_roomShadeMgr.onLeaveMap(this),this.m_map.mapRoot.parent&&Context.mapMgr.sceneRoot.removeChild(this.m_map.mapRoot),this.m_map.stopRendering()},e.prototype.updateMapStop=function(t){var e=Context.mapConfigMgr.getStopData(t);e&&this.m_map.m_config.updateMapStop(e)},e}();t.MapControl=e,__reflect(e.prototype,"scene.MapControl")}(scene||(scene={}));var scene;!function(t){var e=function(){function t(){this.m_dicEffect={}}return t.prototype.onEnterMap=function(t){this.clearEffect()},t.prototype.onLeaveMap=function(t){this.clearEffect()},t.prototype.clearEffect=function(){var t=this.m_dicEffect;for(var e in t)t[e].stop(!0);UtilDictionary.clear(t)},t}();t.MapEffectMgr=e,__reflect(e.prototype,"scene.MapEffectMgr")}(scene||(scene={}));var scene;!function(t){var e=function(){function t(){this.m_dic={}}return t.prototype.add=function(t){var e=t.url;e in this.m_dic||(this.m_dic[e]=t,t.increment())},t.prototype.dispose=function(){for(var t in this.m_dic)this.m_dic[t].discrease();this.m_dic=null},t}();t.MapFloorImageMgr=e,__reflect(e.prototype,"scene.MapFloorImageMgr")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){this.m_count=0,this.m_currentMapControl=null,this.m_curCopyID=0,this.m_lastCopyID=0,this.m_bSwitchMapEnd=!0,this.m_timeoutKey=0,this.m_timeoutKey_test=0,this.m_sceneRoot=new t.SpriteEx,this.m_sceneRoot.name="sceneRoot",Context.stage.addEventListener(egret.Event.ENTER_FRAME,this.onStageEnterFrame,this),this.m_effectMgr=new t.MapEffectMgr,this.m_roomShadeMgr=new t.MapRoomShadeMgr}return Object.defineProperty(e.prototype,"sceneRoot",{get:function(){return this.m_sceneRoot},enumerable:!0,configurable:!0}),e.prototype.show=function(e,i,n){if(void 0===n&&(n=null),this.m_currentMapControl){if(this.m_currentMapControl.thisID==e)return;this.m_currentMapControl.dispose(),this.m_currentMapControl=null}this.m_currentMapControl=new t.MapControl,this.m_currentMapControl.init(e,i),this.m_currentMapControl.show(),this.initCameraPos(),Context.gameAreaMgr.adjustWindowPos()},e.prototype.initCameraPos=function(){var t=this.currentMap;if(t){var e=this.getMapInitPos(this.m_currentMapControl.mapID);t.currentCamera.initByPos(e.x,e.y)}},Object.defineProperty(e.prototype,"currentMap",{get:function(){return this.m_currentMapControl?this.m_currentMapControl.map:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentMapControl",{get:function(){return this.m_currentMapControl},enumerable:!0,configurable:!0}),e.prototype.bInMap=function(t){if(this.m_currentMapControl){var e=this.m_curCopyID>0?this.m_curCopyID:this.m_currentMapControl.thisID;return t==e}return!1},e.prototype.onStageEnterFrame=function(){this.m_currentMapControl&&this.m_currentMapControl.map.onFrameEnd()},e.prototype.updateStateOfSwitchMap=function(){0==this.m_bSwitchMapEnd?0==this.m_timeoutKey&&(this.m_timeoutKey=egret.setTimeout(this.switchMapEnd,this,2e3),Context.logMgr.addLog(" -- egret.setTimeout copyid="+this.m_curCopyID+" m_timeoutKey="+this.m_timeoutKey+" m_timeoutKey_test="+this.m_timeoutKey_test),this.m_timeoutKey_test=window.setTimeout(this.switchMapEnd_test,this,2e3)):(this.m_timeoutKey>0&&(egret.clearTimeout(this.m_timeoutKey),this.m_timeoutKey=0),this.m_timeoutKey_test>0&&(window.clearTimeout(this.m_timeoutKey_test),this.m_timeoutKey_test=0))},e.prototype.switchMapEnd_test=function(){Context.logMgr.addLog(" -- switchMapEnd_test() copyid="+this.m_curCopyID+" timeoutKey_test="+this.m_timeoutKey_test)},e.prototype.switchMapBegin=function(){Context.logMgr.addLog(" -- switchMapBegin() copyid="+this.m_curCopyID+" m_bSwitchMapEnd"+this.m_bSwitchMapEnd),this.m_bSwitchMapEnd&&(this.m_bSwitchMapEnd=!1,this.updateStateOfSwitchMap())},e.prototype.switchMapEnd=function(){this.m_bSwitchMapEnd=!0,this.updateStateOfSwitchMap(),egret.log("------------ [切换地图] switchMapEnd  m_timeoutKey="+this.m_timeoutKey),Context.logMgr.addLog(" -- switchMapEnd() copyid="+this.m_curCopyID+" m_timeoutKey="+this.m_timeoutKey);var t=sound.SOUND_mainbg;Context.soundMgr.playBgMusic(t)},Object.defineProperty(e.prototype,"bSwitchMaping",{get:function(){return 0==this.m_bSwitchMapEnd},enumerable:!0,configurable:!0}),e.prototype.getMapInitPos=function(t){var e=new egret.Point(0,0),i=Context.dataXmlMgr.getJson(dataXml.XML_mapfurniture);for(var n in i.map)if(i.map[n].id==t){e.x=i.map[n].initX,e.y=i.map[n].initY;break}return e},e.prototype.reset_to_beforeLogin=function(){this.m_currentMapControl&&(this.m_currentMapControl.dispose(),this.m_currentMapControl=null)},e.prototype.showRoomMap=function(){var e=Context.dataXmlMgr.getJson(dataXml.XML_mapfurniture),i=e.map[0].id;Context.mapMgr.show(i,i);var n=Context.mapMgr.currentMap;Context.headLabelMgr.setParent(n.getLayer(t.SLHeadLabel)),Context.playerMgr.createMainPlayer(),egret.Tween.get(this).wait(5e3).call(Context.playerMgr.onShowGuest,Context.playerMgr)},e}();t.MapMgr=e,__reflect(e.prototype,"scene.MapMgr")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){this.m_dicRoomShadeImg={}}return e.prototype.onEnterMap=function(e){if(this.m_map=e,this.clearShadeImg(),!this.m_dicRoomData){this.m_dicRoomData={};var i=Context.dataXmlMgr.getJson(dataXml.XML_mapfurniture).map[0].room;for(var n in i)this.m_dicRoomData[i[n].id]=i[n]}var o,r=Context.heroinfoMgr.guan,s=0,a="";for(var n in this.m_dicRoomData)if(o=this.m_dicRoomData[n],o.openguan>r){var h=this.m_dicRoomShadeImg[o.id];h||(h=new eui.Image(UtilTools.uiimagePath(o.shadeImg)),h.scaleX=5,h.scaleY=5,h.x=o.shadeX,h.y=o.shadeY,this.m_dicRoomShadeImg[o.id]=h),e.map.getLayer(t.SLRoomShade).addChild(h)}else o.openguan>=s&&(a=o.mapstop);a&&e.updateMapStop(a)},e.prototype.onLeaveMap=function(t){this.clearShadeImg(),this.m_map=null},e.prototype.updateRoomOpen=function(t){var e,i=this.m_dicRoomShadeImg,n=0,o="";for(var r in i){var s=this.m_dicRoomData[r].openguan;t>=s&&(e=i[r],e&&e.parent&&e.parent.removeChild(e),UtilUI.disposeDisplayObject(e),delete i[r],s>=n&&(o=this.m_dicRoomData[r].mapstop))}o&&this.m_map&&this.m_map.updateMapStop(o)},e.prototype.clearShadeImg=function(){var t,e=this.m_dicRoomShadeImg;for(var i in e)t=e[i],t&&UtilUI.disposeDisplayObject(t);UtilDictionary.clear(e)},e}();t.MapRoomShadeMgr=e,__reflect(e.prototype,"scene.MapRoomShadeMgr")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){}return e.prototype.createEff=function(e,i){var n=Context.mapMgr.currentMap,o=n.createObject(t.fEffect,"dianjidimian",e,i,0);o.addEventListener(egret.Event.COMPLETE,this.onComplete,this),o.loop=!1,o.play()},e.prototype.onComplete=function(t){var e=t.target;e.removeEventListener(egret.Event.COMPLETE,this.onComplete,this);var i=Context.mapMgr.currentMap;i&&i.hasRenderableElement(e)&&Context.mapMgr.currentMap.removeObject(e,!0)},e}();t.MapClickEff=e,__reflect(e.prototype,"scene.MapClickEff")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(e){this.m_bshowCanTouch=!0,this.m_touchStatus=!1,this.m_globalPos=egret.Point.create(0,0),this.m_mouseMovePos=egret.Point.create(0,0),this.m_clickStagePos=egret.Point.create(0,0),this.m_mapRoot=e.mapRoot,this.m_mapClickEff=new t.MapClickEff,this.m_mapRoot.touchEnabled=!0,this.m_mapRoot.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onMouseDown,this),this.m_mapRoot.addEventListener(egret.TouchEvent.TOUCH_END,this.onMouseUp,this)}return Object.defineProperty(e.prototype,"canTouch",{get:function(){return this.m_bshowCanTouch},set:function(t){this.m_bshowCanTouch=t},enumerable:!0,configurable:!0}),e.prototype.onMouseDown=function(t){if(this.m_bshowCanTouch){var e=(imageLoad.ImageLoadItem.s_nTotalTexture,imageLoad.ImageLoadItem.s_nDisposeTexture,imageLoad.ImageLoadItem.s_sizeTotalTexture,imageLoad.ImageLoadItem.s_sizeDisposeTexture,t.stageX-this.m_mapRoot.x),i=t.stageY-this.m_mapRoot.y;
if(this.m_touchStatus=!0,this.m_clickStagePos.setTo(e,i),this.m_mouseMovePos.setTo(e,i),this.m_mapRoot.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMouseMove,this),this.m_clickStagePos.x==e&&this.m_clickStagePos.y==i){var n=Context.mapMgr.currentMap;if(!n)return;n.convertStageToScene(e,i,this.m_globalPos);var o=n.translateStageCoordsToElements(this.m_globalPos.x,this.m_globalPos.y),r=0,s=o.length,a=void 0;for(r=0;!a&&s>r;++r){var h=o[r];if(h instanceof sceneApp.PlayerOther){a=h;break}}if(a){var m=Context.uimgr.getFirstLayer();this.circleTimer||(this.circleTimer=new uicommon.CircleTimer,m&&m.addChild(this.circleTimer)),this.circleTimer.init(1e3,70,!0,"furniture.bg_caozuoyuandi_png",100),this.circleTimer.x=t.stageX,this.circleTimer.y=t.stageY,this.circleTimer.setComplete_callback(a.onClick,a),this.circleTimer.start()}}}},e.prototype.onMouseUp=function(t){this.m_touchStatus=!1,this.m_mapRoot.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMouseMove,this);var e=t.stageX-this.m_mapRoot.x,i=t.stageY-this.m_mapRoot.y;if(Context.stageX=t.stageX,Context.stageY=t.stageY,this.m_clickStagePos.x==e&&this.m_clickStagePos.y==i){var n=Context.mapMgr.currentMap;if(!n)return;n.convertStageToScene(e,i,this.m_globalPos);var o=n.translateStageCoordsToElements(this.m_globalPos.x,this.m_globalPos.y),r=!1,s=0,a=o.length;for(this.circleTimer&&this.circleTimer.getCount()<3e3&&(this.circleTimer.dispose(),this.circleTimer=null),s=0;!r&&a>s;++s){var h=o[s];if(h instanceof sceneApp.PlayerOther){r=!0;break}}if(!r){if(n.isStopPoint_PixelPos(this.m_globalPos.x,this.m_globalPos.y))return;this.m_mapClickEff.createEff(this.m_globalPos.x,this.m_globalPos.y);var m=Context.playerMgr.getPlayerMain();m?(m.stopTalk(),m.moveToDesPos(this.m_globalPos)):(Context.logMgr.sendServer("----------- not PlayerMain!"),egret.log("----------- not PlayerMain!"))}}},e.prototype.onMouseMove=function(t){if(this.m_touchStatus){var e=Context.mapMgr.currentMap;if(e){this.circleTimer&&this.circleTimer.getCount()<3e3&&(this.circleTimer.dispose(),this.circleTimer=null);var i=t.stageX-this.m_mapRoot.x,n=t.stageY-this.m_mapRoot.y,o=i-this.m_mouseMovePos.x,r=n-this.m_mouseMovePos.y;e.currentCamera.gotoPos(e.currentCamera.x-o,e.currentCamera.y-r),this.m_mouseMovePos.setTo(i,n)}}},e.prototype.dispose=function(){egret.Point.release(this.m_globalPos),this.m_globalPos=null,this.m_mapRoot.touchEnabled=!1,this.m_mapRoot.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onMouseDown,this),this.m_mapRoot.removeEventListener(egret.TouchEvent.TOUCH_END,this.onMouseUp,this),this.m_mapRoot.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMouseMove,this),this.m_mapRoot=null},e}();t.MapEventProcesser=e,__reflect(e.prototype,"scene.MapEventProcesser")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){this.m_data={},this.m_header=new t.stMapFileHeader}return e.prototype.setPoint=function(t,e,i){var n=this.m_header.width*e+t;this.m_data[n]=i},e.prototype.getPoint=function(t,e){var i=this.m_header.width*e+t;return this.m_data[i]},e.prototype.getAllStopPoint=function(){var t,e=[];for(t in this.m_data){var i=this.m_data[t];if((1&i)>0){var n=parseInt(t,10),o=n%this.m_header.width,r=Math.floor(n/this.m_header.width);e.push(new egret.Point(o,r))}}return e},e.prototype.getAllTranslucent=function(){var t,e=[];for(t in this.m_data){var i=this.m_data[t];if((4&i)>0){var n=parseInt(t,10),o=n%this.m_header.width,r=Math.floor(n/this.m_header.width);e.push(new egret.Point(o,r))}}return e},e.prototype.parse=function(e){this.m_bytes=e,this.m_header.parseByteArray(e);for(var i=new t.stSrvMapTile,n=0,o=0,r=this.m_header;o<r.height;){for(n=0;n<r.width;)i.parseByteArray(this.m_bytes),0!=i.flags&&this.setPoint(n,o,i.flags),++n;++o}},e.prototype.resetStop=function(t){UtilDictionary.clear(this.m_data),this.parse(t)},e}();t.fMapStop=e,__reflect(e.prototype,"scene.fMapStop")}(scene||(scene={}));var scene;!function(t){var e=function(){function t(){this.ver=0,this.width=0,this.height=0}return t.prototype.parseByteArray=function(t){this.ver=t.readUnsignedInt(),this.width=t.readUnsignedInt(),this.height=t.readUnsignedInt()},t}();t.stMapFileHeader=e,__reflect(e.prototype,"scene.stMapFileHeader")}(scene||(scene={}));var scene;!function(t){var e=function(){function t(){this.flags=0,this.type=0}return t.prototype.parseByteArray=function(t){this.flags=t.readUnsignedByte(),this.type=t.readUnsignedByte()},t}();t.stSrvMapTile=e,__reflect(e.prototype,"scene.stSrvMapTile")}(scene||(scene={}));var scene;!function(t){var e=function(){function t(){this.mActID=0,this.mLoop=!1,this.mBackwardPlay=!1}return t.prototype.copyFrom=function(t){this.mActID=t.mActID,this.mLoop=t.mLoop,this.mBackwardPlay=t.mBackwardPlay},t.prototype.isEqualTo=function(t,e,i){return this.mActID==t&&this.mLoop==e&&this.mBackwardPlay==i},t}();t.Action=e,__reflect(e.prototype,"scene.Action")}(scene||(scene={}));var DebugPlatform=function(){function t(){this.jsVersion="1.0.0",this.shareCharid=0,this.funcType=0,this.sceneID=""}return t.prototype.authorize=function(t,e,i,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.isAuthorize=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getShareInfo=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getLaunchOptionsSync=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.pay=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.share=function(t,e,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.loginOut=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.memoryWarning=function(t){},t.prototype.triggerGC=function(){},t.prototype.setUserCloudStorage=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.sendMsgToOpenDataContext=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.startRewardVideo=function(t,e){},t.prototype.showBanner=function(t){},t.prototype.hideBanner=function(){},t.prototype.isNewPlayer=function(){return!1},t.prototype.vibrate=function(){},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var scene;!function(t){var e=function(){function e(t,e){this.m_dicLayer={},this.m_assetCreated=!1,this.m_dicLayer=e,this.m_model=Context.modelDataMgr.getModelData(t),Context.modelDataMgr.addUser(this.m_model,this)}return e.prototype.createAsset=function(){0==this.m_assetCreated&&(this.m_assetCreated=!0,this.m_container=t.fMap.s_getSprite(),this.m_modelMC=new t.ModelMovieclip(this.m_model.name))},e.prototype.clearAsset=function(){this.m_container&&(t.fMap.s_collectSprite(this.m_container),this.m_container=null,this.m_modelMC.dispose(),this.m_modelMC=null,this.m_assetCreated=!1)},Object.defineProperty(e.prototype,"isAssetCreated",{get:function(){return this.m_assetCreated},enumerable:!0,configurable:!0}),e.prototype.show=function(t,e,i){var n=this.m_modelMC.getActMovieClip(t);this.m_curImage!=n&&(this.m_curImage&&this.m_curImage.parent&&this.m_curImage.parent.removeChild(this.m_curImage),n&&(n.parent||this.m_container.addChild(n)),this.m_curImage=n),n&&n.setDir_frame(e,i)},e.prototype.dispose=function(){this.clearAsset(),Context.modelDataMgr.removeUser(this.m_model,this)},e.prototype.getLayer=function(t){return this.m_dicLayer[t]},Object.defineProperty(e.prototype,"container",{get:function(){return this.m_container},enumerable:!0,configurable:!0}),e}();t.AdditionalModel=e,__reflect(e.prototype,"scene.AdditionalModel")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){this.m_dicAddtionalModel={},this.m_dicDir_AddtionalModelList={};for(var t,e=0,i=UtilModel.m_allDir;e<i.length;e++)t=i[e],this.m_dicDir_AddtionalModelList[t]=[0]}return e.prototype.addAdditionalModel=function(e,i){if(!this.m_dicAddtionalModel.hasOwnProperty[e]){var n=new t.AdditionalModel(e,i);this.m_dicAddtionalModel[e]=n;for(var o,r=0,s=UtilModel.m_allDir;r<s.length;r++){o=s[r];var a=this.m_dicDir_AddtionalModelList[o],h=n.getLayer(o),m=a.length,c=0,u=void 0;for(c=0;m>c;c++){var l=a[c];if(u=l instanceof t.AdditionalModel?l.getLayer(o):l,u>=h){a.splice(c,0,n);break}}}}},e.prototype.removeAdditionalModel=function(t){var e=this.m_dicAddtionalModel[t];if(e){e.dispose(),delete this.m_dicAddtionalModel[t];for(var i=void 0,n=0,o=UtilModel.m_allDir;n<o.length;n++){i=o[n];var r=this.m_dicDir_AddtionalModelList[i];UtilArray.removeItem(r,e)}}},Object.defineProperty(e.prototype,"dicAddtionalModel",{get:function(){return this.m_dicAddtionalModel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return UtilDictionary.isEmpty(this.m_dicAddtionalModel)},enumerable:!0,configurable:!0}),e.prototype.getLayerList=function(t){return this.m_dicDir_AddtionalModelList[t]},e}();t.AdditionalModelMgr=e,__reflect(e.prototype,"scene.AdditionalModelMgr")}(scene||(scene={}));var Table;!function(t){t.TABLE_OBJECT="objbase_client.tbl",t.TABLE_ARTMAP="artmap_client.tbl",t.TABLE_EFFECT="effect_client.tbl",t.TABLE_SENSITIVEWORD="sensitiveword_client.tbl",t.TABLE_Model="model_client.tbl",t.TABLE_Goods="goods_client.tbl";var e=function(){function e(){this.m_dicTable={},this.m_dicTableName={};var e=this.m_dicTableName;e[t.TABLE_OBJECT]=new t.TableConfigItem(t.TObjectItem,"道具表.xlsx"),e[t.TABLE_ARTMAP]=new t.TableConfigItem(t.TArtMapItem,"地图.xlsx"),e[t.TABLE_EFFECT]=new t.TableConfigItem(t.TEffectItem,"特效.xlsx",new t.CTable_Dictionary(t.TEffectItem,"m_name")),e[t.TABLE_SENSITIVEWORD]=new t.TableConfigItem(t.TSensitiveWordItem,"敏感词库.xlsx - 敏感词库"),e[t.TABLE_Model]=new t.TableConfigItem(t.TModelItem,"模型.xlsx",new t.CTable_Dictionary(t.TModelItem,"m_name")),e[t.TABLE_Goods]=new t.TableConfigItem(t.TGoodsItem,"物品表.xlsx",new t.CTable_Dictionary(t.TGoodsItem,"m_name"))}return e.prototype.getTable=function(t){var e=this.m_dicTable[t];return null==e&&(this.loadOneTable(t),e=this.m_dicTable[t]),e.getItems()},e.prototype.getItem=function(t,e){var i=this.m_dicTable[t];null==i&&(this.loadOneTable(t),i=this.m_dicTable[t]);var n=i.getItem(e);if(!n){var o="tbl表("+t+")缺少编号为"+e+"的记录";o=UtilCommon.getStackInfo(o),Context.logMgr.sendServer(o),Context.logMgr.showWarning(o)}return n},e.prototype.getItemByKey=function(t,e){var i=this.m_dicTable[t];null==i&&(this.loadOneTable(t),i=this.m_dicTable[t]);var n=i.getItemByKey(e);if(!n){var o="tbl表("+t+")缺少key为"+e+"的记录";Context.logMgr.showWarning(o)}return n},e.prototype.loadOneTable=function(t){var e=this.m_dicTableName[t],i=this.getTableByteArray(t),n=e.m_table;n.init(i),this.m_dicTable[t]=n},e.prototype.loadInitTable=function(){this.m_zip=new JSZip;var t=RES.getRes("table_zip");this.m_zip.load(t,{}),RES.destroyRes("table_zip")},e.prototype.getTableByteArray=function(t){var e=this.m_zip.file(t).asArrayBuffer(),i=new egret.ByteArray(e);return i},e}();t.DataTableMgr=e,__reflect(e.prototype,"Table.DataTableMgr")}(Table||(Table={}));var scene;!function(t){var e=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.m_being=t,n}return __extends(i,e),i.prototype.createAssets=function(){e.prototype.createAssets.call(this),this.m_shadow=t.fMap.s_getBitmap(),this.m_shadow.anchorOffsetX=95,this.m_shadow.anchorOffsetY=45,this.m_eleRoot.addChild(this.m_shadow),this.m_eleRoot.setChildIndex(this.m_shadow,0);var i=UtilTools.uiimagePath("shadow");Context.imageLoaderMgr.isLoaded(i)?(this.m_imageLoader=Context.imageLoaderMgr.getImageLoadItem(i),this.onShadowLoaded()):this.m_imageLoader=Context.imageLoaderMgr.load(i,this.onShadowLoaded,this.onShadowLoadFailed,this),this.m_imageLoader.increment()},i.prototype.onShadowLoaded=function(){this.m_shadow.texture=this.m_imageLoader.texture},i.prototype.onShadowLoadFailed=function(){},i.prototype.dispose=function(){this.m_assetsCreated&&(Context.imageLoaderMgr.removeListener(this.m_imageLoader,this.onShadowLoaded,this.onShadowLoadFailed,this),this.m_imageLoader.discrease(),this.m_imageLoader=null,t.fMap.s_collectBitmap(this.m_shadow),this.m_shadow=null),e.prototype.dispose.call(this)},i}(t.fObjectRender);t.BeingEntityRender=e,__reflect(e.prototype,"scene.BeingEntityRender")}(scene||(scene={}));var Table;!function(t){var e=function(){function e(e,i,n){void 0===n&&(n=null),this.m_excelName=i,this.m_recordClass=e,null==n&&(n=new t.CTable(e)),this.m_table=n}return e}();t.TableConfigItem=e,__reflect(e.prototype,"Table.TableConfigItem")}(Table||(Table={}));var Table;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parseByteArray=function(e){t.prototype.parseByteArray.call(this,e),this.m_w=e.readUnsignedShort(),this.m_h=e.readUnsignedShort()},e}(t.TDataItem);t.TArtMapItem=e,__reflect(e.prototype,"Table.TArtMapItem")}(Table||(Table={}));var scene;!function(t){var e=function(){function e(t,e){return this.m_dicDir={},this.m_modelData=t,this.m_act=e,this.m_config=this.m_modelData.config.getActConfig(e),this.m_config?(this.m_sw=this.m_config.sw,void(this.m_sh=this.m_config.sh)):void Context.logMgr.showError("模型缺少资源 "+t.name+" act="+e)}return Object.defineProperty(e.prototype,"modelData",{get:function(){return this.m_modelData},enumerable:!0,configurable:!0}),e.prototype.getDirData=function(e){var i=this.m_dicDir[e];return null==i&&(i=new t.ModelDirData(this,e),this.m_dicDir[e]=i),i},Object.defineProperty(e.prototype,"act",{get:function(){return this.m_act},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sw",{get:function(){return this.m_sw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sh",{get:function(){return this.m_sh},enumerable:!0,configurable:!0}),e.prototype.getDirSx=function(t){var e=UtilModel.angle2ResAngle(t),i=this.getDirData(e);if(e==t)return i.sx;var n=this.m_modelData.config.tModelItem.m_pivotX-i.sx,o=i.w-n,r=i.sx-(o-n);return r},e.prototype.getDirSy=function(t){var e=UtilModel.angle2ResAngle(t),i=this.getDirData(e);return i.sy},e.prototype.getDirW=function(t){var e=UtilModel.angle2ResAngle(t),i=this.getDirData(e);return i.w},e.prototype.getDirH=function(t){var e=UtilModel.angle2ResAngle(t),i=this.getDirData(e);return i.h},e.prototype.dispose=function(){var t,e;for(t in this.m_dicDir)e=this.m_dicDir[t],e.dispose();UtilDictionary.clear(this.m_dicDir),this.m_dicDir=null,this.m_config=null,this.m_modelData=null},e}();t.ModelActData=e,__reflect(e.prototype,"scene.ModelActData")}(scene||(scene={}));var scene;!function(t){var e=function(){function t(t,e){this.m_name=t,this.m_config=e,this.m_tModelItem=Context.dataTableMgr.getItemByKey(Table.TABLE_Model,t)}return Object.defineProperty(t.prototype,"name",{get:function(){return this.m_name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tModelItem",{get:function(){return this.m_tModelItem},enumerable:!0,configurable:!0}),t.prototype.getDirConfig=function(t,e){var i=this.m_config[t];return i?i[e]:null},t.prototype.getActBound=function(t,e){var i=this.getActConfig(t);if(!i)return!1;if(!this.m_tModelItem)return egret.log("model Error! ModelConfig.ts::getActBound() name"+this.m_name),!1;var n=UtilModel.m_sResAngles,o=0,r=n.length;for(o=0;r>o;o++){var s=i[n[o]];if(s){var a=s.frames,h=a[0],m=h.frame;return e.width=m.w,e.height=m.h,e.x=-this.m_tModelItem.m_pivotX+h.sx,e.y=-this.m_tModelItem.m_pivotY+h.sy,!0}}return!1},t.prototype.getNFrame=function(t){var e=this.getDirConfig(t,1);if(e||(e=this.getDirConfig(t,3)),e){var i=e.frames;return i.length}return 0},t.prototype.getActConfig=function(t){return this.m_config[t]},t.prototype.getBound=function(t){var e=[0,1,2,3],i=0;for(i=0;i<e.length;i++)if(this.getActBound(e[i],t))return!0;return!1},t}();t.ModelConfig=e,__reflect(e.prototype,"scene.ModelConfig")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){this.m_dicConfig={}}return e.prototype.load=function(){this.m_zip=new JSZip;var t=RES.getRes("model_zip");this.m_zip.load(t,{})},e.prototype.getModelConfig=function(e){var i=this.m_dicConfig[e];if(!i)try{var n=e+".json",o=this.m_zip.file(n),r=o.asText(),s=JSON.parse(r);i=new t.ModelConfig(e,s),this.m_dicConfig[e]=i}catch(a){Context.system.logException(a),Context.logMgr.showError("错误:modelname="+e)}return i},e}();t.ModelConfigMgr=e,__reflect(e.prototype,"scene.ModelConfigMgr")}(scene||(scene={}));var scene;!function(t){var e=function(e){function i(t){var i=e.call(this,t)||this;if(i.m_dicAct={},i.m_config=Context.modelConfigMgr.getModelConfig(t),!i.m_config){Context.logMgr.showError("ModelData::constructor 缺失模型配置 name="+t),Context.logMgr.sendServer("ModelData::constructor 缺失模型配置 name="+t);try{var n=void 0;n.d}catch(o){Context.system.logException(o)}}return i}return __extends(i,e),i.prototype.createActData=function(e){var i=this.m_dicAct[e];i||(i=new t.ModelActData(this,e),this.m_dicAct[e]=i)},i.prototype.getActData=function(t){var e=this.m_dicAct[t];return e||(this.createActData(t),e=this.m_dicAct[t]),e},i.prototype.hasAct=function(t){return null!=this.getActData(t)},i.prototype.getDirData=function(t,e){var i,n=this.getActData(t);return i=n.getDirData(e)},Object.defineProperty(i.prototype,"config",{get:function(){return this.m_config},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){var t,i;for(t in this.m_dicAct)i=this.m_dicAct[t],i.dispose();UtilDictionary.clear(this.m_dicAct),this.m_dicAct=null,this.m_config=null,e.prototype.dispose.call(this)},i}(dataset.TimeResourceBase);t.ModelData=e,__reflect(e.prototype,"scene.ModelData")}(scene||(scene={}));var scene;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.getModelData=function(e){var i=this.getResource(e);return i||(i=new t.ModelData(e)),i},i}(dataset.TimeResourceMgrBase);t.ModelDataMgr=e,__reflect(e.prototype,"scene.ModelDataMgr")}(scene||(scene={}));var scene;!function(t){var e=function(){function t(t,e){this.m_sx=Number.NaN,this.m_sy=Number.NaN,this.m_w=Number.NaN,this.m_h=Number.NaN,this.m_gpuTexureUse=!1,this.m_modelActData=t,this.m_dir=e,this.m_modelConfig=this.m_modelActData.modelData.config,this.m_dirConfig=this.m_modelConfig.getDirConfig(this.m_modelActData.act,this.m_dir),this.m_mvList=[]}return t.prototype.addMV=function(t){var e=this.m_mvList.indexOf(t);-1==e?this.m_mvList.push(t):egret.log("addMV i == -1 = "+(-1==e))},t.prototype.removeMV=function(t){var e=this.m_mvList.indexOf(t);e>=0?this.m_mvList.splice(e,1):egret.log("removeMV i>=0 = "+(e>=0))},t.prototype.onUseTextures=function(t){this.m_gpuTexureUse||(this.m_gpuTexureUse=!0,this.m_imageLoader.useTextures())},t.prototype.onNotUseTextures=function(t){if(this.m_gpuTexureUse){var e=0,i=this.m_mvList.length;for(e=0;i>e;e++)if(this.m_mvList[e].getIsGPUTexureUse())return;this.m_gpuTexureUse=!1,this.m_imageLoader.disuseTextures()}},t.prototype.getModelActData=function(){return this.m_modelActData},t.prototype.compute_sxy=function(){var t=this.m_dirConfig.frames;if(t&&t.length){var e=t[0];if(e){this.m_sx=e.sx,this.m_sy=e.sy;var i=e.frame;return this.m_w=i.w,void(this.m_h=i.h)}}this.m_sx=0,this.m_sy=0,this.m_w=0},Object.defineProperty(t.prototype,"sx",{get:function(){return isNaN(this.m_sx)&&this.compute_sxy(),this.m_sx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sy",{get:function(){return isNaN(this.m_sy)&&this.compute_sxy(),this.m_sy},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"w",{get:function(){return isNaN(this.m_w)&&this.compute_sxy(),this.m_w},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"h",{get:function(){return isNaN(this.m_h)&&this.compute_sxy(),this.m_h},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loaded",{get:function(){return this.m_imageLoader&&this.m_imageLoader.loaded},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasRequest",{get:function(){return!!this.m_imageLoader},enumerable:!0,configurable:!0}),t.prototype.onLoaded=function(){this.createTextures()},t.prototype.onLoadFailed=function(){},t.prototype.createTextures=function(){if(!this.m_dirConfig){var t="模型缺少配置信息 name="+this.m_modelConfig.name+" act="+this.m_modelActData.act+" dir="+this.m_dir;return Context.logMgr.showError(t),void egret.log(t)}var e=this.m_imageLoader.texture,i=this.m_dirConfig.frames,n=i.length,o=0;this.m_textures=[];var r=this.m_modelActData.sw,s=this.m_modelActData.sh;for(o=0;n>o;o++){var a=i[o],h=a.frame,m=new egret.Texture;m.$bitmapData=e.bitmapData,m.$initData(h.x,h.y,h.w,h.h,a.sx,a.sy,r,s,e.$sourceWidth,e.$sourceHeight),this.m_textures[o]=m}},t.prototype.load=function(){if(!this.m_imageLoader){var t=UtilTools.modelPath(this.m_modelConfig.name,this.m_modelActData.act,this.m_dir);if(Context.imageLoaderMgr.isLoaded(t))this.m_imageLoader=Context.imageLoaderMgr.getImageLoadItem(t),this.createTextures();else{if(Context.imageLoaderMgr.isLoadFailed(t))return;this.m_imageLoader=Context.imageLoaderMgr.load(t,this.onLoaded,this.onLoadFailed,this)}this.m_imageLoader.increment()}},t.prototype.useTextures=function(){return this.m_textures},t.prototype.dispose=function(){if(this.m_imageLoader&&(Context.imageLoaderMgr.removeListener(this.m_imageLoader,this.onLoaded,this.onLoadFailed,this),this.m_imageLoader.discrease(),this.m_imageLoader=null),this.m_modelActData=null,this.m_modelConfig=null,this.m_dirConfig=null,this.m_mvList.length=0,this.m_textures){for(var t=this.m_textures.length,e=void 0,i=t-1;i>=0;i--)e=this.m_textures[i],e.dispose(),e=null;this.m_textures.length=0}},t}();t.ModelDirData=e,__reflect(e.prototype,"scene.ModelDirData")}(scene||(scene={}));var scene;!function(t){var e=function(){function t(){this.m_actID=0,this.m_duration=0,this.m_srcActID=0,this.m_frameList=new Array}return t.prototype.parse=function(t){var e=t.split(":");this.m_actID=e[0],this.m_duration=e[1],this.m_srcActID=e[2],t=e[3],e=t.split(",");var i=0,n=e.length;for(i=0;n>i;i++)if(t=e[i],t.indexOf("-")>=0){var o=t.split("-"),r=o[0],s=o[1],a=0,h=0;for(h=s>=r?1:-1,a=r;s>=a;a+=h)this.m_frameList.push(a)}else this.m_frameList.push(parseInt(t))},t}();t.NewActDefine=e,__reflect(e.prototype,"scene.NewActDefine")}(scene||(scene={}));var scene;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.m_obj=t,i.m_effList=new Array,i}return __extends(i,e),i.prototype.addEffect=function(e,n,o){void 0===o&&(o=!0);var r=new t.EffectOnBeingItem;return r.mEffectOnBeing=this,r.mPosition=n,r.loop=o,r.mID=i.s_EffectOnNpcItemItem++,r.mEffName=e,this.m_effList.push(r),this.m_obj.onAddEffect(r.mID),r.mID},i.prototype.removeEffect=function(t){var e,i=0,n=this.m_effList.length;for(i=0;n>i;i++)if(e=this.m_effList[i],e.mID==t)return e.dispose(),void this.m_effList.splice(i,1)},i.prototype.getEffectByIndex=function(t){return this.m_effList[t]},i.prototype.getEffectByID=function(t){var e=0,i=this.m_effList.length;for(e=0;i>e;e++)if(this.m_effList[e].mID==t)return this.m_effList[e];return null},i.prototype.dispose=function(){var t,e=0,i=this.m_effList.length;for(e=0;i>e;e++)t=this.m_effList[e],t.dispose();this.m_effList.length=0},i.prototype.createAllEffectEntity=function(t){var e=0,i=this.m_effList.length;for(e=0;i>e;e++)this.m_effList[e].createEffectEntity(t)},i.prototype.removeAllEffectEntity=function(){var t=0,e=this.m_effList.length;for(t=0;e>t;t++)this.m_effList[t].removeEffectEntity()},Object.defineProperty(i.prototype,"obj",{get:function(){return this.m_obj},enumerable:!0,configurable:!0}),i.prototype.setOffset=function(t,e,i){var n=this.getEffectByID(t);n&&n.setOffset(e,i)},i.s_EffectOnNpcItemItem=0,i}(egret.HashObject);t.EffectOnBeing=e,__reflect(e.prototype,"scene.EffectOnBeing")}(scene||(scene={}));var scene;!function(t){var e=function(){function t(){this.mID=0,this.m_xOffset=0,this.m_yOffset=0,this.m_loop=!0}return t.prototype.createEffectEntity=function(t){this.mEff||(this.mEff=new core.EffectMovieclip(this.mEffName),this.mEff.setParent(t),this.mEff.x=this.m_xOffset,this.mEff.y=this.mEffectOnBeing.obj.getPositionY(this.mPosition)+this.m_yOffset,this.mEff.loop=this.m_loop,this.m_loop||this.mEff.addEventListener(egret.Event.COMPLETE,this.onEffComplete,this),this.mEff.play())},t.prototype.onEffComplete=function(){this.mEffectOnBeing.removeEffect(this.mID)},Object.defineProperty(t.prototype,"loop",{set:function(t){this.m_loop=t},enumerable:!0,configurable:!0}),t.prototype.setOffset=function(t,e){this.m_xOffset=t,this.m_yOffset=e,this.mEff&&(this.mEff.x=this.m_xOffset,this.mEff.y=this.mEffectOnBeing.obj.getPositionY(this.mPosition)+this.m_yOffset)},t.prototype.removeEffectEntity=function(){this.mEff&&(this.m_loop||this.mEff.removeEventListener(egret.Event.COMPLETE,this.onEffComplete,this),this.mEff.dispose(),this.mEff=null)},t.prototype.dispose=function(){this.mEffName=null,this.mID=0,this.removeEffectEntity()},t}();t.EffectOnBeingItem=e,__reflect(e.prototype,"scene.EffectOnBeingItem")}(scene||(scene={}));var scene;!function(t){var e=function(e){function i(t,i){var n=e.call(this,i)||this;n.m_isAddToJuggle=!0,n.m_currentTime=0,n.m_effConfig=Context.effectConfigMgr.getModelConfig(t);var o=n.m_effConfig.nFrame;return n.m_effTimer=new animation.AnimationTimer(o,o/n.m_effConfig.tEffectItem.m_duration),n.m_effTimer.stop(),n}return __extends(i,e),Object.defineProperty(i.prototype,"effectConfig",{get:function(){return this.m_effConfig},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"effName",{get:function(){return this.m_effConfig.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"loop",{get:function(){return this.m_effTimer.loop},set:function(t){this.m_effTimer.loop=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"duration",{get:function(){return this.m_duration},set:function(t){this.m_duration=t},enumerable:!0,configurable:!0}),i.prototype.play=function(){this.m_effTimer.isPlaying||(this.m_currentTime=0,this.m_effTimer.currentFrame=0,this.m_effTimer.currentTime=0,this.m_effTimer.play())},Object.defineProperty(i.prototype,"currentFrame",{get:function(){return this.m_effTimer.currentFrame},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPlaying",{get:function(){return this.m_effTimer.isPlaying},enumerable:!0,configurable:!0}),i.prototype.getflash9RendererClass=function(){return t.fEffectRender},i.prototype.advanceTime=function(t){if(this.m_effTimer.isPlaying){this.m_effTimer.advanceTime(t),this.m_currentTime+=t;var i=!1;this.m_effTimer.isComplete?(this.dispatchEventWith(egret.Event.COMPLETE),i=!0):this.m_duration>0&&this.m_currentTime>t&&(this.m_effTimer.stop(),this.dispatchEventWith(egret.Event.COMPLETE),i=!0),i&&this.m_effTimer&&this.m_effTimer.stop(),e.prototype.advanceTime.call(this,t)}},i.prototype.dispose=function(){this.m_effConfig=null,this.m_effTimer.stop(),this.m_effTimer=null,e.prototype.dispose.call(this)},i}(t.fRenderableElement);t.fEffect=e,__reflect(e.prototype,"scene.fEffect")}(scene||(scene={}));var scene;!function(t){var e=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.m_eff=t,n}return __extends(i,e),i.prototype.createMV=function(){if(null==this.m_effData&&(this.m_effData=Context.effectDataMgr.getModelData(this.m_eff.effName),Context.effectDataMgr.addUser(this.m_effData,this)),!this.m_mv&&this.m_effData.loaded){var e=this.m_eff.effectConfig;this.m_mv=new t.MovieClip_NoAni(this.m_effData.textures,e.sw,e.sh),this.m_mv.anchorOffsetX=e.tEffectItem.m_pivotX,this.m_mv.anchorOffsetY=e.tEffectItem.m_pivotY,0!=e.tEffectItem.m_scalePer&&100!=e.tEffectItem.m_scalePer&&(this.m_mv.width=100*this.m_mv.width/e.tEffectItem.m_scalePer,this.m_mv.height=100*this.m_mv.height/e.tEffectItem.m_scalePer)}},i.prototype.advanceTime=function(t){if(this.isAssetCreated){if(!this.m_eff.isPlaying)return void(this.m_mv&&this.m_mv.parent&&this.m_mv.parent.removeChild(this.m_mv));this.m_mv||this.createMV(),this.m_mv&&(this.m_mv.parent||this.m_eleRoot.addChild(this.m_mv),this.m_mv.currentFrame=this.m_eff.currentFrame)}},i.prototype.dispose=function(){this.m_mv&&(this.m_mv.parent&&this.m_mv.parent.removeChild(this.m_mv),this.m_mv.dispose(),this.m_mv=null),this.m_effData&&(Context.effectDataMgr.removeUser(this.m_effData,this),this.m_effData=null),this.m_eff=null,e.prototype.dispose.call(this)},i}(t.fElementRender);t.fEffectRender=e,__reflect(e.prototype,"scene.fEffectRender")}(scene||(scene={}));var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function o(t){e.call(n,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),egret.assert(!1))}return 0==t.search("resource/default.thm.json")&&Context.resource1Loader?void o(Context.resource1Loader.getDefault_thmString()):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),void RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var scene;!function(t){var e=function(e){function i(t){return e.call(this,t)||this}return __extends(i,e),i.prototype.updateHeadTopData=function(){this.clearAutoData();var t=UtilColor.GREEN,e="更多好友";this.addAutoData(e,t),this.showInviteBtn()},i.prototype.showInviteBtn=function(){this.m_inviteBtn||(this.m_inviteBtn=new eui.Button,this.m_inviteBtn.skinName="skins.ButtonSkin",this.m_inviteBtn.anchorOffsetX=36,this.m_inviteBtn.anchorOffsetY=20,this.m_inviteBtn.width=72,this.m_inviteBtn.height=40,this.m_inviteBtn.label="邀请",this.m_inviteBtn.labelDisplay,this.m_inviteBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onInviteBtn,this),this.m_inviteBtn[t.HeadRPosX]=0,this.m_inviteBtn[t.HeadRPosY]=this.m_curTop-40,this.m_inviteBtn.validateNow(),Context.mapMgr.currentMap.getUILayer().addChild(this.m_inviteBtn)),this.m_displayList.push(this.m_inviteBtn),this.invalidPosition()},i.prototype.onInviteBtn=function(){Context.logMgr.bShowDebugBtn()&&Context.sysPromptMgr.addPrompt("点击 邀请")},i.prototype.dispose=function(){this.m_inviteBtn&&(this.m_inviteBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onInviteBtn,this),this.m_inviteBtn.parent&&this.m_inviteBtn.parent.removeChild(this.m_inviteBtn),this.m_inviteBtn=null),e.prototype.dispose.call(this)},i}(t.HeadTopBlockBase);t.HeadTopNpc=e,__reflect(e.prototype,"scene.HeadTopNpc")}(scene||(scene={}));var Table;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.parseByteArray=function(i){e.prototype.parseByteArray.call(this,i),this.m_name=t.TDataItem.readString(i),this.m_pivotX=i.readUnsignedShort(),this.m_pivotY=i.readUnsignedShort(),this.m_duration=.001*i.readUnsignedInt(),this.m_scalePer=i.readUnsignedShort()},i}(t.TDataItem);t.TEffectItem=e,__reflect(e.prototype,"Table.TEffectItem")}(Table||(Table={}));var scene;!function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i.m_timeNum=0,i}return __extends(e,t),e.prototype.updateHeadTopData=function(){this.clearAutoData();var t=this.m_fObj;if(null!=t){var e=UtilColor.GREEN;this.addAutoData(t.name,e)}},e.prototype.showBubbleReward=function(t){void 0===t&&(t=1e3)},e.prototype.hideBubbleReward=function(){this.m_timeNum>0&&(egret.clearTimeout(this.m_timeNum),this.m_timeNum=0)},e.prototype.bBubbleReward=function(){return!1},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(t.HeadTopPlayer);t.HeadTopPlayerOther=e,__reflect(e.prototype,"scene.HeadTopPlayerOther")}(scene||(scene={}));
var scene;!function(t){var e=function(t){function e(){var e,i=t.call(this)||this;return e=new egret.TextField,e.width=220,e.x=-110,e.stroke=2,e.strokeColor=6162440,e.fontFamily=UtilFont.SimHei,e.textAlign=egret.HorizontalAlign.CENTER,i.addChild(e),i.textLabel=e,i}return __extends(e,t),e}(egret.DisplayObjectContainer);t.HeadLabel=e,__reflect(e.prototype,"scene.HeadLabel")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){this.m_gc=new dataset.GCCommon(t.HeadLabel,15,null,null),this.m_list=[]}return e.prototype.reset_to_beforeLogin=function(){},e.prototype.setParent=function(t){this.m_list.length>0&&egret.log("this.m_list.length != 0 len="+this.m_list.length),this.m_parent!=t&&(this.m_parent=t)},e.prototype.get=function(){var t=this.m_gc.getObject();return this.m_parent.addChild(t),this.m_list.push(t),t},e.prototype.collect=function(t){t.parent&&t.parent.removeChild(t),1!=t.alpha&&(t.alpha=1),UtilArray.removeItem(this.m_list,t),this.m_gc.collect(t)},e}();t.HeadLabelMgr=e,__reflect(e.prototype,"scene.HeadLabelMgr")}(scene||(scene={}));var scene;!function(t){var e=function(e){function i(t,i){var n=e.call(this)||this;n.m_dir=0,n.m_dicDir={},n.m_bBackWardPlay=!1,n.m_ModelMC=t,n.m_tMI=n.m_ModelMC.tModelItem,n.m_act=i,n.m_dir=i==UtilModel.TActDie?3:0;var o,r;return o=n.m_ModelMC.config.getNFrame(n.m_act),r=n.m_tMI.getActFPS(i,o),n.m_effTimer=new animation.AnimationTimer(o,r),n}return __extends(i,e),i.prototype.setActParam=function(t){this.m_bBackWardPlay=t.mBackwardPlay,this.m_effTimer.loop=t.mLoop},i.prototype.advanceTime=function(t,e){this.m_effTimer.advanceTime(t);var i=this.m_effTimer.currentFrame,n=0;n=this.m_bBackWardPlay?this.m_frameList?this.m_frameList[this.m_frameList.length-i-1]:this.m_effTimer.numFrames-i-1:this.m_frameList?this.m_frameList[i]:i,this.setDir_frame(e,n),this.m_effTimer.isComplete&&this.dispatchEventWith(egret.Event.COMPLETE)},i.prototype.setDir_frame=function(t,e){var i=this.getDirMC(t);if(i&&(this.m_willMV&&i!=this.m_willMV&&(this.m_willMV.onNotUse(),this.m_willMV=null),i!=this.m_curMV&&(i.mv?(this.m_curMV&&(this.m_curMV.parent&&this.m_curMV.parent.removeChild(this.m_curMV),this.m_curMV.onNotUse()),this.m_curMV=i,this.m_dir=t,this.addChild(this.m_curMV),this.m_curMV.onUse()):(this.m_willMV||(this.m_willMV=i),this.m_willMV.onUse())),this.m_curMV)){var n=this.m_curMV.mv;n&&e<n.numFrames&&(n.currentFrame=e)}},i.prototype.getDirMC=function(t){var e=this.m_dicDir[t];return null==e&&(e=this.createDirMV(t),e&&(this.m_dicDir[t]=e)),e},i.prototype.createDirMV=function(e){var i=UtilModel.angle2ResAngle(e),n=this.m_ModelMC.modelData.getDirData(this.act,i);return n?new t.DirMovieClip(n,e):null},i.prototype.play=function(){this.m_effTimer.play()},i.prototype.stop=function(){this.m_effTimer.stop()},Object.defineProperty(i.prototype,"isBackwardPlay",{set:function(t){this.m_bBackWardPlay=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"act",{get:function(){return this.m_act},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dir",{get:function(){return this.m_dir},enumerable:!0,configurable:!0}),i.prototype.getCurMV=function(){return this.m_curMV},Object.defineProperty(i.prototype,"loop",{get:function(){return this.m_effTimer.loop},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"timeScale",{get:function(){return this.m_effTimer.timeScale},set:function(t){this.m_effTimer.timeScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isComplete",{get:function(){return this.m_effTimer.isComplete},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentFrame",{get:function(){return this.m_effTimer.currentFrame},set:function(t){this.m_effTimer.currentFrame=0},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this.m_ModelMC=null,this.m_curMV=null;var t;for(t in this.m_dicDir)this.m_dicDir[t].dispose()},i.prototype.isHit=function(t,e){return this.m_curMV&&this.m_curMV.isHit(t,e)},i}(egret.DisplayObjectContainer);t.ActMovieClip=e,__reflect(e.prototype,"scene.ActMovieClip")}(scene||(scene={}));var scene;!function(t){var e=function(e){function i(t,i){var n=e.call(this)||this;return n.m_delayNO=0,n.m_gpuTexureUse=!1,n.m_delayTime=5e3,n.m_modelDirData=t,t.addMV(n),n.m_dir=i,n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.onRemoveFromStage,n),n.addEventListener(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n.m_delayTime=Context.system.delayTimeForDeleteGPUTexture,n}return __extends(i,e),Object.defineProperty(i.prototype,"mv",{get:function(){return this.m_mv},enumerable:!0,configurable:!0}),i.prototype.clearDelayCall=function(){this.m_delayNO&&(egret.clearTimeout(this.m_delayNO),this.m_delayNO=0)},i.prototype.increaseUseTextures=function(){this.m_mv&&!this.m_gpuTexureUse&&(this.m_gpuTexureUse=!0,this.m_modelDirData.onUseTextures(this))},i.prototype.decreaseUseTextures=function(){this.m_mv&&this.m_gpuTexureUse&&(this.m_gpuTexureUse=!1,this.m_modelDirData.onNotUseTextures(this))},i.prototype.getIsGPUTexureUse=function(){return this.m_gpuTexureUse},i.prototype.onUse=function(){this.m_isUsed&&this.m_mv||(this.m_isUsed=!0,this.clearDelayCall(),this.m_mv||this.createMV(),this.increaseUseTextures())},i.prototype.onNotUse=function(){this.m_isUsed&&(this.m_isUsed=!1,this.isCanRemoveMV()&&(this.m_delayNO=egret.setTimeout(this.onDelayCall,this,this.m_delayTime)))},i.prototype.onDelayCall=function(){this.clearDelayCall(),this.isCanRemoveMV()&&this.decreaseUseTextures()},i.prototype.isCanRemoveMV=function(){return!this.m_isUsed&&!this.stage},i.prototype.onRemoveFromStage=function(){this.isCanRemoveMV()&&(this.m_delayNO=egret.setTimeout(this.onDelayCall,this,this.m_delayTime))},i.prototype.onAddToStage=function(){this.clearDelayCall(),this.increaseUseTextures()},i.prototype.clearMV=function(){this.m_mv&&(this.decreaseUseTextures(),this.m_mv.parent&&this.m_mv.parent.removeChild(this.m_mv),this.m_mv.dispose(),this.m_mv=null)},i.prototype.createMV=function(){if(!this.m_mv)if(this.m_modelDirData.loaded){var e=this.m_modelDirData.getModelActData(),i=e.modelData.config.tModelItem,n=UtilModel.angle2ResAngle(this.m_dir);this.m_mv=new t.MovieClip_NoAni(this.m_modelDirData.useTextures(),e.sw,e.sh),this.m_mv.anchorOffsetX=i.m_pivotX,this.m_mv.anchorOffsetY=i.m_pivotY,this.addChild(this.m_mv),n!=this.m_dir&&(this.m_mv.scaleX=-1),0!=i.m_scalePer&&100!=i.m_scalePer&&(this.m_mv.width=100*this.mv.width/i.m_scalePer,this.m_mv.height=100*this.mv.height/i.m_scalePer)}else this.m_modelDirData.hasRequest||this.m_modelDirData.load()},i.prototype.isHit=function(t,e){var i=this.m_modelDirData.getModelActData(),n=i.modelData.config.tModelItem,o=-this.m_modelDirData.sx+n.m_pivotX+t,r=-this.m_modelDirData.sy+n.m_pivotY+e;return o>=0&&o<this.m_modelDirData.w&&r>=0&&r<this.m_modelDirData.h?!0:!1},i.prototype.dispose=function(){this.clearDelayCall(),this.clearMV(),this.m_modelDirData.removeMV(this)},i}(egret.DisplayObjectContainer);t.DirMovieClip=e,__reflect(e.prototype,"scene.DirMovieClip")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(t){this.m_dicMC={},this.m_model=Context.modelDataMgr.getModelData(t),Context.modelDataMgr.addUser(this.m_model,this)}return e.prototype.dispose=function(){var t;for(t in this.m_dicMC)this.m_dicMC[t].dispose();UtilDictionary.clear(this.m_dicMC),Context.modelDataMgr.removeUser(this.m_model,this),this.m_model=null},Object.defineProperty(e.prototype,"modelData",{get:function(){return this.m_model},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tModelItem",{get:function(){return this.m_model.config.tModelItem},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return this.m_model.config},enumerable:!0,configurable:!0}),e.prototype.getActMovieClip=function(e){var i=this.m_dicMC[e];return null==i&&(i=new t.ActMovieClip(this,e),this.m_dicMC[e]=i),i},e}();t.ModelMovieclip=e,__reflect(e.prototype,"scene.ModelMovieclip")}(scene||(scene={}));var scene;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.m_withDiagonals=!0,i.m_smoothProcess=!0,i.scene=t,i}return __extends(i,e),i.prototype.findPath=function(e,i){return null==this.m_fDefaultPathfindCriteria&&(this.m_fDefaultPathfindCriteria=new t.fDefaultPathfindCriteria(this.scene,this.m_withDiagonals,this.m_smoothProcess)),this.m_fDefaultPathfindCriteria.setParam(e,i),t.fPathfindSolver.findPathAStar(this.m_fDefaultPathfindCriteria)},i.prototype.findPathByCell=function(e,i,n,o){return void 0===n&&(n=!1),void 0===o&&(o=!1),null==this.m_fDefaultPathfindCriteria&&(this.m_fDefaultPathfindCriteria=new t.fDefaultPathfindCriteria(this.scene,this.m_withDiagonals,this.m_smoothProcess)),this.m_fDefaultPathfindCriteria.setParamByCell(e,i,n,o),t.fPathfindSolver.findPathAStar(this.m_fDefaultPathfindCriteria)},i.prototype.findPathCustomCriteria=function(e){return t.fPathfindSolver.findPathAStar(e)},i.prototype.hasStopBewteenPoint=function(e,i,n,o){return t.fLineOfSightSolver.calculatePt2PtVisible(this.scene,e,i,n,o)},i.MAXSEARCHDEPTH=8e3,i}(egret.HashObject);t.fAiContainer=e,__reflect(e.prototype,"scene.fAiContainer")}(scene||(scene={}));var scene;!function(t){var e=function(){function t(t,e,i){this.m_withDiagonals=!1,this.m_smoothProcess=!1,this.m_bIncludeFirstPoint=!1,this.m_recordCellCoordinate=!1,this.m_scene=t,this.m_smoothProcess=i,this.m_withDiagonals=e,this.m_origin=new egret.Point,this.m_destiny=new egret.Point}return t.prototype.setParam=function(t,e){this.m_bIncludeFirstPoint=!1,this.m_recordCellCoordinate=!1,this.m_origin.copyFrom(t),this.m_destiny.copyFrom(e),this.m_originCell=this.m_scene.translateToCell(t.x,t.y),this.m_destinyCell=this.m_scene.translateToCell(e.x,e.y)},t.prototype.setParamByCell=function(t,e,i,n){this.m_recordCellCoordinate=n,this.m_bIncludeFirstPoint=i,this.m_originCell=t,this.m_destinyCell=e,this.m_origin.x=t.x,this.m_origin.y=t.y,this.m_destiny.x=e.x,this.m_destiny.y=e.y},t.prototype.getOrigin=function(){return this.m_origin},t.prototype.getDestiny=function(){return this.m_destiny},t.prototype.getOriginCell=function(){return this.m_originCell},t.prototype.getDestinyCell=function(){return this.m_destinyCell},Object.defineProperty(t.prototype,"smoothProcess",{get:function(){return this.m_smoothProcess},enumerable:!0,configurable:!0}),t.prototype.getHeuristic=function(t){return UtilMath.distance(t.i,t.j,this.m_destinyCell.i,this.m_destinyCell.j)},t.prototype.getAccessibleFrom=function(e){t.s_help_AFArray.length=0;var i,n,o;return i=this.m_scene.getCellAt(e.i,e.j-1),i&&!i.isStop&&(i.cost=t.COST_ORTHOGONAL,t.s_help_AFArray[t.s_help_AFArray.length]=i),i=this.m_scene.getCellAt(e.i,e.j+1),i&&!i.isStop&&(i.cost=t.COST_ORTHOGONAL,t.s_help_AFArray[t.s_help_AFArray.length]=i),i=this.m_scene.getCellAt(e.i-1,e.j),i&&!i.isStop&&(i.cost=t.COST_ORTHOGONAL,t.s_help_AFArray[t.s_help_AFArray.length]=i),i=this.m_scene.getCellAt(e.i+1,e.j),i&&!i.isStop&&(i.cost=t.COST_ORTHOGONAL,t.s_help_AFArray[t.s_help_AFArray.length]=i),this.m_withDiagonals&&(i=this.m_scene.getCellAt(e.i+1,e.j-1),i&&!i.isStop&&(n=this.m_scene.getCellAt(e.i,e.j-1),o=this.m_scene.getCellAt(e.i+1,e.j),n.isStop||o.isStop||(i.cost=t.COST_DIAGONAL,t.s_help_AFArray[t.s_help_AFArray.length]=i)),i=this.m_scene.getCellAt(e.i-1,e.j-1),i&&!i.isStop&&(n=this.m_scene.getCellAt(e.i,e.j-1),o=this.m_scene.getCellAt(e.i-1,e.j),n.isStop||o.isStop||(i.cost=t.COST_DIAGONAL,t.s_help_AFArray[t.s_help_AFArray.length]=i)),i=this.m_scene.getCellAt(e.i+1,e.j+1),i&&!i.isStop&&(n=this.m_scene.getCellAt(e.i+1,e.j),o=this.m_scene.getCellAt(e.i,e.j+1),n.isStop||o.isStop||(i.cost=t.COST_DIAGONAL,t.s_help_AFArray[t.s_help_AFArray.length]=i)),i=this.m_scene.getCellAt(e.i-1,e.j+1),i&&!i.isStop&&(n=this.m_scene.getCellAt(e.i-1,e.j),o=this.m_scene.getCellAt(e.i,e.j+1),n.isStop||o.isStop||(i.cost=t.COST_DIAGONAL,t.s_help_AFArray[t.s_help_AFArray.length]=i))),t.s_help_AFArray},Object.defineProperty(t.prototype,"map",{get:function(){return this.m_scene},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isIncludeFirstPoint",{get:function(){return this.m_bIncludeFirstPoint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRecordCellCoordinate",{get:function(){return this.m_recordCellCoordinate},enumerable:!0,configurable:!0}),t.COST_ORTHOGONAL=.7,t.COST_DIAGONAL=.9,t.COST_GOING_UP=2,t.COST_GOING_DOWN=-1.1,t.s_help_AFArray=new Array,t}();t.fDefaultPathfindCriteria=e,__reflect(e.prototype,"scene.fDefaultPathfindCriteria")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){}return e.calculatePt2PtVisible=function(i,n,o,r,s){var a;a=i.translateToCell(n,o);var h;h=i.translateToCell(r,s),e.minGrid.x=Math.min(a.i,h.i),e.minGrid.y=Math.min(a.j,h.j),e.maxGrid.x=Math.max(a.i,h.i),e.maxGrid.y=Math.max(a.j,h.j);var m,c=s-o,u=n-r,l=(r-n)*s-(s-o)*r,p=0,d=0,_=0;if(null==e.m_sPt2Vec)for(e.m_sPt2Vec=new Array(4),p=0;4>p;p++)e.m_sPt2Vec[p]=new egret.Point;var f,g,y=t.fMapConfig.GRID_SIZE_HALF,C=0;for(p=e.minGrid.x;p<=e.maxGrid.x;p++)for(d=e.minGrid.y;d<=e.maxGrid.y;d++)if(m=i.getCellAt(p,d),m.isStop){if(e.m_sPt2Vec[0].x=m.x-y,e.m_sPt2Vec[0].y=m.y-y,e.m_sPt2Vec[1].x=m.x+y,e.m_sPt2Vec[1].y=e.m_sPt2Vec[0].y,e.m_sPt2Vec[2].x=e.m_sPt2Vec[1].x,e.m_sPt2Vec[2].y=m.y+y,e.m_sPt2Vec[3].x=e.m_sPt2Vec[0].x,e.m_sPt2Vec[3].y=e.m_sPt2Vec[2].y,C=c*e.m_sPt2Vec[0].x+u*e.m_sPt2Vec[0].y+l,0==C)return!1;for(f=C>0,_=1;4>_;_++){if(C=c*e.m_sPt2Vec[_].x+u*e.m_sPt2Vec[_].y+l,0==C)return!1;if(g=C>0,f!=g)return!1}}return!0},e.smoothPath=function(t,i){var n=0;if(t.size>=3)for(t.getPoint(n,e.ptfir),n+=2,t.getPoint(n,e.ptsnd);n<t.size;)if(e.calculatePt2PtVisible(i,e.ptfir.x,e.ptfir.y,e.ptsnd.x,e.ptsnd.y)){if(t.remove(n-1),!(n<t.size))break;t.getPoint(n,e.ptsnd)}else{if(t.getPoint(n-1,e.ptfir),++n,!(n<t.size))break;t.getPoint(n,e.ptsnd)}return t},e.minGrid=new egret.Point,e.maxGrid=new egret.Point,e.ptfir=new egret.Point,e.ptsnd=new egret.Point,e}();t.fLineOfSightSolver=e,__reflect(e.prototype,"scene.fLineOfSightSolver")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){}return e.findPathAStar=function(i){var n={},o={},r=i.getOriginCell();if(null==r)return null;var s=i.getDestinyCell();if(!s||s==r)return null;var a=r;a.g=0,a.heuristic=i.getHeuristic(a),n[a.hashCode]=a;for(var h,m=!1,c=0;!m;){if(c++>t.fAiContainer.MAXSEARCHDEPTH)return Context.logMgr.sendServer("FindPath reached its depth limit without a solution"),null;var u=Number.MAX_VALUE;a=null;for(var l in n)h=n[l],h.totalScore<u&&(a=h,u=h.totalScore);if(null==a)break;if(delete n[a.hashCode],o[a.hashCode]=a,a==s){m=!0;break}for(var p=i.getAccessibleFrom(a),d=0,_=p;d<_.length;d++)if(h=_[d],!(h.hashCode in o))if(h.hashCode in n){var f=h.cost+a.g+h.heuristic;f<h.totalScore&&(h.parent=a,h.g=h.cost+a.g)}else n[h.hashCode]=h,h.parent=a,h.heuristic=i.getHeuristic(h),h.g=a.g+h.cost}if(e.s_path.clear(),m){if(i.isRecordCellCoordinate){for(e.s_path.add(s.i,s.j);a.parent&&a.parent!=r;)a=a.parent,e.s_path.add(a.i,a.j);i.isIncludeFirstPoint&&e.s_path.add(r.i,r.j),e.s_path.reverse()}else{var g=i.getOrigin(),y=i.getDestiny(),C=g.x-r.x,v=g.y-r.y;for(e.s_path.add(y.x,y.y);a.parent&&a.parent!=r;)a=a.parent,e.s_path.add(a.x+C,a.y+v);e.s_path.add(g.x,g.y),e.s_path.reverse(),i.smoothProcess&&(e.s_path=t.fLineOfSightSolver.smoothPath(e.s_path,i.map)),i.isIncludeFirstPoint||e.s_path.remove(0)}return e.s_path}return e.s_path},e.s_path=new t.PathFound,e}();t.fPathfindSolver=e,__reflect(e.prototype,"scene.fPathfindSolver")}(scene||(scene={}));var Table;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.parseByteArray=function(i){e.prototype.parseByteArray.call(this,i),this.m_name=t.TDataItem.readString(i),this.m_type=i.readUnsignedShort(),this.m_iIconName=t.TDataItem.readString(i),this.m_iDesc=t.TDataItem.readString(i)},i.prototype.pathIconName=function(){return UtilTools.uiimagePath(this.m_iIconName)},i}(t.TDataItem);t.TGoodsItem=e,__reflect(e.prototype,"Table.TGoodsItem")}(Table||(Table={}));var scene;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.m_ACfresh=!1,i.m_ACIndex=0,i.m_dx=0,i.m_dy=0,i.m_vel=200,i.m_funOnArrive=null,i.m_funThisObj=null,i.m_angle=0/0,i.m_dir=0,i.m_base=new t.SpriteEx,i.addChild(i.m_base),i.m_AC=new t.ActionList,i.m_AC.addAction(UtilModel.TActStand),i.m_ACfresh=!0,i.angle=90,i}return __extends(i,e),i.prototype.setModel=function(t){this.clearModel(),this.m_model=Context.modelDataMgr.getModelData(t),Context.modelDataMgr.addUser(this.m_model,this),this.createModelMC()},i.prototype.clearModel=function(){this.m_model&&(Context.modelDataMgr.removeUser(this.m_model,this),this.m_model=null)},Object.defineProperty(i.prototype,"angle",{get:function(){return this.m_angle},set:function(t){var e=t%360;0>e&&(e+=360),this.m_angle!=e&&(this.m_angle=e,this.m_dir=UtilModel.angle360ToDir8(this.m_angle))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"act",{get:function(){var t=this.m_AC.getAction(this.m_ACIndex);return t.mActID},enumerable:!0,configurable:!0}),i.prototype.setAct=function(t,e,n){if(void 0===e&&(e=!0),void 0===n&&(n=!1),null!=this.m_model){if(!this.m_model.hasAct(t))return void egret.log("this.m_model.hasAct(a) == false; a"+t+" name="+this.m_model.name);if(1==this.m_AC.length){var o=this.m_AC.getAction(0);if(o.isEqualTo(t,e,n))return}i.s_oldAC.copyFrom(this.m_AC),this.m_AC.clear(),this.m_AC.addAction(t,e,n),this.m_ACfresh=!0}},i.prototype.createModelMC=function(){if(this.m_modelMC){if(this.m_modelMC.modelData==this.m_model)return;this.clearModelMC()}if(this.m_modelMC=new t.ModelMovieclip(this.m_model.name),this.has_additionalModel()){var e,i=this.amMgr.dicAddtionalModel,n=void 0;for(e in i)n=i[e],n.createAsset()}},i.prototype.clearModelMC=function(){this.m_modelMC&&(this.m_modelMC.dispose(),this.m_modelMC=null,this.m_curImage&&this.m_curImage.parent&&this.m_curImage.parent.removeChild(this.m_curImage))},i.prototype.changeContainerParent=function(t){this.m_showParent!=t&&(this.parent&&this.parent.removeChild(this),this.m_showParent=t)},i.prototype.show=function(){this.m_bShow||(this.m_showParent!=this.parent&&this.m_showParent.addChild(this),Context.juggle.add(this),this.m_bShow=!0)},i.prototype.hide=function(){0!=this.m_bShow&&(this.parent&&this.parent.removeChild(this),Context.juggle.remove(this),this.m_bShow=!1)},i.prototype.moveTo=function(t,e){this.x=t,this.y=e},i.prototype.moveToPos=function(t,e){this.setAct(UtilModel.TActRun),this.m_dx=t,this.m_dy=e,this.angle=UtilMath.getAngle(this.x,this.y,this.m_dx,this.m_dy),this.startMoving()},i.prototype.moveToPos_Path=function(e){var i=e.length;if(!(2>i)){this.m_curPath||(this.m_curPath=new t.PathFound),this.m_curPath.clear();for(var n=0;i>n;n+=2)this.m_curPath.add(e[n],e[n+1]);var o=this.m_curPath.getTempPoint(0);this.m_curPath.remove(0),this.moveToPos(o.x,o.y)}},i.prototype.startMoving=function(){},i.prototype.updateMove=function(t){if(this.isMoving()){if(this.m_dx==this.x&&this.m_dy==this.y){if(!(this.m_curPath&&this.m_curPath.size>0))return this.stopMoving(),void(null!=this.m_funOnArrive&&this.m_funOnArrive.call(this.m_funThisObj));var e=this.m_curPath.getTempPoint(0);this.m_curPath.remove(0),this.moveToPos(e.x,e.y)}var i=this.angle*Math.PI/180,n=this.m_vel*Math.cos(i),o=this.m_vel*Math.sin(i),r=n*t,s=o*t;Math.abs(this.m_dx-this.x)<Math.abs(r)&&(r=this.m_dx-this.x),Math.abs(this.m_dy-this.y)<Math.abs(s)&&(s=this.m_dy-this.y);this.x+r,this.y+s;this.moveTo(this.x+r,this.y+s)}},i.prototype.stopMoving=function(){this.isMoving()&&(this.setAct(UtilModel.TActStand),this.m_dx=this.x,this.m_dy=this.y,this.clearPath())},i.prototype.clearPath=function(){this.m_curPath&&this.m_curPath.clear()},i.prototype.isMoving=function(){return UtilModel.TActRun==this.act},i.prototype.setFunOnarrive=function(t,e){this.m_funOnArrive=t,this.m_funThisObj=e},i.prototype.dispose=function(){this.clearModelMC(),this.clearModel(),this.m_headTop&&core.ui_call_dispose(this.m_headTop),Context.juggle.remove(this)},i.prototype.advanceTime=function(e){var i;if(this.m_modelMC){var n,o=0;o=this.m_ACfresh?0:this.m_ACIndex;var r=this.m_AC.getAction(o);if(this.m_ACfresh?(this.m_ACfresh=!1,this.m_ACIndex=0,this.m_AC.m_curIndex=this.m_ACIndex,n=!0):this.m_ACIndex!=this.m_AC.m_curIndex&&(this.m_AC.m_curIndex=this.m_ACIndex,n=!0),i=this.m_modelMC.getActMovieClip(r.mActID),n&&(i.setActParam(r),i.currentFrame=0,i.play()),i!=this.m_curImage&&(this.m_curImage&&(this.m_curImage.parent&&this.m_curImage.parent.removeChild(this.m_curImage),this.m_curImage.stop()),this.m_curImage=i,this.m_curImage&&this.m_base.addChild(this.m_curImage)),this.m_curImage&&(this.m_curImage.advanceTime(e,this.m_dir),this.m_curImage.isComplete&&(this.m_ACIndex+1<this.m_AC.length?this.m_ACIndex++:this.onActListComplete()),this.has_additionalModel())){var s=void 0,a=void 0;for(s in this.amMgr.dicAddtionalModel)a=this.amMgr.dicAddtionalModel[s],a.isAssetCreated||a.createAsset(),a.show(this.act,this.m_dir,this.m_curImage.currentFrame),a.container.parent!=this.m_base&&this.m_base.addChild(a.container);var h=this.amMgr.getLayerList(this.m_dir),m=h.length,c=void 0,u=void 0;for(c=0;m>c;c++)u=h[c],u instanceof t.AdditionalModel&&(a=u,this.m_base.getChildAt(c)!=a.container&&this.m_base.setChildIndex(a.container,c))}this.updateMove(e)}},Object.defineProperty(i.prototype,"amMgr",{get:function(){return this.m_amMgr||(this.m_amMgr=new t.AdditionalModelMgr),this.m_amMgr},enumerable:!0,configurable:!0}),i.prototype.onActListComplete=function(){this.act==UtilModel.TActAttack&&this.setAct(UtilModel.TActStand)},i.prototype.has_additionalModel=function(){return null!=this.m_amMgr&&!this.m_amMgr.isEmpty},i.prototype.isHit=function(t,e){return this.m_curImage&&this.m_curImage.isHit(t,e)},i.prototype.$hitTest=function(t,e){var n=this.globalToLocal(t,e,i.tempPoint);return this.isHit(n.x,n.y)?this:null},Object.defineProperty(i.prototype,"headTop",{get:function(){return this.m_headTop||(this.m_headTop=new eui.Group,this.addChild(this.m_headTop),this.m_headTop.y=this.m_model.config.tModelItem.m_offsetName),this.m_headTop},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"model",{get:function(){return this.m_model},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"offsetName",{get:function(){return this.m_model.config.tModelItem.m_offsetName},enumerable:!0,configurable:!0}),i.s_oldAC=new t.ActionList,i.tempPoint=new egret.Point,i}(t.SpriteEx);t.UIModel=e,__reflect(e.prototype,"scene.UIModel")}(scene||(scene={}));var core;!function(t){var e=function(){function t(t){this.m_main=t,this.m_gameRoot=new egret.DisplayObjectContainer,this.m_main.addChild(this.m_gameRoot)}return t.prototype.stopRender=function(){this.m_gameRoot.parent&&(this.m_main.removeChild(this.m_gameRoot),Context.logMgr.addLog("game stopRender"))},t.prototype.startRender=function(){this.m_gameRoot.parent||(this.m_main.addChild(this.m_gameRoot),Context.logMgr.addLog("game startRender"))},Object.defineProperty(t.prototype,"gameRoot",{get:function(){return this.m_gameRoot},enumerable:!0,configurable:!0}),t.prototype._adjustWindowPos=function(){var t,e=Context.stage.stageWidth,i=Context.stage.stageHeight,n=e,o=i;if(Context.mapMgr&&(t=Context.mapMgr.currentMap),t){t.widthPx;t.widthPx<e&&(n=t.widthPx),t.heightPx<i&&(o=t.heightPx)}return this.m_gameRoot.x=(e-n)/2,this.m_gameRoot.y=(i-o)/2,n!=Context.width||o!=Context.height?(Context.width=n,Context.height=o,!0):!1},t.prototype.adjustWindowPos=function(){if(this._adjustWindowPos()&&(Context.uimgr&&Context.uimgr.onStageResize(),Context.mapMgr)){var t=void 0;t=Context.mapMgr.currentMap,t&&t.currentCamera.onViewPortSizeChange()}},t}();t.GameAreaMgr=e,__reflect(e.prototype,"core.GameAreaMgr")}(core||(core={}));var core;!function(t){var e=function(){function t(){if(this.m_androidVersion=0,this.versionType_wx=0,this.isActivate=!0,this.m_delayTimeForDeleteGPUTexture=0,"web"==egret.Capabilities.runtimeType){var t=egret.web;t.Html5Capatibility&&(this.ua=t.Html5Capatibility.ua)}this.isIos?this.m_delayTimeForDeleteGPUTexture=5e3:this.m_delayTimeForDeleteGPUTexture=12e4}return Object.defineProperty(t.prototype,"delayTimeForDeleteGPUTexture",{get:function(){return this.m_delayTimeForDeleteGPUTexture},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isWXGame",{get:function(){return"isWXGame"in window?window.isWXGame:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBaiduGame",{get:function(){return"isBaiduGame"in window?window.isBaiduGame:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPC",{get:function(){var t=egret.Capabilities.os;return-1!=t.indexOf("Windows PC")||-1!=t.indexOf("Mac OS")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAndroid",{get:function(){return"android"==egret.Capabilities.os.toLocaleLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isIos",{get:function(){return this.systemInfo_wx&&"ios"==this.systemInfo_wx.platform.toLocaleLowerCase()?!0:"ios"==egret.Capabilities.os.toLocaleLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMobile",{get:function(){return egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isiPhoneX",{get:function(){if(this.systemInfo_wx&&this.systemInfo_wx.model&&0==this.systemInfo_wx.model.indexOf("iPhone X"))return!0;var t=document.createElement("canvas"),e=t.getContext("experimental-webgl");if(!e)return!1;var i=e.getExtension("WEBGL_debug_renderer_info");if(!i)return!1;var n=e.getParameter(i.UNMASKED_RENDERER_WEBGL);return n.indexOf("Apple")>-1&&n.indexOf("A11")>-1&&375==window.screen.width&&812==window.screen.height?!0:!1},enumerable:!0,configurable:!0}),t.prototype.hasNotchInScreen=function(){return this.isWXGame&&this.systemInfo_wx&&this.systemInfo_wx.statusBarHeight>24?!0:!1},t.prototype.printLog=function(){var t=UtilTools.keyValueToString_parenthese("renderMode",egret.Capabilities.renderMode,"runtimeType",egret.Capabilities.runtimeType,"os",egret.Capabilities.os,"isMobile",egret.Capabilities.isMobile,"stageW",Context.width,"stageH",Context.height,"jsVersion",Context.logMgr.jsversion),e="";if("web"==egret.Capabilities.runtimeType){var i=egret.web;i.Html5Capatibility&&(t+=" Html5Capatibility.ua="+i.Html5Capatibility.ua),this.isAndroid?e="Android "+this.androidVersion:this.isIos?e="ios "+this.iOsVersion:this.isiPhoneX?e="iPhoneX"+this.iOsVersion:this.isMobile&&(e="isMobile")}Context.logMgr.addLog(t),e&&Context.logMgr.addLog(e)},Object.defineProperty(t.prototype,"androidVersion",{get:function(){if(0==this.m_androidVersion&&this.ua&&"Android"==egret.Capabilities.os){var t=this.ua.search("android");if(-1!=t){t+=7;var e=this.ua.substr(t,10);this.m_androidVersion=parseFloat(e)}}return this.m_androidVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iOsVersion",{get:function(){if(this.ua){var t=egret.web;return t.Html5Capatibility.getIOSVersion()}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"osType",{get:function(){return this.isPC?1:this.isAndroid?2:this.isIos?3:4},enumerable:!0,configurable:!0}),t.prototype.logException=function(t){var e=this.ExceptionToString(t);e&&egret.log(e)},t.prototype.ExceptionToString=function(t){var e="";if(t instanceof Error){var i=t,n=i.name+" "+i.message;"stack"in i&&(n+=" "+i.stack),e=n}return e},t}();t.System=e,__reflect(e.prototype,"core.System")}(core||(core={}));var core;!function(t){var e=function(){function t(){this.m_year=0,this.m_month=0,this.m_date=0,this.m_week=0,this.m_hour=0,this.m_minute=0,this.m_second=0}return t.prototype.setTimeByStr=function(t){var e=this,i=t.split(" "),n=i[0].split("/"),o=i[1].split(":");e.m_year=parseInt(n[0]),e.m_month=parseInt(n[1]),e.m_date=parseInt(n[2]),e.m_hour=parseInt(o[0]),e.m_minute=parseInt(o[1]),e.m_second=parseInt(o[2])},t.prototype.setTimeByDate=function(t){var e=this;e.m_year=t.getUTCFullYear(),e.m_month=t.getUTCMonth(),e.m_date=t.getUTCDate(),e.m_week=t.getUTCDay(),e.m_hour=t.getUTCHours(),e.m_minute=t.getUTCMinutes(),e.m_second=t.getUTCSeconds()},t.prototype.formatString_year_month_day_hour=function(){return Context.languageMgr.getEleStr("con",324,[this.m_year,this.m_month+1,this.m_date,this.m_hour])},t.prototype.formatString_month_day_hour=function(){return Context.languageMgr.getEleStr("con",325,[this.m_month+1,this.m_date,this.m_hour])},t.prototype.formatString_month_day_hm=function(){return Context.languageMgr.getEleStr("con",340,[this.m_month+1,this.m_date,this.formatString_hm()])},t.prototype.formatString_month_day=function(){return Context.languageMgr.getEleStr("con",341,[this.m_month+1,this.m_date])},t.prototype.formatString_ymdhms=function(){var t=3600*this.m_hour+60*this.m_minute+this.m_second;return Context.languageMgr.getEleStr("con",326,[this.m_year,this.m_month+1,this.m_date,UtilTime.formatTimeToString(t)])},t.prototype.formatString_hms=function(){var t=this,e=t.m_hour<10?"0"+t.m_hour:""+t.m_hour,i=t.m_minute<10?"0"+t.m_minute:""+t.m_minute,n=t.m_second<10?"0"+t.m_second:""+t.m_second;return e+":"+i+":"+n},t.prototype.formatString_hm=function(){var t=this.m_minute<10?"0"+this.m_minute:""+this.m_minute,e=this.m_hour<10?"0"+this.m_hour:""+this.m_hour;return e+":"+t},t.prototype.formatString_Standard=function(){return this.m_year+"."+(this.m_month+1)+"."+this.m_date+" "+this.m_hour+":"+this.m_minute+":"+this.m_second},t.prototype.fromTimeString=function(t){var e=t.split(" ");if(2!=e.length)return!1;var i=e[0].split(".");return 3!=i.length?!1:(this.m_year=i[0],this.m_month=i[1]-1,this.m_date=i[2],i=e[1].split(":"),3!=i.length?!1:(this.m_hour=i[0],this.m_minute=i[1],this.m_second=i[2],!0))},t.prototype.getCalendarTimeFromBeingjingTime=function(){null==t.s_date&&(t.s_date=new Date),t.s_date.setUTCFullYear(this.m_year,this.m_month,this.m_date);var e=t.s_date.setUTCHours(this.m_hour,this.m_minute,this.m_second,0);return e-=UtilTime.TIME_ZONE_MillionSecond,e/1e3},t}();t.TimeL=e,__reflect(e.prototype,"core.TimeL")}(core||(core={}));var core;!function(t){var e=function(){function e(){this.m_bInited=!1,this.m_initCalendarTime=0/0,this.m_initVMTime=0/0,this.m_serverTimeFromServer_VMTime=0/0,this.m_openservertime=0/0,this.m_openservertime_zero=0/0,this.m_dayOfOpenServer_7=0,this.m_dayOfOpenServer_0=0,this.m_openServer7_second=0,this.m_regtime=0,this.m_dayOfReg=0,this.m_mergeTime=0,this.m_dayOfMerge=0,this.m_todayZeorTime=0,this.m_localTimeStart=0,this.m_relativeTimeStart=0,this.m_platformTime=0,this.m_platformTime_second=0,this.m_delayCall_5Minutes=0,this.m_delayCall_1Sec=0,this.m_clientAcceleratedLog="",this.m_date=new Date,this.m_localTimeStart=this.m_date.getTime(),this.m_platformTime=this.m_relativeTimeStart=egret.getTimer(),this.m_platformTime_second=Math.floor(.001*this.m_platformTime),this.m_todayTimeL=new t.TimeL,this.m_delayCall_5Minutes=this.m_platformTime+1*UtilTime.MINUTE_MILLISECOND,this.m_delayCall_1Sec=this.m_platformTime+UtilTime.SECOND_MILLISECOND}return e.prototype.calendarTimeToPlatformTime=function(t){return this.m_initVMTime+1e3*t-this.m_initCalendarTime},e.prototype.advanceTime=function(t){this.m_platformTime=egret.getTimer(),this.m_platformTime_second=Math.floor(.001*this.m_platformTime),this.m_platformTime>=this.m_delayCall_5Minutes&&(this.m_delayCall_5Minutes=this.m_delayCall_5Minutes+1*UtilTime.MINUTE_MILLISECOND,dataset.TimeResourceMgrBase.s_process())},Object.defineProperty(e.prototype,"platformTime",{get:function(){return this.m_platformTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"platformTime_second",{get:function(){return this.m_platformTime_second},enumerable:!0,configurable:!0}),e.prototype.updateTodayDate=function(t){this.m_date.setTime(t+UtilTime.TIME_ZONE_MillionSecond),this.m_todayTimeL.m_year=this.m_date.getUTCFullYear(),this.m_todayTimeL.m_month=this.m_date.getUTCMonth(),this.m_todayTimeL.m_date=this.m_date.getUTCDate(),this.m_todayTimeL.m_week=this.m_date.getUTCDay(),this.m_todayTimeL.m_hour=this.m_date.getUTCHours(),this.m_todayTimeL.m_minute=this.m_date.getUTCMinutes(),this.m_todayTimeL.m_second=this.m_date.getUTCSeconds()
},e.prototype.process_stGameTimeTimerUserCmd=function(t){var e=new Cmd.stGameTimeTimerUserCmd;e.deserialize(t);var i=e.qwGameTime,n=e.openservertime;this.m_bInited||(this.m_bInited=!0,this.m_initCalendarTime=1e3*i,this.m_initVMTime=this.m_platformTime,this.m_openservertime=n,this.m_openservertime_zero=UtilTime.s_getDay_0(n),this.m_dayOfOpenServer_7=UtilTime.s_computeDayDifference_7(this.m_openservertime,i)+1,this.m_dayOfOpenServer_0=UtilTime.s_computeDayDifference_0(this.m_openservertime,i)+1,this.m_openServer7_second=UtilTime.s_curDay_7(this.m_openservertime),this.m_todayZeorTime=1e3*UtilTime.s_getDay_0(i),this.m_serverTimeFromServer=i,this.m_serverTimeFromServer_VMTime=this.m_platformTime_second,this.updateTodayDate(this.m_initCalendarTime))},e.prototype.process_stGameMergeTimeUserCmd=function(t){var e=new Cmd.stGameMergeTimeUserCmd;e.deserialize(t),Context.logMgr.addLog("stGameMergeTimeUserCmd"),egret.assert(!isNaN(this.m_openservertime)),this.m_mergeTime=e.mergeservertime,0==this.m_mergeTime?this.m_dayOfMerge=0:this.m_dayOfMerge=UtilTime.s_computeDayDifference_0(this.m_mergeTime,this.m_initCalendarTime/1e3)+1},e.prototype.reset_to_beforeLogin=function(){this.m_bInited=!1},Object.defineProperty(e.prototype,"serverTimeFromServer",{get:function(){return this.m_serverTimeFromServer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverTimeCompute",{get:function(){return this.m_serverTimeFromServer+this.m_platformTime_second-this.m_serverTimeFromServer_VMTime},enumerable:!0,configurable:!0}),e.prototype.getServerTimeL=function(){return this.m_date.setTime(this.m_platformTime-this.m_initVMTime+this.m_initCalendarTime+UtilTime.TIME_ZONE_MillionSecond),this.m_todayTimeL.m_hour=this.m_date.getUTCHours(),this.m_todayTimeL.m_minute=this.m_date.getUTCMinutes(),this.m_todayTimeL.m_second=this.m_date.getUTCSeconds(),this.m_todayTimeL},e.prototype.calendarToTimeL=function(e){this.m_date.setTime(1e3*e+UtilTime.TIME_ZONE_MillionSecond);var i;return i=new t.TimeL,i.m_year=this.m_date.getUTCFullYear(),i.m_month=this.m_date.getUTCMonth(),i.m_date=this.m_date.getUTCDate(),i.m_hour=this.m_date.getUTCHours(),i.m_minute=this.m_date.getUTCMinutes(),i.m_second=this.m_date.getUTCSeconds(),i},e.s_priMonth=function(t,e){var i=new egret.Point;return 0==e?(i.x=t-1,i.y=11):(i.x=t,i.y=e-1),i},e.s_nextMonth=function(t,e){var i=new egret.Point;return 11==e?(i.x=t+1,i.y=0):(i.x=t,i.y=e+1),i},e.s_numOfdaysInMonth=function(t,i){var n=e.s_nextMonth(t,i),o=(Date.UTC(n.x,n.y,1)-Date.UTC(t,i,1))/864e5;return o},e.s_weekByDate=function(t,e,i){var n=new Date(t,e,i);return n.getDay()},Object.defineProperty(e.prototype,"dataString",{get:function(){var t;return this.getServerTimeL(),t=this.m_todayTimeL.m_year+":"+(this.m_todayTimeL.m_month+1).toString()+":"+this.m_todayTimeL.m_date+"_"+this.m_todayTimeL.m_hour+":"+this.m_todayTimeL.m_minute+":"+this.m_todayTimeL.m_second},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataStringEx",{get:function(){var t;return this.getServerTimeL(),t=this.m_todayTimeL.m_year+"a"+(this.m_todayTimeL.m_month+1).toString()+"a"+this.m_todayTimeL.m_date+"_"+this.m_todayTimeL.m_hour+"a"+this.m_todayTimeL.m_minute+"a"+this.m_todayTimeL.m_second},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataStringWithoutYear",{get:function(){var t;return this.getServerTimeL(),t=(this.m_todayTimeL.m_month+1).toString()+"a"+this.m_todayTimeL.m_date+"_"+this.m_todayTimeL.m_hour+"a"+this.m_todayTimeL.m_minute+"a"+this.m_todayTimeL.m_second},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeString",{get:function(){var t;return this.getServerTimeL(),t=this.m_todayTimeL.m_hour+":"+this.m_todayTimeL.m_minute+":"+this.m_todayTimeL.m_second},enumerable:!0,configurable:!0}),e.prototype.getCalendarTimeMillionSecond=function(){return this.m_platformTime-this.m_initVMTime+this.m_initCalendarTime},Object.defineProperty(e.prototype,"calendarTimeSecond",{get:function(){return(this.m_platformTime-this.m_initVMTime+this.m_initCalendarTime)/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hmsString",{get:function(){var t;return this.getServerTimeL(),t=this.m_todayTimeL.m_hour+":"+this.m_todayTimeL.m_minute+":"+this.m_todayTimeL.m_second},enumerable:!0,configurable:!0}),e.prototype.process7ClockUserCmd=function(){this.m_dayOfOpenServer_7++},e.prototype.process0ClockUserCmd=function(){this.m_dayOfOpenServer_0++,this.m_dayOfReg++,this.m_todayZeorTime+=UtilTime.DAY_MillionSecond,this.m_dayOfMerge&&this.m_dayOfMerge++,this.updateTodayDate(this.m_initCalendarTime)},Object.defineProperty(e.prototype,"todayBeginTime",{get:function(){return this.m_todayZeorTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"todayEndTime",{get:function(){return this.m_todayZeorTime/1e3+UtilTime.DAY_MillionSecond-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dayOfOpenServer_7",{get:function(){return this.m_dayOfOpenServer_7},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"openServer7_second",{get:function(){return this.m_openServer7_second},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dayOfOpenServer_0",{get:function(){return this.m_dayOfOpenServer_0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initCalendarTime",{get:function(){return this.m_initCalendarTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"openservertime",{get:function(){return this.m_openservertime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"openservertime_zero",{get:function(){return this.m_openservertime_zero},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInit",{get:function(){return this.m_bInited},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localTimeStart",{get:function(){return this.m_localTimeStart},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeTimeStart",{get:function(){return this.m_relativeTimeStart},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"todayTimeL",{get:function(){return this.m_todayTimeL},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"regTime",{get:function(){return this.m_regtime},set:function(t){this.m_regtime=t,this.m_dayOfReg=UtilTime.s_computeDayDifference_0(this.m_regtime,this.m_initCalendarTime/1e3)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dayOfReg",{get:function(){return this.m_dayOfReg},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dayOfMerge",{get:function(){return this.m_dayOfMerge},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mergeTime",{get:function(){return this.m_mergeTime},enumerable:!0,configurable:!0}),e.prototype.updateServerTime=function(t){isNaN(this.m_serverTimeFromServer)||(this.m_serverTimeFromServer=t,this.m_serverTimeFromServer_VMTime=this.m_platformTime_second)},e.prototype.isClientAccelerated=function(){var t=1e3*this.m_serverTimeFromServer,e=t-this.m_initCalendarTime,i=1e3*this.m_serverTimeFromServer_VMTime-this.m_initVMTime;if(i>e){var n=i-e;if(n>12e4&&n/i>.2)return this.m_clientAcceleratedLog=UtilTools.keyValueToString_parenthese("a",e,i,"b"),!0}return!1},e.prototype.getClientAcceleratedLog=function(){return this.m_clientAcceleratedLog},e.prototype.formatTime_month_day=function(t){var e=this.calendarToTimeL(t);return e.formatString_month_day()},e.prototype.formatTime_mdhm=function(t){var e=this.calendarToTimeL(t);return e.formatString_month_day_hm()},e.prototype.formatTime_mdh=function(t){var e=this.calendarToTimeL(t);return e.formatString_month_day_hour()},e.prototype.formatTime_month_day_start_stop=function(t,e){var i=this.formatTime_month_day(t),n=this.formatTime_month_day(e);return Context.languageMgr.getEleStr("con",352,[i,n])},e.prototype.formatTime_mdhm_start_stop=function(t,e){var i=this.formatTime_mdhm(t),n=this.formatTime_mdhm(e);return Context.languageMgr.getEleStr("con",352,[i,n])},e.prototype.formatTime_mdh_start_stop=function(t,e){var i=this.formatTime_mdh(t),n=this.formatTime_mdh(e);return Context.languageMgr.getEleStr("con",352,[i,n])},e.prototype.formatTime_month_day_start_stop_days=function(t,e){e--;var i=t+e*UtilTime.DAY_SECOND;return this.formatTime_month_day_start_stop(t,i)},e.prototype.formatTime_mdhm_start_stop_days=function(t,e){var i=t+e*UtilTime.DAY_SECOND-1;return this.formatTime_mdhm_start_stop(t,i)},e}();t.TimeMgr=e,__reflect(e.prototype,"core.TimeMgr")}(core||(core={}));var core;!function(t){var e=function(){function t(){this.m_dic={},this.init()}return t.prototype.init=function(){function t(t){var e=t.indexOf("/resource");if(e>=0){var i=t.slice(e);return i}return t}if(Context.bzConfig.bShowMemoryInfo){Context.juggle1Sec.add(this);var e=this.m_dic,i=egret.BitmapData.prototype;Object.defineProperty(i,"source",{get:function(){return this.$source},set:function(i){if(this.$source=i,this.source&&this.source.currentSrc){var n=t(this.source.currentSrc);e[n]=this}egret.nativeRender&&egret_native.NativeDisplayObject.setSourceToNativeBitmapData(this.$nativeBitmapData,i)},enumerable:!0,configurable:!0});var n=i.$dispose;i.$dispose=function(){if(this.source&&this.source.currentSrc){var i=t(this.source.currentSrc);delete e[i]}n.call(this)}}},t.prototype.advanceTime=function(t){this.stats()},t.prototype.stats=function(){var t=0,e=0,i=0,n={};for(var o in this.m_dic){t++;var r=this.m_dic[o];r.webGLTexture&&(e++,i+=r.width*r.height*4,n[o]=r)}var s=i/1048576;console.log("image memory size:"+s.toFixed(2)+"MB")},t}();t.BitmapStatsMgr=e,__reflect(e.prototype,"core.BitmapStatsMgr",["animation.IAnimatable"])}(core||(core={}));var core;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_loadStep=0,e.m_load_withContent_step=0,e.m_load_withContent_skinPath=[],e.m_load_withContent_parseSkin_i=0,e.m_load_withContent_parseSkin_n=0,e.m_path2skinName={},e.m_path2Content={},e.m_isParse=!1,e.delayList=[],e.skinMap={},e.$styles={},egret.registerImplementation("eui.Theme",e),e}return __extends(e,t),Object.defineProperty(e.prototype,"hasContent",{get:function(){return this.m_hasContent},enumerable:!0,configurable:!0}),e.prototype.advanceTime=function(t){if(1==this.m_loadStep){for(var e in this.m_skinName2Path)this.m_path2skinName[this.m_skinName2Path[e]]=e;return this.progress(.2),void(this.m_loadStep=2)}if(2==this.m_loadStep){if(this.m_thmData&&this.m_thmData.skins)for(var i=this.skinMap,n=this.m_thmData.skins,o=Object.keys(n),r=o.length,s=0;r>s;s++){var e=o[s];i[e]||this.mapSkin(e,n[e])}this.m_thmData.styles&&(this.$styles=this.m_thmData.styles),this.progress(.3),this.m_loadStep=3}else if(3==this.m_loadStep){var a=void 0;a=this.m_thmData.exmls[0].content?this.load_withContent():this.load_noContent(),a&&(this.m_loadStep=4)}},e.prototype.progress=function(t){this.dispatchEventWith(egret.Event.CHANGE,!1,t)},e.prototype.load=function(t,e,i){var n,o=JSON.parse(i);window.JSONParseClass.setData(o);var r=this,n=new Promise(function(t,e){r.progress(.5),t()});return n},e.prototype.load_withContent=function(){if(0==this.m_load_withContent_step)this.parseExmls(this.m_thmData.exmls),this.m_load_withContent_step=1,this.progress(.4);else if(1==this.m_load_withContent_step){var t=void 0;for(t in this.m_preLoadSkin)this.m_load_withContent_skinPath.push(this.m_preLoadSkin[t]);this.m_load_withContent_step=2,this.progress(.5),this.m_load_withContent_parseSkin_n=this.m_load_withContent_skinPath.length,this.m_load_withContent_parseSkin_i=0}else if(2==this.m_load_withContent_step){if(this.m_load_withContent_parseSkin_i>=this.m_load_withContent_parseSkin_n)return this.m_load_withContent_step=3,!1;var e=this.m_load_withContent_skinPath[this.m_load_withContent_parseSkin_i],i=this.m_path2Content[e];egret.assert(i),EXML.$parseURLContent(e,i),this.m_load_withContent_parseSkin_i++,this.progress(.5+.4*(this.m_load_withContent_parseSkin_i/this.m_load_withContent_parseSkin_n))}else if(3==this.m_load_withContent_step)return this.m_hasContent=!0,this.onLoaded(),this.m_load_withContent_step=4,!0;return!1},e.prototype.load_noContent=function(){this.m_hasContent=!1;var t=[];for(var e in this.m_preLoadSkin){var i=this.m_preLoadSkin[e];t.push(i)}for(var e in this.m_skinName2Path){var i=this.m_skinName2Path[e];t.push(i)}return EXML.$loadAll(t,this.onLoaded,this,!0),!0},e.prototype.parseExmls=function(t){var e=0,i=t.length;for(e=0;i>e;e++){var n=t[e];this.m_path2Content[n.path]=n.content}},e.prototype.parseBySkinName=function(t){var e=egret.getDefinitionByName(t);if(!e&&!this.m_isParse){this.m_isParse=!0,egret.assert(t in this.m_skinName2Path);var i=this.m_skinName2Path[t];egret.assert(i in this.m_path2Content);var n=this.m_path2Content[i];EXML.$parseURLContent(i,n),this.m_isParse=!1}},e.prototype.onLoaded=function(t,e){Context.juggle.remove(this),this.initialized=!0,this.handleDelayList(),this.progress(1),this.dispatchEventWith(egret.Event.COMPLETE)},e.prototype.debugParseResult=function(t,e){if(t&&e){var i={},n=t.length,o=0;for(o=0;n>o;o++){var r=t[o].prototype,s=r.__class__;i[s]=e[o]}JSON.stringify(i)}},e.prototype.handleDelayList=function(){for(var t=this.delayList,e=t.length,i=0;e>i;i++){var n=t[i];if(!n.$Component[5]){var o=this.getSkinName(n);o&&(n.$Component[1]=o,n.$parseSkinName())}}t.length=0},e.prototype.getSkinName=function(t){if(!this.initialized)return-1==this.delayList.indexOf(t)&&this.delayList.push(t),"";var e=this.skinMap,i=e[t.hostComponentKey];return i||(i=this.findSkinName(t)),i&&(i=this.m_path2skinName[i]),i},e.prototype.findSkinName=function(t){if(!t)return"";var e=t.__class__;if(void 0===e)return"";var i=this.skinMap[e];return i||"eui.Component"==e?i:this.findSkinName(Object.getPrototypeOf(t))},e.prototype.mapSkin=function(t,e){this.skinMap[t]=e},e.prototype.$getStyleConfig=function(t){return this.$styles[t]},e}(egret.EventDispatcher);t.MUTheme=e,__reflect(e.prototype,"core.MUTheme",["animation.IAnimatable"])}(core||(core={}));var core;!function(t){function e(){var t=egret.BitmapData.prototype;t.clearGPUTexture=function(){egret.Capabilities.runtimeType==egret.RuntimeType.WEB&&"webgl"==egret.Capabilities.renderMode&&this.webGLTexture&&(egret.WebGLUtils.deleteWebGLTexture(this.webGLTexture),this.webGLTexture=null)},t=egret.Texture.prototype,t.clearGPUTexture=function(){this.$bitmapData?this.$bitmapData.clearGPUTexture():this._bitmapData&&this._bitmapData.clearGPUTexture()}}function i(t){t.clearGPUTexture()}t.initTexture=e,t.texture_clearGPUTexture=i}(core||(core={}));var core;!function(t){function e(){var t=egret.sys.SystemTicker.prototype;t.__render__=t.render,t.render=function(t,e){try{this.__render__(t,e)}catch(i){Context.system.logException(i)}};var t=eui.Component.prototype;Object.defineProperty(t,"enabled",{get:function(){return this.$Component[3]},set:function(t){t=!!t,this.$setEnabled(t);var e=this;t?e.filters=null:"__isGray_whenDisable__"in e&&1!=e.__isGray_whenDisable__||(e.filters=[UtilFlilter.createGrayFilter()])},enumerable:!0,configurable:!0});var t=egret.DisplayObject.prototype;t.dispose=function(){},t=egret.DisplayObjectContainer.prototype,t.dispose=function(){var t=this.$children.length,e=0;for(e=0;t>e;e++)this.$children[e].dispose()};var t=eui.Image.prototype;t.parseSource=function(){this.sourceChanged=!1;var t=this._source;t&&"string"==typeof t?Context.imageAssetAdapter.getAsset(this._source,this.contentChanged,this):this.$setBitmapData(t)},t.contentChanged=function(t,e){return e!==this._source?!1:egret.is(t,"egret.Texture")?(this.$setBitmapData(t),t?(this.dispatchEventWith(egret.Event.COMPLETE),this.__source__&&Context.imageAssetAdapter.unattach(this.__source__,this),this.__source__=e,!0):!1):!1},t.dispose=function(){this.__source__&&(Context.imageAssetAdapter.unattach(this.__source__,this),this.__source__=null),this._source=null};var t=eui.BitmapLabel.prototype;t.$parseFont=function(){this.$fontChanged=!1;var t=this.$fontForBitmapLabel;t&&"string"==typeof t?Context.imageAssetAdapter.getAsset(t,this.$onFontChanged,this):this.$setFontData(t)},t.$onFontChanged=function(t,e){return e&&e!==this.$fontForBitmapLabel?!1:(this.$setFontData(t),this.__source__&&Context.imageAssetAdapter.unattach(this.__source__,this),this.__source__=e,!0)},t.dispose=function(){this.__source__&&(Context.imageAssetAdapter.unattach(this.__source__,this),this.__source__=null)}}function i(t,e){t.prototype.dispose.call(e)}function n(t){t.dispose()}function o(t,e){t.__gray__!=e&&(t.__gray__=e,e?t.filters=[UtilFlilter.createGrayFilter()]:t.filters=null)}function r(t,e){t.__black__!=e&&(t.__black__=e,e?t.filters=[UtilFlilter.createBlackFilter()]:t.filters=null)}function s(t,e){t.__isGray_whenDisable__=e}function a(t,e){return null}function h(t){t.$hitTest=a}function m(t,e,i,n,o){if(o||(o=new egret.Point),o.x=i,o.y=n,t==e)return!0;for(var r=t.parent;r;){if(o.x+=t.x,o.y+=t.y,r==e)return!0;r=r.parent}return!1}t.initUIComponent=e,t.ui_call_supper_dispose=i,t.ui_call_dispose=n,t.ui_setGray=o,t.ui_setBlack=r,t.ui_isGray_whenDisable=s,t.set_$hitTest_empty=h,t.displayObject_localToSomeParent=m}(core||(core={}));var UtilArray;!function(t){function e(t,e){var i=t,n=i.indexOf(e);return-1!=n&&i.splice(n,1),-1}function i(t){var e=new eui.ArrayCollection,i=t,n=i.length,o=0;for(o=0;n>o;o++)e.addItem(i[o]);return e}function n(t,e,i,n){void 0===n&&(n=1);var o=t.length;1==n?e.writeByte(o):2==n&&e.writeUnsignedShort(o);var r,s=0;for(s=0;o>s;s++)r=t[s],"string"==typeof i?"I"==i?e.writeUnsignedInt(r):"H"==i?e.writeUnsignedShort(r):"B"==i?e.writeByte(r):egret.assert(!1):r.serialize(e)}function o(t,e,i){void 0===i&&(i=1);var n=[],o=0;1==i?o=t.readUnsignedByte():2==i&&(o=t.readUnsignedShort());var r,s=0;for(s=0;o>s;s++)"string"==typeof e?"I"==e?r=t.readUnsignedInt():"H"==e?r=t.readUnsignedShort():"B"==e?r=t.readUnsignedByte():egret.assert(!1):(r=new e,r.deserialize(t)),n.push(r);return n}function r(t,e){return e.indexOf(t)>=0}t.removeItem=e,t.toArrayCollection=i,t.serialize=n,t.deserialize=o,t.bInList=r}(UtilArray||(UtilArray={}));var UtilByteArray;!function(t){function e(){p=new egret.ByteArray;var t;for(p.length=5e4,t=0;256>t;t++)p.writeByte(0)}function i(t,e,i){if(null==e)t.writeBytes(p,0,i);else{var n=(t.position,t.position+i);t.writeUTFBytes(e);var o=t.position;if(o>n)throw new Error("writeStr bytes.position > posEnd");n>o&&t.writeBytes(p,0,n-o)}}function n(t,e,i){void 0===i&&(i=2);var n=t.position,o=t.position+i;h(t,0,i),e&&t.writeUTFBytes(e);var r=t.position,s=r-o;t.position=n,h(t,s,i),t.position=r}function o(t,e){void 0===e&&(e=2);var i;1==e?i=t.readUnsignedByte():2==e?i=t.readUnsignedShort():4==e&&(i=t.readUnsignedInt());var n=t.readUTFBytes(i);return n}function r(t){return t.readUTFBytes(Cmd.MAX_NAMESIZE)}function s(t,e){return t.readUTFBytes(e)}function a(t,e){return i(t,e,Cmd.MAX_NAMESIZE)}function h(t,e,i){2==i?t.writeShort(e):1==i?t.writeByte(e):4==i&&t.writeUnsignedInt(e)}function m(t,e,i,n){if(i||(i=0),(!n||n+i>e.length)&&(n=e.length-i),0>n)throw new Error("ByteArrayToUint8Array length <=0");var o=0,r=i+n;for(o=i;r>o;o++)t.writeByte(e[o])}function c(t,e,i){if(e||(e=0),(!i||i+e>t.length)&&(i=t.length-e),0>i)throw new Error("ByteArrayToUint8Array length <=0");var n=new Uint8Array(i);t.position=e;var o=0;for(o=0;i>o;o++)n[o]=t.readUnsignedByte();return n}function u(t){var e=new egret.ByteArray,i=0,n=t.length;for(e.length=n,e.position=0,i=0;n>i;i++)e.writeByte(t[i]);return e}function l(t,e){var i=0,n=e.length;for(d.length=0,i=0;n>i;i++)switch(e.charAt(i)){case"i":d[i]=t.readInt();break;case"I":d[i]=t.readUnsignedInt();break;case"H":d[i]=t.readUnsignedShort();break;case"B":d[i]=t.readUnsignedByte()}return d}var p;t.initZeroBuffer=e,t.writeStr_FixedLength=i,t.writeStr=n,t.readStr=o,t.readStr_MAX_NAMESIZE=r,t.readStr_fixedLength=s,t.writeStr_MAX_NAMESIZE=a,t.readFromUint8Array=m,t.toUint8Array=c,t.fromUint8Array=u;var d=new Array;t.deserialize=l}(UtilByteArray||(UtilByteArray={}));var UtilColor;!function(t){function e(e){var i;switch(e){case t.COLOR_WHITE:i=t.WHITE;break;case t.COLOR_GREEN:i=t.GREEN;break;case t.COLOR_BLUE:i=t.BLUE;break;case t.COLOR_PURPLE:i=t.PURPLE;break;case t.COLOR_GOLD:i=t.GOLD;break;case t.COLOR_RED:i=t.RED;break;default:i=t.DEFAULT}return i}t.CHAT_SYS_WHITE_COLOR=13615784,t.CHAT_SYS_RED_COLOR=13641507,t.CHAT_USERNAME_BLUE_COLOR=751584,t.CHAT_BOSS_YELLOW_COLOR=14918695,t.CHAT_SYS_GREEN_COLOR=1681408,t.DEFAULT=14745596,t.GRAY=10855071,t.WHITE=14674672,t.GREEN=9171081,t.BLUE=3919342,t.PURPLE=11759087,t.GOLD=16767837,t.RED=13449043,t.COLOR_WHITE=0,t.COLOR_GREEN=1,t.COLOR_BLUE=2,t.COLOR_PURPLE=3,t.COLOR_GOLD=4,t.COLOR_RED=5,t.colorValue=e}(UtilColor||(UtilColor={}));var UtilCommon;!function(t){function e(e,i){var n=Math.floor(i/t.UNITSIZE),o=i%t.UNITSIZE;e[n]|=1<<o}function i(e,i){var n=Math.floor(i/t.UNITSIZE),o=i%t.UNITSIZE;e[n]&=~(1<<o)}function n(e,i){var n=Math.floor(i/t.UNITSIZE),o=i%t.UNITSIZE;return 0!=(e[n]&1<<o)}function o(t,e){return t|=1<<e}function r(t,e){return t&=~(1<<e)}function s(t,e){return 0!=(t&1<<e)}function a(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=t;return n>>=e,n&=Math.pow(2,i-e+1)-1}function h(t){void 0===t&&(t="");var e="";try{throw new Error(t)}catch(i){e=Context.system.ExceptionToString(i)}return e}t.UNITSIZE=32,t.setState=e,t.clearState=i,t.isSet=n,t.setStateUint=o,t.clearStateUint=r,t.isSetUint=s,t.valueUint=a,t.getStackInfo=h}(UtilCommon||(UtilCommon={}));var UtilCompress;!function(t){function e(t){var e=new Zlib.Deflate(t,{compressionType:1}),i=e.compress();return i}function i(t){var e=new Zlib.Inflate(t),i=e.decompress();return i}t.compress=e,t.uncompress=i}(UtilCompress||(UtilCompress={}));var UtilDictionary;!function(t){function e(t){var e;for(e in t)return!1;return!0}function i(t,e){for(var i in t)if(t[i]==e)return i;return null}function n(t){for(var e in t)delete t[e];return!0}function o(t){var e=0;for(var i in t)e++;return e}function r(t){for(var e=t.match(/[a-zA-Z0-9-]+/g),i=e.length,n={},o=0;i>o;o+=2)n[e[o]]=e[o+1];return n}function s(t){for(var e=t.match(/[a-zA-Z0-9-]+/g),i=e.length,n={},o=0;i>o;o+=2)n[e[o]]=parseInt(e[o+1]);return n}function a(t,e){for(var i in e)t[i]?t[i]=t[i]+e[i]:t[i]=e[i]}function h(t,e){for(var i in e)t[i]=e[i]}function m(t,e,i,n){void 0===n&&(n=1);var o={},r=0;1==n?r=t.readUnsignedByte():2==n&&(r=t.readUnsignedShort());var s,a=0;for(a=0;r>a;a++)s=new e,s.deserialize(t),o[s[i]]=s;return o}function c(e,i){t.clear(i);for(var n in e)i[n]=e[n]}function u(t){for(var e in t)t[e]=0}function l(t){for(var e in t)t[e]=""}t.isEmpty=e,t.getKey=i,t.clear=n,t.length=o,t.str2KeyValue=r,t.str2KeyNum=s,t.mergeAdd=a,t.mergeInto=h,t.deserialize=m,t.copy=c,t.resetNumber=u,t.resetString=l}(UtilDictionary||(UtilDictionary={}));var UtilEffect;!function(t){function e(t,e,o){switch(void 0===t&&(t=""),void 0===e&&(e=1),void 0===o&&(o=UtilColor.DEFAULT),e){case 1:i(t,o);break;case 2:n(t,o)}}function i(t,e){var i=new egret.TextField;i.size=28,i.textAlign=egret.HorizontalAlign.CENTER,i.textColor=e,i.fontFamily=UtilFont.SimHei,i.alpha=0,i.text=t,i.y=.5*Context.height,i.x=.5*(Context.width-i.textWidth),Context.uimgr.getFourthLayer().addChild(i);var n=function(){Context.uimgr.getFourthLayer().contains(i)&&(Context.uimgr.getFourthLayer().removeChild(i),i=null)},o=function(){egret.Tween.get(i).to({y:i.y-60,alpha:0},500).call(n,this)};egret.Tween.get(i).to({y:i.y-120,alpha:1},1e3,egret.Ease.cubicOut).call(o,this)}function n(t,e){var i=this,n=new egret.TextField;n.size=28,n.textAlign=egret.HorizontalAlign.CENTER,n.textColor=e,n.fontFamily=UtilFont.SimHei,n.alpha=0,n.text=t,n.y=.5*Context.height,n.x=.5*Context.width,n.anchorOffsetX=.5*n.textWidth,n.anchorOffsetY=.5*n.textHeight,n.scaleX=6,n.scaleY=6,Context.uimgr.getFourthLayer().addChild(n);var o=function(){Context.uimgr.getFourthLayer().contains(n)&&(Context.uimgr.getFourthLayer().removeChild(n),n=null)};egret.Tween.get(n).to({scaleX:1,scaleY:1,alpha:1},500,egret.Ease.quintInOut),egret.setTimeout(function(){egret.Tween.get(n).to({alpha:0},400).call(o,i)},this,1e3)}function o(t,e,i,n,o){function r(t,e){t&&t.call(e)}void 0===e&&(e=100),void 0===i&&(i=1),void 0===n&&(n=null),void 0===o&&(o=null),egret.Tween.removeTweens(t),egret.Tween.get(t).to({alpha:i},e).call(r,this,[n,o])}function r(t,e,i,n){function o(t,e){t&&t.call(e)}void 0===e&&(e=100),void 0===i&&(i=null),void 0===n&&(n=null),egret.Tween.removeTweens(t),egret.Tween.get(t).to({alpha:0},e).call(o,this,[i,n])}function s(t,e,i,n,o){void 0===e&&(e=100),void 0===i&&(i=0),void 0===n&&(n=null),void 0===o&&(o=null);var r=function(){egret.Tween.get(t).to({scaleX:.9,scaleY:.9},.5*e).call(this.AniScale,this)};egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},.5*e).call(r,this)}function a(t){egret.Tween.get(t).to({alpha:.3},120,egret.Ease.quadOut).to({alpha:1},120,egret.Ease.quadIn).to({alpha:.3},120,egret.Ease.quadOut).to({alpha:1},120,egret.Ease.quadIn).to({alpha:.3},120,egret.Ease.quadOut).to({alpha:1},120,egret.Ease.quadIn).call(function(){egret.Tween.removeTweens(t)})}function h(t,e,i,n,o){void 0===i&&(i=1e3),egret.Tween.get(t).to({scaleX:1,scaleY:1},300).to({x:e.x,y:e.y},i).to({scaleX:0,scaleY:0},300).call(n,o,[t])}function m(t,e,i,n,o,r,s,a){void 0===n&&(n=1e3),void 0===o&&(o=0),void 0===r&&(r=0),void 0===s&&(s=null),void 0===a&&(a=null);var h=new eui.Image(t);h.x=e.x,h.y=e.y,h.anchorOffsetX=.5*o,h.anchorOffsetY=.5*r,h.width=o,h.height=r,h.scaleX=.8,h.scaleY=.8,h.alpha=0,h.touchEnabled=!1,Context.uimgr.getFourthLayer().addChild(h);var m=function(t,e){t&&UtilUI.disposeDisplayObject(t)},c=function(t){var e=Context.dBonesMgr.createDBones("qizixiaochu");Context.uimgr.getFourthLayer().addChild(e),e.addEventListener(egret.Event.COMPLETE,function(t){var e=t.target;e.clear()},this),e.x=t.x,e.y=t.y,e.play()},u=function(t,e){t&&t.call(e,this)};egret.Tween.get(h).to({scaleX:1,scaleY:1,alpha:1},300).to({x:i.x,y:i.y},n).to({scaleX:1.2,scaleY:1.2},100).to({scaleX:.6,scaleY:.6},200).to({alpha:0},200).call(c,this,[h]).call(m,this,[h]).call(u,this,[s,a])}function c(t,e,i,n,o){void 0===e&&(e=500),void 0===i&&(i=egret.Ease.quadIn),void 0===n&&(n=null),void 0===o&&(o=null),t.scaleX=.8,t.scaleY=.8,t.alpha=.5;var r=function(t,e){t&&t.call(e,this)};egret.Tween.removeTweens(t),egret.Tween.get(t).to({scaleX:1.05,scaleY:1.05,alpha:1,blurFliter:0},200,i).to({scaleX:1,scaleY:1},300,egret.Ease.backOut).call(r,this,[n,o])}function u(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),egret.Tween.removeTweens(t),egret.Tween.get(t).to({scaleX:1.05,scaleY:1.05,alpha:1,blurFliter:0},100,egret.Ease.quadIn).to({scaleX:.8,scaleY:.8,alpha:0},200).call(e,i)}t.showPrompt=e,t.aniFadeIn=o,t.aniFadeOut=r,t.AniScale=s,t.aniFlicker=a,t.showFlyCom=h,t.showFlyImage=m,t.MovieTweenBox=c,t.reMovieTweenBox=u}(UtilEffect||(UtilEffect={}));var UtilFlilter;!function(t){function e(){if(null==u){var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0];u=new egret.ColorMatrixFilter(t)}return u}function i(){if(null==l){var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0];l=new egret.ColorMatrixFilter(t)}return l}function n(){if(null==p){var t=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0];p=new egret.ColorMatrixFilter(t)}return p}function o(){if(null==d){var t=[0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0];d=new egret.ColorMatrixFilter(t)}return d}function r(){if(null==_){var t=[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0];_=new egret.ColorMatrixFilter(t)}return _}function s(){if(null==f){var t=[1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0];f=new egret.ColorMatrixFilter(t)}return f}function a(){if(null==g){var t=[1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0];g=new egret.ColorMatrixFilter(t)}return g}function h(){if(null==y){var t=[0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];y=new egret.ColorMatrixFilter(t)}return y}function m(){return null==C&&(C=new egret.GlowFilter(16730112,.8,12,12,6)),C}function c(){return null==v&&(v=new egret.GlowFilter(16730112,.8,12,12,8,2,!0)),v}t.createGrayFilter=e;var u=null;t.createBlackFilter=i;var l=null;t.createRedFilter=n;var p=null;t.createGreenFilter=o;var d=null;t.createBlueFilter=r;var _=null;t.createYellowFilter=s;var f=null;t.createPurpleFilter=a;var g=null;t.createLightblueFilter=h;var y=null;t.createGlowFilter=m;var C=null;t.createGlowFilterInner=c;var v=null}(UtilFlilter||(UtilFlilter={}));var UtilFont;!function(t){t.SimHei="SimHei"}(UtilFont||(UtilFont={}));var UtilJson;!function(t){function e(t,e){var i=t[e];return i&&"true"==i?!0:!1}t.attributeAsBoolean=e}(UtilJson||(UtilJson={}));var UtilMath;!function(t){function e(e,i,n,o){var r=Math.atan2(o-i,n-e);return 0>r&&(r+=t.PI2),180*r/Math.PI}function i(e,i,n,o){var r=Math.atan2(o-i,n-e);return 0>r&&(r+=t.PI2),r}function n(e,i){var n=Math.atan2(i,e);return 0>n&&(n+=t.PI2),n}function o(t,e,i,n){var o=t-i,r=n-e;return Math.sqrt(o*o+r*r)}function r(t,e){var i=t*Math.PI/180,n=e*Math.cos(i),o=e*Math.sin(i);return new egret.Point(n,o)}function s(e,i,n,o,r,s){var a=Math.atan2(o-i,n-e),h=t.distance(e,i,n,o)*r,m=h*Math.cos(a),c=h*Math.sin(a);return null==s&&(s=new egret.Point),s.x=e+m,s.y=i+c,s}function a(t){return t%=360,t*c}function h(e,i,n,o,r,s,a){var h=n*r+(1-r)*e,m=o*r+(1-r)*i;if(null==u&&(u=new egret.Point(0,0)),0!=s){if(o==i)u.x=0,u.y=-1;else if(e==n)u.x=-1,u.y=0;else{var c=(e-n)/(i-o);c>0?(u.x=1,u.y=-c):(u.x=-1,u.y=c),u.normalize(1)}var l=t.distance(e,i,n,o)*s;h+=u.x*l,m+=u.y*l}null==a&&(a=new egret.Point),a.x=h,a.y=m}function m(t,e,i){return t>i&&e>=t}t.PI2=2*Math.PI,t.getAngle=e,t.getAngleRadian=i,t.getAngleRadian2=n,t.distance=o,t.getPosInBeeline=r,t.getPosInSegment=s;var c=Math.PI/180;t.angle360ToRadian=a;var u;t.computeMidPointTop=h,t.valueReach=m}(UtilMath||(UtilMath={}));var UtilModel;!function(t){function e(t){return p[t]}function i(e){e=(e+45)%360,0>e&&(e+=360);var i=0,n=e*t.spriteIndexCoefficient;return i=n>=7.5?0:Math.round(n)}function n(t,e){return void 0===e&&(e=0),t>0?"c"+t+"_"+e:""}function o(t,e){return void 0===e&&(e=0),""}function r(t,e){return void 0===e&&(e=0),t>0?"w"+t+"_"+e:""}function s(t,e){return void 0===e&&(e=0),""}function a(t,e,i){return void 0===i&&(i=0),t>0?"f"+(t+e)+"_"+i:""}function h(t,e){return void 0===e&&(e=0),t>0?"c"+t+"_"+e+"_ui":""}function m(t,e){return void 0===e&&(e=0),""}function c(t,e){return void 0===e&&(e=0),t>0?"w"+t+"_"+e+"_ui":""}function u(t,e){void 0===e&&(e=0)}function l(t){return t>0?"f"+t+"_ui":""}t.TActStand=0,t.TActRun=1,t.TActAttack=2,t.TActDie=3,t.TActStandUI=4,t.TActAttackUI=5,t.EVENT_ActList_Complete="ActList_Complete",t.MODELPostion_name="name",t.MODELPostion_hit="hit",t.MODELPostion_referencePoint="referencePoint",t.spriteIndexCoefficient=8/360,t.m_allDir=[0,1,2,3,4,5,6,7];var p=[0,1,2,3,2,1,0,7];t.m_sResAngles=[0,1,2,3,7];t.wuqiLayer={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:-1},t.chibangLayer={0:2,1:-1,2:-1,3:-1,4:-1,5:-1,6:2,7:1},t.yunLayer={0:-1,1:-1,2:-1,3:-1,4:-1,5:-1,6:-1,7:-2},t.wuqiLayer_ui={0:1,1:1,2:1,3:0,4:1,5:1,6:1,7:-1},t.angle2ResAngle=e,t.angle360ToDir8=i,t.getModelName=n,t.getModelNameByEquipID=o,t.getWeaponName=r,t.getWeaponNameByEquipID=s,t.getWingName=a,t.getModelName_ui=h,t.getModelNameByEquipID_ui=m,t.getWeaponName_ui=c,t.getWeaponNameByEquipID_ui=u,t.getWingName_ui=l}(UtilModel||(UtilModel={}));var UtilObject;!function(t){function e(t){if(void 0===t)return"<undefined>";if(null===t)return"<null>";var e=typeof t;return"number"==e?t:"string"==e?t:"boolean"==e?t:"function"==e?"<function>":t instanceof Array?i(t):"object"==e?o(t):""}function i(t){var i="[",n=t.length,o=0;for(o=0;n>o&&(i+=e(t[o]),o++,n>o);)i+=",";return i+="]"}function n(t){return"function"==typeof t}function o(t){var i,o="{",r=!0;for(i in t)"__logFlag__"!=i&&"__class__"!=i&&"__types__"!=i&&(n(t[i])||(r?r=!1:o+=",\n",o+=i+":"+e(t[i])));return o+="}"}function r(t){for(var e in t)return!1;return!0}t.dump=e,t.dumpArray=i,t.isFunction=n,t.dumpObject=o,t.isEmpty=r}(UtilObject||(UtilObject={}));var UtilRandom;!function(t){function e(t){var e=t.length,i=0,n=0;for(i=0;e>i;i++)n+=t[i];var o=Math.random()*n;for(n=0,i=0;e>i;i++)if(n+=t[i],n>=o)return i;return 0}function i(t){var e,i=0;for(e in t)i+=t[e];var n=Math.random()*i;i=0;var o=0;for(e in t)if(o=parseInt(e),i+=t[e],i>=n)break;
return o}function n(t){var e=t.length-1;return e>0&&(e=Math.round(e*Math.random())),t[e]}function o(e,i){void 0===i&&(i=1);var n,o=[],r=e.length;if(i>r)for(n=0;i>n;n++)r>n?o.push(e[n]):o.push(t.random(e));else if(r>i){var s=[];for(n=0;r>n;n++)s.push(n);var a=void 0;for(n=0;i>n;n++)a=t.random(s),o.push(e[a]),s.splice(s.indexOf(a),1)}else for(n=0;r>n;n++)o.push(e[n]);return t.shuffle(o),o}function r(t){for(var e,i,n=t.length;n;)e=Math.floor(Math.random()*n--),i=t[n],t[n]=t[e],t[e]=i}function s(t,e){var i=Math.floor(Math.random()*(e-t))+t;return i}t.random_weights=e,t.randomID=i,t.random=n,t.randomObjs=o,t.shuffle=r,t.randomNum=s}(UtilRandom||(UtilRandom={}));var UtilRichText;!function(t){function e(){m=[]}function i(){return m}function n(t,e,i,n){void 0===i&&(i=18),void 0===n&&(n=!1);var o={textColor:e,size:i};return n&&(o.underline=!0),{text:t,style:o}}function o(t,e,i,o){void 0===i&&(i=18),void 0===o&&(o=!1);var r,s=[];return r=o?n(t,e,i,!0):n(t,e,i),s.push(r),s}function r(t,e,i,o){void 0===i&&(i=18),void 0===o&&(o=!1),m.push(n(t,e,i))}function s(){var t={text:"\n"};m.push(t)}function a(t){var e;try{e=JSON.parse(t)}catch(i){Context.system.logException(i),Context.logMgr.sendServer("stringToTextFlow() error! str="+t)}return e}function h(t){var e=t;e=e.replace(RegExp("\\{selfname}","g"),Context.heroinfoMgr.name);var i;return i=1==Context.heroinfoMgr.sex?Context.languageMgr.getEleStr("con",28):Context.languageMgr.getEleStr("con",27),e=e.replace(RegExp("\\{chenghu}","g"),i),(new egret.HtmlTextParser).parser(e)}var m=[];t.beginCompose=e,t.getComposedContent=i,t.formatTextFlow=o,t.add=r,t.breakline=s,t.stringToTextFlow=a,t.htmlTextToTextFlow=h}(UtilRichText||(UtilRichText={}));var UtilRichText2;!function(t){function e(t,e){void 0===e&&(e=20);var n=(t.length,0),o={},r=[];UtilRichText.beginCompose();for(var s="";n<t.length;){var a=t.charAt(n);if("["==a){n=i(t,n,o);var h=o.s,m=void 0;if("-"==h)m=r.pop();else{m=r[r.length-1],h.length>6&&(h=h.substr(0,6));var c=parseInt(h,16);r.push(c)}s.length&&(UtilRichText.add(s,m,e),s="")}else{if("\\"==a){var u=t.charAt(n+1);if("n"==u){var c=r[r.length-1];UtilRichText.add(s,c,e),s="",UtilRichText.breakline(),n+=2;continue}}s+=a,n++}}return UtilRichText.getComposedContent()}function i(t,e,i){var n=(t.length,t.indexOf("]",e+1)),o=t.substring(e+1,n);return i.s=o,n+1}t.parse=e}(UtilRichText2||(UtilRichText2={}));var UtilRichTextApp;!function(t){function e(t,e,i,n){void 0===i&&(i=18),void 0===n&&(n=UtilColor.WHITE);var o;return o=e>t?UtilColor.RED:n,UtilRichText.beginCompose(),UtilRichText.add(t.toString(),o,20),UtilRichText.add("/"+e,n,20),UtilRichText.getComposedContent()}function i(t,e,i,n,o){void 0===n&&(n=18),void 0===o&&(o=UtilColor.WHITE);var r;return r=i?UtilColor.RED:o,UtilRichText.beginCompose(),UtilRichText.add(t,r,20),UtilRichText.add("/"+e,o,20),UtilRichText.getComposedContent()}t.progressDesc=e,t.progressDesc_String=i}(UtilRichTextApp||(UtilRichTextApp={}));var UtilString;!function(t){function e(t){return t.match(/[a-zA-Z0-9-]+/g)}function i(t){return t.replace("\\","/")}function n(t,e,i){var n,o=t.length,r="";for(e++;o>e;e++){if(n=t.charAt(e),"'"==n){e++;break}r+=n}i[0]=r,i[1]=e}function o(t,e,i){for(var n,o=t.length,r="";o>e&&(n=t.charAt(e),!s(n)&&"'"!=n&&"="!=n);e++)r+=n;i[0]=r,i[1]=e}function r(t){for(var e,i=t.length,r=0,a=[],h=[];i>r;)e=t.charAt(r),"'"==e?(n(t,r,h),a.push(h[0]),r=h[1]):"="==e?(a.push("="),r++):s(e)?r++:(o(t,r,h),a.push(h[0]),r=h[1]);return a}function s(t){return" "==t||"	"==t}function a(t){var e=(t.length,t.indexOf("<"));return-1==e?!1:-1==t.indexOf("font",e)&&-1==t.indexOf("FONT",e)?!1:-1==t.indexOf(">",e)?!1:!0}function h(t){try{var e=t.length;if(0==t.indexOf("[")&&e>0&&e==t.lastIndexOf("]")+1&&-1!=t.indexOf("text")){JSON.parse(t);return!0}return!1}catch(i){return!1}}function m(t){return!isNaN(Number(t))}function c(t){var e=["%","/","\\","<",">"," "];for(var i in e)if(-1!=t.indexOf(e[i]))return!0;return!1}function u(t){var e=/[^\a-\z\A-\Z0-9\u4E00-\u9FA5]/;return""!=t&&t?e.test(t)?!1:!0:!1}t.split=e,t.replaceBlackslashWidthSlash=i,t.readSingleQuoteContent=n,t.readToken=o,t.parseTokens=r,t.isSpace=s,t.isXml=a,t.isJson=h,t.isNumber=m,t.bHasInvalidChar=c,t.isChinese=u}(UtilString||(UtilString={}));var UtilTime;!function(t){function e(e,i){var n=o(e),r=o(i);return(r-n)/t.DAY_SECOND}function i(e,i){var o=n(e),r=n(i);return(r-o)/t.DAY_SECOND}function n(e){var i=Math.floor((e+t.TIME_ZONE_Second)/t.DAY_SECOND)*t.DAY_SECOND;return i-t.TIME_ZONE_Second}function o(e){var i=0,o=n(e),r=7*t.HOUR_SECOND;return i=e-o>=r?o+r:o+r-t.DAY_SECOND}function r(e){var i=0,o=n(e),r=7*t.HOUR_SECOND;return i=r>=e-o?o+r:o+r+t.DAY_SECOND}function s(t,e,i,n){void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=!1);var o,r,s="";return t>=3600?(o=Math.floor(t/3600),10>o?(s+="0",s+=o,s+=n?Context.languageMgr.getEleStr("con",310):":"):(s+=o,s+=n?Context.languageMgr.getEleStr("con",310):":"),t-=3600*o):e&&(s+=n?"0"+Context.languageMgr.getEleStr("con",310):"00:"),t>=60?(r=Math.floor(t/60),10>r?(s+="0",s+=r,n?s+=Context.languageMgr.getEleStr("con",311):i&&(s+=":")):(s+=r,n?s+=Context.languageMgr.getEleStr("con",311):i&&(s+=":")),t-=60*r):t>0&&!i?s+=n?"1"+Context.languageMgr.getEleStr("con",311):"01":n?s+="00"+Context.languageMgr.getEleStr("con",311):(s+="00",i&&(s+=":")),i&&(0==t?s+="00":t>0&&10>t?(s+="0",s+=t):s+=t,n&&(s+=Context.languageMgr.getEleStr("con",312))),s}function a(e,i){void 0===i&&(i=!1);var n="",o=Math.floor(e/t.DAY_SECOND),r=Math.floor(Math.floor(e%t.DAY_SECOND/t.HOUR_SECOND));return i?n=o?o+Context.languageMgr.getEleStr("con",313):r+Context.languageMgr.getEleStr("con",310):(o&&(n=o.toString()+Context.languageMgr.getEleStr("con",313)),n+=r.toString()+Context.languageMgr.getEleStr("con",310)),n}function h(e){var i=e>=t.DAY_SECOND?Math.floor(e/t.DAY_SECOND):0;e-=i*t.DAY_SECOND;var n=e>=t.HOUR_SECOND?Math.floor(e/t.HOUR_SECOND):0;e-=n*t.HOUR_SECOND;var o=e>=60?Math.floor(e/60):0;return Context.languageMgr.getEleStr("con",308,[i,n,o])}function m(e){var i=e>=t.DAY_SECOND?Math.floor(e/t.DAY_SECOND):0;e-=i*t.DAY_SECOND;var n=e>=t.HOUR_SECOND?Math.floor(e/t.HOUR_SECOND):0;e-=n*t.HOUR_SECOND;e>=60?Math.floor(e/60):0;return Context.languageMgr.getEleStr("con",309,[i,n])}function c(e){var i=e>=t.DAY_SECOND?Math.floor(e/t.DAY_SECOND):0;e-=i*t.DAY_SECOND;var n=e>=t.HOUR_SECOND?Math.floor(e/t.HOUR_SECOND):0;e-=n*t.HOUR_SECOND;var o=e>=60?Math.floor(e/60):0;return Context.languageMgr.getEleStr("con",111,[n,o])}function u(t,e){var i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in i)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[n]:("00"+i[n]).substr((""+i[n]).length)));return e}function l(e,i){void 0===i&&(i="hh:mm:ss");var n=new Date(1e3*e);return t.dateFormat(n,i)}function p(t,e){var i=Math.floor(.001*(egret.getTimer()-e));return t>i?t-i:0}function d(t){return Math.floor(.001*(egret.getTimer()-t))}function _(t){var e=t.split("-"),i=Context.timeMgr.getServerTimeL().formatString_hms(),n=e[0]+":00",o=e[1]+":00";return n>i?1:i>=o?-1:0}function f(t){var e=1e3*Context.timeMgr.serverTimeCompute,i=new Date(e),n=Date.parse(i.toLocaleDateString()+" "+t+":00");return n>e?1:-1}t.TIME_ZONE=8,t.TIME_ZONE_MillionSecond=288e5,t.TIME_ZONE_Second=28800,t.DAY_SECOND=86400,t.DAY_MillionSecond=1e3*t.DAY_SECOND,t.HOUR_SECOND=3600,t.HOUR_MILLISECOND=36e5,t.MINUTE_MILLISECOND=6e4,t.SECOND_MILLISECOND=1e3,t.s_computeDayDifference_7=e,t.s_computeDayDifference_0=i,t.s_getDay_0=n,t.s_curDay_7=o,t.s_NextDay_7=r,t.formatTimeToString=s,t.formatTimeToStr2=a,t.formatTimeToStr_dhm=h,t.formatTimeToStr_dh=m,t.formatTimeToStr_hm=c,t.dateFormat=u,t.dateFormat2=l,t.leftTime=p,t.passTime=d,t.stateSometime=_,t.stateTime=f}(UtilTime||(UtilTime={}));var UtilTools;!function(t){function e(t,e){void 0===e&&(e=null);var i=t;if(e)for(var n=e.length,o=0;n>o;o++)i=i.replace(RegExp("\\{"+o+"\\}","g"),e[o]);return i}function i(t){return"resource/assets/ui/uiimage/"+t+".png"}function n(t){return"resource/assets/ui/uiimage/"+t+".jpg"}function o(t){return"resource/assets/ui/"+t+".png"}function r(t){return"resource/assets/ui/uiimage/obj_"+t+".png"}function s(e){return t.uiimagePath("icon_clothes"+e)}function a(e){return t.uiimagePath("img_clothes"+e)}function h(t,e,i){var n="resource/assets/model/"+t+"/"+e+"_"+i+".png";return n}function m(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i="(",n=0;for(n=0;n+1<t.length;n+=2)n>0&&(i+=", "),i+=t[n]+"="+t[n+1];return i+=")"}function c(t){var e="(",i=0;for(var n in t)i>0&&(e+=", "),e+=n+"="+t[n],i++;return e+=")"}function u(t,e){return void 0===e&&(e=0),t>=1e8?(t=1e-8*t,t>1e3&&(e=0),t-=.5*Math.pow(.1,e),t.toFixed(e)+Context.languageMgr.getEleStr("con",14)):t>=1e5?(t=1e-4*t,t>1e3&&(e=0),t-=.5*Math.pow(.1,e),t.toFixed(e)+Context.languageMgr.getEleStr("con",13)):""+t}t.replaceStr=e,t.uiimagePath=i,t.uiimagePath_jpg=n,t.uiPath=o,t.uiObjImagePath=r,t.uiClothesIcon=s,t.uiClothesImg=a,t.modelPath=h,t.keyValueToString_parenthese=m,t.keyValueToString_parenthese2=c,t.num2Str=u}(UtilTools||(UtilTools={}));var UtilUI;!function(t){function e(t,e){t.promptIcon.visible=e}function i(t,e){return t[e]}function n(t){core.ui_call_dispose(t),t.parent&&t.parent.removeChild(t)}function o(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=0);for(var o=t.x+e-t.anchorOffsetX,r=t.y+i-t.anchorOffsetY,s=t.parent;s&&(o+=s.x-s.anchorOffsetX,r+=s.y-s.anchorOffsetY,!(s instanceof eui.UILayer));)s=s.parent;return n?(n.setTo(o,r),n):new egret.Point(o,r)}function r(t,e,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0);for(var r=e.x+i-e.anchorOffsetX,s=e.y+n-e.anchorOffsetY,a=e.parent;a&&(r+=a.x,s+=a.y,a!=t&&a!=Context.stage);)a=a.parent;return o||(o=new egret.Point(0,0)),o.setTo(r,s)}function s(t){for(var e=t;e;){if(e instanceof Form)return e.isVisible();e=e.parent}return!1}t.setButtonPromptIconVisible=e,t.getButtonImage=i,t.disposeDisplayObject=n,t.localToUILayer=o,t.localToParent=r,t.isVisibleBelongForm=s}(UtilUI||(UtilUI={}));var UtilUrl;!function(t){function e(){return Context.platformMgr.getisWss()?"https://hldmx-login.cmcm.com/yunying/tool/msn_monitor/":"http://hldmx-login.cmcm.com/yunying/tool/msn_monitor/"}function i(){return Context.platformMgr.getisWss()?"https://hldmx-login.cmcm.com/yunying/tool/msn_Yunying/":"http://hldmx-login.cmcm.com/yunying/tool/msn_Yunying/"}function n(t){var e={};if(0==t.length)return e;for(var i=t.split("&"),n=0;n<i.length;n++){var o=i[n].split("=");e[o[0]]=o[1]}return e}function o(t){var e,i="",n=!0;for(e in t)n?n=!1:i+="&",i+=e+"="+encodeURIComponent(t[e]);return i}t.getMonitorURL=e,t.getYunyingURL=i,t.parseURLParam=n,t.jointURLParam=o}(UtilUrl||(UtilUrl={}));var UtilXml;!function(t){function e(t,e){return t.attributes.hasOwnProperty(e)}function i(t,e){return t.attributes.hasOwnProperty(e)?t.attributes[e]:""}function n(t,e){if(t.attributes.hasOwnProperty(e)){var i=t.attributes[e];if(i)return parseInt(i,10)}return 0}function o(t,e){if(t.attributes.hasOwnProperty(e)){var i=t.attributes[e];return parseFloat(i)}return 0}function r(t,e){if(t.attributes.hasOwnProperty(e)){var i=t.attributes[e];if("true"==i||"TRUE"==i)return!0}return!1}function s(t,e){var i=t.children,n=0,o=i.length,r=[];for(n=0;o>n;n++){var s=i[n];if(1==s.nodeType){var a=s;a.localName==e&&r.push(a)}}return r}function a(t,e){var i=t.children,n=0,o=i.length;for(n=0;o>n;n++){var r=i[n];if(1==r.nodeType){var s=r;if(s.localName==e)return s}}return null}function h(t,e,i,n){void 0===n&&(n="");var o;t.hasOwnProperty(e)?o=t[e]:(o=n?{}:[],t[e]=o),o instanceof Array?o.push(i):o[n]=i}function m(t,e){void 0===e&&(e=[]);var i,n={},o=t.attributes;for(var r in o){if(i=o[r],UtilString.isNumber(i)){var s=parseInt(i),a=parseFloat(i);i=s==a?s:a}n[r]=i}var c,u,l,p=t.children;for(var s in p)if(c=p[s],l=c.localName,"_config"!=l){u=m(c,e);var d="";if(-1!=e.indexOf(l)){var _=["id","num","name","level"];for(var f in _)c.attributes.hasOwnProperty(_[f])&&(d=""+c.attributes[_[f]])}h(n,l,u,d)}return n}function c(e){var i=t.getOneChildByName(e,"_config");m(i);return m(e)}t.hasAttribute=e,t.attributeString=i,t.attributeInt=n,t.attributeNumber=o,t.attributeBoolean=r,t.getChildrenByName=s,t.getOneChildByName=a,t.xml2Json=c}(UtilXml||(UtilXml={}));var Login;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._cdnRoot="",e}return __extends(e,t),Object.defineProperty(e.prototype,"cdnRoot",{get:function(){return this._cdnRoot},enumerable:!0,configurable:!0}),e.prototype.loadVersionFile=function(){var t=this;this._cdnRoot=Context.bzConfig.cdnroot,RES.getRealURL=this.getVirtualUrl.bind(this);var e=this,i="version.zip";this.cdnRoot&&(i=this.cdnRoot+i);var n;n="version"in window?window.version:Date.now().toString();var o=new Promise(function(o,r){function s(t){r()}function a(){this.m_zip=new JSZip;var t=h.response;this.m_zip.load(t,{});var i=this.m_zip.file("version.json").asText();e._versionInfo=JSON.parse(i),o()}var h=new egret.HttpRequest;h.addEventListener(egret.Event.COMPLETE,a,t),h.addEventListener(egret.IOErrorEvent.IO_ERROR,s,t),h.responseType=egret.HttpResponseType.ARRAY_BUFFER,h.open(i+"?r="+n,"get"),h.send()});return o},e.prototype.getVirtualUrl=function(t){var e;return e=this._versionInfo&&this._versionInfo[t]?this._cdnRoot+t+"?v="+this._versionInfo[t]:t},e.prototype.getVersion=function(t){return this._versionInfo&&this._versionInfo[t]?this._versionInfo[t]:"0"},e}(egret.EventDispatcher);t.GameVersionController=e,__reflect(e.prototype,"Login.GameVersionController")}(Login||(Login={}));var Login;!function(t){var e=function(){function t(){this.m_complete=!1,this.m_step=t.STEP_none}return t.prototype.advanceTime=function(e){this.m_step==t.STEP_dataXml?(Context.dataXmlMgr=new dataXml.DataXmlMgr,Context.dataXmlMgr.load(),Context.aniXmlMgr=new common.AniXmlMgr,Context.aniXmlMgr.load(),this.m_step=t.STEP_platformInit):this.m_step==t.STEP_platformInit?(this.m_step=t.STEP_platformInit_ing,this.m_step=t.STEP_platformInit_complete):this.m_step==t.STEP_platformInit_complete&&this.onPlatformInitComplete()},t.prototype.begin=function(){this.m_step=t.STEP_dataXml,Context.juggle.add(this)},t.prototype.onPlatformMgrInit=function(){return this.m_step>=t.STEP_platformInit_complete?void Context.logMgr.sendServer("onPlatformMgrInit this.m_step="+this.m_step):void(this.m_step=t.STEP_platformInit_complete)},t.prototype.onPlatformInitComplete=function(){this.m_step=t.STEP_end,this.m_complete=!1,Context.loginCC.showLoginForm(),Context.juggle.remove(this)},t.prototype.isComplete=function(){return this.m_complete},t.STEP_none=0,t.STEP_dataXml=1,t.STEP_platformInit=2,t.STEP_platformInit_ing=3,t.STEP_platformInit_complete=4,t.STEP_end=5,t}();t.LoginControl2=e,__reflect(e.prototype,"Login.LoginControl2",["animation.IAnimatable"])}(Login||(Login={}));var Login;!function(t){var e=function(){function t(){this.m_process2_pre=0,this.computeProcess=new dataset.ComputeProcess}return Object.defineProperty(t.prototype,"promise",{get:function(){return this.m_promise},enumerable:!0,configurable:!0}),t.prototype.begin=function(){var t=this;this.m_promise=new Promise(function(e,i){function n(){e()}t.onComplete=n}),RES.loadGroup("config2",-1).then(this.process1.bind(this))},t.prototype.process1=function(){RES.loadGroup("preload",-1).then(this.process2.bind(this));var t=this.computeProcess;t.clear(),t.add(Context.modelConfigMgr.load,Context.modelConfigMgr),t.add(Context.effectConfigMgr.load,Context.effectConfigMgr),t.add(Context.dBonesMgr.load,Context.dBonesMgr),t.add(Context.mapConfigMgr.loadMapStop,Context.mapConfigMgr),t.compute().then(this.process2.bind(this))},t.prototype.process2=function(){this.m_process2_pre++,this.m_process2_pre<2||(this.m_isComplete=!0,this.onComplete.call(),RES.destroyRes("config2"))},t}();t.LoginControl3=e,__reflect(e.prototype,"Login.LoginControl3")}(Login||(Login={}));var Login;!function(t){var e=function(){function t(){this.zoneId=1,this.platformType=100,this.userInfo_wx={nickName:"",avatarUrl:"",gender:0,openid:""},this.authorize_wx={"scope.userInfo":!1}}return t}();t.LoginData=e,__reflect(e.prototype,"Login.LoginData")}(Login||(Login={}));var Login;!function(t){var e=function(){function e(){this.m_finalMsgreceived=!1,this.m_progressDurationRatio=1,this.m_isComplete=!1,this.m_process2_pre=0,this.m_isLoginServerConnectPrepare=!1,this.computeProcess=new dataset.ComputeProcess,Context.loginCC3=new t.LoginControl3,Context.loadingView=new t.UILoadingMgr,Context.loginData=new t.LoginData}return e.prototype.begin=function(){if(Context.mapMgr=new scene.MapMgr,Context.gameAreaMgr.gameRoot.addChild(Context.mapMgr.sceneRoot),Context.uimgr=new UIManager,Context.gameAreaMgr.gameRoot.addChild(Context.uimgr.uiRoot),Context.platformMgr=new common.PlatformMgr,Context.operationMgr=new common.OperationMgr,Context.imageLoaderMgr=new imageLoad.ImageLoadMgr,Context.imageAssetAdapter=new core.ImageAssetAdapter,Context.resGroupProloadMgr=new core.ResourceGroupProloadMgr,Context.loginCC2=new t.LoginControl2,Context.reloginMgr=new t.ReloginMgr,Context.timeMgr=new core.TimeMgr,Context.revMessageMgr=new Server.ReceiveMessageMgr,Context.sendMessageMgr=new Server.SendMessageMgr,Context.juggle1min=new animation.Juggler,Context.juggle1Sec=new animation.Juggler,Context.httpRecMgr=new httpCmd.HttpCmdRecevieMgr,Context.httpSendMgr=new httpCmd.HttpCmdSendMgr,Context.system.isWXGame){var e={ver:Context.logMgr.jsversion,v:Math.random()},i=UtilUrl.jointURLParam(e),n=UtilUrl.getYunyingURL()+"platforms/wx/GetVersionType.php?"+i;this.m_verRequestWX=new core.HttpRequest_get,this.m_verRequestWX.send(n,this.onRequestComplete,this.onHttpError,this)}else this.loadResourceConfig()},e.prototype.onRequestComplete=function(){var t=this.m_verRequestWX.getResponse(),e=JSON.parse(t);Context.system.versionType_wx=e.type,Context.bzConfig.updateData(e.type),this.loadResourceConfig(),Context.logMgr.addLog("wxgame GetVersionType OK! ver="+Context.logMgr.jsversion+" type="+e.type)},e.prototype.onHttpError=function(t){this.loadResourceConfig(),Context.logMgr.sendServer("wxgame GetVersionType error! ver="+Context.logMgr.jsversion)},e.prototype.loadResourceConfig=function(){this.loadResource().then(this.process2.bind(this))["catch"](function(t){console.log(t)});var t=this.computeProcess;t.clear(),t.add(this.compute1,this),t.add(this.compute2,this),t.add(Context.createMgrs,Context),t.add(messageProcess.createProcess,messageProcess),t.compute().then(this.process2.bind(this))["catch"](function(t){console.log(t)})},e.prototype.compute1=function(){this.loginLoadSkinSubsystem=new t.LoginLoadSkinSubsystem(this),Context.system.printLog(),Context.logMgr.showPerformanceInfo(),Context.system.isMobile?this.m_progressDurationRatio=9:this.m_progressDurationRatio=3},e.prototype.compute2=function(){UtilByteArray.initZeroBuffer(),Context.msgRecordMgr=new common.MsgRecordMgr},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return Context.gameVersionController=new t.GameVersionController,[4,Context.gameVersionController.loadVersionFile()];case 1:return i.sent(),e=Context.gameVersionController.getVersion("resource/default.res.json"),[4,RES.loadConfig("default.res.json?"+e,Context.gameVersionController.cdnRoot+"resource/")];case 2:return i.sent(),[3,5];case 3:return[4,RES.loadConfig("resource/default.res.json?"+e,"resource/")];case 4:i.sent(),i.label=5;case 5:return window.GameGH||(Context.loadingView.show(),Context.loadingView.resetBarValue()),this.toProgressValue(.1),[4,RES.loadGroup("config1")];case 6:return i.sent(),Context.loginCC2.begin(),[3,8];case 7:return i.sent(),[3,10];case 8:return Context.resource1Loader=new t.Resource1Loader,[4,Context.resource1Loader.load()];case 9:i.sent(),i.label=10;case 10:return[2]}})})},e.prototype.process2=function(){if(this.m_process2_pre++,!(this.m_process2_pre<2)){var t=this.computeProcess;t.addEventListener(egret.Event.CHANGE,this.process2_progress,this),t.clear(),t.add(Context.dataTableMgr.loadInitTable,Context.dataTableMgr),t.add(Context.SWMgr.init,Context.SWMgr),t.compute().then(this.process3.bind(this))}},e.prototype.process2_progress=function(t){var e=.2;this.toProgressValue(e)},e.prototype.process3=function(){this.computeProcess.removeEventListener(egret.Event.CHANGE,this.process2_progress,this),Context.loginCC3.begin(),this.loginLoadSkinSubsystem.loadSkin().then(this.process4.bind(this))},e.prototype.process3_progress=function(t){var e=.3;this.toProgressValue(e)},e.prototype.process4=function(){this.m_isComplete=!0,Context.loginCC2.isComplete()?this.showLoginForm():Context.loadingView.setText("生活开始变得更美好",12),Context.logMgr.bShowDebugBtn()&&Context.uimgr.showForm(UIFormID.UIGmFloatBtn)},e.prototype.isComplete=function(){return this.m_isComplete},e.prototype.toProgressValue=function(t){if(window.GameGH){var e=.4+.6*t;return window.GameGH.adjustValue(),void window.GameGH.toValue(e)}Context.loadingView.setBarValue(t)&&Context.logMgr.addLog("toProgressValue "+t)},e.prototype.showLoginForm=function(){window.GameGH&&window.GameGH.close(),Context.logMgr.addLog("showLoginForm() UILoading!"),Context.loadingView.show(),Context.loadingView.resetBarValue(),this.m_isLoginServerConnectPrepare=!0},e.prototype.loginServerConnect=function(){Context.logMgr.addLog("loginServerConnect"),!this.m_isLoginServerConnectPrepare||Context.bzConfig.php_server_URL&&!Context.operationMgr.m_loginInfo||(Context.logMgr.addLog("loginServerConnect connect"),Context.loginServer.connect())},e}();t.LoginLoadControl=e,__reflect(e.prototype,"Login.LoginLoadControl")}(Login||(Login={}));var Login;!function(t){var e=function(){function t(t){this.m_lc=t}return t.prototype.loadSkin=function(){egret.registerImplementation("eui.IAssetAdapter",Context.imageAssetAdapter),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),Context.muskinTheme=new core.MUTheme;var t,e,i;return Context.resource1Loader?(t=Context.resource1Loader.getDefault_thmString(),e=Context.resource1Loader.getSkinPathString(),i=Context.resource1Loader.getGameEuiPathString()):(t=RES.getRes("default_thm"),e=RES.getRes("skinpath"),i=RES.getRes("gameeui")),Context.muskinTheme.addEventListener(egret.Event.CHANGE,Context.loginCC.process3_progress,Context.loginCC),Context.muskinTheme.load(t,e,i)},t}();t.LoginLoadSkinSubsystem=e,__reflect(e.prototype,"Login.LoginLoadSkinSubsystem")}(Login||(Login={}));var Login;!function(t){var e=function(){function t(){}return t.prototype.load=function(){this.m_zip=new JSZip;var t=RES.getRes("resource_zip");this.m_zip.load(t,{}),RES.destroyRes("resource_zip")},t.prototype.getDefault_thmString=function(){var t=this.m_zip.file("default.thm.json").asText();return t},t.prototype.getSkinPathString=function(){var t=this.m_zip.file("skinpath.json").asText();return t},t.prototype.getGameEuiPathString=function(){var t=this.m_zip.file("gameEui.json").asText();return t},t}();t.Resource1Loader=e,__reflect(e.prototype,"Login.Resource1Loader")}(Login||(Login={}));var Login;!function(t){var e=function(){function t(){}return t.prototype.load=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,RES.getResAsync("default_thm")];case 1:return t.sent(),[4,RES.getResAsync("skinpath")];case 2:return t.sent(),[2]}})})},t}();t.Resource1LoaderNeiwang=e,__reflect(e.prototype,"Login.Resource1LoaderNeiwang")}(Login||(Login={}));var Login;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_speed=2,e.m_noticeList=[],e.m_datas=[],e.width=202,e.height=120,e.scrollRect=new egret.Rectangle(0,0,e.width+100,e.height),e.initData(),e}return __extends(e,t),e.prototype.initData=function(){this.m_datas=[{name:"冰宝",txt:"进入游戏"},{name:"呆弟",txt:"进入游戏"},{name:"王者归来",txt:"进入游戏"},{name:"叶紫星",txt:"进入游戏"}],window.newPlayers&&(this.m_datas=window.newPlayers),UtilRandom.shuffle(this.m_datas);for(var t,e=0;5>e;e++)t=new i(this),t.updateData(this.getItemData()),t.y=30*e,this.m_noticeList.push(t)},e.prototype.getItemData=function(){var t=this.m_datas.pop();return this.m_datas.unshift(t),t},e.prototype.onEnterFame=function(){for(var t,e=this.m_noticeList,i=e.length,n=0;i>n;n++)t=e[n],t.y-=this.m_speed,t.y<=-30&&(t.y=120,t.updateData(this.getItemData()))},e.prototype.onShow=function(){this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFame,this)},e.prototype.onHide=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFame,this)},e.prototype.dispose=function(){this.onHide(),core.ui_call_supper_dispose(eui.Component,this)},e}(eui.Component);t.NewPlayerNotice=e,__reflect(e.prototype,"Login.NewPlayerNotice");var i=function(t){function e(e){var i=t.call(this)||this;return e.addChild(i),i.m_bgImg=new eui.Image,i.m_bgImg.source=Context.system.isWXGame?"openDataContext/assets/bg_xiaoandi.png":"bg_xiaoandi_png",i.addChild(i.m_bgImg),i.m_txtLabel=new eui.Label,i.addChild(i.m_txtLabel),i.m_txtLabel.x=4,i.m_txtLabel.y=4,i.m_txtLabel.fontFamily=UtilFont.SimHei,i.m_txtLabel.stroke=1.2,i.m_txtLabel.strokeColor=11355461,i.m_txtLabel.textFlow=UtilRichText.getComposedContent(),i}return __extends(e,t),e.prototype.updateData=function(t){UtilRichText.beginCompose(),UtilRichText.add(t.name,UtilColor.GREEN,20),UtilRichText.add(t.txt,UtilColor.DEFAULT,20),this.m_txtLabel.textFlow=UtilRichText.getComposedContent()},e}(eui.Component);__reflect(i.prototype,"NoticeItem")}(Login||(Login={}));var Login;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.m_bBarComplete=!0,t.horizontalCenter=0,t.verticalCenter=0,t.createView(),t}return __extends(i,e),i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.testTouchRect=new eui.Image("common.pixel_png"),this.testTouchRect.scale9Grid=new egret.Rectangle(1,1,2,2),this.testTouchRect.width=180,this.testTouchRect.height=180,this.testTouchRect.alpha=0,this.addChild(this.testTouchRect),this.testTouchRect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTestTouchRect,this),this.onStageReSize()},i.prototype.onStageReSize=function(){var t=640/1136,e=Context.width/Context.height;Math.abs(t-e)<.17?(this.percentWidth=100,this.percentHeight=100):(this.percentWidth=Number.NaN,this.percentHeight=Number.NaN,this.width=640,this.height=1136)},i.prototype.onTestTouchRect=function(){Context.uimgr.showForm(UIFormID.UIGmFloatBtn)},i.prototype.createView=function(){var e=this;e.width=Context.width,e.height=Context.height;var i=Context.system.isWXGame?"openDataContext/assets/bg_loading.jpg":"bg_loading_jpg";e.bgImage=new eui.Image(i),e.addChild(e.bgImage);var n=(Context.width,Context.height,640/Context.width),o=1136/Context.height,r=o>n?n:o;e.bgImage.width=640/r,e.bgImage.height=1136/r,e.bgImage.validateNow(),e.bgImage.x=.5*(Context.width-e.bgImage.width),e.bgImage.y=.5*(Context.height-e.bgImage.height);var s=new eui.Group;s.width=640,s.height=1136,s.horizontalCenter=0,s.verticalCenter=0,e.addChild(s),e.textField=new eui.Label,s.addChild(e.textField),e.textField.size=20,e.textField.y=1e3,e.textField.horizontalCenter=0,e.textField.fontFamily="SimHei",e.textField.text="一起来让我们的小屋更美丽吧",e.textField.stroke=2,e.textField.strokeColor=11355461,e.barGroup=new eui.Group,s.addChild(e.barGroup),e.barGroup.horizontalCenter=0,e.barGroup.y=e.textField.y+20;var a=Context.system.isWXGame?"openDataContext/assets/loading.png":"loading_png",h=Context.system.isWXGame?"openDataContext/assets/loadingbg.png":"loadingbg_png";e.barBg=new eui.Image(h),e.barBg.width=456,e.barBg.height=80,e.barGroup.addChild(e.barBg),e.bar=new uicommon.BarInProgress2,e.bar.setSource(a),e.bar.setChangeCallBack(e,e.onChangeBar),e.bar.x=28,e.bar.y=28,e.bar.mvSpeed=.5,e.bar.initValue=0,e.bar.setAniEndBarFullCallBack(e,e.onAniEndBarFull),e.barGroup.addChild(e.bar),e.barLabel=new eui.Label,e.barLabel.fontFamily="SimHei",e.barLabel.size=18,e.barLabel.stroke=1,e.barLabel.horizontalCenter=0,e.barLabel.y=30,e.barGroup.addChild(e.barLabel),platform.isNewPlayer()&&(e.notice=new t.NewPlayerNotice,e.notice.x=0,e.notice.y=800),e.m_bBarComplete=!1},i.prototype.onChangeBar=function(){var t=Math.floor(100*this.bar.value);this.barLabel.text=t+"%"},i.prototype.onShow=function(){e.prototype.onShow.call(this),this.notice&&(this.addChild(this.notice),this.notice.onShow())},i.prototype.onHide=function(){e.prototype.onHide.call(this),this.hideNewPlayerNotice(),this.bar.stop()},i.prototype.darkOthers=function(t,i){void 0===t&&(t=0),void 0===i&&(i=.6),e.prototype.darkOthers.call(this,t,1)},i.prototype.onAniEndBarFull=function(){this.m_bBarComplete=!0,Context.loginCC.m_finalMsgreceived?Context.loadingView.exit():Context.loadingView.hide(),Context.lobbyMgr.entryLobby()},i.prototype.setProgress=function(t,e,i){void 0===i&&(i=1);var n=t/e,o=n-this.bar.value;if(o>.15?o>.2?this.bar.mvSpeed*=1.1:this.bar.mvSpeed*=1.06:n-this.bar.value<-.15&&(this.bar.mvSpeed*=.94),e>t){var r=(t+i)/e;r>1&&(r=1),this.bar.toValue(r)}else this.bar.toValue(1)},i.prototype.initValue=function(t){this.bar&&(this.bar.initValue=0,this.m_bBarComplete=!1)},i.prototype.exit=function(){e.prototype.exit.call(this)},i.prototype.toValue=function(t){if(t<this.bar.value);this.bar.toValue(t)},Object.defineProperty(i.prototype,"value",{get:function(){return this.bar.value},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"destV",{get:function(){return this.bar.destV},enumerable:!0,configurable:!0}),i.prototype.setText=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=1),void 0===n&&(n=1),this.setProgress(e,i,n),this.textField.text=t},i.prototype.hideProgress=function(){this.textField.visible=!1},i.prototype.showProgress=function(){this.barGroup.visible=!0,this.textField.visible=!0},i.prototype.onStopBar=function(){this.hideNewPlayerNotice(),this.bar.stop()},i.prototype.hideNewPlayerNotice=function(){this.notice&&(this.contains(this.notice)&&this.removeChild(this.notice),this.notice.onHide())},i.prototype.dispose=function(){this.testTouchRect.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTestTouchRect,this),this.notice&&!this.notice.parent&&(this.notice.dispose(),this.notice=null),e.prototype.dispose.call(this)},i}(Form);t.UILoading=e,__reflect(e.prototype,"Login.UILoading")}(Login||(Login={}));var Login;!function(t){var e=function(){function t(){}return t.prototype.show=function(){Context.reloginMgr.bReLoginInGame||Context.loginCC.m_finalMsgreceived||(Context.uimgr.isFormVisible(UIFormID.UILoading)?this.m_ui=Context.uimgr.getForm(UIFormID.UILoading):this.m_ui=Context.uimgr.showForm(UIFormID.UILoading))},t.prototype.hide=function(){Context.uimgr.hideForm(UIFormID.UILoading),this.m_ui=null},t.prototype.exit=function(){Context.uimgr.exitForm(UIFormID.UILoading),this.m_ui=null},t.prototype.isVisible=function(){return this.m_ui&&this.m_ui.isVisible()},t.prototype.hideProgress=function(){this.m_ui&&this.m_ui.hideProgress()},t.prototype.showProgress=function(){this.m_ui&&this.m_ui.showProgress()},t.prototype.setText=function(e,i,n,o){void 0===i&&(i=0),void 0===n&&(n=t.LoadingPerMax),void 0===o&&(o=1),this.m_ui&&this.m_ui.setText(e,i,n,o)},t.prototype.stopBarByLoginFailed=function(){this.m_ui&&this.m_ui.onStopBar()},t.prototype.resetBarValue=function(){this.m_ui&&this.m_ui.initValue(0)},t.prototype.setBarValue=function(t){return this.m_ui?(this.m_ui.toValue(t),!0):!1},t.LoadingPerMax=12,t}();t.UILoadingMgr=e,__reflect(e.prototype,"Login.UILoadingMgr")}(Login||(Login={}));var Login;!function(t){var e=function(){function t(){this.bReLoginInGame=!1,this.bFirstReLoginInGame=!0,this.bLoginFailed=!1}return t.prototype.reset_to_beforeLogin=function(){Context.loginCC.m_finalMsgreceived=!1,Context.gatewayServer.reset_to_beforeLogin(),Context.playerMgr.reset_to_beforeLogin(),Context.npcMgr.reset_to_beforeLogin(),Context.uimgr.reset_to_beforeLogin(),Context.mapMgr.reset_to_beforeLogin(),Context.timeMgr.reset_to_beforeLogin(),Context.heroinfoMgr.reset_to_beforeLogin(),Context.packageMgr.reset_to_beforeLogin(),Context.commonSetMgr.reset_to_beforeLogin(),Context.soundMgr.reset_to_beforeLogin(),Context.headLabelMgr.reset_to_beforeLogin(),Context.rankMgr.reset_to_beforeLogin(),Context.guideprompMgr.reset_to_beforeLogin()
},Object.defineProperty(t.prototype,"isSupportRelogin",{get:function(){return Context.operationMgr.operation.isSupportRelogin},enumerable:!0,configurable:!0}),t.prototype.reLogin=function(){this.bReLoginInGame=!1,this.bFirstReLoginInGame=!0,this.bLoginFailed=!1,this.reset_to_beforeLogin(),Context.logMgr.bShowDebugBtn()&&Context.uimgr.showForm(UIFormID.UIGmFloatBtn),this.connectServer()},t.prototype.reLoginInGame=function(){Context.loginCC.m_finalMsgreceived=!1,this.bReLoginInGame=!0,this.connectServer()},t.prototype.connectServer=function(){Context.loadingView.show(),Context.loadingView.resetBarValue(),Context.loginServer.connect()},t}();t.ReloginMgr=e,__reflect(e.prototype,"Login.ReloginMgr")}(Login||(Login={}));var messageProcess;!function(t){function e(){Context.revMessageMgr.addProcess(Cmd.stNullUserCmd.LOGON_USERCMD,new t.ProcessLogin),Context.revMessageMgr.addProcess(Cmd.stNullUserCmd.TIME_USERCMD,new t.ProcessTime),Context.revMessageMgr.addProcess(Cmd.stNullUserCmd.GAME_USERCMD,new t.ProcessScene),Context.revMessageMgr.addProcess(Cmd.stNullUserCmd.MAIL_USERCMD,new t.ProcessMail),Context.revMessageMgr.addProcess(Cmd.stNullUserCmd.TASK_USERCMD,new t.ProcessQuest),Context.revMessageMgr.addProcess(Cmd.stNullUserCmd.CHAT_USERCMD,new t.ProcessChat),Context.revMessageMgr.addProcess(Cmd.stNullUserCmd.ACTIVITY_USERCMD,new t.ProcessActivity),Context.revMessageMgr.addProcess(Cmd.stNullUserCmd.OBJECT_USERCMD,new t.ProcessProperty),Context.revMessageMgr.addProcess(Cmd.stNullUserCmd.GIFT_USERCMD,new t.ProcessGiftCmd),Context.revMessageMgr.addProcess(Cmd.stNullUserCmd.FRIEND_USERCMD,new t.ProcessFriend),Context.revMessageMgr.addProcess(Cmd.stNullUserCmd.FUNCTION_USERCMD,new t.ProcessFunction)}t.createProcess=e}(messageProcess||(messageProcess={}));var messageProcess;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(Server.MsgProcessBase);t.ProcessActivity=e,__reflect(e.prototype,"messageProcess.ProcessActivity")}(messageProcess||(messageProcess={}));var messageProcess;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(Server.MsgProcessBase);t.ProcessChat=e,__reflect(e.prototype,"messageProcess.ProcessChat")}(messageProcess||(messageProcess={}));var messageProcess;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.addFun(Cmd.stFriendCmd.ONLINE_SEND_VISITOR_DATA_USERCMD,Context.playerMgr.process_onlineSendVisitorDataUserCmd,Context.playerMgr),e.addFun(Cmd.stFriendCmd.RET_VISITOR_REWARD_USERCMD,Context.playerMgr.process_retVisitorRewardUserCmd,Context.playerMgr),e}return __extends(e,t),e}(Server.MsgProcessBase);t.ProcessFriend=e,__reflect(e.prototype,"messageProcess.ProcessFriend")}(messageProcess||(messageProcess={}));var messageProcess;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(Server.MsgProcessBase);t.ProcessFunction=e,__reflect(e.prototype,"messageProcess.ProcessFunction")}(messageProcess||(messageProcess={}));var messageProcess;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(Server.MsgProcessBase);t.ProcessGiftCmd=e,__reflect(e.prototype,"messageProcess.ProcessGiftCmd")}(messageProcess||(messageProcess={}));var messageProcess;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.addFun(Cmd.stLogonUserCmd.RETURN_USER_VERIFY_VER_PARA,Context.loginServer.process_stReturnUserVerifyVerCmd,Context.loginServer),e.addFun(Cmd.stLogonUserCmd.SERVER_RETURN_LOGIN_FAILED,Context.loginServer.process_stServerReturnLoginFailedCmd,Context.loginServer),e.addFun(Cmd.stLogonUserCmd.SERVER_RETURN_LOGIN_OK,Context.loginServer.process_stServerReturnLoginSuccessCmd,Context.loginServer),e.addFun(Cmd.stLogonUserCmd.RETURN_NO_CHAR_USERCMD_PARA,Context.gatewayServer.process_stReturnNoCharUserCmd,Context.gatewayServer),e.addFun(Cmd.stLogonUserCmd.RET_VERIFY_USE_NAME_USERCMD_PARA,e.process_stRetVerifyUseNameUserCmd,e),e.addFun(Cmd.stLogonUserCmd.SERVER_RETURN_DISCONNECT,e.process_stServerReturnDisConnectCmd,e),e.addFun(Cmd.stLogonUserCmd.SEND_RELOGIN_TOKEN_PARA,e.process_stSendReloginTokenPara,e),e}return __extends(e,t),e.prototype.process_stRetVerifyUseNameUserCmd=function(t){var e=new Cmd.stRetVerifyUseNameUserCmd;if(e.deserialize(t),1==e.valid){var i=Context.system.isWXGame?Context.loginData.userInfo_wx.gender:0,n=new Cmd.stCreateCharUserCmd;n.career=1,n.sex=i>0?i-1:i,n.minor=0,Context.sendMsg(n)}else{var n=new Cmd.stReqVerifyUseNameUserCmd;n.name=e.name+"a",Context.sendMsg(n)}},e.prototype.process_stServerReturnDisConnectCmd=function(t){var e=new Cmd.stServerReturnDisConnectCmd;if(e.deserialize(t),!Context.reloginMgr.bLoginFailed){Context.reloginMgr.bLoginFailed=!0;var i=Context.languageMgr.getEleStr("disconnect",e.ret);Context.sysPromptMgr.showUINetConnectClose(i),Context.logMgr.sendServer("stServerReturnDisConnectCmd ret:"+e.ret+" msg:"+i)}},e.prototype.process_stSendReloginTokenPara=function(t){var e=new Cmd.stSendReloginTokenPara;e.deserialize(t),Context.loginData.reloginToken=e.reloginToken,Context.logMgr.addLog("stSendReloginTokenPara token="+e.reloginToken)},e}(Server.MsgProcessBase);t.ProcessLogin=e,__reflect(e.prototype,"messageProcess.ProcessLogin")}(messageProcess||(messageProcess={}));var messageProcess;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(Server.MsgProcessBase);t.ProcessMail=e,__reflect(e.prototype,"messageProcess.ProcessMail")}(messageProcess||(messageProcess={}));var messageProcess;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.addFun(Cmd.stObjectUserCmd.ONLINE_SEND_USER_OBJECT_USERCMD,Context.packageMgr.process_onlineSendUserObjectUserCmd,Context.packageMgr),e.addFun(Cmd.stObjectUserCmd.ADD_USER_OBJECT_USERCMD,Context.packageMgr.process_addUserObjectUserCmd,Context.packageMgr),e.addFun(Cmd.stObjectUserCmd.UPDATE_USER_OBJECT_USERCMD,Context.packageMgr.process_updateUserObjectUserCmd,Context.packageMgr),e.addFun(Cmd.stObjectUserCmd.RETURN_NEW_NAME_USERCMD_PARA,Context.packageMgr.process_stReturnNewNameUserCmd,Context.packageMgr),e.addFun(Cmd.stObjectUserCmd.RET_CHANGE_NAME_VERIFY_USE_NAME_USERCMD_PARA,Context.packageMgr.process_stRetChangeNameVerifyUseNameUserCmd,Context.packageMgr),e.addFun(Cmd.stObjectUserCmd.MATCH_GAME_END_SEND_OBJ_TYPE_TWO_USERCMD,Context.packageMgr.process_matchGameEndSendObjTypeTwoUserCmd,Context.packageMgr),e}return __extends(e,t),e}(Server.MsgProcessBase);t.ProcessProperty=e,__reflect(e.prototype,"messageProcess.ProcessProperty")}(messageProcess||(messageProcess={}));var messageProcess;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(Server.MsgProcessBase);t.ProcessQuest=e,__reflect(e.prototype,"messageProcess.ProcessQuest")}(messageProcess||(messageProcess={}));var messageProcess;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_debug_rev_mapCmd=!1,e.addFun(Cmd.stSceneUserCmd.RETURN_USER_REG_SCENE_PARA,e.process_stReturnUserRegSceneCmd,e),e.addFun(Cmd.stSceneUserCmd.MAIN_USER_DATA_USERCMD_PARA,e.process_stMainUserDataUserCmd,e),e.addFun(Cmd.stSceneUserCmd.SYN_ONLINE_FIN_DATA_USERCMD,e.process_synOnlineFinDataUserCmd,e),e.addFun(Cmd.stSceneUserCmd.SEND_OFFLINE_REWARD_USERCMD_PARA,e.process_sendOffLineRewardCmd,e),e.addFun(Cmd.stSceneUserCmd.st0_CLOCK_USERCMD,e.process_st0ClockUserCmd,e),e.addFun(Cmd.stSceneUserCmd.UPDATE_USER_YUANBAO_USERCMD_PARA,e.process_stUpdateUserYuanbaoUserCmd,e),e.addFun(Cmd.stSceneUserCmd.REQ_SET_COMMONSET_USERCMD_PARA,Context.commonSetMgr.process_stReqSetCommonSetUserCmd,Context.commonSetMgr),e.addFun(Cmd.stSceneUserCmd.RET_COMMONSET_USERCMD_PARA,Context.commonSetMgr.process_stRetCommonSetUserCmd,Context.commonSetMgr),e.addFun(Cmd.stSceneUserCmd.SEND_USER_PASS_USERCMD,e.process_sendUserPassUserCmd,e),e.addFun(Cmd.stSceneUserCmd.UPDATE_MONEY_NUM_USERCMD,e.process_updateMoneyNumUserCmd,e),e.addFun(Cmd.stSceneUserCmd.UPDATE_LOVE_NUM_USERCMD,e.process_updateLoveNumUserCmd,e),e.addFun(Cmd.stSceneUserCmd.UPDATE_STARS_USERCMD,e.process_updateStarsUserCmd,e),e.addFun(Cmd.stSceneUserCmd.ONLINE_SEND_FASHION_DATA_USERCMD,Context.heroinfoMgr.process_onlineSendFashionDataUserCmd,Context.heroinfoMgr),e.addFun(Cmd.stSceneUserCmd.RET_DRESS_FASHION_USERCMD,Context.heroinfoMgr.process_retDressFashionUserCmd,Context.heroinfoMgr),e.addFun(Cmd.stSceneUserCmd.UPDATE_USER_CHARM_VALUE_USERCMD,Context.heroinfoMgr.process_updateUserCharmValueUserCmd,Context.heroinfoMgr),e.addFun(Cmd.stSceneUserCmd.RET_OFFLINE_REWARD_USERCMD,e.process_retOfflineRewardUserCmd,e),e.addFun(Cmd.stSceneUserCmd.REQ_CHANGE_SEX_USERCMD,Context.heroinfoMgr.process_reqChangeSexUserCmd,Context.heroinfoMgr),e.addFun(Cmd.stSceneUserCmd.SEND_USER_BUFF_LIST_USERCMD,Context.heroinfoMgr.process_sendUserBuffListUserCmd,Context.heroinfoMgr),e.addFun(Cmd.stSceneUserCmd.SYN_ADD_BUFF_USERCMD,Context.heroinfoMgr.process_synAddBuffUserCmd,Context.heroinfoMgr),e.addFun(Cmd.stSceneUserCmd.SYN_DELETE_BUFF_USERCMD,Context.heroinfoMgr.process_synDeleteBuffUserCmd,Context.heroinfoMgr),e}return __extends(e,t),e.prototype.process_stReturnUserRegSceneCmd=function(t){Context.loadingView.setText("打开门迎接客人们吧",10,Login.UILoadingMgr.LoadingPerMax,1),Context.logMgr.addLog("返回注册场景用户")},e.prototype.process_stMainUserDataUserCmd=function(t){var e=new Cmd.stMainUserDataUserCmd;e.deserialize(t);var i=e.maindata;Context.timeMgr.regTime=i.regtime,Context.heroinfoMgr.initMainData(i),Context.logMgr.addLog("stMainUserDataUserCmd: charid="+i.charid+" name="+i.name+" sex="+i.sex+" guan="+i.guan),Context.revMessageMgr.setMsgReceived("stMainUserDataUserCmd")},e.prototype.process_synOnlineFinDataUserCmd=function(t){if(Context.logMgr.addLog("--- synOnlineFinDataUserCmd: Welcome!"),Context.loginCC.m_finalMsgreceived=!0,!Context.revMessageMgr.addDelayProcessMsg("stMainUserDataUserCmd",this.process_synOnlineFinDataUserCmd,t,this)){if(Context.reloginMgr.bReLoginInGame){Context.reloginMgr.bReLoginInGame=!1,Context.reloginMgr.bFirstReLoginInGame=!0;var e=Context.uimgr.getForm(UIFormID.UIReloginCircle);return e&&e.onReloginComplete(),void Context.sendMessageMgr.sendMsgOfOffLine()}var i=new httpCmd.RecordOnline;if(Context.httpSendMgr.send(i),Context.heroinfoMgr.bFirstEntryGame){var n=new httpCmd.RecordPassLevel;Context.httpSendMgr.send(n)}else Context.mapMgr.showRoomMap();Context.operationMgr.operation instanceof common.operation_wx&&Context.operationMgr.operation.onLoadResOfOpenDataContext(),Context.loadingView.setText("开始布置房间啦！",12,Login.UILoadingMgr.LoadingPerMax,1),Context.logMgr.addLog("上线消息结束消息"),Context.monitorDataMgr.sendRecordClientData(common.MonitorDataMgr.Type_loadResComplete),Context.ABTestMgr.reqAbTestUserVersion(),Context.logMgr.sendSynOsType();var o=Context.loginData.userInfo_wx.avatarUrl;Context.logMgr.addLog("playerurl = "+o)}},e.prototype.process_sendOffLineRewardCmd=function(t){var e=new Cmd.sendOffLineRewardCmd;e.deserialize(t),Context.heroinfoMgr.offLineRewardData={offlineTime:e.offlineTime,yinbi:e.yinbi,guest:e.guest,friends:e.friends},egret.setTimeout(Context.heroinfoMgr.onShowUIOfflineReward,Context.heroinfoMgr,2e3)},e.prototype.process_retOfflineRewardUserCmd=function(t){},e.prototype.process_sendUserPassUserCmd=function(t){var e=new Cmd.sendUserPassUserCmd;e.deserialize(t),Context.heroinfoMgr.updateGuan(e.pass)},e.prototype.process_updateMoneyNumUserCmd=function(t){var e=new Cmd.updateMoneyNumUserCmd;e.deserialize(t),Context.heroinfoMgr.updateYinbi(e.money)},e.prototype.process_updateLoveNumUserCmd=function(t){var e=new Cmd.updateLoveNumUserCmd;e.deserialize(t),Context.heroinfoMgr.lifeNum=e.loveNum},e.prototype.process_updateStarsUserCmd=function(t){var e=new Cmd.updateStarsUserCmd;e.deserialize(t),Context.heroinfoMgr.setvitalityNum(e.stars)},e.prototype.process_stUpdateUserYuanbaoUserCmd=function(t){var e=new Cmd.stUpdateUserYuanbaoUserCmd;e.deserialize(t),Context.heroinfoMgr.zuanshi=e.num},e.prototype.process_st0ClockUserCmd=function(t){Context.logMgr.sendServer("零点消息测试  收到零点消息")},e}(Server.MsgProcessBase);t.ProcessScene=e,__reflect(e.prototype,"messageProcess.ProcessScene")}(messageProcess||(messageProcess={}));var messageProcess;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.addFun(Cmd.stTimerUserCmd.GAMETIME_TIMER_USERCMD_PARA,Context.timeMgr.process_stGameTimeTimerUserCmd,Context.timeMgr),e.addFun(Cmd.stTimerUserCmd.GAME_MERGEZONE_TIME_USERCMD_PARA,Context.timeMgr.process_stGameMergeTimeUserCmd,Context.timeMgr),e}return __extends(e,t),e}(Server.MsgProcessBase);t.ProcessTime=e,__reflect(e.prototype,"messageProcess.ProcessTime")}(messageProcess||(messageProcess={}));var Table;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_pivotX=0,t.m_pivotY=0,t.m_offsetName=0,t.m_dicFT={},t.m_hitY=0,t.m_dicNewAct={},t.m_musicid=0,t}return __extends(i,e),i.prototype.parseByteArray=function(i){e.prototype.parseByteArray.call(this,i),this.m_name=t.TDataItem.readString(i),this.m_pivotX=i.readShort(),this.m_pivotY=i.readShort(),this.m_offsetName=i.readShort(),this.m_hitY=i.readShort()-this.m_pivotY;var n,o,r,s=t.TDataItem.readString(i),a=0,h=0,m=0,c=0;if(""!=s&&"0"!=s)for(n=s.split(";"),a=0;a<n.length;a++){o=n[a].split(":"),m=o[0],r=o[1].split(",");var u=r.length;if(u>1){var l=new Array;for(h=0;u>h;h++)c=.001*r[h],l.push(c);this.m_dicFT[m]=l}else this.m_dicFT[m]=r[0]/1e3}this.m_scalePer=i.readUnsignedShort(),this.m_actEffect=t.TDataItem.readString(i),this.m_commmonAttackEffectRP=t.TDataItem.readString(i),this.m_musicid=i.readUnsignedInt(),this.m_strNewAct=t.TDataItem.readString(i)},i.prototype.getNewAct=function(t){if(t=t,this.m_strNewAct.length>0){if(null==this.m_dicNewAct){this.m_dicNewAct={};var e=this.m_strNewAct.split(";"),i=0;for(i=0;i<e.length;i++){var n=new scene.NewActDefine;n.parse(e[i]),this.m_dicNewAct[n.m_actID]=n}}return this.m_dicNewAct[t]}return null},i.prototype.getActFPS=function(t,e){var i=this.m_dicFT[t];return i?e/i:13},i.prototype.getActTotalTime=function(t){var e=this.m_dicFT[t];return e?e:1},i}(t.TDataItem);t.TModelItem=e,__reflect(e.prototype,"Table.TModelItem")}(Table||(Table={}));var UIFormID=function(){function t(){}return t.Layer=function(t){return t>>this.LAYER_BIT},t.FormID=function(e,i){return void 0===i&&(i=t.SecondLayer),i<<t.LAYER_BIT|e},t.LAYER_BIT=27,t.FirstLayer=0,t.SecondLayer=1,t.ThirdLayer=2,t.FourthLayer=3,t.UIFunctionIconsTop=t.FirstLayer<<t.LAYER_BIT|15,t.UILoginInner=t.SecondLayer<<t.LAYER_BIT|1,t.UIGm=t.SecondLayer<<t.LAYER_BIT|2,t.UILobby=t.SecondLayer<<t.LAYER_BIT|3,t.UIStudy=t.SecondLayer<<t.LAYER_BIT|4,t.UIExam=t.SecondLayer<<t.LAYER_BIT|5,t.UICompete=t.SecondLayer<<t.LAYER_BIT|6,t.UIExamInfo=t.SecondLayer<<t.LAYER_BIT|7,t.UIDialogPrompt=t.SecondLayer<<t.LAYER_BIT|32,t.UIObjTips=t.SecondLayer<<t.LAYER_BIT|33,t.UIRank=t.SecondLayer<<t.LAYER_BIT|34,t.UISettings=t.SecondLayer<<t.LAYER_BIT|45,t.UILoading=t.ThirdLayer<<t.LAYER_BIT|1,t.UICreateHero=t.ThirdLayer<<t.LAYER_BIT|6,t.UIModifyName=t.ThirdLayer<<t.LAYER_BIT|11,t.UIAnnouncement=t.FourthLayer<<t.LAYER_BIT|1,t.UINetConnectClose=t.FourthLayer<<t.LAYER_BIT|2,t.UIError=t.FourthLayer<<t.LAYER_BIT|3,t.UISceneTransition=t.FourthLayer<<t.LAYER_BIT|4,t.UIPassGuid=t.FourthLayer<<t.LAYER_BIT|5,t.UIReloginCircle=t.FourthLayer<<t.LAYER_BIT|9,t.UIGmLogMessage=t.FourthLayer<<t.LAYER_BIT|10,t.UIGmFloatBtn=t.FourthLayer<<t.LAYER_BIT|11,t.UILoginWXAuthorize=t.FourthLayer<<t.LAYER_BIT|12,t}();__reflect(UIFormID.prototype,"UIFormID");var FormIDToUI=function(){function t(){this.classList={};var t=this.classList;t[UIFormID.UILoginInner]=UILoginInner,t[UIFormID.UILoginWXAuthorize]=UILoginWXAuthorize,t[UIFormID.UILoading]=Login.UILoading,t[UIFormID.UIAnnouncement]=systemPrompt.UIAnnouncement,t[UIFormID.UIError]=systemPrompt.UIError,t[UIFormID.UINetConnectClose]=systemPrompt.UINetConnectClose,t[UIFormID.UIReloginCircle]=systemPrompt.UIReloginCircle,t[UIFormID.UIGm]=gm.UIGm,t[UIFormID.UIGmLogMessage]=gm.UIGmLogMessage,t[UIFormID.UIGmFloatBtn]=gm.UIGmFloatBtn,t[UIFormID.UIDialogPrompt]=systemPrompt.UIDialogPrompt,t[UIFormID.UIObjTips]=tips.UIObjTips,t[UIFormID.UIRank]=rank.UIRank,t[UIFormID.UISceneTransition]=scene.UISceneTransition,t[UIFormID.UISettings]=settings.UISettings,t[UIFormID.UILobby]=uimain.UILobby,t[UIFormID.UIStudy]=uimain.UIStudy,t[UIFormID.UIExam]=uimain.UIExam,t[UIFormID.UIExamInfo]=uimain.UIExamInfo,t[UIFormID.UICompete]=uimain.UICompete,this.groupResList={},t=this.groupResList}return t.prototype.hasFormDefinition=function(t){return null!=this.classList[t]},t.prototype.getGroupResName=function(t){return this.groupResList[t]},t.prototype.createUI=function(t){return new this.classList[t]},t}();__reflect(FormIDToUI.prototype,"FormIDToUI");var UIManager=function(){function t(){this.m_base=new eui.UILayer,this.m_base.touchEnabled=!1,this.init()}return t.prototype.init=function(){var t=[UIFormID.FirstLayer,UIFormID.SecondLayer,UIFormID.ThirdLayer,UIFormID.FourthLayer];this.m_layerList=[],this.m_formList={};var e;for(var i in t)e=new eui.UILayer,e.name="uiLayer"+t[i],e.touchEnabled=!1,this.m_base.addChild(e),this.m_layerList[t[i]]=e;this.m_uiMgrforUI=new FormIDToUI,this.m_dicOpenPageID={},this.m_dicOpenCallbackData={},this.m_dicGroupResUse={},this.m_dicGroupLoading={},this.m_base.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUITouchTab,this)},t.prototype.onUITouchTab=function(t){t.target instanceof eui.Button&&Context.soundMgr.play(sound.SOUND_clickBtn)},Object.defineProperty(t.prototype,"uiRoot",{get:function(){return this.m_base},enumerable:!0,configurable:!0}),t.prototype.getLayer=function(t){var e;return UIFormID.FirstLayer<=t&&t<=UIFormID.FourthLayer&&(e=this.m_layerList[t]),e},t.prototype.hasFormDefinition=function(t){return this.m_uiMgrforUI.hasFormDefinition(t)},t.prototype.getFirstLayer=function(){return this.m_layerList[UIFormID.FirstLayer]},t.prototype.getFourthLayer=function(){return this.m_layerList[UIFormID.FourthLayer]},t.prototype.getForm=function(t){return this.m_formList[t]},t.prototype.getGroupResData=function(t){var e=this.m_uiMgrforUI.getGroupResName(t);return e?this.m_dicGroupResUse[e]:null},t.prototype.loadedGroupRes=function(t,e){if(0>=t||!e)return Context.logMgr.sendServer("loadedGroupRes error! formID="+t+" groupRes="+e),!1;var i=this.m_dicGroupResUse[e];if(i||(i={groupRes:e,formIDList:{}},this.m_dicGroupResUse[e]=i),i.formIDList[t]=t,Context.resGroupProloadMgr.isGroupLoaded(e))return!0;var n=!0,o=this.m_dicGroupLoading;for(var r in o)if(o[r]==e){n=!1;break}return o[t]=e,n&&(Context.resGroupProloadMgr.loadGroup(e,this.onGroupResLoadComplete,this),Context.logMgr.addLog("UIManager.ts ++++++++++ loadedGroupRes() groupRes="+e)),!1},t.prototype.onGroupResLoadComplete=function(t){var e=0,i=this.m_dicGroupLoading;for(var n in i)i[n]==t&&(e=parseInt(n),e>0&&this.showForm(e),i[n]=null);Context.logMgr.addLog("UIManager.ts ++++++++++ onGroupResLoadComplete() groupRes="+t+" formID="+e)},t.prototype.createForm=function(t){var e=this.getForm(t);if(null==e)if(this.m_uiMgrforUI.hasFormDefinition(t)){var i=this.m_uiMgrforUI.getGroupResName(t);if(i&&!this.loadedGroupRes(t,i))return null;e=this.m_uiMgrforUI.createUI(t),e.id=t,this.m_formList[t]=e}else{var n="createForm Error: formid"+t;Context.logMgr.sendServer(n)}return e},t.prototype.showForm=function(t){var e=this.createForm(t);if(e){var i=this.getLayer(UIFormID.Layer(t));if(i){e.parent&&i!=e.parent&&e.parent.removeChild(e),i.addChild(e),e.onShow();var n=this.m_dicOpenCallbackData;n[t]&&(e.onOpenCallback(n[t]),delete n[t]),n=this.m_dicOpenPageID,n[t]&&e.openPage(n[t])}}return e},t.prototype.setOpenPageID=function(t,e){this.m_dicOpenPageID[t]=e},t.prototype.setOpenCallbackData=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var o=this.m_dicOpenCallbackData[t];o||(o={},this.m_dicOpenCallbackData[t]=o),o[e]=i},t.prototype.exitForm=function(t){var e=this.getForm(t);e&&e.exit()},t.prototype.hideForm=function(t){var e=this.getForm(t);e&&(e.hideForm(),delete this.m_dicOpenPageID[t])},t.prototype.destroyForm=function(t){var e=this.getForm(t);e&&(delete this.m_formList[t],e.destroyForm(),delete this.m_dicOpenPageID[t],delete this.m_dicOpenCallbackData[t])},t.prototype.destroyGroupRes=function(t){var e=this.getGroupResData(t);if(e){var i=e.formIDList[t];if(i&&delete e.formIDList[t],UtilDictionary.isEmpty(e.formIDList)){var n=Context.resGroupProloadMgr.destroyRes(e.groupRes,!1);Context.logMgr.addLog("UIManager.ts ---------- destroyGroupRes() groupRes="+e.groupRes+" success="+n)}}},t.prototype.onStageResize=function(){var t,e=this.m_formList;for(var i in e)t=e[i],t&&t.onStageReSize()},t.prototype.isFormVisible=function(t){var e=this.getForm(t);return e&&e.isVisible()},t.prototype.showUICreateHero=function(t){var e=this.getForm(UIFormID.UICreateHero);(!e||e&&!e.isVisible())&&(e=this.showForm(UIFormID.UICreateHero)),e&&e.updateData(t)},t.prototype.reset_to_beforeLogin=function(){UtilDictionary.clear(this.m_dicOpenPageID),UtilDictionary.clear(this.m_dicOpenCallbackData);var t=[],e=this.m_formList;for(var i in e)t.push(e[i].id);for(var n=0,o=t;n<o.length;n++){var i=o[n];this.destroyForm(i)}UtilDictionary.clear(this.m_formList)},t.prototype.updateShowFunbtnUI=function(t){},t.prototype.updateShowUIShadeImg=function(t){t?(this.m_uiShadeImg||(this.m_uiShadeImg=new eui.Image("bg_uishade_png"),this.m_uiShadeImg.touchEnabled=!1,this.m_uiShadeImg.width=Context.width,this.m_uiShadeImg.height=Context.height),this.m_base.addChildAt(this.m_uiShadeImg,0)):this.m_uiShadeImg&&this.m_uiShadeImg.parent&&this.m_base.removeChild(this.m_uiShadeImg)},t}();__reflect(UIManager.prototype,"UIManager");var uimain;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="CompeteSkin",e.horizontalCenter=0,e.verticalCenter=0,e}return __extends(e,t),e}(Form);t.UICompete=e,__reflect(e.prototype,"uimain.UICompete")}(uimain||(uimain={}));var uimain;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="ExamSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.returnBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitBtnClick,this),this.goodsImg.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onGoodsImgBegin,this),this.goodsImg.addEventListener(egret.TouchEvent.TOUCH_END,this.onGoodsImgEnd,this),this.goodsImg.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onGoodsImgMove,this)},e.prototype.showNextGoods=function(t){if(this.curGoodsItem=Context.lobbyMgr.getGoodsItem(t),this.curGoodsItem){var e=this.goodsImg;e.scaleX=.4,e.scaleY=.4,e.alpha=0,e.source="",egret.Tween.removeTweens(e),egret.Tween.get(e).to({scaleX:1.05,scaleY:1.05,alpha:1,blurFliter:0},200,egret.Ease.quadIn).to({scaleX:1,scaleY:1},300,egret.Ease.backOut).call(this.onShowGoodsAniEnd,this)}},e.prototype.onShowGoodsAniEnd=function(){this.goodsImg.touchEnabled=!0},e.prototype.onGoodsImgBegin=function(t){},e.prototype.onGoodsImgEnd=function(t){},e.prototype.onGoodsImgMove=function(t){},e.prototype.onHide=function(){t.prototype.onHide.call(this),Context.uimgr.exitForm(UIFormID.UIExam)},e.prototype.dispose=function(){this.returnBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitBtnClick,this),t.prototype.dispose.call(this)},e}(Form);t.UIExam=e,__reflect(e.prototype,"uimain.UIExam")}(uimain||(uimain={}));var uimain;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="ExamInfoSkin",e.horizontalCenter=0,e.top=0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.updateansweredNum=function(t){this.answeredNumLabel.text="已答:"+t},e.prototype.onResults=function(t,e){e?(this.rightNumLabel.text="答对:"+t,this.onShowRightAni()):(this.wrongNumLabel.text="答错:"+t,this.onShowWrongAni())},e.prototype.onShowRightAni=function(){var t=this.rightImg;t||(t=this.rightImg=new eui.Image("common.img_duihao_png"),this.addChild(t),t.alpha=0),t.alpha=0,t.x=60,t.y=140,egret.Tween.removeTweens(t),egret.Tween.get(t).to({alpha:1},200).to({y:120},200).to({y:100,alpha:0},200)},e.prototype.onShowWrongAni=function(){},e}(Form);t.UIExamInfo=e,__reflect(e.prototype,"uimain.UIExamInfo")}(uimain||(uimain={}));var gm;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="GmSkin",e.horizontalCenter=0,e.verticalCenter=0,e.bDarkeOthers=!0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.exitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitBtnClick,this),this.sendChatBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatBtn,this),this.upGuanBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGMAdd,this),this.sendLifeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGMAdd,this),this.jinbiBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGMAdd,this),this.sendXingBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGMAdd,this),this.zuanshiBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGMAdd,this),this.addNanDuBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGMAdd,this),this.objSendBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchObjSend,this),this.fashionSendBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchFashion,this),this.mapStopPtCheckBox.addEventListener(egret.Event.CHANGE,this.onMapStopPtCheckBox,this),this.logBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchLog,this),this.resInfoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchLog,this),this.testBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTest,this),this.m_goalList.dataProvider=new eui.ArrayCollection,this.updateSelfData(),this.updateTaskData()},e.prototype.updateSelfData=function(){this.nameLabel.text="name:"+Context.heroinfoMgr.name,this.charidLabel.text="charID:"+Context.heroinfoMgr.charid,this.uidLabel.text="uID:"+Context.operationMgr.operation.get_uid_common(),this.abTestVerLabel.text="abTestVer:"+Context.operationMgr.operation.getABTestVersion()},e.prototype.updateTaskData=function(){var t=Context.heroinfoMgr.guan;this.guanLabel.text=t+"关"},e.prototype.onTouchGMAdd=function(t){var e=t.target,i=0,n=0;e==this.upGuanBtn?(i=4,n=parseInt(this.guanInput.text)):e==this.jinbiBtn?(i=2,n=parseInt(this.jinbiInput.text)):e==this.zuanshiBtn?(i=5,n=parseInt(this.zuanshiInput.text)):e==this.sendXingBtn?(i=3,n=parseInt(this.xingInput.text)):e==this.sendLifeBtn?(i=1,n=parseInt(this.lifeInput.text)):e==this.addNanDuBtn&&(i=6,n=parseInt(this.difficultyInput.text))},e.prototype.onChatBtn=function(t){var e=this.chatInput.text;if(!e)return void Context.sysPromptMgr.addErrorPrompt("input is null!");if("//gmfps"==e){var i=document.querySelectorAll(".egret-player"),n=i[0],o=n["egret-player"];o=o.player;var r={bgAlpha:"0.9",size:12,textColor:"0xffffff",x:0,y:0};return void o.displayFPS(!0,!1,!1,r)}"//gmlog"==e&&Context.uimgr.showForm(UIFormID.UIGmFloatBtn);var s=new Cmd.stChannelChatUserCmd;s.name=Context.heroinfoMgr.name,s.type=Cmd.stChatUserCmd.CHAT_ALL,s.chat=e,Context.sendMsg(s),Context.logMgr.addLog("stChannelChatUserCmd chat=["+e+"]")},e.prototype.onTouchObjSend=function(){var t=parseInt(this.objidInput.text),e=parseInt(this.objnumInput.text);if(t&&e){var i=new Cmd.setAddObjObjectUserCmd;i.id=t,i.num=e,Context.sendMsg(i)}},e.prototype.onTouchFashion=function(){parseInt(this.fashionIDInput.text),parseInt(this.fashionLevelInput.text)},e.prototype.onMapStopPtCheckBox=function(t){this.mapStopPtCheckBox.selected?Context.mapMgr.currentMap.drawStopPt():Context.mapMgr.currentMap.clearStopPt()},e.prototype.onTouchLog=function(t){this.resInfoBtn==t.target&&(RES.profile(),Context.imageAssetAdapter.profile())},e.prototype.onTouchTest=function(){},e.prototype.dispose=function(){this.upGuanBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGMAdd,this),this.sendChatBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatBtn,this),this.sendLifeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGMAdd,this),this.jinbiBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGMAdd,this),this.sendXingBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGMAdd,this),this.zuanshiBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGMAdd,this),this.exitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitBtnClick,this),this.objSendBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchObjSend,this),this.addNanDuBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGMAdd,this),this.fashionSendBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchFashion,this),this.mapStopPtCheckBox.removeEventListener(egret.Event.CHANGE,this.onMapStopPtCheckBox,this),this.logBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchLog,this),this.testBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTest,this),t.prototype.dispose.call(this)},e}(Form);t.UIGm=e,__reflect(e.prototype,"gm.UIGm")}(gm||(gm={}));var gm;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_bMoved=!1,e.right=0,e.bottom=320,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.m_logBtn=new eui.Button,this.m_logBtn.skinName="skins.ButtonSkin",this.m_logBtn.anchorOffsetX=40,this.m_logBtn.anchorOffsetY=20,this.m_logBtn.width=80,this.m_logBtn.height=40,this.m_logBtn.label="日志",this.addChild(this.m_logBtn),Context.operationMgr.isNeiwang&&(this.m_gmBtn=new eui.Button,this.m_gmBtn.skinName="skins.ButtonSkin",this.m_gmBtn.anchorOffsetX=40,this.m_gmBtn.anchorOffsetY=20,this.m_gmBtn.width=80,this.m_gmBtn.height=40,this.m_gmBtn.label="GM",this.m_gmBtn.y=50,this.addChild(this.m_gmBtn)),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.onStageReSize()},e.prototype.onTouchBegin=function(t){this.m_bMoved=!1},e.prototype.onTouchMove=function(t){this.right=0/0,this.bottom=0/0,this.m_bMoved=!0,t.stageX!=this.x&&30<t.stageX&&t.stageX<Context.width-30&&(this.x=t.stageX),t.stageY!=this.y&&20<t.stageY&&t.stageY<Context.height-20&&(this.y=t.stageY)},e.prototype.onTouchEnd=function(t){this.m_bMoved?this.m_bMoved=!1:this.m_logBtn==t.target?Context.uimgr.showForm(UIFormID.UIGmLogMessage):Context.uimgr.showForm(UIFormID.UIGm)},e.prototype.dispose=function(){this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),t.prototype.dispose.call(this)},e}(Form);t.UIGmFloatBtn=e,__reflect(e.prototype,"gm.UIGmFloatBtn")}(gm||(gm={}));var gm;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="GmLogMessageSkin",e.horizontalCenter=0,e.verticalCenter=0,e.bDarkeOthers=!0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.exitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitBtnClick,this),this.tabBar.addEventListener(egret.Event.CHANGE,this.onTabBar,this),this.tabBar.validateNow(),this.copyLogBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCopyLogBtn,this),this.clearLogBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClearLogBtn,this),this.logList.dataProvider=new eui.ArrayCollection,this.updateLogList()},e.prototype.updateLogList=function(){var t=Context.logMgr.getLog(),e=t.split("\n");this.logList.dataProvider.source=e},e.prototype.onTabBar=function(t){var e=this.tabBar.selectedIndex;0==e||this.updateLogList()},e.prototype.onCopyLogBtn=function(t){var e=Context.logMgr.getLog();Context.logMgr.sendLogWeb(e)},e.prototype.onClearLogBtn=function(t){Context.logMgr.clearLog()},e.prototype.dispose=function(){this.exitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitBtnClick,this),this.tabBar.removeEventListener(egret.Event.CHANGE,this.onTabBar,this),this.copyLogBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCopyLogBtn,this),this.clearLogBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClearLogBtn,this),t.prototype.dispose.call(this)
},e}(Form);t.UIGmLogMessage=e,__reflect(e.prototype,"gm.UIGmLogMessage")}(gm||(gm={}));var LoginOutnetPlayerMgr=function(){function t(){this.m_loginByGM=!1,this.pid=0,this.zone=0}return t.prototype.setParam=function(t,e,i,n){this.pid=t,this.zone=e,this.uid=i,this.mima=n,this.m_loginByGM=!0},t.prototype.isLoginByGM=function(){return this.m_loginByGM},t.prototype.send=function(){var t=new Cmd.muPlatformUserRequestDebugLoginCmd;t.uid=this.uid,t.mima=this.mima,t.zone=this.zone,t.pid=this.pid,Context.sendMsg(t),Context.loadingView.setText("房间打扫中 ",6),Context.logMgr.addLog("发送登录信息 "+t.pid)},t}();__reflect(LoginOutnetPlayerMgr.prototype,"LoginOutnetPlayerMgr");var UILoginInner=function(t){function e(){var e=t.call(this)||this;return e.skinName="LoginInnerSkin",e.horizontalCenter=0,e.verticalCenter=0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.loginBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginBtnClick,this),this.loginBtn.validateNow();var e,i,n=Context.platformMgr.platformID;if(common.op_Neiwang==n||common.op_Neiwang_wanba==n||common.op_Neiwang_YunyingTest==n)if(this.neiwangGroup.visible=!0,Context.system.isWXGame?(e=window.wx.getStorageSync("serverID"),i=window.wx.getStorageSync("account")):(e=egret.localStorage.getItem("serverID"),i=egret.localStorage.getItem("account")),e||i?(this.serverInput.text=e,this.nameInput.text=i):(this.serverInput.prompt="输入服务器",this.nameInput.prompt="输入帐号"),Context.logMgr.bTest_205()||Context.logMgr.bShowDebugBtn()){this.severGroup.visible=!0,this.connectSeverGroup.visible=!0;var o=egret.localStorage.getItem("loginIP"),r=egret.localStorage.getItem("loginPort"),s=egret.localStorage.getItem("loginPType");(o||r||s)&&(this.ipInput.text=o,this.portInput.text=""+r,this.pTypeInput.text=""+s),this.ABTestGroup.visible=!0}else this.severGroup.visible=!1,this.connectSeverGroup.visible=!1,this.ABTestGroup.visible=!1;else Context.system.isWXGame?(this.neiwangGroup.visible=!1,this.connectSeverGroup.visible=!1,i=window.wx.getStorageSync("account"),i||(i=Context.loginData.userInfo_wx.openid),this.nameInput.text=i):(this.neiwangGroup.visible=!1,this.connectSeverGroup.visible=!1);Context.bzConfig.bShowDebugBtn?this.loginOutnetBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginOutnetBtn,this):this.loginOutnetBtn.visible=!1,this.onStageReSize()},e.prototype.onShow=function(){t.prototype.onShow.call(this),Context.system.isWXGame},e.prototype.setAuthorize=function(t){console.log("setAuthorize()"),Context.loginData.authorize_wx=t,egret.log("Context.loginData.authorize_wx:"),egret.log(t),t["scope.userInfo"]?platform.getUserInfo().then(function(t){Context.loginData.userInfo_wx.nickName=t.nickName,Context.loginData.userInfo_wx.avatarUrl=t.avatarUrl,Context.loginData.userInfo_wx.gender=t.gender,platform.sendMsgToOpenDataContext({command:"loadRes"})}):Context.loginData.authorize_wx["scope.userInfo"]||platform.authorize(0,0,1,1).then(function(t){Context.loginData.userInfo_wx.nickName=t.nickName,Context.loginData.userInfo_wx.avatarUrl=t.avatarUrl,Context.loginData.userInfo_wx.gender=t.gender,platform.sendMsgToOpenDataContext({command:"loadRes"}),egret.log("Context.loginData.userInfo_wx"),egret.log(t),Context.loginData.authorize_wx["scope.userInfo"]=!0,Context.monitorDataMgr.sendRecordClientData(common.MonitorDataMgr.Type_authorize_wx),Context.uimgr.exitForm(UIFormID.UILoginWXAuthorize)})},e.prototype.onLoginOutnetBtn=function(){Context.uimgr.exitForm(UIFormID.UILoginInner)},e.prototype.onLoginBtnClick=function(){var t,e,i,n,o="2",r=Context.platformMgr.platformID;common.op_Neiwang==r||common.op_Neiwang2==r||common.op_Neiwang_wanba==r||common.op_Neiwang_YunyingTest==r?(o=this.serverInput.text||"2",t=this.nameInput.text,e=this.ipInput.text,i=this.portInput.text,n=this.pTypeInput.text,Context.system.isWXGame?(window.wx.setStorage({key:"serverID",data:o}),window.wx.setStorage({key:"account",data:t})):(egret.localStorage.setItem("serverID",o),egret.localStorage.setItem("account",t),egret.localStorage.setItem("loginIP",e),egret.localStorage.setItem("loginPort",i),egret.localStorage.setItem("loginPType",n)),Context.operationMgr.operation.setABTestVersion(this.ABTestInput.text)):Context.system.isWXGame&&(t=this.nameInput.text,window.wx.setStorage({key:"account",data:t})),Context.loginData.uId=t,Context.loginData.zoneId=parseInt(o);var s={1:{ip:"119.29.16.190",port:1089},2:{ip:"119.29.16.190",port:1122},5:{ip:"119.29.16.190",port:1105}};return s[o]?(Context.bzConfig.loginServer.ip=s[o].ip,Context.bzConfig.loginServer.port=s[o].port,this.loginCheckBox.selected&&(Context.loginData.platformType=parseInt(n),Context.bzConfig.loginServer.ip=e,Context.bzConfig.loginServer.port=parseInt(i)),Context.operationMgr.operation.setParam(parseInt(o),t),Context.loadingView.show(),Context.loadingView.resetBarValue(),void this.exit()):void Context.sysPromptMgr.addErrorPrompt("输入服务器错误，请重新输入！")},e.prototype.onStageReSize=function(){var t=640/1136,e=Context.width/Context.height;Math.abs(t-e)<.17?(this.percentWidth=100,this.percentHeight=100):(this.percentWidth=Number.NaN,this.percentHeight=Number.NaN);var i=(Context.width,Context.height,640/Context.width),n=1136/Context.height,o=n>i?i:n;this.bgImage.width=640/o,this.bgImage.height=1136/o,this.bgImage.validateNow();this.bgImage.width,this.bgImage.height;this.bgImage.x=.5*(Context.width-this.bgImage.width);var r=.5*(Context.height-this.bgImage.height);this.bgImage.y=r},e.prototype.onResize=function(){var t=(Context.width,Context.height,640/Context.width),e=1136/Context.height,i=e>t?t:e;this.bgImage.width=640/i,this.bgImage.height=1136/i,this.bgImage.validateNow();this.bgImage.width,this.bgImage.height;this.bgImage.x=.5*(Context.width-this.bgImage.width),this.bgImage.y=.5*(Context.height-this.bgImage.height)},e.prototype.dispose=function(){this.loginBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginBtnClick,this),t.prototype.dispose.call(this)},e}(Form);__reflect(UILoginInner.prototype,"UILoginInner");var UILoginOutnetPlayer=function(t){function e(){var e=t.call(this)||this;return e.skinName="LoginOutnetPlayerSkin",e.horizontalCenter=0,e.verticalCenter=0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.loginBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginBtnClick,this);var e;if(e=egret.localStorage.getItem("pid")){var i=egret.localStorage.getItem("zone"),n=egret.localStorage.getItem("uid"),o=egret.localStorage.getItem("mima");this.pidInput.text=e,this.zoneInput.text=i,this.uidInput.text=n,this.mimaInput.text=o}},e.prototype.onLoginBtnClick=function(){var t=parseFloat(this.pidInput.text),e=parseFloat(this.zoneInput.text),i=this.uidInput.text,n=this.mimaInput.text;Context.platformMgr.initByGM(t),Context.loginOutnetPlayerMgr.setParam(t,e,i,n),egret.localStorage.setItem("pid",t.toString()),egret.localStorage.setItem("zone",e.toString()),egret.localStorage.setItem("uid",i),egret.localStorage.setItem("mima",n),Context.loadingView.show(),Context.loadingView.resetBarValue(),Context.loginServer.connect(),this.exit()},e}(Form);__reflect(UILoginOutnetPlayer.prototype,"UILoginOutnetPlayer");var UILoginWXAuthorize=function(t){function e(){var e=t.call(this)||this;return e.width=224,e.height=119,e.horizontalCenter=0,e.bottom=120,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this);var e=new eui.Image(UtilTools.uiimagePath("authorize_btnbg"));this.addChild(e);var i=new eui.Image(UtilTools.uiimagePath("authorize_btntxt"));i.horizontalCenter=0,i.verticalCenter=0,this.addChild(i)},e}(Form);__reflect(UILoginWXAuthorize.prototype,"UILoginWXAuthorize");var rank;!function(t){var e=function(){function t(){this.m_bShowRankList=!1}return t.prototype.reset_to_beforeLogin=function(){},t.prototype.onShowFriendRankList_wx=function(){Context.system.isWXGame&&this.onShowRankList()},t.prototype.onShowGroupRankList_wx=function(){Context.system.isWXGame&&this.onShowRankList()},t.prototype.onShowRankList=function(){var t=window.platform;this.m_bShowRankList?(this.m_bShowRankList=!1,this.m_rankBit.parent&&this.m_rankBit.parent.removeChild(this.m_rankBit),this.m_rankListMask.parent&&this.m_rankListMask.parent.removeChild(this.m_rankListMask),t.sendMsgToOpenDataContext({command:"close"}),this.m_rankListMask.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowRankList,this)):(this.m_rankListMask||(this.m_rankListMask=new egret.Shape,this.m_rankListMask.graphics.beginFill(0,1),this.m_rankListMask.graphics.drawRect(0,0,Context.width,Context.height),this.m_rankListMask.graphics.endFill(),this.m_rankListMask.alpha=.5,this.m_rankListMask.touchEnabled=!0),this.m_rankListMask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowRankList,this),Context.uimgr.getFourthLayer().addChild(this.m_rankListMask),this.m_rankBit=t.openDataContext.createDisplayObject(null,Context.width,Context.height),this.m_rankBit.touchEnabled=!0,this.m_rankBit.pixelHitTest=!0,Context.uimgr.getFourthLayer().addChild(this.m_rankBit),t.sendMsgToOpenDataContext({command:"open",type:"friend"}),this.m_bShowRankList=!0)},t}();t.RankMgr=e,__reflect(e.prototype,"rank.RankMgr")}(rank||(rank={}));var rank;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="RankSkin",e.horizontalCenter=0,e.verticalCenter=0,e.bDarkeOthers=!0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.exitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitBtnClick,this),Context.system.isWXGame&&(this.onShowRankList_wx(),this.rankGroup.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.rankGroup.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.rankGroup.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this))},e.prototype.onShowRankList_wx=function(){var t,e=window.platform;t=e.openDataContext.createDisplayObject(null,520,654),t.x=0,t.y=0,this.rankGroup.addChild(t),this.m_rankListBitmap=t,e.sendMsgToOpenDataContext({command:"open",type:"friend"})},e.prototype.onTouchBegin=function(t){this.m_touchPos=egret.Point.create(t.stageX,t.stageY)},e.prototype.onTouchMove=function(t){if(this.m_touchPos){var e=t.stageY-this.m_touchPos.y;Math.abs(e)>=10&&(platform.sendMsgToOpenDataContext({command:"scrollView",offSetY:e}),this.m_touchPos.x=t.stageX,this.m_touchPos.y=t.stageY)}},e.prototype.onTouchEnd=function(t){this.m_touchPos&&(egret.Point.release(this.m_touchPos),this.m_touchPos=null)},e.prototype.dispose=function(){Context.system.isWXGame&&(this.m_rankListBitmap&&(this.m_rankListBitmap.parent&&this.m_rankListBitmap.parent.removeChild(this.m_rankListBitmap),this.m_rankListBitmap=null),platform.sendMsgToOpenDataContext({command:"close"}),this.rankGroup.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.rankGroup.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.rankGroup.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.m_touchPos&&(egret.Point.release(this.m_touchPos),this.m_touchPos=null)),this.exitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitBtnClick,this),t.prototype.dispose.call(this)},e}(Form);t.UIRank=e,__reflect(e.prototype,"rank.UIRank")}(rank||(rank={}));var scene;!function(t){var e=function(){function t(){this.goHomeOpenformID=0,this.m_bInSelfHome=!0}return Object.defineProperty(t.prototype,"bInSelfHome",{get:function(){return this.m_bInSelfHome},enumerable:!0,configurable:!0}),t.prototype.onSceneTransition=function(t,e){if(!Context.uimgr.isFormVisible(UIFormID.UISceneTransition))if(Context.loginCC.m_finalMsgreceived){var i={reqFunc:t,thisObj:e},n=Context.uimgr.showForm(UIFormID.UISceneTransition);n.updateData(i)}else t.call(e)},t.prototype.goToOtherHome=function(t,e,i){void 0===e&&(e=111),void 0===i&&(i=0),this.m_data={furnitureList:t,mapid:e},this.onSceneTransition(this.onGoToOtherHome,this),this.goHomeOpenformID=i},t.prototype.createFunBtnData=function(t,e,i,n,o,r){void 0===n&&(n=""),void 0===o&&(o=!1),void 0===r&&(r=!1),this.funBtnData={reqFunc:t,thisObj:e,desc:i,name:n,bshowFilter:o,bshowFilter2:r}},t.prototype.onShowFunBtn=function(){this.funBtnData},t.prototype.onGoToOtherHome=function(){if(this.m_data&&this.m_data.furnitureList){var t=this.m_data.mapid;this.m_data.furnitureList;Context.uimgr.hideForm(UIFormID.UIFunctionIconsTop),Context.playerMgr.onStopGuest(),Context.npcMgr.removeAll();var e=100*t;Context.mapMgr.show(e,t),this.m_data=null,this.m_bInSelfHome=!1,this.onShowFunBtn()}},t.prototype.goHome=function(){this.onSceneTransition(this.onGoHome,this)},t.prototype.onGoHome=function(){Context.playerMgr.onStopGuest(),Context.npcMgr.removeAll();var t=Context.dataXmlMgr.getJson(dataXml.XML_mapfurniture),e=t.map[0].id;Context.mapMgr.show(e,e),Context.playerMgr.createMainPlayer(),egret.Tween.get(this).wait(3e3).call(Context.playerMgr.onShowGuest,Context.playerMgr),this.goHomeOpenformID&&Context.uimgr.showForm(this.goHomeOpenformID),this.m_bInSelfHome=!0},t}();t.SceneTransitionMgr=e,__reflect(e.prototype,"scene.SceneTransitionMgr")}(scene||(scene={}));var scene;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.horizontalCenter=0,e.touchEnabled=!0,e.touchChildren=!1,e.bAniFormFadeInOut=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=Context.width,e=Context.height;this.width=t,this.height=e,this.m_leftGroup=new eui.Group,this.m_leftGroup.width=.5*t,this.m_leftGroup.height=e,this.addChild(this.m_leftGroup);var i;i=new eui.Image("common.pixel_png"),i.scale9Grid=new egret.Rectangle(1,1,2,2),i.width=t,i.height=e,i.right=0,this.m_leftGroup.addChild(i),this.m_leftRect=i,i=new eui.Image("door_png"),i.scaleX=-1,i.x=.5*t,i.width=.5*t,i.height=e,this.m_leftGroup.addChild(i),this.m_leftImg=i,this.m_rightGroup=new eui.Group,this.m_rightGroup.width=.5*t,this.m_rightGroup.height=e,this.m_rightGroup.x=.5*t,this.addChild(this.m_rightGroup),i=new eui.Image("common.pixel_png"),i.scale9Grid=new egret.Rectangle(1,1,2,2),i.width=t,i.height=e,i.left=0,this.m_rightGroup.addChild(i),this.m_rightRect=i,i=new eui.Image("door_png"),i.width=.5*t,i.height=e,this.m_rightGroup.addChild(i),this.m_rightImg=i,this.rectX=.5*-t},e.prototype.updateData=function(e){void 0===e&&(e=null),t.prototype.updateData.call(this,e),this.m_reqFunc=e.reqFunc,this.m_thisObj=e.thisObj},Object.defineProperty(e.prototype,"rectX",{get:function(){return this.m_rectX},set:function(t){this.m_rectX=t,this.m_leftGroup.x=t,this.m_rightGroup.x=.5*this.width-t},enumerable:!0,configurable:!0}),e.prototype.onShow=function(){t.prototype.onShow.call(this),egret.Tween.removeTweens(this),egret.Tween.get(this).to({rectX:0},600,egret.Ease.quartIn).call(this.onReqEntryNewCopy,this).wait(600).to({rectX:.5*-this.width},400,egret.Ease.circIn).call(this.aniEndCallBack,this)},e.prototype.onReqEntryNewCopy=function(){this.m_reqFunc&&this.m_reqFunc.call(this.m_thisObj)},e.prototype.aniEndCallBack=function(){this.exit()},e.prototype.dispose=function(){egret.Tween.removeTweens(this),t.prototype.dispose.call(this)},e}(Form);t.UISceneTransition=e,__reflect(e.prototype,"scene.UISceneTransition")}(scene||(scene={}));var settings;!function(t){var e=function(){function t(){this.touchNum=0}return t.prototype.loadConfig=function(){if(!this.settingXmlData){var t=Context.dataXmlMgr.getJson(dataXml.XML_instructions);this.settingXmlData=t.roleinfo[0]}},t.prototype.getInstructions=function(){return this.loadConfig(),this.settingXmlData.explain},t.prototype.countForID=function(e){var i=0;switch(e){case t.SettingID_JinBi:i=Context.heroinfoMgr.yinbi;break;case t.SettingID_Xing:i=Context.heroinfoMgr.vitalityNum;break;case t.SettingID_ZuanShi:i=Context.heroinfoMgr.zuanshi;break;case t.SettingID_MeiLi:i=Context.heroinfoMgr.meili}var n=UtilTools.num2Str(i);return e==t.SettingID_ShouYi&&(n=Context.languageMgr.getEleStr("con",461,[UtilTools.num2Str(i)])),n},t.SettingID_JinBi=1,t.SettingID_Xing=2,t.SettingID_ZuanShi=3,t.SettingID_ShouYi=4,t.SettingID_MeiLi=5,t}();t.SettingMgr=e,__reflect(e.prototype,"settings.SettingMgr")}(settings||(settings={}));var settings;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="SettingsItemSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.paramBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchParam,this),this.iconImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchIcon,this)},e.prototype.dataChanged=function(){var t=this.data;this.iconImg.source="common."+t.icon,this.descLabel.text=t.name,this.numLabel.text=Context.settingMgr.countForID(t.id),this.paramBtn.visible=t.params},e.prototype.onTouchParam=function(){},e.prototype.onTouchIcon=function(){1==this.data.id&&(Context.settingMgr.touchNum+=1,Context.settingMgr.touchNum>=10)},e.prototype.dispose=function(){this.paramBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchParam,this),this.iconImg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchIcon,this),core.ui_call_supper_dispose(eui.ItemRenderer,this)},e}(eui.ItemRenderer);t.SettingsItem=e,__reflect(e.prototype,"settings.SettingsItem")}(settings||(settings={}));var settings;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.selectSex=0,t.skinName="SettingsSkin",t.height=Context.height,t.left=-t.width,t.verticalCenter=0,t.bDarkeOthers=!0,t}return __extends(i,e),i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.sex0RadioBtn.selected=!0,this.sex0RadioBtn.value=0,this.sex0RadioBtn.addEventListener(egret.Event.CHANGE,this.onSexRadioBtn,this),this.sex1RadioBtn.value=1,this.sex1RadioBtn.addEventListener(egret.Event.CHANGE,this.onSexRadioBtn,this),this.reNameBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchReName,this),this.fankuiBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchFanKui,this),this.addreGroup1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchaddreGroup,this),this.addreGroup2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchaddreGroup,this),this.shopBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),this.gonggaoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),this.rankBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),this.exitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closePage,this),this.updateGameBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.updateGame,this),this.soundBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSoundBtnChange,this),this.soundBtn.selected=!Context.soundMgr.bOnEffect,this.musicBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSoundBtnChange,this),this.musicBtn.selected=!Context.soundMgr.bOnMusic,this.rankBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRank,this),this.bgImg.height=Context.height,this.explainList.itemRenderer=t.SettingsItem,this.explainList.dataProvider=new eui.ArrayCollection,this.headImg.source=UtilTools.uiimagePath("head_"+Context.heroinfoMgr.fashionID),this.charIDLabel.text="游戏ID："+Context.heroinfoMgr.charid,this.updateName(),this.updateList()},i.prototype.onShow=function(){e.prototype.onShow.call(this),egret.Tween.get(this).wait(200).to({left:0},400).call(this.onShowAniEnd,this)},i.prototype.onShowAniEnd=function(){egret.Tween.removeTweens(this);var t=this.fankuiBtn.localToGlobal();Context.system.isWXGame&&Context.operationMgr.operation instanceof common.operation_wx&&Context.operationMgr.operation.showFeedbackButton(t.x,t.y,this.fankuiBtn.width,this.fankuiBtn.height)},i.prototype.updateName=function(){this.nameLabel.text=Context.heroinfoMgr.name,this.updateSexState(Context.heroinfoMgr.sex),this.vipGroup.visible&&(this.vipGroup.x=this.nameLabel.x+this.nameLabel.width+20)},i.prototype.updateList=function(){this.explainList.dataProvider.source=Context.settingMgr.getInstructions(),this.explainList.validateNow();var t=this.explainList.y+this.explainList.height+30;this.shopBtn.y=t,this.gonggaoBtn.y=t,this.rankBtn.y=t},i.prototype.onSoundBtnChange=function(t){var e=t.target;this.soundBtn==e?Context.soundMgr.updateEffectState(!this.soundBtn.selected):this.musicBtn==e&&Context.soundMgr.updateMusicState(!this.musicBtn.selected)},i.prototype.onTouchCopy=function(t){},i.prototype.onSexRadioBtn=function(t){var e=t.target;if(this.selectSex!=e.value){var i=new Cmd.reqChangeSexUserCmd;i.sex=e.value,Context.sendMsg(i)}},i.prototype.updateSexState=function(t){1==t?(this.sex0RadioBtn.selected=!1,this.sex1RadioBtn.selected=!0):(this.sex0RadioBtn.selected=!0,this.sex1RadioBtn.selected=!1),this.selectSex=t},i.prototype.updateGame=function(){Context.logMgr.addLog("UINetConnectClose.ts gatewayServer.connected="+Context.gatewayServer.connected),Context.reloginMgr.reLogin()},i.prototype.onTouchReName=function(){Context.sysPromptMgr.addErrorPrompt(Context.languageMgr.getEleStr("con",18)),Context.system.isWXGame&&Context.operationMgr.operation instanceof common.operation_wx&&Context.operationMgr.operation.openCustomerService()},i.prototype.onDialogLeftFunc=function(){},i.prototype.onDialogRightFunc=function(){var t=Context.packageMgr.computeObjNumInPackage(PackageMgr.ObjID_GaiMingKa),e=new Cmd.reqChangeNameTypeUserCmd;e.type=t?1:2,Context.sendMsg(e)},i.prototype.closePage=function(){Context.settingMgr.touchNum=0,egret.Tween.get(this).to({left:-this.width},400).call(this.exit,this)},i.prototype.exit=function(){e.prototype.exit.call(this)},i.prototype.onTouchFanKui=function(){Context.logMgr.bTest_205()?Context.uimgr.showForm(UIFormID.UIGm):Context.system.isWXGame?Context.operationMgr.operation instanceof common.operation_wx:Context.sysPromptMgr.addErrorPrompt(Context.languageMgr.getEleStr("con",18))},i.prototype.onTouchRank=function(){"//gm5819"==this.UIDlabel.text&&Context.uimgr.showForm(UIFormID.UIGm)},i.prototype.onTouchBtn=function(){Context.sysPromptMgr.addErrorPrompt(Context.languageMgr.getEleStr("con",18))},i.prototype.onTouchaddreGroup=function(){Context.sysPromptMgr.addErrorPrompt(Context.languageMgr.getEleStr("con",18))},i.prototype.onHide=function(){e.prototype.onHide.call(this),Context.system.isWXGame&&Context.operationMgr.operation instanceof common.operation_wx&&Context.operationMgr.operation.hideFeedbackButton()},i.prototype.dispose=function(){this.UIDlabel.text="",egret.Tween.removeTweens(this),this.addreGroup1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchaddreGroup,this),this.addreGroup2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchaddreGroup,this),this.shopBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),this.gonggaoBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),this.rankBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),this.sex0RadioBtn.removeEventListener(egret.Event.CHANGE,this.onSexRadioBtn,this),this.sex1RadioBtn.removeEventListener(egret.Event.CHANGE,this.onSexRadioBtn,this),this.soundBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSoundBtnChange,this),this.updateGameBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.updateGame,this),this.exitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closePage,this),this.reNameBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchReName,this),this.fankuiBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchFanKui,this),this.rankBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRank,this),e.prototype.dispose.call(this)},i}(Form);t.UISettings=e,__reflect(e.prototype,"settings.UISettings")}(settings||(settings={}));var uimain;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="StudySkin",e.horizontalCenter=0,e.verticalCenter=0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.tabBar.addEventListener(egret.Event.CHANGE,this.onTabBar,this),this.tabBar.validateNow(),this.returnBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitBtnClick,this),this.wasteList.dataProvider=new eui.ArrayCollection},e.prototype.onShow=function(){t.prototype.onShow.call(this),this.updateWasteList(1)},e.prototype.updateWasteList=function(t){var e=Context.lobbyMgr.getGoodsList(t);this.wasteList.dataProvider.source=e},e.prototype.onTabBar=function(t){var e=this.tabBar.selectedIndex,i=e+1;this.updateWasteList(i)},e.prototype.dispose=function(){this.returnBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitBtnClick,this),t.prototype.dispose.call(this)},e}(Form);t.UIStudy=e,__reflect(e.prototype,"uimain.UIStudy")}(uimain||(uimain={}));var Table;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_color=0,t.m_zuanshiPrice=0,t.m_iStandbyNum=0,t}return __extends(i,e),i.prototype.parseByteArray=function(i){e.prototype.parseByteArray.call(this,i),this.m_name=t.TDataItem.readString(i),this.m_type=i.readUnsignedShort(),this.m_maxNum=i.readUnsignedInt(),this.m_color=i.readByte(),this.m_jinbiPrice=i.readUnsignedInt(),this.m_zuanshiPrice=i.readUnsignedShort(),this.m_iIconName=t.TDataItem.readString(i),this.m_iDesc=t.TDataItem.readString(i),this.m_iDescParams=t.TDataItem.readString(i),this.m_iStandbyNum=i.readUnsignedInt()},i.prototype.pathIconName=function(){return UtilTools.uiimagePath("obj_"+this.m_iIconName)},i}(t.TDataItem);t.TObjectItem=e,__reflect(e.prototype,"Table.TObjectItem")}(Table||(Table={}));var systemPrompt;!function(t){var e=function(){function e(){this.bShowDanmu=!0,this.m_promptCtrlList=[]}return e.s_getSprite=function(){return e.s_PromptCtrlGc.getObject()},e.s_collectSprite=function(t){t.clear(),t.parent&&t.parent.removeChild(t),e.s_PromptCtrlGc.collect(t)},e.prototype.addPrompt=function(t){var i=e.s_getSprite();i.setData(t),this.showDanmu(i)},e.prototype.addPromptRichText=function(t){var i=e.s_getSprite();i.addPromptRichText(t),this.showDanmu(i)},e.prototype.showDanmu=function(t){t.show(),this.m_promptCtrlList.push(t)},e.prototype.onCtrlMoveOut=function(t){var i=this.m_promptCtrlList.indexOf(t);-1!=i&&this.m_promptCtrlList.splice(i,1),e.s_collectSprite(t)},e.s_PromptCtrlGc=new dataset.GCCommon(t.DanmuCtrl,10,null,null),e}();t.DanmuPromptMgr=e,__reflect(e.prototype,"systemPrompt.DanmuPromptMgr")}(systemPrompt||(systemPrompt={}));var Table;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.parseByteArray=function(i){e.prototype.parseByteArray.call(this,i),this.m_strWord=t.TDataItem.readString(i)},i}(t.TDataItem);t.TSensitiveWordItem=e,__reflect(e.prototype,"Table.TSensitiveWordItem")}(Table||(Table={}));var systemPrompt;!function(t){var e=function(){function e(){this.m_promptCtrlList=[]}return e.s_getSprite=function(){return e.s_PromptCtrlGc.getObject()},e.s_collectSprite=function(t){t.clear(),t.parent&&t.parent.removeChild(t),e.s_PromptCtrlGc.collect(t)},e.prototype.addPrompt=function(t){var i=e.s_getSprite();i.setData(t),this.refresh(i)},e.prototype.addPromptColor=function(t,i){var n=e.s_getSprite();n.setDataWithColor(t,i),this.refresh(n)},e.prototype.addPromptWithJson=function(t){var i=e.s_getSprite();i.setDataWithJson(t),this.refresh(i)},e.prototype.addPromptWithRichText=function(t){var i=e.s_getSprite();i.setDataWithArray(t),this.refresh(i)},e.prototype.addErrorPrompt=function(t){var i=e.s_getSprite();i.setDataWithColor(t,16777215,2,11994373),this.refresh(i)},e.prototype.addGreenPrompt=function(t){var i=e.s_getSprite();i.setDataWithColor(t,16777215,2,UtilColor.CHAT_USERNAME_BLUE_COLOR),this.refresh(i)},e.prototype.refresh=function(t){var e=56,i=this.m_promptCtrlList.length;if(i>0){var n=void 0,o=0,r=this.startPosY-e;for(n=i-1;n>=0;n--)r-=e,o=i-n>=8?0:680-100*(i-n-1),272>r?this.m_promptCtrlList[n].hide():this.m_promptCtrlList[n].moveTo(r,o)}t.y=this.startPosY,t.show(),this.m_promptCtrlList.push(t)},e.prototype.onCtrlFadeOut=function(t){var i=this.m_promptCtrlList.indexOf(t);-1!=i&&this.m_promptCtrlList.splice(i,1),e.s_collectSprite(t)},Object.defineProperty(e.prototype,"startPosY",{get:function(){return.5*Context.height},enumerable:!0,configurable:!0}),e.prototype.showAnnouncement=function(t){var e=Context.uimgr.createForm(UIFormID.UIAnnouncement);e.isVisible()?e.updateData(t):(e.updateData(t),e.show())},e.prototype.showGmNotice=function(t){this.m_gmNoticeStr=t},e.prototype.showUINetConnectClose=function(t){if(void 0===t&&(t=null),Context.loginCC.m_finalMsgreceived||Context.reloginMgr.bReLoginInGame){var e=Context.uimgr.getForm(UIFormID.UINetConnectClose);e&&e.isVisible()||(e=Context.uimgr.showForm(UIFormID.UINetConnectClose)),e&&t&&e.updateData(t)}},e.prototype.showDialogPrompt=function(t,e){void 0===e&&(e=!0)},e.prototype.showDialogPrompt2=function(t,e,i,n,o,r){void 0===o&&(o="btn_quxiaoxuanze_png"),void 0===r&&(r="btn_quedingxuanze_png")},e.s_PromptCtrlGc=new dataset.GCCommon(t.PromptCtrl,10,null,null),e}();t.SystemPromptMgr=e,__reflect(e.prototype,"systemPrompt.SystemPromptMgr")}(systemPrompt||(systemPrompt={}));var systemPrompt;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.horizontalCenter=0,e.top=200,e.touchChildren=!1,e.touchEnabled=!1,e.exitMode="hide",e.width=520,e.height=50,e.cutRect=new egret.Rectangle(.5*e.width,0,0,e.height),e.strList=[],e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.curGroup=new eui.Group,this.curGroup.width=this.width-10,this.curGroup.height=this.height,this.curGroup.scrollEnabled=!0,this.addChild(this.curGroup),this.bgImage=new eui.Image("bg_paomadengditu_png"),this.bgImage.width=this.width,this.bgImage.height=this.height,this.curGroup.addChild(this.bgImage),this.textLabel=new eui.Label,this.textLabel.textColor=UtilColor.DEFAULT,this.textLabel.size=24,this.textLabel.fontFamily=UtilFont.SimHei,this.textLabel.y=12,this.textLabel.x=this.width,this.curGroup.addChild(this.textLabel)},e.prototype.onShow=function(){t.prototype.onShow.call(this),this.onShowUIAniBegin()},e.prototype.updateData=function(e){void 0===e&&(e=null),t.prototype.updateData.call(this,e);var i=e;this.strList.push(i)},Object.defineProperty(e.prototype,"cutRectW",{get:function(){return this.cutRect.width},set:function(t){this.cutRect.width=t,this.cutRect.x=.5*(this.width-t),this.curGroup.scrollRect=this.cutRect,this.curGroup.x=this.cutRect.x},enumerable:!0,configurable:!0}),e.prototype.onShowUIAniBegin=function(){var t=function(){this.onShowTextAniBegin()};this.cutRect.width=0,egret.Tween.get(this).to({cutRectW:this.width},800).call(t,this)},e.prototype.onShowTextAniBegin=function(){try{if(this.strList.length>0){var t=this.strList.shift();UtilString.isXml(t)?this.textLabel.textFlow=(new egret.HtmlTextParser).parser(t):this.textLabel.textFlow=UtilRichText.stringToTextFlow(t),this.textLabel.validateNow(),this.textLabel.x=this.width,egret.Tween.get(this.textLabel).to({x:-20-this.textLabel.textWidth},12e3).call(this.onShowTextAniEnd,this)}}catch(e){Context.system.logException(e),this.exit()}},e.prototype.onShowTextAniEnd=function(){this.strList.length>0?this.onShowTextAniBegin():this.exit()},e.prototype.onHide=function(){t.prototype.onHide.call(this),egret.Tween.removeTweens(this.textLabel),egret.Tween.removeTweens(this)},e}(Form);t.UIAnnouncement=e,__reflect(e.prototype,"systemPrompt.UIAnnouncement")}(systemPrompt||(systemPrompt={}));var systemPrompt;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="SysDialogPromptSkin",e.horizontalCenter=0,e.verticalCenter=0,e.bDarkeOthers=!0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.m_leftBtnRes&&(this.leftBtn.iconDisplay.source=this.m_leftBtnRes),this.m_rightBtnRes&&(this.rightBtn.iconDisplay.source=this.m_rightBtnRes),this.leftBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtn,this),this.rightBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtn,this)
},e.prototype.setDialogData=function(t,e,i,n,o){void 0===o&&(o=0),this.txt.textFlow=t,this.m_leftBtnFunCall=e,this.m_rightBtnFunCall=i,this.m_callbackThisObj=n,this.m_formID=o},e.prototype.setText=function(t,e){void 0===e&&(e=0),e>0&&this.m_formID==e&&(this.txt.textFlow=t)},e.prototype.setLeftBtnRes=function(t){this.m_leftBtnRes=t,this.leftBtn&&(this.leftBtn.iconDisplay.source=t)},e.prototype.setRightBtnRes=function(t){this.m_rightBtnRes=t,this.m_rightBtnRes&&(this.rightBtn.iconDisplay.source=t)},e.prototype.setBtnRes=function(t,e){t&&this.setLeftBtnRes(t),e&&this.setRightBtnRes(e)},e.prototype.onBtn=function(t){var e=t.target;this.leftBtn==e?null!=this.m_leftBtnFunCall&&this.m_leftBtnFunCall.call(this.m_callbackThisObj):this.rightBtn==e&&null!=this.m_rightBtnFunCall&&this.m_rightBtnFunCall.call(this.m_callbackThisObj),this.exit()},e.prototype.dispose=function(){this.m_text=null,this.m_leftBtnRes=null,this.m_rightBtnRes=null,this.m_leftBtnFunCall=null,this.m_rightBtnFunCall=null,this.m_callbackThisObj=null,this.leftBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtn,this),this.rightBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtn,this),t.prototype.dispose.call(this)},e}(Form);t.UIDialogPrompt=e,__reflect(e.prototype,"systemPrompt.UIDialogPrompt")}(systemPrompt||(systemPrompt={}));var systemPrompt;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.horizontalCenter=0,e.verticalCenter=0,e.width=300,e.height=200,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this);var e=new egret.Shape;e.graphics.beginFill(0,1),e.graphics.drawRoundRect(0,0,300,200,20,20),e.graphics.endFill(),this.addChild(e),this.textLabel=new eui.Label,this.textLabel.x=17,this.textLabel.y=16,this.textLabel.width=266,this.textLabel.wordWrap=!0,this.addChild(this.textLabel),Context.loadingView&&Context.loadingView.hide(),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitBtnClick,this)},e.prototype.dispose=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitBtnClick,this),t.prototype.dispose.call(this)},e.prototype.setText=function(t){this.textLabel.text=t+"\n请重新登录"},e.prototype.setTextWarning=function(t){this.textLabel.text="Waring: "+t},e}(Form);t.UIError=e,__reflect(e.prototype,"systemPrompt.UIError")}(systemPrompt||(systemPrompt={}));var systemPrompt;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="NetConnectCloseSkin",e.horizontalCenter=0,e.verticalCenter=0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.reLoginBtn.visible=Context.reloginMgr.isSupportRelogin},e.prototype.updateData=function(t){void 0===t&&(t=null);var e=t;e&&(this.textLabel.text=e)},e.prototype.onTouchTap=function(t){Context.logMgr.addLog("UINetConnectClose.ts gatewayServer.connected="+Context.gatewayServer.connected),this.reLoginBtn!=t.target||Context.reloginMgr.bLoginFailed?Context.gatewayServer.connected||Context.operationMgr.operation.loginOut():Context.reloginMgr.bFirstReLoginInGame?(Context.reloginMgr.bFirstReLoginInGame=!1,Context.reloginMgr.reLoginInGame(),Context.uimgr.showForm(UIFormID.UIReloginCircle)):Context.reloginMgr.reLogin(),this.exit()},e.prototype.setText=function(t){this.textLabel.text=t},e.prototype.dispose=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),t.prototype.dispose.call(this)},e}(Form);t.UINetConnectClose=e,__reflect(e.prototype,"systemPrompt.UINetConnectClose")}(systemPrompt||(systemPrompt={}));var systemPrompt;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.width=80,e.height=80,e.horizontalCenter=0,e.verticalCenter=0,e.bDarkeOthers=!0,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.m_circleImg=new eui.Image("common.relogincircle_png"),this.m_circleImg.x=40,this.m_circleImg.y=40,this.m_circleImg.anchorOffsetX=42,this.m_circleImg.anchorOffsetY=42,this.addChild(this.m_circleImg),this.m_timer=new egret.Timer(4e3,3),this.m_timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.m_timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onTimerComplete,this)},e.prototype.onShow=function(){var e=this;t.prototype.onShow.call(this),egret.Tween.removeTweens(this.m_circleImg),egret.Tween.get(this.m_circleImg,{loop:!0}).to({rotation:360},640).call(function(){e.m_circleImg.rotation=0}),this.m_timer.reset(),this.m_timer.start()},e.prototype.onReloginComplete=function(){this.exit()},e.prototype.onTimer=function(t){egret.log("UIReloginCircle.ts onTimer() count="+this.m_timer.currentCount),Context.reloginMgr.reLoginInGame()},e.prototype.onTimerComplete=function(){Context.reloginMgr.reLogin(),this.exit()},e.prototype.dispose=function(){egret.Tween.removeTweens(this.m_circleImg),this.m_timer&&(this.m_timer.stop(),this.m_timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.m_timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onTimerComplete,this),this.m_timer=null),t.prototype.dispose.call(this)},e}(Form);t.UIReloginCircle=e,__reflect(e.prototype,"systemPrompt.UIReloginCircle")}(systemPrompt||(systemPrompt={}));var systemPrompt;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.arrowX=0,e.arrowY=0,e.m_bShow=!1,e.skinName="GuideArrowSkin",e.touchEnabled=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.setData=function(t,e,i,n,o){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n="bottom"),void 0===o&&(o=!0),this.m_bShow=!0,this.m_pos||(this.m_pos=new egret.Point),o&&UtilUI.localToUILayer(t,0,0,this.m_pos),this.x=this.m_pos.x,this.y=this.m_pos.y,this.width=t.width,this.height=t.height,this.validateNow();switch(n){case"top":this.arrowImg.rotation=180;break;case"right":this.arrowImg.rotation=90;break;case"bottom":this.arrowImg.rotation=0;break;case"left":this.arrowImg.rotation=-90}this.arrowX+=e,this.arrowY+=i,this.arrowImg.x=this.arrowX,this.arrowImg.y=this.arrowY,this.playTween(n)},e.prototype.playTween=function(t){switch(t){case"top":egret.Tween.get(this.arrowImg,{loop:!0}).to({y:this.arrowY-20},300,egret.Ease.quadIn).to({y:this.arrowY},300,egret.Ease.quartIn).to({y:this.arrowY-20},300,egret.Ease.quadIn).to({y:this.arrowY},300,egret.Ease.quartIn).wait(600);break;case"right":egret.Tween.get(this.arrowImg,{loop:!0}).to({x:this.arrowX+20},300,egret.Ease.quadIn).to({x:this.arrowX},300,egret.Ease.quartIn).to({x:this.arrowX+20},300,egret.Ease.quadIn).to({x:this.arrowX},300,egret.Ease.quartIn).wait(1e3);break;case"bottom":egret.Tween.get(this.arrowImg,{loop:!0}).to({y:this.arrowY+20},300,egret.Ease.quadIn).to({y:this.arrowY},300,egret.Ease.quartIn).to({y:this.arrowY+20},300,egret.Ease.quadIn).to({y:this.arrowY},300,egret.Ease.quartIn).wait(1e3);break;case"left":egret.Tween.get(this.arrowImg,{loop:!0}).to({x:this.arrowX-20},300,egret.Ease.quadIn).to({x:this.arrowX},300,egret.Ease.quartIn).to({x:this.arrowX-20},300,egret.Ease.quadIn).to({x:this.arrowX},300,egret.Ease.quartIn).wait(1e3)}},Object.defineProperty(e.prototype,"bShow",{get:function(){return this.m_bShow},enumerable:!0,configurable:!0}),e.prototype.hide=function(){this.parent&&this.parent.removeChild(this),this.arrowX=0,this.arrowY=0,this.m_pos=null,egret.Tween.removeTweens(this.arrowImg),this.m_bShow=!1},e.prototype.dispose=function(){this.hide(),core.ui_call_supper_dispose(eui.Component,this)},e}(eui.Component);t.GuideArrow=e,__reflect(e.prototype,"systemPrompt.GuideArrow")}(systemPrompt||(systemPrompt={}));var systemPrompt;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.arrowX=0,e.arrowY=0,e.m_pos=new egret.Point,e.m_bShow=!1,e.skinName="GuideArrowDescSkin",e.touchEnabled=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.setData=function(t,e,i,n,o){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n="bottom"),this.m_bShow=!0,UtilUI.localToUILayer(t,0,0,this.m_pos);switch(n){case"top":this.arrowX=this.topGroup.x,this.arrowY=this.topGroup.y,this.arrowImg.rotation=180,this.x=this.m_pos.x-.5*this.width,this.y=this.m_pos.y;break;case"right":this.arrowX=this.rightGroup.x,this.arrowY=this.rightGroup.y,this.arrowImg.rotation=90,this.x=this.m_pos.x-this.width,this.y=this.m_pos.y-.5*this.height;break;case"bottom":this.arrowX=this.bottomGroup.x,this.arrowY=this.bottomGroup.y,this.arrowImg.rotation=0,this.x=this.m_pos.x+.5*t.width-.5*this.width,this.y=this.m_pos.y-this.height;break;case"left":this.arrowX=this.leftGroup.x,this.arrowY=this.leftGroup.y,this.arrowImg.rotation=-90,this.x=this.m_pos.x,this.y=this.m_pos.y-.5*this.height}this.arrowImg.x=this.arrowX,this.arrowImg.y=this.arrowY,this.descLabel.textFlow=o,this.playTween(n)},e.prototype.playTween=function(t){switch(t){case"top":egret.Tween.get(this.arrowImg,{loop:!0}).to({y:this.arrowY-20},300,egret.Ease.quadIn).to({y:this.arrowY},300,egret.Ease.quartIn).to({y:this.arrowY-20},300,egret.Ease.quadIn).to({y:this.arrowY},300,egret.Ease.quartIn).wait(600);break;case"right":egret.Tween.get(this.arrowImg,{loop:!0}).to({x:this.arrowX+20},300,egret.Ease.quadIn).to({x:this.arrowX},300,egret.Ease.quartIn).to({x:this.arrowX+20},300,egret.Ease.quadIn).to({x:this.arrowX},300,egret.Ease.quartIn).wait(1e3);break;case"bottom":egret.Tween.get(this.arrowImg,{loop:!0}).to({y:this.arrowY+20},300,egret.Ease.quadIn).to({y:this.arrowY},300,egret.Ease.quartIn).to({y:this.arrowY+20},300,egret.Ease.quadIn).to({y:this.arrowY},300,egret.Ease.quartIn).wait(1e3);break;case"left":egret.Tween.get(this.arrowImg,{loop:!0}).to({x:this.arrowX-20},300,egret.Ease.quadIn).to({x:this.arrowX},300,egret.Ease.quartIn).to({x:this.arrowX-20},300,egret.Ease.quadIn).to({x:this.arrowX},300,egret.Ease.quartIn).wait(1e3)}},Object.defineProperty(e.prototype,"bShow",{get:function(){return this.m_bShow},enumerable:!0,configurable:!0}),e.prototype.hide=function(){this.parent&&this.parent.removeChild(this),this.m_bShow=!1},e.prototype.dispose=function(){this.hide(),core.ui_call_supper_dispose(eui.Component,this)},e}(eui.Component);t.GuideArrowDesc=e,__reflect(e.prototype,"systemPrompt.GuideArrowDesc")}(systemPrompt||(systemPrompt={}));var systemPrompt;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_bShow=!1,e.m_posX=0,e.m_posY=0,e.m_width=0,e.m_height=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=Context.width;2048>1.2*t?this.width=1.2*t:this.width=Context.width;var e=Context.height;2048>1.2*e?this.height=1.2*e:this.height=e,this.touchEnabled=!0,this.m_bShow=!0,this.TextureGroup||(this.TextureGroup=new eui.Group,this.addChild(this.TextureGroup)),this.m_bitmap=new egret.Bitmap,this.TextureGroup.addChild(this.m_bitmap),this.m_bitmap.touchEnabled=!0,this.m_bitmap.pixelHitTest=!1},e.prototype.setData=function(t,e,i,n){this.m_posX=t,this.m_posY=e,this.m_width=i,this.m_height=n;var o=new egret.DisplayObjectContainer;this.m_rTexture=new egret.RenderTexture;var r=Context.width;r=2048>1.2*r?1.2*r:Context.width;var s=Context.height;s=2048>1.2*s?1.2*s:s;var a=new egret.Shape;a.graphics.beginFill(0,.6),a.graphics.drawRect(0,0,r,s),a.graphics.endFill(),o.addChild(a),a.touchEnabled=!0;var h=new egret.Shape;h.graphics.beginFill(0,1),h.graphics.drawRoundRect(t,e,i,n,20,20),h.graphics.endFill(),o.addChild(h),h.blendMode=egret.BlendMode.ERASE,h.touchEnabled=!0,this.m_rTexture.drawToTexture(o),this.m_bitmap.texture=this.m_rTexture,this.m_bitmap.width=r,this.m_bitmap.height=s,Context.logMgr.addLog("guideblackBg width="+this.m_bitmap.width),Context.logMgr.addLog("guideblackBg height="+this.m_bitmap.height)},Object.defineProperty(e.prototype,"bShow",{get:function(){return this.m_bShow},enumerable:!0,configurable:!0}),e.prototype.hide=function(){this.parent&&this.parent.removeChild(this),this.m_bShow=!1},e.prototype.dispose=function(){this.hide(),this.m_rTexture&&(this.m_rTexture.dispose(),this.m_rTexture=null),core.ui_call_supper_dispose(eui.Component,this)},e}(eui.Component);t.GuideBlackBg=e,__reflect(e.prototype,"systemPrompt.GuideBlackBg")}(systemPrompt||(systemPrompt={}));var systemPrompt;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_bShow=!1,e.skinName="GuideDescSkin",e.horizontalCenter=0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.setData=function(t,e){this.reachLabel.textFlow=e,this.updateModel(t),this.m_bShow=!0},e.prototype.updateModel=function(t){t&&""!=t||(Context.logMgr.addLog("ERROR!! GuideDesc model="+t),t="gril"),this.modelDB&&(this.modelDB.clear(),this.modelDB=null),"player"==t?(this.modelGroup.visible=!1,this.playerImg.visible=!0,this.nameLabel.visible=!0,this.nameLabel.text="房东",2==Context.loginData.userInfo_wx.gender?this.playerImg.source=UtilTools.uiimagePath("img_huainv3"):this.playerImg.source=UtilTools.uiimagePath("img_dakuannan"),Context.loginData.userInfo_wx.nickName&&(this.nameLabel.text=Context.loginData.userInfo_wx.nickName)):(this.modelGroup.visible=!0,this.playerImg.visible=!1,this.nameLabel.visible=!1,t&&(this.modelDB=Context.dBonesMgr.createDBones(t),this.modelGroup.addChild(this.modelDB),this.modelDB.scaleX=1,this.modelDB.scaleY=1,this.modelDB.play(null,0)))},Object.defineProperty(e.prototype,"bShow",{get:function(){return this.m_bShow},enumerable:!0,configurable:!0}),e.prototype.onTouchReturn=function(){Context.guideprompMgr.removeGuide()},e.prototype.hide=function(){egret.Tween.removeTweens(this),this.parent&&this.parent.removeChild(this),this.m_bShow=!1},e.prototype.dispose=function(){this.hide(),this.modelDB&&(this.modelDB.clear(),this.modelDB=null),core.ui_call_supper_dispose(eui.Component,this)},e}(eui.Component);t.GuideDesc=e,__reflect(e.prototype,"systemPrompt.GuideDesc")}(systemPrompt||(systemPrompt={}));var systemPrompt;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(t,e,i,n){this.m_eff||(this.m_eff=new core.EffectMovieclip("btnyuanquantexiao_new",this)),this.m_eff.scaleX=1.5,this.m_eff.scaleY=1.5,this.m_eff.show(),this.x=t,this.y=e,this.height=n,this.width=i},Object.defineProperty(e.prototype,"bShow",{get:function(){return this.m_bShow},enumerable:!0,configurable:!0}),e.prototype.hide=function(){this.parent&&this.parent.removeChild(this),this.m_bShow=!1},e.prototype.dispose=function(){this.hide(),this.m_eff&&(this.m_eff.dispose(),this.m_eff=null),core.ui_call_supper_dispose(eui.Component,this)},e}(eui.Component);t.GuideEff=e,__reflect(e.prototype,"systemPrompt.GuideEff")}(systemPrompt||(systemPrompt={}));var systemPrompt;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_bShow=!1,e.init(),e.touchEnabled=!0,e}return __extends(e,t),e.prototype.init=function(){this.m_bShow=!0,this.exitLabel=new uicommon.ButtonUnderline,this.exitLabel.label="点击跳过>>",this.exitLabel.color=UtilColor.GREEN,this.exitLabel.size=30,this.addChild(this.exitLabel)},Object.defineProperty(e.prototype,"bShow",{get:function(){return this.m_bShow},enumerable:!0,configurable:!0}),e.prototype.hide=function(){this.m_bShow=!1,this.parent&&this.parent.removeChild(this)},e.prototype.dispose=function(){this.hide(),core.ui_call_supper_dispose(eui.Component,this)},e}(eui.Component);t.GuideExit=e,__reflect(e.prototype,"systemPrompt.GuideExit")}(systemPrompt||(systemPrompt={}));var systemPrompt;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_pos=new egret.Point,e.m_bShow=!1,e.m_initPosX=0,e.m_initPosY=0,e.skinName="GuideFingerSkin",e.touchEnabled=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.init=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bShow=!0,egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.fingerImg),this.fingerImg.source="common.finger02_png",this.m_initPosX||(this.m_initPosX=t),this.m_initPosY||(this.m_initPosY=e),this.x=t,this.y=e},e.prototype.moveTo=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=0),this.m_com||(this.m_com=t),this.m_posX||(this.m_posX=e),this.m_posY||(this.m_posY=i),this.m_duration||(this.m_duration=n),UtilUI.localToUILayer(t,0,0,this.m_pos),egret.Tween.get(this).wait(300).to({x:this.m_pos.x,y:this.m_pos.y},n),egret.Tween.get(this.fingerImg).wait(300).to({x:e,y:i},n).wait(500).call(this.playTween,this)},e.prototype.setData=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bShow=!0,this.x=t,this.y=e,this.playTween()},e.prototype.playTween=function(){egret.Tween.get(this.fingerImg,{loop:!0}).to({source:"common.finger01_png"},300).wait(300).to({source:"common.finger02_png"},300).wait(2e3)},e.prototype.hide=function(){egret.Tween.removeTweens(this.fingerImg),this.parent&&this.parent.removeChild(this),this.m_bShow=!1},e.prototype.dispose=function(){this.hide(),this.m_initPosX=0,this.m_initPosY=0,this.m_com=null,this.m_posX=0,this.m_posY=0,this.m_duration=0,core.ui_call_supper_dispose(eui.Component,this)},e}(eui.Component);t.GuideFinger=e,__reflect(e.prototype,"systemPrompt.GuideFinger")}(systemPrompt||(systemPrompt={}));var systemPrompt;!function(t){var e=function(){function e(){this.m_posX=0,this.m_posY=0,this.m_height=0,this.m_width=0,this.m_complete_CallBack_this=null,this.m_complete_CallBack=null,this.m_desc_complete_CallBack_this=null,this.m_desc_complete_CallBack=null,this.curGuideID=0,this.curGuideIndex=0,this.bAnyResTouch=!1}return e.prototype.loadConfig=function(){if(!this.yindaoXmlData){var t=Context.dataXmlMgr.getJson(dataXml.XML_yindao);this.yindaoXmlData=t.yindao}},e.prototype.bRunning=function(){return this.guideBlackBg&&this.guideBlackBg.bShow||this.guideArrow&&this.guideArrow.bShow||this.guideEff&&this.guideEff.bShow||this.guideDesc&&this.guideDesc.bShow||this.guideArrowDesc&&this.guideArrowDesc.bShow?!0:!1},e.prototype.createTimeCallBack=function(t){this.callbackTimer=egret.setTimeout(this.onTouchTab,this,t)},e.prototype.getGuanForYinDaoType=function(t){return this.loadConfig(),this.yindaoXmlData[t].guan},e.prototype.newGongNengKaiFangGuide=function(t){},e.prototype.onShowFingerGuide=function(e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var o=new egret.Point;UtilUI.localToUILayer(e,0,0,o),this.guideFinger||(this.guideFinger=new t.GuideFinger);var r=Context.uimgr.getFourthLayer();r&&r.addChild(this.guideFinger),this.guideFinger.setData(o.x+i,o.y+n)},e.prototype.onShowXMLGuide=function(t,e,i,n,o,r,s,a,h,m,c,u){void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r="bottom"),this.curGuideID=t,this.curGuideIndex=e,this.loadConfig();var l=this.yindaoXmlData[t];if(!l)return void Context.logMgr.showError("引导配置不存在type"+t);var p=UtilRichText.htmlTextToTextFlow(l.content[e].text);s&&(UtilRichText.beginCompose(),UtilRichText.add(s,6689298,28),p=UtilRichText.getComposedContent()),i||Context.logMgr.sendServer("onShowXMLGuide com不存在,guideID="+t+",guideIndex="+e),this.createGuide(i,n,o,r,p,a,h,m,c,u)},e.prototype.createArrowGuide=function(t,e,i,n,o,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n="bottom"),this.createBlackBg(t,o,r),this.createArrow(t,e,i,n,!1)},e.prototype.onShowArrowDescGuide=function(e,i,n,o,r,s,a,h,m){void 0===s&&(s="bottom"),void 0===a&&(a=""),this.curGuideID=e,this.curGuideIndex=i,this.loadConfig();var c=this.yindaoXmlData[e];if(!c)return void Context.logMgr.showError("引导配置不存在type"+e);var u=UtilRichText.htmlTextToTextFlow(c.content[i].text);a&&(UtilRichText.beginCompose(),UtilRichText.add(a,6689298,28),u=UtilRichText.getComposedContent()),this.createBlackBg(n,h,m),this.guideArrowDesc||(this.guideArrowDesc=new t.GuideArrowDesc),this.guideArrowDesc.setData(n,o,r,s,u);var l=Context.uimgr.getFourthLayer();this.guideArrowDesc&&l.addChild(this.guideArrowDesc)},e.prototype.createGuide=function(t,e,i,n,o,r,s,a,h,m){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n="bottom"),this.createBlackBg(t,h,m),this.createArrow(t,e,i,n),this.createDesc(o,r,s,a)},e.prototype.createBlackBg=function(e,i,n){this.m_complete_CallBack=i,this.m_complete_CallBack_this=n;var o=new egret.Point;UtilUI.localToUILayer(e,0,0,o),this.m_posX=o.x,this.m_posY=o.y,this.m_height=e.height,this.m_width=e.width,this.guideBlackBg||(this.guideBlackBg=new t.GuideBlackBg,this.guideBlackBg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this)),this.guideBlackBg.setData(o.x,o.y,e.width,e.height);var r=Context.uimgr.getFourthLayer();this.guideBlackBg&&r.addChild(this.guideBlackBg)},e.prototype.onTouchTab=function(t){if(this.bAnyResTouch)this.hideGuide(),this.m_complete_CallBack&&this.m_complete_CallBack.call(this.m_complete_CallBack_this,this),this.bAnyResTouch=!1,this.removeCallBack();else if(this.callbackTimer)this.hideGuide(),this.m_complete_CallBack&&this.m_complete_CallBack.call(this.m_complete_CallBack_this,this),egret.clearTimeout(this.callbackTimer),this.callbackTimer=0,this.removeCallBack();else{if(!(t.stageX>=this.m_posX&&t.stageX<=this.m_posX+this.m_width&&t.stageY>=this.m_posY&&t.stageY<=this.m_posY+this.m_height))return;this.hideGuide(),this.m_complete_CallBack&&this.m_complete_CallBack.call(this.m_complete_CallBack_this,this)}},e.prototype.onTouchDesc=function(){if(this.m_desc_complete_CallBack){this.hideGuide();var t={};t.callback=this.m_desc_complete_CallBack,t.callbackThis=this.m_desc_complete_CallBack_this,this.m_desc_complete_CallBack=null,this.m_desc_complete_CallBack_this=null,t.callback.call(t.callbackThis,this)}},e.prototype.createArrow=function(e,i,n,o,r){void 0===o&&(o="bottom"),void 0===r&&(r=!0),this.guideArrow||(this.guideArrow=new t.GuideArrow),this.guideArrow.setData(e,i,n,o);var s=Context.uimgr.getFourthLayer();if(s&&s.addChild(this.guideArrow),r){this.guideEff||(this.guideEff=new t.GuideEff);var a=new egret.Point;UtilUI.localToUILayer(e,0,0,a),this.guideEff.setData(a.x+.5*e.width,a.y+.5*e.height,e.width,e.height),this.guideEff&&s.addChild(this.guideEff)}},e.prototype.createDesc=function(e,i,n,o){if(void 0===i&&(i="gril"),void 0===n&&(n="bottom"),void 0===o&&(o=300),e&&e.length){this.guideDesc||(this.guideDesc=new t.GuideDesc,this.guideDesc.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchDesc,this)),this.guideDesc.setData(i,e);var r=Context.uimgr.getFourthLayer();this.guideDesc&&r.addChild(this.guideDesc),"top"==n?(this.guideDesc.top=-200,egret.Tween.get(this.guideDesc).to({top:o},300)):(this.guideDesc.bottom=-200,egret.Tween.get(this.guideDesc).to({bottom:o},300)),egret.Tween.get(this.guideDesc).to({alpha:1},300)}},e.prototype.removeGuide=function(){this.curGuideID=0,this.curGuideIndex=0,this.guideBlackBg&&(this.guideBlackBg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this),this.guideBlackBg.dispose(),this.guideBlackBg=null),this.guideArrow&&(this.guideArrow.dispose(),this.guideArrow=null),this.guideArrowDesc&&(this.guideArrowDesc.dispose(),this.guideArrowDesc=null),this.guideEff&&(this.guideEff.dispose(),this.guideEff=null),this.guideDesc&&(this.guideDesc.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchDesc,this),this.guideDesc.dispose(),this.guideDesc=null),this.guideFinger&&(this.guideFinger.dispose(),this.guideFinger=null),this.removeCallBack()},e.prototype.removeCallBack=function(){this.m_complete_CallBack&&(this.m_complete_CallBack=null,this.m_complete_CallBack_this=null)},e.prototype.hideGuide=function(){this.guideBlackBg&&this.guideBlackBg.hide(),this.guideArrow&&this.guideArrow.hide(),this.guideArrowDesc&&this.guideArrowDesc.hide(),this.guideEff&&this.guideEff.hide(),this.guideDesc&&(this.guideDesc.top?this.guideDesc.top=0/0:this.guideDesc.bottom&&(this.guideDesc.bottom=0/0),this.guideDesc.hide()),this.guideFinger&&this.guideFinger.hide()},e.prototype.reset_to_beforeLogin=function(){this.removeGuide()},e.GuideTYPE_FirstPlay_1=1,e.GuideTYPE_levelup_2=2,e.GuideTYPE_HuoJianZhaDan_3=3,e.GuideTYPE_SmallHammer_4=4,e.GuideTYPE_Rainbow_5=5,e.GuideTYPE_BixHammer_6=6,e.GuideTYPE_TwoPlane_7=7,e.GuideTYPE_ShouTao_8=8,e.GuideTYPE_addStep_9=9,e.GuideTYPE_MuBiao_10=10,e.GuideTYPE_FangWen_101=101,e.GuideTYPE_Fashion_102=102,e.GuideTYPE_Friend_103=103,e.GuideTYPE_ZhuanPan_104=104,e.GuideTYPE_YuLanEnd_201=201,e.GuideTYPE_QuestGuide_202=202,e.GuideTYPE_QuestGuide_203=203,e.GuideTYPE_QuestGuide_204=204,e.GuideTYPE_QuestGuide_205=205,e.GuideTYPE_HuoJianZhaDan_301=301,e.GuideTYPE_Rainbow_302=302,e.GuideTYPE_TwoPlane_303=303,e.GuideTYPE_addStep_303=304,e.GuideType_pass9_401=401,e}();t.GuidePrompMgr=e,__reflect(e.prototype,"systemPrompt.GuidePrompMgr")}(systemPrompt||(systemPrompt={}));var tips;!function(t){var e=function(){function t(){}return t.prototype.onShowObjTips=function(t,e){var i=Context.uimgr.showForm(UIFormID.UIObjTips);i&&i.updateObjData(t,e)},t}();t.TipsMgr=e,__reflect(e.prototype,"tips.TipsMgr")}(tips||(tips={}));var tips;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="objTipsSkin",e.horizontalCenter=0,e.verticalCenter=0,e.bDarkeOthers=!0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitBtnClick,this)},e.prototype.updateObjData=function(t,e){var i=Context.dataTableMgr.getItem(Table.TABLE_OBJECT,t);i&&(this.iconImg.source=i.pathIconName(),this.nameLabel.text=i.m_name,this.numLabel.text="数量:"+e,this.descLabel.text=i.m_iDesc,this.descLabel.validateNow(),this.height=this.descLabel.y+this.descLabel.height+50)},e.prototype.dispose=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitBtnClick,this),t.prototype.dispose.call(this)},e}(Form);t.UIObjTips=e,__reflect(e.prototype,"tips.UIObjTips")}(tips||(tips={}));var HeroInfoMgr=function(t){function e(){var e=t.call(this)||this;return e.m_lastGuan=0,e.life=0,e.vitality=0,e.m_maxGuan=0,e.m_fashionID=0,e.m_fashionlevel=0,e.m_meili=0,e.offLineRewardData=null,e.bFirstEntryGame=!1,e}return __extends(e,t),e.prototype.reset_to_beforeLogin=function(){this.life=0,this.vitality=0,this.m_fashionID=0,this.m_fashionlevel=0,this.m_meili=0,this.offLineRewardData=null,this.bFirstEntryGame=!1},e.prototype.loadConfig=function(){if(!this.m_guanCfg){var t=Context.dataXmlMgr.getJson(dataXml.XML_gameinit);this.m_guanCfg=t,this.m_userInitCfg=t.initial[0],this.m_friendCfg=t.friendVisit[0],this.m_maxGuan=t.fixedvalue[0].maxpass}},Object.defineProperty(e.prototype,"maxGuan",{get:function(){return this.loadConfig(),this.m_maxGuan},enumerable:!0,configurable:!0}),e.prototype.initMainData=function(t){this.m_mainData=t},e.prototype.getMaxDaliCount=function(){return this.loadConfig(),this.m_friendCfg.maxdali},Object.defineProperty(e.prototype,"fashionID",{get:function(){return this.m_fashionID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fashionlevel",{get:function(){return this.m_fashionlevel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vip",{get:function(){return this.mainData.vip},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"meili",{get:function(){return this.m_meili},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sex",{get:function(){return this.m_mainData.sex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.m_mainData.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"charid",{get:function(){return this.m_mainData.charid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"guan",{get:function(){return this.m_mainData?this.m_mainData.guan:1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastguan",{get:function(){return this.m_lastGuan},set:function(t){this.m_lastGuan=t},enumerable:!0,configurable:!0}),e.prototype.onModifyName=function(t,e){this.m_mainData&&(this.m_mainData.name=t,this.m_mainData.sex=e);var i=Context.uimgr.getForm(UIFormID.UISettings);i&&i.updateName()},e.prototype.updateGuan=function(t){if(this.m_mainData.guan!=t){this.m_mainData.guan=t;var e=new httpCmd.RecordPassLevel;Context.httpSendMgr.send(e),Context.mapMgr.m_roomShadeMgr.updateRoomOpen(t),Context.system.isWXGame&&platform.setUserCloudStorage([{key:"score",value:""+t}])}},e.prototype.onUpdateUIByChangeGuan=function(){var t=(this.m_mainData.guan,Context.uimgr.getForm(UIFormID.UIGm));t&&t.updateTaskData()},Object.defineProperty(e.prototype,"yinbi",{get:function(){return this.m_mainData?this.m_mainData.yinbi:0},enumerable:!0,configurable:!0}),e.prototype.updateYinbi=function(t){t-this.m_mainData.yinbi;this.m_mainData.yinbi=t},Object.defineProperty(e.prototype,"zuanshi",{get:function(){return this.m_mainData.zuanshi},set:function(t){this.m_mainData.zuanshi=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lifeNum",{get:function(){return this.life},set:function(t){this.life=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxlifeNum",{get:function(){return this.loadConfig(),this.m_userInitCfg.maxxin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vitalityNum",{get:function(){return this.vitality},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainData",{get:function(){return this.m_mainData},enumerable:!0,configurable:!0}),e.prototype.setvitalityNum=function(t){this.vitality=t},e.prototype.getRewardXing=function(t){this.loadConfig();var e=this.m_guanCfg.pass;for(var i in e)if(e[i].minpass<=t&&t<=e[i].maxpass)return e[i].xing;return 0},e.prototype.getRewardZuanShi=function(t){this.loadConfig();var e=this.m_guanCfg.fixedvalue[0],i=0,n=this.m_guanCfg.pass;for(var o in n)n[o].minpass<=t&&t<=n[o].maxpass&&(i=Math.ceil(e.diamond*(n[o].diamond_percent/100)));return i},e.prototype.bRemoveLife=function(t){this.loadConfig();var e=this.m_guanCfg.fixedvalue[0].pass;return e>=t?!1:!0},e.prototype.getRewardYinbi=function(t,e){this.loadConfig();var i=this.m_guanCfg.pass,n=0;for(var o in i)if(i[o].minpass<=t&&t<=i[o].maxpass){n=Math.ceil(e*(i[o].jinbi_percent/100))+i[o].yinbi;break}return n},e.prototype.getNextOpenElement=function(t){this.loadConfig();var e=this.m_guanCfg.jiesuan;for(var i in e)if(e[i].pass>t)return e[i];return null},e.prototype.getRevivePerent=function(t){this.loadConfig();var e=this.m_guanCfg.pass;for(var i in e)if(e[i].minpass<=t&&t<=e[i].maxpass)return e[i].revive_percent;return 100},e.prototype.getBuyObjPerent=function(t){this.loadConfig();var e=this.m_guanCfg.pass;for(var i in e)if(e[i].minpass<=t&&t<=e[i].maxpass)return e[i].buyobj_percent;return 100},e.prototype.process_onlineSendFashionDataUserCmd=function(t){var e=new Cmd.onlineSendFashionDataUserCmd;e.deserialize(t),this.m_fashionID=e.fashionId,this.m_fashionlevel=e.fashionLevel,this.m_meili=e.meiLi},e.prototype.reqDressFashion=function(t,e){var i=new Cmd.reqDressFashionUserCmd;i.fashionId=t,i.fashionLevel=e,Context.sendMsg(i)},e.prototype.process_retDressFashionUserCmd=function(t){var e=new Cmd.retDressFashionUserCmd;e.deserialize(t),this.m_fashionID=e.fashionId,this.m_fashionlevel=e.fashionLevel},e.prototype.process_updateUserCharmValueUserCmd=function(t){var e=new Cmd.updateUserCharmValueUserCmd;e.deserialize(t),this.m_meili=e.charm},e.prototype.onShowUIOfflineReward=function(){var t=this.offLineRewardData;t&&t.offlineTime>=600&&this.guan>10&&(this.offLineRewardData=null)},e.prototype.process_reqChangeSexUserCmd=function(t){var e=new Cmd.reqChangeSexUserCmd;e.deserialize(t),this.m_mainData&&(this.m_mainData.sex=e.sex);var i=Context.uimgr.getForm(UIFormID.UISettings);i&&i.updateSexState(e.sex)},e.prototype.process_sendUserBuffListUserCmd=function(t){var e=new Cmd.sendUserBuffListUserCmd;e.deserialize(t),Context.logMgr.addLog("上线收到buff列表"),this.buffData=e.data},e.prototype.process_synAddBuffUserCmd=function(t){var e=new Cmd.synAddBuffUserCmd;e.deserialize(t),this.buffData||(this.buffData=[]);var i=0;for(i=0;i<this.buffData.length;i++)if(this.buffData[i].buff==e.buff){this.buffData[i].time=e.time;break}i>=this.buffData.length&&this.buffData.push({buff:e.buff,time:e.time})
},e.prototype.process_synDeleteBuffUserCmd=function(t){var e=new Cmd.synDeleteBuffUserCmd;e.deserialize(t);for(var i=0;i<this.buffData.length;i++)if(this.buffData[i].buff==e.buff){this.buffData.splice(i,1);break}},e}(egret.EventDispatcher);__reflect(HeroInfoMgr.prototype,"HeroInfoMgr");var uicommon;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_leftTime=4,e.m_onTimerCompleteFunc=null,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.setCompleteCallFunc=function(t,e){this.m_thisObj=t,this.m_onTimerCompleteFunc=e},e.prototype.start=function(t){void 0===t&&(t=5);var e=this.m_timer;null==e&&(e=new egret.Timer(1e3,t),e.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),e.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onTimerComplete,this),this.m_timer=e),this.m_leftTime=t,e.repeatCount=t,e.reset(),e.start(),this.updateTxtLabel(t)},e.prototype.stop=function(){this.m_timer&&this.m_timer.stop()},e.prototype.end=function(){this.stop(),this.onTimerComplete(null)},e.prototype.onTimer=function(t){var e=this.m_leftTime-t.target.currentCount;this.updateTxtLabel(e)},e.prototype.onTimerComplete=function(t){this.updateTxtLabel(0),this.m_onTimerCompleteFunc&&this.m_onTimerCompleteFunc.call(this.m_thisObj)},e.prototype.updateTxtLabel=function(t){this.label=Context.languageMgr.getEleStr("con",25,[t])},e.prototype.dispose=function(){var t=this.m_timer;t&&(t.stop(),t.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),t.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onTimerComplete,this),t=null),this.m_thisObj=null,this.m_onTimerCompleteFunc=null},e}(eui.Button);t.ButtonDaojishi=e,__reflect(e.prototype,"uicommon.ButtonDaojishi"),window.ButtonDaojishi=e}(uicommon||(uicommon={})),window.uicommon||(window.uicommon=uicommon);var uicommon;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchCaptured=!1,e._icon=null,e._img=null,e.iconDisplay=null,e.imgDisplay=null,e.skinName="ButtonImgChangeSkin",e.touchChildren=!1,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchBegin,e),e}return __extends(e,t),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},set:function(t){this._icon=t,this.iconDisplay&&(this.iconDisplay.source=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"img",{get:function(){return this._img},set:function(t){this._img=t,this.imgDisplay&&(this.imgDisplay.source=t)},enumerable:!0,configurable:!0}),e.prototype.onTouchBegin=function(t){this.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!0,this.invalidateState(),t.updateAfterEvent()},e.prototype.onTouchCancle=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!1,this.invalidateState()},e.prototype.onStageTouchEnd=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.contains(t.target)&&this.buttonReleased(),this.touchCaptured=!1,this.invalidateState()},e.prototype.getCurrentState=function(){return this.enabled?this.touchCaptured?"down":"up":"disabled"},e.prototype.partAdded=function(t,e){e==this.img?this.imgDisplay.source=this._img:e==this.iconDisplay&&(this.iconDisplay.source=this._icon)},e.prototype.buttonReleased=function(){},e.prototype.dispose=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),core.ui_call_supper_dispose(eui.Component,this)},e}(eui.Component);t.ButtonImgChange=e,__reflect(e.prototype,"uicommon.ButtonImgChange"),window.ButtonImgChange=e}(uicommon||(uicommon={})),window.uicommon||(window.uicommon=uicommon);var uicommon;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.m_text="",e.m_size=20,e.m_color=UtilColor.GREEN,e.labelDisplay=null,e.touchCaptured=!1,e.touchChildren=!1,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchBegin,e),e.skinName="ButtonUnderlineSkin",e}return __extends(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this.m_text},set:function(t){this.m_text=t,this._updateText()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{set:function(t){this.m_size=t,this._updateText()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{set:function(t){this.m_color=t,this._updateText()},enumerable:!0,configurable:!0}),e.prototype._updateText=function(){if(this.labelDisplay){var t=this.labelDisplay;t.textFlow=UtilRichText.formatTextFlow(this.m_text,this.m_color,this.m_size,!0),t.validateNow(),this.width=t.width,this.height=t.height,t.x=t.width/2,t.y=t.height/2,t.anchorOffsetX=t.x,t.anchorOffsetY=t.y,t.textColor=this.m_color}},e.prototype.partAdded=function(t,e){e===this.labelDisplay&&this._updateText()},e.prototype.validateDisplayList=function(){t.prototype.validateDisplayList.call(this)},e.prototype.onTouchCancle=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!1,this.invalidateState()},e.prototype.onTouchBegin=function(t){this.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!0,this.invalidateState(),t.updateAfterEvent()},e.prototype.onStageTouchEnd=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.contains(t.target)&&this.buttonReleased(),this.touchCaptured=!1,this.invalidateState()},e.prototype.getCurrentState=function(){return this.enabled?this.touchCaptured?"down":"up":"disabled"},e.prototype.buttonReleased=function(){},e.prototype.dispose=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),core.ui_call_supper_dispose(eui.Component,this)},e}(eui.Component);t.ButtonUnderline=e,__reflect(e.prototype,"uicommon.ButtonUnderline"),window.ButtonUnderline=e}(uicommon||(uicommon={})),window.uicommon||(window.uicommon=uicommon);var uicommon;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.callbackTime=50,e.m_complete_CallBack_this=null,e.m_complete_CallBack=null,e.skinName="CircleTimerSkin",e.touchChildren=!1,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.init=function(t,e,i,n,o){void 0===i&&(i=!0),void 0===n&&(n=""),void 0===o&&(o=0),this.m_time=t,this.m_diameter=e;var r=0,s=0;n?(r=o,s=o,this.bgImg.source=n,this.bgImg.width=o,this.bgImg.height=o):(r=e,s=e),this.width=r,this.height=s,this.anchorOffsetX=.5*r,this.anchorOffsetY=.5*s,this.m_bshowLabel=i,this.labelDisplay.visible=i,this.m_shap||(this.m_shap=new egret.Shape,this.shapeGroup.addChild(this.m_shap),this.shapeGroup.rotation=-90),this.timer||(this.timer=new egret.Timer(this.callbackTime,Math.ceil(t/this.callbackTime)),this.timer.addEventListener(egret.TimerEvent.TIMER,this.updateShow,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.animationComplete,this))},e.prototype.start=function(){this.timer.reset(),this.timer.start()},e.prototype.updateShow=function(){var t=this.timer.currentCount*this.callbackTime/this.m_time*360,e=360;this.changeGraphics(360*(t/e)),this.m_bshowLabel&&(this.labelDisplay.text=Math.floor(t/e*this.callbackTime).toString()+"%")},e.prototype.changeGraphics=function(t){var e=this.m_shap;e.graphics.clear(),e.graphics.beginFill(16754013,1),e.graphics.lineTo(this.m_diameter/2,0),e.graphics.drawArc(0,0,this.m_diameter/2,0,t*Math.PI/180,!1),e.graphics.lineTo(0,0),e.graphics.endFill()},e.prototype.setComplete_callback=function(t,e){this.m_complete_CallBack=t,this.m_complete_CallBack_this=e},e.prototype.animationComplete=function(){this.m_complete_CallBack&&this.m_complete_CallBack.call(this.m_complete_CallBack_this,this),this.dispose()},e.prototype.getCount=function(){return this.timer?this.callbackTime*this.timer.currentCount:0},Object.defineProperty(e.prototype,"size",{get:function(){return this.labelDisplay.size},set:function(t){this.labelDisplay.size=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this.labelDisplay.textColor},set:function(t){this.labelDisplay.textColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stroke",{set:function(t){this.labelDisplay.stroke=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stroketColor",{set:function(t){this.labelDisplay.strokeColor=t},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.m_time=0,this.m_diameter=0,this.m_bshowLabel=!0,this.m_shap&&(this.m_shap.graphics.clear(),this.m_shap=null),this.timer&&(this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.updateShow,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.animationComplete,this),this.timer=null),this.parent&&this.parent.removeChild(this),this.m_complete_CallBack=null,this.m_complete_CallBack_this=null,core.ui_call_supper_dispose(eui.Component,this)},e}(eui.Component);t.CircleTimer=e,__reflect(e.prototype,"uicommon.CircleTimer")}(uicommon||(uicommon={}));var uicommon;!function(t){var e=function(t){function e(e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=t.call(this)||this;return n.m_leftTime=0,n.m_curLeftTime=0,n.bShowHour=!0,n.bShowSecond=!0,n.bShowType=!1,n.x=e,n.y=i,n.txt=new eui.Label,n.txt.size=20,n.txt.textColor=UtilColor.DEFAULT,n.txt.fontFamily=UtilFont.SimHei,n.addChild(n.txt),n.touchEnabled=!1,n.touchChildren=!1,n}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},Object.defineProperty(e.prototype,"size",{set:function(t){this.txt.size=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textColor",{set:function(t){this.txt.textColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stroke",{set:function(t){this.txt.stroke=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeColor",{set:function(t){this.txt.strokeColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bold",{set:function(t){this.txt.bold=t},enumerable:!0,configurable:!0}),e.prototype.setCallFunc=function(t,e,i){void 0===i&&(i=null),this.thisObj=t,this.onTimerFunc=e,this.onTimerCompleteFunc=i},e.prototype.setStyle=function(t,e,i,n){void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=!1),this.m_textTemplet=t,this.bShowHour=e,this.bShowSecond=i,this.bShowType=n},e.prototype.start=function(t){null==this.timer&&(this.timer=new egret.Timer(1e3,1),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onTimerComplete,this)),this.m_leftTime=t,this.timer.repeatCount=t,this.timer.reset(),this.timer.start(),this.updateTxtLabel(t),this.txt.visible=!0},e.prototype.stop=function(){this.timer&&this.timer.stop()},e.prototype.end=function(t){void 0===t&&(t=!0),this.stop(),this.updateTxtLabel(0),this.txt.visible=t},Object.defineProperty(e.prototype,"timeLabel",{get:function(){return this.txt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curLeftTime",{get:function(){return this.m_curLeftTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bRun",{get:function(){return this.m_curLeftTime>0},enumerable:!0,configurable:!0}),e.prototype.onTimer=function(t){var e=this.m_leftTime-t.target.currentCount;this.updateTxtLabel(e),this.onTimerFunc&&this.onTimerFunc.call(this.thisObj,e)},e.prototype.onTimerComplete=function(t){this.updateTxtLabel(0),this.onTimerCompleteFunc&&this.onTimerCompleteFunc.call(this.thisObj)},e.prototype.updateTxtLabel=function(t){this.m_curLeftTime=t,this.m_textTemplet?this.txt.text=UtilTools.replaceStr(this.m_textTemplet,[UtilTime.formatTimeToString(t,this.bShowHour,this.bShowSecond,this.bShowType)]):this.txt.text=UtilTime.formatTimeToString(t,this.bShowHour,this.bShowSecond,this.bShowType)},e.prototype.dispose=function(){this.timer&&(this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onTimerComplete,this),this.timer=null),this.onTimerFunc=null,this.onTimerCompleteFunc=null,core.ui_call_supper_dispose(eui.Component,this)},e}(eui.Component);t.DaojishiLabel=e,__reflect(e.prototype,"uicommon.DaojishiLabel"),window.DaojishiLabel=e}(uicommon||(uicommon={})),window.uicommon||(window.uicommon=uicommon);var uicommon;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.skinName="MapPreviweBtnSkin",i.buyBtn.labelDisplay.text=e,i}return __extends(e,t),e.prototype.dispose=function(){this.parent&&this.parent.removeChild(this),core.ui_call_supper_dispose(eui.Component,this)},e}(eui.Component);t.ButtonPageSpecialBtn=e,__reflect(e.prototype,"uicommon.ButtonPageSpecialBtn")}(uicommon||(uicommon={}));var uicommon;!function(t){var e=function(t){function e(e,i){var n=t.call(this)||this;return n.bShowNum=!0,n.bShowTip=!0,n.bShowName=!0,n.m_objid=0,n.m_objnum=0,n.skinName="ObjItemSkin",n.x=e,n.y=i,n}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onItemRendererObjClick,this)},e.prototype.dataChanged=function(){"bShowName"in this.data&&(this.bShowName=this.data.bShowName),"scaleXY"in this.data&&(this.scaleX=this.data.scaleXY,this.scaleY=this.data.scaleXY),"bShowTip"in this.data&&(this.bShowTip=this.data.bShowTip),this.data.objid?this.m_objid=this.data.objid:this.data.id&&(this.m_objid=this.data.id),this.data.objnum?this.m_objnum=this.data.objnum:this.data.num&&(this.m_objnum=this.data.num),this.updateData(this.m_objid,this.m_objnum)},e.prototype.updateData=function(t,e){void 0===e&&(e=1);var i=Context.dataTableMgr.getItem(Table.TABLE_OBJECT,t);i&&(this.iconImg.source=i.pathIconName(),this.bShowName?(this.nameLabel.visible=!0,this.nameLabel.text=i.m_name,this.nameLabel.textColor=UtilColor.colorValue(i.m_color)):this.nameLabel.visible=!1,this.bShowNum?(this.numLabel.visible=!0,this.numLabel.text=UtilTools.num2Str(e)):this.numLabel.visible=!1)},e.prototype.iconPos=function(){return this.iconImg.localToGlobal(.5*this.iconImg.width,.5*this.iconImg.height)},e.prototype.onItemRendererObjClick=function(t){this.bShowTip&&this.m_objid&&this.m_objnum&&Context.tipsMgr.onShowObjTips(this.m_objid,this.m_objnum)},e.prototype.dispose=function(){this.m_objid=0,this.m_objnum=0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onItemRendererObjClick,this),core.ui_call_supper_dispose(eui.Component,this)},e}(eui.ItemRenderer);t.ObjectItemShow=e,__reflect(e.prototype,"uicommon.ObjectItemShow")}(uicommon||(uicommon={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var o=RES.getRes(t);o?n(o):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var uicommon;!function(t){var e=function(){function t(){this.m_pageList=[]}return t.prototype.show=function(t){return t==this.m_curPage?!1:(t.show(),this.m_curPage=t,this.notifyOthers(t),-1==this.m_pageList.indexOf(t)&&this.m_pageList.push(t),!0)},t.prototype.notifyOthers=function(t){if(t.parent){var e=this.m_pageList;for(var i in e)e[i]&&e[i]!=t&&e[i].hide()}},Object.defineProperty(t.prototype,"curPage",{get:function(){return this.m_curPage},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t=this.m_pageList;for(var e in t)t[e]&&!t[e].parent&&t[e].dispose();t.length=0},t}();t.PanelPageMgr=e,__reflect(e.prototype,"uicommon.PanelPageMgr");var i=function(t){function e(e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),t.call(this,e,i,n)||this}return __extends(e,t),e}(t.PanelShowAndHide);t.PanelPage=i,__reflect(i.prototype,"uicommon.PanelPage")}(uicommon||(uicommon={}));var httpCmd;!function(t){var e=function(){function t(){this.m_dicProcess={},this.m_receiveCache=new dataset.QueueVec(100),Context.juggle.add(this)}return t.prototype.registerProcessor=function(t,e,i){egret.assert(!(t in this.m_dicProcess)),this.m_dicProcess[t]=[e,i]},t.prototype.push=function(t){for(var e=t.length,i=0;e>i;i++)this.m_receiveCache.push(t[i])},t.prototype.advanceTime=function(t){var e=this.m_receiveCache,i=0;for(i=0;6>i&&e.size;i++){var n=this.m_receiveCache.pop(),o=this.m_dicProcess[n.param];if(o){var r=o[0],s=o[1];r.call(s,n)}else console.log("没有定义消息 param="+n.param)}},t}();t.HttpCmdRecevieMgr=e,__reflect(e.prototype,"httpCmd.HttpCmdRecevieMgr",["animation.IAnimatable"])}(httpCmd||(httpCmd={}));var uicommon;!function(t){var e=function(t){function e(){var i=t.call(this)||this;return i.m_repeat=1,i.m_repeatCount=0,i._max=1,i.m_destV=0/0,i.m_car=new animation.Car1D_2,i.m_car.addEventListener(egret.Event.COMPLETE,i.onAniEndCallBack,i),i.m_car.addEventListener(egret.Event.CHANGE,i.onChange,i),i.m_car.mvSpeed=.2,i.m_id=e.count++,i}return __extends(e,t),Object.defineProperty(e.prototype,"initValue",{set:function(t){t>this._max&&(t=this._max),this.value=t,this.m_destV=t,this.m_car.resetTo(t),0==this.m_id&&Context.logMgr.addLog("Car1D_2 resetTo"+this.m_car.curPos)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"destV",{get:function(){return this.m_destV},enumerable:!0,configurable:!0}),e.prototype.onChange=function(){this.value=this.m_car.curPos,this.m_changeCallback&&this.m_changeCallback.call(this.m_changeThisObj),0==this.m_id&&(this.value<.1||this.value>.95?Context.logMgr.addLog("Car1D_2 "+this.m_car.curPos):egret.log("Car1D_2 "+this.m_car.curPos))},e.prototype.toValue=function(t){this.m_destV=t,this.m_car.to(t)},Object.defineProperty(e.prototype,"mvSpeed",{get:function(){return this.m_car.mvSpeed},set:function(t){this.m_car.mvSpeed=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mvRepeat",{set:function(t){this.m_repeat=t},enumerable:!0,configurable:!0}),e.prototype.stop=function(){this.m_car.stop()},e.prototype.setAniEndBarFullCallBack=function(t,e){this.m_callbackThisObj=t,this.m_funCallOnAniEndBarFull=e},e.prototype.setChangeCallBack=function(t,e){this.m_changeThisObj=t,this.m_changeCallback=e},e.prototype.onAniEndCallBack=function(){1==this.m_destV&&(this.m_repeatCount+=1,0==this.m_repeat?(this.initValue=0,this.toValue(1)):this.m_repeat==this.m_repeatCount&&this.m_funCallOnAniEndBarFull&&this.m_funCallOnAniEndBarFull.call(this.m_callbackThisObj))},e.prototype.dispose=function(){this.m_callbackThisObj=null,this.m_funCallOnAniEndBarFull=null,this.m_changeThisObj=null,this.m_changeCallback=null,this.m_car.clear(),this.m_car.removeEventListener(egret.Event.COMPLETE,this.onAniEndCallBack,this),this.m_car.removeEventListener(egret.Event.CHANGE,this.onChange,this),t.prototype.dispose.call(this)},e.count=0,e}(t.PanelCut2);t.BarInProgress2=e,__reflect(e.prototype,"uicommon.BarInProgress2")}(uicommon||(uicommon={}));var httpCmd;!function(t){var e=function(){function t(){Context.bzConfig.php_server_URL&&(this.m_url=Context.bzConfig.php_server_URL+"?r="+encodeURIComponent("muYunying/gamelogic/game")),this.m_sendCache=new dataset.QueueVec(100);var t=new egret.HttpRequest;t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),t.addEventListener(egret.Event.COMPLETE,this.onLoaded,this),this.m_http=t,Context.juggle.add(this)}return t.prototype.setParam=function(t,e,i){this.m_token=t,this.m_uid=e,this.m_pid=i},t.prototype.advanceTime=function(t){if(Context.bzConfig.php_server_URL&&0!=this.m_sendCache.size&&!this.m_isSending){for(var e=[];this.m_sendCache.size;){var i=this.m_sendCache.pop();e.push(i.toObject())}var n={cmds:e};this.m_token&&(n.token=this.m_token,n.pid=this.m_pid),this.m_uid&&(n.uid=this.m_uid),this.m_isSending=!0;var o=JSON.stringify(n);this.m_content_sending=o,this.m_http.open(this.m_url,egret.HttpMethod.POST),this.m_http.send(o)}},t.prototype.send=function(t){this.m_sendCache.push(t)},t.prototype.onError=function(){this.m_isSending=!1},t.prototype.onLoaded=function(){var t=this.m_http.response,e=JSON.parse(t);if(this.m_isSending=!1,0==e.code){var i=e.cmds;Context.httpRecMgr.push(i)}else Context.sysPromptMgr.showDialogPrompt(e.msg)},t}();t.HttpCmdSendMgr=e,__reflect(e.prototype,"httpCmd.HttpCmdSendMgr",["animation.IAnimatable"])}(httpCmd||(httpCmd={}));var uimain;!function(t){t.WASTE_Recyclable=1,t.WASTE_Kitchen=2,t.WASTE_Harmful=3,t.WASTE_Other=4;var e=function(){function t(){this.m_bInit=!1}return t.prototype.init=function(){if(!this.m_bInit){var t,e=this.m_dicGoods={},i=Context.dataTableMgr.getTable(Table.TABLE_Goods);for(var n in i)t=i[n],e[t.m_type]||(e[t.m_type]={}),e[t.m_type][n]=t;this.m_bInit=!0}},t.prototype.getGoodsItem=function(t){return Context.dataTableMgr.getItem(Table.TABLE_Goods,t)},t.prototype.getGoodsList=function(t){this.init();var e=[],i=this.m_dicGoods[t];if(i){var n=void 0;for(var o in i)n=i[o],e.push(n.m_name+":"+n.m_iDesc)}return e},t.prototype.entryLobby=function(){Context.loginCC.m_finalMsgreceived=!0,Context.uimgr.showForm(UIFormID.UILobby)},t}();t.LobbyMgr=e,__reflect(e.prototype,"uimain.LobbyMgr")}(uimain||(uimain={}));var uimain;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="LobbySkin",e.horizontalCenter=0,e.verticalCenter=0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnTouchTab,this)},e.prototype.onBtnTouchTab=function(t){var e=t.target;this.studyBtn==e?Context.uimgr.showForm(UIFormID.UIStudy):this.examBtn==e?(Context.uimgr.showForm(UIFormID.UIExam),Context.uimgr.showForm(UIFormID.UIExamInfo)):this.competeBtn==e?Context.sysPromptMgr.addErrorPrompt("时间未到"):this.invitedBtn==e&&Context.sysPromptMgr.addErrorPrompt("未开放")},e.prototype.dispose=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnTouchTab,this),t.prototype.dispose.call(this)},e}(Form);t.UILobby=e,__reflect(e.prototype,"uimain.UILobby")}(uimain||(uimain={}));